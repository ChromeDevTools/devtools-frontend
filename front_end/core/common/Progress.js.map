{
  "version": 3,
  "sources": ["../../../../../../front_end/core/common/Progress.ts"],
  "sourcesContent": ["// Copyright 2012 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nexport interface Progress {\n  totalWork: number;\n  worked: number;\n  title: string|undefined;\n  canceled: boolean;\n  done: boolean;\n}\n\nexport class Progress implements Progress {\n  totalWork = 0;\n  worked = 0;\n  title: string|undefined = undefined;\n  canceled = false;\n  done = false;\n}\n\nexport class CompositeProgress {\n  readonly parent: Progress;\n  readonly #children: SubProgress[];\n  #childrenDone: number;\n\n  constructor(parent: Progress) {\n    this.parent = parent;\n    this.#children = [];\n    this.#childrenDone = 0;\n    this.parent.totalWork = 1;\n    this.parent.worked = 0;\n  }\n\n  childDone(): void {\n    if (++this.#childrenDone !== this.#children.length) {\n      return;\n    }\n    this.parent.done = true;\n  }\n\n  createSubProgress(weight?: number): SubProgress {\n    const child = new SubProgress(this, weight);\n    this.#children.push(child);\n    return child;\n  }\n\n  update(): void {\n    let totalWeights = 0;\n    let done = 0;\n\n    for (let i = 0; i < this.#children.length; ++i) {\n      const child = this.#children[i];\n      if (child.totalWork) {\n        done += child.weight * child.worked / child.totalWork;\n      }\n      totalWeights += child.weight;\n    }\n    this.parent.worked = done / totalWeights;\n  }\n}\n\nexport class SubProgress implements Progress {\n  readonly #composite: CompositeProgress;\n  #weight: number;\n  #worked: number;\n  #totalWork: number;\n  constructor(composite: CompositeProgress, weight?: number) {\n    this.#composite = composite;\n    this.#weight = weight || 1;\n    this.#worked = 0;\n\n    this.#totalWork = 0;\n  }\n\n  get canceled(): boolean {\n    return this.#composite.parent.canceled;\n  }\n\n  set title(title: string) {\n    this.#composite.parent.title = title;\n  }\n\n  set done(done: boolean) {\n    if (!done) {\n      return;\n    }\n    this.worked = this.#totalWork;\n    this.#composite.childDone();\n  }\n\n  set totalWork(totalWork: number) {\n    this.#totalWork = totalWork;\n    this.#composite.update();\n  }\n\n  set worked(worked: number) {\n    this.#worked = worked;\n    this.#composite.update();\n  }\n\n  get weight(): number {\n    return this.#weight;\n  }\n\n  get worked(): number {\n    return this.#worked;\n  }\n\n  get totalWork(): number {\n    return this.#totalWork;\n  }\n}\n\nexport class ProgressProxy implements Progress {\n  readonly #delegate: Progress|null|undefined;\n  readonly #doneCallback: (() => void)|undefined;\n  readonly #updateCallback: (() => void)|undefined;\n\n  constructor(delegate?: Progress|null, doneCallback?: (() => void), updateCallback?: (() => void)) {\n    this.#delegate = delegate;\n    this.#doneCallback = doneCallback;\n    this.#updateCallback = updateCallback;\n  }\n\n  get canceled(): boolean {\n    return this.#delegate ? this.#delegate.canceled : false;\n  }\n\n  set title(title: string) {\n    if (this.#delegate) {\n      this.#delegate.title = title;\n    }\n    if (this.#updateCallback) {\n      this.#updateCallback();\n    }\n  }\n\n  get title(): string {\n    return this.#delegate?.title ?? '';\n  }\n\n  set done(done: boolean) {\n    if (this.#delegate) {\n      this.#delegate.done = done;\n    }\n    if (done && this.#doneCallback) {\n      this.#doneCallback();\n    }\n  }\n\n  get done(): boolean {\n    return this.#delegate ? this.#delegate.done : false;\n  }\n\n  set totalWork(totalWork: number) {\n    if (this.#delegate) {\n      this.#delegate.totalWork = totalWork;\n    }\n    if (this.#updateCallback) {\n      this.#updateCallback();\n    }\n  }\n\n  get totalWork(): number {\n    return this.#delegate ? this.#delegate.totalWork : 0;\n  }\n\n  set worked(worked: number) {\n    if (this.#delegate) {\n      this.#delegate.worked = worked;\n    }\n    if (this.#updateCallback) {\n      this.#updateCallback?.();\n    }\n  }\n\n  get worked(): number {\n    return this.#delegate ? this.#delegate.worked : 0;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
