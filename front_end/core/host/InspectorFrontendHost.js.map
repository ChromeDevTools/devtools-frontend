{
  "version": 3,
  "sources": ["../../../../../../front_end/core/host/InspectorFrontendHost.ts"],
  "sourcesContent": ["// Copyright 2009 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\nimport * as i18n from '../i18n/i18n.js';\nimport * as Platform from '../platform/platform.js';\nimport * as Root from '../root/root.js';\n\nimport {\n  type AidaClientResult,\n  type AidaCodeCompleteResult,\n  type CanShowSurveyResult,\n  type ChangeEvent,\n  type ClickEvent,\n  type ContextMenuDescriptor,\n  type DispatchHttpRequestRequest,\n  type DispatchHttpRequestResult,\n  type DoAidaConversationResult,\n  type DragEvent,\n  type EnumeratedHistogram,\n  EventDescriptors,\n  Events,\n  type EventTypes,\n  type ExtensionDescriptor,\n  type FunctionCallEvent,\n  type HoverEvent,\n  type ImpressionEvent,\n  type InspectorFrontendHostAPI,\n  type KeyDownEvent,\n  type LoadNetworkResourceResult,\n  type ResizeEvent,\n  type SettingAccessEvent,\n  type ShowSurveyResult,\n  type SyncInformation,\n} from './InspectorFrontendHostAPI.js';\nimport {streamWrite as resourceLoaderStreamWrite} from './ResourceLoader.js';\n\nconst UIStrings = {\n  /**\n   * @description Document title in Inspector Frontend Host of the DevTools window\n   * @example {example.com} PH1\n   */\n  devtoolsS: 'DevTools - {PH1}',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('core/host/InspectorFrontendHost.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst MAX_RECORDED_HISTOGRAMS_SIZE = 100;\nconst OVERRIDES_FILE_SYSTEM_PATH = '/overrides' as Platform.DevToolsPath.RawPathString;\n\n/**\n * The `InspectorFrontendHostStub` is a stub interface used the frontend is loaded like a webpage. Examples:\n *   - devtools://devtools/bundled/devtools_app.html\n *   - https://chrome-devtools-frontend.appspot.com/serve_rev/@030cc140435b0152645522b9864b75cac6c0a854/worker_app.html\n *   - http://localhost:9222/devtools/inspector.html?ws=localhost:9222/devtools/page/xTARGET_IDx\n *\n * When the frontend runs within the native embedder, then the InspectorFrontendHostAPI methods are provided\n * by devtools_compatibility.js. Those leverage `DevToolsAPI.sendMessageToEmbedder()` which match up with\n * the embedder API defined here: https://source.chromium.org/search?q=f:devtools%20f:dispatcher%20f:cc%20symbol:CreateForDevToolsFrontend&sq=&ss=chromium%2Fchromium%2Fsrc\n * The native implementations live in devtools_ui_bindings.cc: https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/devtools/devtools_ui_bindings.cc\n */\nexport class InspectorFrontendHostStub implements InspectorFrontendHostAPI {\n  readonly #urlsBeingSaved = new Map<\n      Platform.DevToolsPath.RawPathString|Platform.DevToolsPath.UrlString, {isBase64: boolean, buffer: string[]}>();\n  #fileSystem: FileSystem|null = null;\n  /**\n   * Injected bellow in both stub and normal runs via:\n   * ```ts\n   * InspectorFrontendHostInstance.events = new Common.ObjectWrapper.ObjectWrapper();\n   * ```\n   */\n  declare events: Common.EventTarget.EventTarget<EventTypes>;\n\n  recordedCountHistograms:\n      Array<{histogramName: string, sample: number, min: number, exclusiveMax: number, bucketSize: number}> = [];\n  recordedEnumeratedHistograms: Array<{actionName: EnumeratedHistogram, actionCode: number}> = [];\n  recordedPerformanceHistograms: Array<{histogramName: string, duration: number}> = [];\n\n  constructor() {\n    // Guard against errors should this file ever be imported at the top level\n    // within a worker - in which case this constructor is run. If there's no\n    // document, we can early exit.\n    if (typeof document === 'undefined') {\n      return;\n    }\n\n    function stopEventPropagation(this: InspectorFrontendHostAPI, event: KeyboardEvent): void {\n      // Let browser handle Ctrl+/Ctrl- shortcuts in hosted mode.\n      const zoomModifier = this.platform() === 'mac' ? event.metaKey : event.ctrlKey;\n      if (zoomModifier && (event.key === '+' || event.key === '-')) {\n        event.stopPropagation();\n      }\n    }\n\n    document.addEventListener('keydown', event => {\n      stopEventPropagation.call(this, (event));\n    }, true);\n  }\n\n  platform(): string {\n    const userAgent = navigator.userAgent;\n    if (userAgent.includes('Windows NT')) {\n      return 'windows';\n    }\n    if (userAgent.includes('Mac OS X')) {\n      return 'mac';\n    }\n    return 'linux';\n  }\n\n  loadCompleted(): void {\n  }\n\n  bringToFront(): void {\n  }\n\n  closeWindow(): void {\n  }\n\n  setIsDocked(_isDocked: boolean, callback: () => void): void {\n    window.setTimeout(callback, 0);\n  }\n\n  showSurvey(_trigger: string, callback: (arg0: ShowSurveyResult) => void): void {\n    window.setTimeout(() => callback({surveyShown: false}), 0);\n  }\n\n  canShowSurvey(_trigger: string, callback: (arg0: CanShowSurveyResult) => void): void {\n    window.setTimeout(() => callback({canShowSurvey: false}), 0);\n  }\n\n  /**\n   * Requests inspected page to be placed atop of the inspector frontend with specified bounds.\n   */\n  setInspectedPageBounds(_bounds: {\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n  }): void {\n  }\n\n  inspectElementCompleted(): void {\n  }\n\n  setInjectedScriptForOrigin(_origin: string, _script: string): void {\n  }\n\n  inspectedURLChanged(url: Platform.DevToolsPath.UrlString): void {\n    document.title = i18nString(UIStrings.devtoolsS, {PH1: url.replace(/^https?:\\/\\//, '')});\n  }\n\n  copyText(text: string|null|undefined): void {\n    if (text === undefined || text === null) {\n      return;\n    }\n    void navigator.clipboard.writeText(text);\n  }\n\n  openInNewTab(url: Platform.DevToolsPath.UrlString): void {\n    if (Common.ParsedURL.schemeIs(url, 'javascript:')) {\n      return;\n    }\n    window.open(url, '_blank');\n  }\n\n  openSearchResultsInNewTab(_query: string): void {\n    Common.Console.Console.instance().error(\n        'Search is not enabled in hosted mode. Please inspect using chrome://inspect');\n  }\n\n  showItemInFolder(_fileSystemPath: Platform.DevToolsPath.RawPathString): void {\n    Common.Console.Console.instance().error(\n        'Show item in folder is not enabled in hosted mode. Please inspect using chrome://inspect');\n  }\n\n  // Reminder: the methods in this class belong to InspectorFrontendHostStub and are typically not executed.\n  // InspectorFrontendHostStub is ONLY used in the uncommon case of devtools not being embedded. For example: trace.cafe or http://localhost:9222/devtools/inspector.html?ws=localhost:9222/devtools/page/xTARGET_IDx\n  save(\n      url: Platform.DevToolsPath.RawPathString|Platform.DevToolsPath.UrlString, content: string, _forceSaveAs: boolean,\n      isBase64: boolean): void {\n    let buffer = this.#urlsBeingSaved.get(url)?.buffer;\n    if (!buffer) {\n      buffer = [];\n      this.#urlsBeingSaved.set(url, {isBase64, buffer});\n    }\n    buffer.push(content);\n    this.events.dispatchEventToListeners(Events.SavedURL, {url, fileSystemPath: url});\n  }\n\n  append(url: Platform.DevToolsPath.RawPathString|Platform.DevToolsPath.UrlString, content: string): void {\n    const buffer = this.#urlsBeingSaved.get(url)?.buffer;\n    if (buffer) {\n      buffer.push(content);\n      this.events.dispatchEventToListeners(Events.AppendedToURL, url);\n    }\n  }\n\n  close(url: Platform.DevToolsPath.RawPathString|Platform.DevToolsPath.UrlString): void {\n    const {isBase64, buffer} = this.#urlsBeingSaved.get(url) || {isBase64: false, buffer: []};\n    this.#urlsBeingSaved.delete(url);\n    let fileName = '';\n\n    if (url) {\n      try {\n        const trimmed = Platform.StringUtilities.trimURL(url);\n        fileName = Platform.StringUtilities.removeURLFragment(trimmed);\n      } catch {\n        // If url is not a valid URL, it is probably a filename.\n        fileName = url;\n      }\n    }\n\n    /* eslint-disable-next-line @devtools/no-imperative-dom-api */\n    const link = document.createElement('a');\n    link.download = fileName;\n    let blob;\n    if (isBase64) {\n      const bytes = Common.Base64.decode(buffer.join(''));\n      blob = new Blob([bytes], {type: 'application/gzip'});\n    } else {\n      blob = new Blob(buffer, {type: 'text/plain'});\n    }\n    const blobUrl = URL.createObjectURL(blob);\n    link.href = blobUrl;\n    link.click();\n    URL.revokeObjectURL(blobUrl);\n  }\n\n  sendMessageToBackend(_message: string): void {\n  }\n\n  recordCountHistogram(histogramName: string, sample: number, min: number, exclusiveMax: number, bucketSize: number):\n      void {\n    if (this.recordedCountHistograms.length >= MAX_RECORDED_HISTOGRAMS_SIZE) {\n      this.recordedCountHistograms.shift();\n    }\n    this.recordedCountHistograms.push({histogramName, sample, min, exclusiveMax, bucketSize});\n  }\n\n  recordEnumeratedHistogram(actionName: EnumeratedHistogram, actionCode: number, _bucketSize: number): void {\n    if (this.recordedEnumeratedHistograms.length >= MAX_RECORDED_HISTOGRAMS_SIZE) {\n      this.recordedEnumeratedHistograms.shift();\n    }\n    this.recordedEnumeratedHistograms.push({actionName, actionCode});\n  }\n\n  recordPerformanceHistogram(histogramName: string, duration: number): void {\n    if (this.recordedPerformanceHistograms.length >= MAX_RECORDED_HISTOGRAMS_SIZE) {\n      this.recordedPerformanceHistograms.shift();\n    }\n    this.recordedPerformanceHistograms.push({histogramName, duration});\n  }\n\n  recordUserMetricsAction(_umaName: string): void {\n  }\n\n  recordNewBadgeUsage(_featureName: string): void {\n  }\n\n  connectAutomaticFileSystem(\n      _fileSystemPath: Platform.DevToolsPath.RawPathString,\n      _fileSystemUUID: string,\n      _addIfMissing: boolean,\n      callback: (result: {success: boolean}) => void,\n      ): void {\n    queueMicrotask(() => callback({success: false}));\n  }\n\n  disconnectAutomaticFileSystem(_fileSystemPath: Platform.DevToolsPath.RawPathString): void {\n  }\n\n  requestFileSystems(): void {\n    this.events.dispatchEventToListeners(Events.FileSystemsLoaded, []);\n  }\n\n  addFileSystem(_type?: string): void {\n    const onFileSystem = (fs: FileSystem): void => {\n      this.#fileSystem = fs;\n      const fileSystem = {\n        fileSystemName: 'sandboxedRequestedFileSystem',\n        fileSystemPath: OVERRIDES_FILE_SYSTEM_PATH,\n        rootURL: 'filesystem:devtools://devtools/isolated/',\n        type: 'overrides' as const,\n      };\n      this.events.dispatchEventToListeners(Events.FileSystemAdded, {fileSystem});\n    };\n    window.webkitRequestFileSystem(window.TEMPORARY, 1024 * 1024, onFileSystem);\n  }\n\n  removeFileSystem(_fileSystemPath: Platform.DevToolsPath.RawPathString): void {\n    const removalCallback = (entries: Entry[]): void => {\n      entries.forEach(entry => {\n        if (entry.isDirectory) {\n          (entry as DirectoryEntry).removeRecursively(() => {});\n        } else if (entry.isFile) {\n          entry.remove(() => {});\n        }\n      });\n    };\n\n    if (this.#fileSystem) {\n      this.#fileSystem.root.createReader().readEntries(removalCallback);\n    }\n\n    this.#fileSystem = null;\n    this.events.dispatchEventToListeners(Events.FileSystemRemoved, OVERRIDES_FILE_SYSTEM_PATH);\n  }\n\n  isolatedFileSystem(_fileSystemId: string, _registeredName: string): FileSystem|null {\n    return this.#fileSystem;\n  }\n\n  loadNetworkResource(\n      url: string, _headers: string, streamId: number, callback: (arg0: LoadNetworkResourceResult) => void): void {\n    fetch(url)\n        .then(async result => {\n          const respBuffer = await result.arrayBuffer();\n          const text = await Common.Gzip.arrayBufferToString(respBuffer);\n          return text;\n        })\n        .then(function(text) {\n          resourceLoaderStreamWrite(streamId, text);\n          callback({\n            statusCode: 200,\n            headers: undefined,\n            messageOverride: undefined,\n            netError: undefined,\n            netErrorName: undefined,\n            urlValid: undefined,\n          });\n        })\n        .catch(function() {\n          callback({\n            statusCode: 404,\n            headers: undefined,\n            messageOverride: undefined,\n            netError: undefined,\n            netErrorName: undefined,\n            urlValid: undefined,\n          });\n        });\n  }\n\n  registerPreference(_name: string, _options: {synced?: boolean}): void {\n  }\n\n  getPreferences(callback: (arg0: Record<string, string>) => void): void {\n    const prefs: Record<string, string> = {};\n    for (const name in window.localStorage) {\n      prefs[name] = window.localStorage[name];\n    }\n    callback(prefs);\n  }\n\n  getPreference(name: string, callback: (arg0: string) => void): void {\n    callback(window.localStorage[name]);\n  }\n\n  setPreference(name: string, value: string): void {\n    window.localStorage[name] = value;\n  }\n\n  removePreference(name: string): void {\n    delete window.localStorage[name];\n  }\n\n  clearPreferences(): void {\n    window.localStorage.clear();\n  }\n\n  getSyncInformation(callback: (arg0: SyncInformation) => void): void {\n    if ('getSyncInformationForTesting' in globalThis) {\n      // @ts-expect-error for testing\n      return callback(globalThis.getSyncInformationForTesting());\n    }\n    callback({\n      isSyncActive: false,\n      arePreferencesSynced: false,\n    });\n  }\n\n  getHostConfig(callback: (hostConfig: Root.Runtime.HostConfig) => void): void {\n    // This HostConfig config is used in the hosted mode (see the\n    // comment on top of this class). Only add non-default config params\n    // here that you want to also apply in the hosted mode. For tests\n    // use the hostConfigForTesting override.\n    const hostConfigForHostedMode: Root.Runtime.HostConfig = {\n      devToolsVeLogging: {\n        enabled: true,\n      },\n      thirdPartyCookieControls: {\n        thirdPartyCookieMetadataEnabled: true,\n        thirdPartyCookieHeuristicsEnabled: true,\n        managedBlockThirdPartyCookies: 'Unset',\n      },\n      devToolsIpProtectionPanelInDevTools: {\n        enabled: false,\n      },\n      devToolsFlexibleLayout: {\n        verticalDrawerEnabled: true,\n      },\n      devToolsStartingStyleDebugging: {\n        enabled: false,\n      },\n    };\n    if ('hostConfigForTesting' in globalThis) {\n      const {hostConfigForTesting} = (globalThis as unknown as {hostConfigForTesting: Root.Runtime.HostConfig});\n      for (const key of Object.keys(hostConfigForTesting)) {\n        const mergeEntry = <K extends keyof Root.Runtime.HostConfig>(key: K): void => {\n          if (typeof hostConfigForHostedMode[key] === 'object' && typeof hostConfigForTesting[key] === 'object') {\n            // If the config is an object, merge the settings, but preferring\n            // the hostConfigForTesting values over the result values.\n            hostConfigForHostedMode[key] = {...hostConfigForHostedMode[key], ...hostConfigForTesting[key]};\n          } else {\n            // Override with the testing config if the value is present + not null/undefined.\n            hostConfigForHostedMode[key] = hostConfigForTesting[key] ?? hostConfigForHostedMode[key];\n          }\n        };\n        mergeEntry(key as keyof Root.Runtime.HostConfig);\n      }\n    }\n    callback(hostConfigForHostedMode);\n  }\n\n  upgradeDraggedFileSystemPermissions(_fileSystem: FileSystem): void {\n  }\n\n  indexPath(_requestId: number, _fileSystemPath: Platform.DevToolsPath.RawPathString, _excludedFolders: string): void {\n  }\n\n  stopIndexing(_requestId: number): void {\n  }\n\n  searchInPath(_requestId: number, _fileSystemPath: Platform.DevToolsPath.RawPathString, _query: string): void {\n  }\n\n  zoomFactor(): number {\n    return 1;\n  }\n\n  zoomIn(): void {\n  }\n\n  zoomOut(): void {\n  }\n\n  resetZoom(): void {\n  }\n\n  setWhitelistedShortcuts(_shortcuts: string): void {\n  }\n\n  setEyeDropperActive(_active: boolean): void {\n  }\n\n  showCertificateViewer(_certChain: string[]): void {\n  }\n\n  reattach(_callback: () => void): void {\n  }\n\n  readyForTest(): void {\n  }\n\n  connectionReady(): void {\n  }\n\n  setOpenNewWindowForPopups(_value: boolean): void {\n  }\n\n  setDevicesDiscoveryConfig(_config: Adb.Config): void {\n  }\n\n  setDevicesUpdatesEnabled(_enabled: boolean): void {\n  }\n\n  openRemotePage(_browserId: string, _url: string): void {\n  }\n\n  openNodeFrontend(): void {\n  }\n\n  showContextMenuAtPoint(_x: number, _y: number, _items: ContextMenuDescriptor[], _document: Document): void {\n    throw new Error('Soft context menu should be used');\n  }\n\n  /**\n   * Think of **Hosted mode** as \"non-embedded\" mode; you can see a devtools frontend URL as the tab's URL. It's an atypical way that DevTools is run.\n   * Whereas in **Non-hosted** (aka \"embedded\"), DevTools is embedded and fully dockable. It's the common way DevTools is run.\n   *\n   * **Hosted mode** == we're using the `InspectorFrontendHostStub`. impl. (@see `InspectorFrontendHostStub` class comment)\n   * Whereas with **non-hosted** mode, native `DevToolsEmbedderMessageDispatcher` is used for CDP and more.\n   *\n   * Relationships to other signals:\n   * - Hosted-ness does not indicate whether the frontend is _connected to a valid CDP target_.\n   * - Being _\"dockable\"_ (aka `canDock`) is typically aligned but technically orthogonal.\n   * - It's unrelated to the _tab's (main frame's) URL_. Though in non-hosted, the devtools frame origin will always be `devtools://devtools`.\n   *\n   *  | Example case                                         | Mode           | Example devtools                                                                   |\n   *  | :--------------------------------------------------- | :------------- | :---------------------------------------------------------------------------- |\n   *  | tab URL: anything. embedded DevTools w/ native CDP bindings    | **NOT Hosted** | `devtools://devtools/bundled/devtools_app.html?targetType=tab&...`            |\n   *  | tab URL: `devtools://\u2026?ws=\u2026`                | **Hosted**     | `devtools://devtools/bundled/devtools_app.html?ws=localhost:9228/...`         |\n   *  | tab URL: `devtools://\u2026` but no connection   | **Hosted**     | `devtools://devtools/bundled/devtools_app.html`                               |\n   *  | tab URL: `https://\u2026` but no connection      | **Hosted**     | `https://chrome-devtools-frontend.appspot.com/serve_rev/@.../worker_app.html` |\n   *  | tab URL: `http://\u2026?ws=` (connected)         | **Hosted**     | `http://localhost:9222/devtools/inspector.html?ws=localhost:9222/...`         |\n   */\n  isHostedMode(): boolean {\n    return true;\n  }\n\n  setAddExtensionCallback(_callback: (arg0: ExtensionDescriptor) => void): void {\n    // Extensions are not supported in hosted mode.\n  }\n\n  async initialTargetId(): Promise<string|null> {\n    return null;\n  }\n\n  doAidaConversation(_request: string, _streamId: number, callback: (result: DoAidaConversationResult) => void): void {\n    callback({\n      error: 'Not implemented',\n    });\n  }\n\n  registerAidaClientEvent(_request: string, callback: (result: AidaClientResult) => void): void {\n    callback({\n      error: 'Not implemented',\n    });\n  }\n\n  aidaCodeComplete(_request: string, callback: (result: AidaCodeCompleteResult) => void): void {\n    callback({\n      error: 'Not implemented',\n    });\n  }\n\n  dispatchHttpRequest(_request: DispatchHttpRequestRequest, callback: (result: DispatchHttpRequestResult) => void):\n      void {\n    callback({error: 'Not implemented'});\n  }\n\n  recordImpression(_event: ImpressionEvent): void {\n  }\n  recordResize(_event: ResizeEvent): void {\n  }\n  recordClick(_event: ClickEvent): void {\n  }\n  recordHover(_event: HoverEvent): void {\n  }\n  recordDrag(_event: DragEvent): void {\n  }\n  recordChange(_event: ChangeEvent): void {\n  }\n  recordKeyDown(_event: KeyDownEvent): void {\n  }\n  recordSettingAccess(_event: SettingAccessEvent): void {\n  }\n  recordFunctionCall(_event: FunctionCallEvent): void {\n  }\n}\n\n// @ts-expect-error Global injected by devtools_compatibility.js\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport let InspectorFrontendHostInstance: InspectorFrontendHostStub = globalThis.InspectorFrontendHost;\n\nclass InspectorFrontendAPIImpl {\n  constructor() {\n    for (const descriptor of EventDescriptors) {\n      // @ts-expect-error Dispatcher magic\n      this[descriptor[0]] = this.dispatch.bind(this, descriptor[0], descriptor[1], descriptor[2]);\n    }\n  }\n\n  private dispatch(name: Events, signature: string[], _runOnceLoaded: boolean, ...params: string[]): void {\n    // Single argument methods get dispatched with the param.\n    if (signature.length < 2) {\n      try {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        InspectorFrontendHostInstance.events.dispatchEventToListeners<any>(name, params[0]);\n      } catch (error) {\n        console.error(error + ' ' + error.stack);\n      }\n      return;\n    }\n    const data: Record<string, string> = {};\n    for (let i = 0; i < signature.length; ++i) {\n      data[signature[i]] = params[i];\n    }\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      InspectorFrontendHostInstance.events.dispatchEventToListeners<any>(name, data);\n    } catch (error) {\n      console.error(error + ' ' + error.stack);\n    }\n  }\n\n  streamWrite(id: number, chunk: string): void {\n    resourceLoaderStreamWrite(id, chunk);\n  }\n}\n\n/**\n * Used in `front_end/devtools_compatibility.js` to verify that calls from there\n * are valid.\n */\nexport type InspectorFrontendAPIImplMethods = keyof InspectorFrontendAPIImpl;\n\n(function(): void {\n\nfunction initializeInspectorFrontendHost(): void {\n  if (!InspectorFrontendHostInstance) {\n    // Instantiate stub for web-hosted mode if necessary.\n    // @ts-expect-error Global injected by devtools_compatibility.js\n    globalThis.InspectorFrontendHost = InspectorFrontendHostInstance = new InspectorFrontendHostStub();\n  } else {\n    // Otherwise add stubs for missing methods that are declared in the interface.\n    const proto = InspectorFrontendHostStub.prototype;\n    for (const name of (Object.getOwnPropertyNames(proto) as Array<keyof InspectorFrontendHostAPI>)) {\n      const stub = proto[name];\n      if (typeof stub !== 'function' || InspectorFrontendHostInstance[name]) {\n        continue;\n      }\n\n      console.error(`Incompatible embedder: method Host.InspectorFrontendHost.${name} is missing. Using stub instead.`);\n      // @ts-expect-error Global injected by devtools_compatibility.js\n      InspectorFrontendHostInstance[name] = stub;\n    }\n  }\n\n  // Attach the events object.\n  InspectorFrontendHostInstance.events = new Common.ObjectWrapper.ObjectWrapper();\n}\n\n// FIXME: This file is included into both apps, since the devtools_app needs the InspectorFrontendHostAPI only,\n// so the host instance should not be initialized there.\ninitializeInspectorFrontendHost();\n// @ts-expect-error Global injected by devtools_compatibility.js\nglobalThis.InspectorFrontendAPI = new InspectorFrontendAPIImpl();\n})();\n\nexport function isUnderTest(prefs?: Record<string, string>): boolean {\n  // Integration tests rely on test queryParam.\n  if (Root.Runtime.Runtime.queryParam('test')) {\n    return true;\n  }\n  // Browser tests rely on prefs.\n  if (prefs) {\n    return prefs['isUnderTest'] === 'true';\n  }\n  return Common.Settings.Settings.hasInstance() &&\n      Common.Settings.Settings.instance().createSetting('isUnderTest', false).get();\n}\n"],
  "mappings": "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",
  "names": ["key"]
}
