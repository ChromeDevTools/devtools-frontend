{"version":3,"file":"IssueAggregator.js","sourceRoot":"","sources":["../../../../../../front_end/models/issues_manager/IssueAggregator.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport {AttributionReportingIssue} from './AttributionReportingIssue.js';\nimport {ContentSecurityPolicyIssue} from './ContentSecurityPolicyIssue.js';\nimport {CookieDeprecationMetadataIssue} from './CookieDeprecationMetadataIssue.js';\nimport {CookieIssue} from './CookieIssue.js';\nimport {CorsIssue} from './CorsIssue.js';\nimport {DeprecationIssue} from './DeprecationIssue.js';\nimport {ElementAccessibilityIssue} from './ElementAccessibilityIssue.js';\nimport {GenericIssue} from './GenericIssue.js';\nimport {HeavyAdIssue} from './HeavyAdIssue.js';\nimport {Issue, IssueCategory, IssueKind, unionIssueKind} from './Issue.js';\nimport type {EventTypes as IssuesManagerEventsTypes, IssueAddedEvent} from './IssuesManager.js';\nimport {Events as IssuesManagerEvents} from './IssuesManagerEvents.js';\nimport {LowTextContrastIssue} from './LowTextContrastIssue.js';\nimport type {MarkdownIssueDescription} from './MarkdownIssueDescription.js';\nimport {MixedContentIssue} from './MixedContentIssue.js';\nimport {PartitioningBlobURLIssue} from './PartitioningBlobURLIssue.js';\nimport {PermissionElementIssue} from './PermissionElementIssue.js';\nimport {QuirksModeIssue} from './QuirksModeIssue.js';\nimport {SharedArrayBufferIssue} from './SharedArrayBufferIssue.js';\n\nexport interface IssuesProvider extends Common.EventTarget.EventTarget<IssuesManagerEventsTypes> {\n  issues(): Iterable<Issue>;\n}\n\ninterface AggregationKeyTag {\n  aggregationKeyTag: undefined;\n}\n\n/**\n * An opaque type for the key which we use to aggregate issues. The key must be\n * chosen such that if two aggregated issues have the same aggregation key, then\n * they also have the same issue code.\n */\nexport type AggregationKey = {\n  toString(): string,\n}&AggregationKeyTag;\n\n/**\n * An `AggregatedIssue` representes a number of `IssuesManager.Issue.Issue` objects that are displayed together.\n * Currently only grouping by issue code, is supported. The class provides helpers to support displaying\n * of all resources that are affected by the aggregated issues.\n */\nexport class AggregatedIssue extends Issue {\n  #allIssues = new Set<Issue>();\n  #affectedCookies = new Map<string, {\n    cookie: Protocol.Audits.AffectedCookie,\n    hasRequest: boolean,\n  }>();\n  #affectedRawCookieLines = new Map<string, {rawCookieLine: string, hasRequest: boolean}>();\n  #affectedRequests: Protocol.Audits.AffectedRequest[] = [];\n  #affectedRequestIds = new Set<Protocol.Network.RequestId>();\n  #affectedLocations = new Map<string, Protocol.Audits.SourceCodeLocation>();\n  #heavyAdIssues = new Set<HeavyAdIssue>();\n  #blockedByResponseDetails = new Map<string, Protocol.Audits.BlockedByResponseIssueDetails>();\n  #bounceTrackingSites = new Set<string>();\n  #corsIssues = new Set<CorsIssue>();\n  #cspIssues = new Set<ContentSecurityPolicyIssue>();\n  #deprecationIssues = new Set<DeprecationIssue>();\n  #issueKind = IssueKind.IMPROVEMENT;\n  #lowContrastIssues = new Set<LowTextContrastIssue>();\n  #cookieDeprecationMetadataIssues = new Set<CookieDeprecationMetadataIssue>();\n  #mixedContentIssues = new Set<MixedContentIssue>();\n  #partitioningBlobURLIssues = new Set<PartitioningBlobURLIssue>();\n  #permissionElementIssues = new Set<PermissionElementIssue>();\n  #sharedArrayBufferIssues = new Set<SharedArrayBufferIssue>();\n  #quirksModeIssues = new Set<QuirksModeIssue>();\n  #attributionReportingIssues = new Set<AttributionReportingIssue>();\n  #genericIssues = new Set<GenericIssue>();\n  #elementAccessibilityIssues = new Set<ElementAccessibilityIssue>();\n  #representative?: Issue;\n  #aggregatedIssuesCount = 0;\n  #key: AggregationKey;\n\n  constructor(code: string, aggregationKey: AggregationKey) {\n    super(code, null);\n    this.#key = aggregationKey;\n  }\n\n  override primaryKey(): string {\n    throw new Error('This should never be called');\n  }\n\n  aggregationKey(): AggregationKey {\n    return this.#key;\n  }\n\n  override getBlockedByResponseDetails(): Iterable<Protocol.Audits.BlockedByResponseIssueDetails> {\n    return this.#blockedByResponseDetails.values();\n  }\n\n  override cookies(): Iterable<Protocol.Audits.AffectedCookie> {\n    return Array.from(this.#affectedCookies.values()).map(x => x.cookie);\n  }\n\n  getRawCookieLines(): Iterable<{rawCookieLine: string, hasRequest: boolean}> {\n    return this.#affectedRawCookieLines.values();\n  }\n\n  override sources(): Iterable<Protocol.Audits.SourceCodeLocation> {\n    return this.#affectedLocations.values();\n  }\n\n  getBounceTrackingSites(): Iterable<string> {\n    return this.#bounceTrackingSites.values();\n  }\n\n  cookiesWithRequestIndicator(): Iterable<{\n    cookie: Protocol.Audits.AffectedCookie,\n    hasRequest: boolean,\n  }> {\n    return this.#affectedCookies.values();\n  }\n\n  getHeavyAdIssues(): Iterable<HeavyAdIssue> {\n    return this.#heavyAdIssues;\n  }\n\n  getCookieDeprecationMetadataIssues(): Iterable<CookieDeprecationMetadataIssue> {\n    return this.#cookieDeprecationMetadataIssues;\n  }\n\n  getMixedContentIssues(): Iterable<MixedContentIssue> {\n    return this.#mixedContentIssues;\n  }\n\n  getCorsIssues(): Set<CorsIssue> {\n    return this.#corsIssues;\n  }\n\n  getCspIssues(): Iterable<ContentSecurityPolicyIssue> {\n    return this.#cspIssues;\n  }\n\n  getDeprecationIssues(): Iterable<DeprecationIssue> {\n    return this.#deprecationIssues;\n  }\n\n  getLowContrastIssues(): Iterable<LowTextContrastIssue> {\n    return this.#lowContrastIssues;\n  }\n\n  override requests(): Iterable<Protocol.Audits.AffectedRequest> {\n    return this.#affectedRequests.values();\n  }\n\n  getSharedArrayBufferIssues(): Iterable<SharedArrayBufferIssue> {\n    return this.#sharedArrayBufferIssues;\n  }\n\n  getQuirksModeIssues(): Iterable<QuirksModeIssue> {\n    return this.#quirksModeIssues;\n  }\n\n  getAttributionReportingIssues(): ReadonlySet<AttributionReportingIssue> {\n    return this.#attributionReportingIssues;\n  }\n\n  getGenericIssues(): ReadonlySet<GenericIssue> {\n    return this.#genericIssues;\n  }\n\n  getElementAccessibilityIssues(): Iterable<ElementAccessibilityIssue> {\n    return this.#elementAccessibilityIssues;\n  }\n\n  getDescription(): MarkdownIssueDescription|null {\n    if (this.#representative) {\n      return this.#representative.getDescription();\n    }\n    return null;\n  }\n\n  getCategory(): IssueCategory {\n    if (this.#representative) {\n      return this.#representative.getCategory();\n    }\n    return IssueCategory.OTHER;\n  }\n\n  getAggregatedIssuesCount(): number {\n    return this.#aggregatedIssuesCount;\n  }\n\n  getPartitioningBlobURLIssues(): Iterable<PartitioningBlobURLIssue> {\n    return this.#partitioningBlobURLIssues;\n  }\n\n  getPermissionElementIssues(): Iterable<PermissionElementIssue> {\n    return this.#permissionElementIssues;\n  }\n\n  /**\n   * Produces a primary key for a cookie. Use this instead of `JSON.stringify` in\n   * case new fields are added to `AffectedCookie`.\n   */\n  #keyForCookie(cookie: Protocol.Audits.AffectedCookie): string {\n    const {domain, path, name} = cookie;\n    return `${domain};${path};${name}`;\n  }\n\n  addInstance(issue: Issue): void {\n    this.#aggregatedIssuesCount++;\n    if (!this.#representative) {\n      this.#representative = issue;\n    }\n    this.#allIssues.add(issue);\n    this.#issueKind = unionIssueKind(this.#issueKind, issue.getKind());\n    let hasRequest = false;\n    for (const request of issue.requests()) {\n      const {requestId} = request;\n      hasRequest = true;\n      if (requestId === undefined) {\n        this.#affectedRequests.push(request);\n      } else if (!this.#affectedRequestIds.has(requestId)) {\n        this.#affectedRequests.push(request);\n        this.#affectedRequestIds.add(requestId);\n      }\n    }\n    for (const cookie of issue.cookies()) {\n      const key = this.#keyForCookie(cookie);\n      if (!this.#affectedCookies.has(key)) {\n        this.#affectedCookies.set(key, {cookie, hasRequest});\n      }\n    }\n    for (const rawCookieLine of issue.rawCookieLines()) {\n      if (!this.#affectedRawCookieLines.has(rawCookieLine)) {\n        this.#affectedRawCookieLines.set(rawCookieLine, {rawCookieLine, hasRequest});\n      }\n    }\n    for (const site of issue.trackingSites()) {\n      if (!this.#bounceTrackingSites.has(site)) {\n        this.#bounceTrackingSites.add(site);\n      }\n    }\n    for (const location of issue.sources()) {\n      const key = JSON.stringify(location);\n      if (!this.#affectedLocations.has(key)) {\n        this.#affectedLocations.set(key, location);\n      }\n    }\n    if (issue instanceof CookieDeprecationMetadataIssue) {\n      this.#cookieDeprecationMetadataIssues.add(issue);\n    }\n    if (issue instanceof MixedContentIssue) {\n      this.#mixedContentIssues.add(issue);\n    }\n    if (issue instanceof HeavyAdIssue) {\n      this.#heavyAdIssues.add(issue);\n    }\n    for (const details of issue.getBlockedByResponseDetails()) {\n      const key = JSON.stringify(details, ['parentFrame', 'blockedFrame', 'requestId', 'frameId', 'reason', 'request']);\n      this.#blockedByResponseDetails.set(key, details);\n    }\n    if (issue instanceof ContentSecurityPolicyIssue) {\n      this.#cspIssues.add(issue);\n    }\n    if (issue instanceof DeprecationIssue) {\n      this.#deprecationIssues.add(issue);\n    }\n    if (issue instanceof SharedArrayBufferIssue) {\n      this.#sharedArrayBufferIssues.add(issue);\n    }\n    if (issue instanceof LowTextContrastIssue) {\n      this.#lowContrastIssues.add(issue);\n    }\n    if (issue instanceof CorsIssue) {\n      this.#corsIssues.add(issue);\n    }\n    if (issue instanceof QuirksModeIssue) {\n      this.#quirksModeIssues.add(issue);\n    }\n    if (issue instanceof AttributionReportingIssue) {\n      this.#attributionReportingIssues.add(issue);\n    }\n    if (issue instanceof GenericIssue) {\n      this.#genericIssues.add(issue);\n    }\n    if (issue instanceof ElementAccessibilityIssue) {\n      this.#elementAccessibilityIssues.add(issue);\n    }\n    if (issue instanceof PartitioningBlobURLIssue) {\n      this.#partitioningBlobURLIssues.add(issue);\n    }\n    if (issue instanceof PermissionElementIssue) {\n      this.#permissionElementIssues.add(issue);\n    }\n  }\n\n  getKind(): IssueKind {\n    return this.#issueKind;\n  }\n\n  getAllIssues(): Issue[] {\n    return Array.from(this.#allIssues);\n  }\n\n  override isHidden(): boolean {\n    return this.#representative?.isHidden() || false;\n  }\n\n  override setHidden(_value: boolean): void {\n    throw new Error('Should not call setHidden on aggregatedIssue');\n  }\n}\n\nexport class IssueAggregator extends Common.ObjectWrapper.ObjectWrapper<EventTypes> {\n  readonly #aggregatedIssuesByKey = new Map<AggregationKey, AggregatedIssue>();\n  readonly #hiddenAggregatedIssuesByKey = new Map<AggregationKey, AggregatedIssue>();\n  constructor(private readonly issuesManager: IssuesProvider) {\n    super();\n    this.issuesManager.addEventListener(IssuesManagerEvents.ISSUE_ADDED, this.#onIssueAdded, this);\n    this.issuesManager.addEventListener(IssuesManagerEvents.FULL_UPDATE_REQUIRED, this.#onFullUpdateRequired, this);\n    for (const issue of this.issuesManager.issues()) {\n      this.#aggregateIssue(issue);\n    }\n  }\n\n  #onIssueAdded(event: Common.EventTarget.EventTargetEvent<IssueAddedEvent>): void {\n    this.#aggregateIssue(event.data.issue);\n  }\n\n  #onFullUpdateRequired(): void {\n    this.#aggregatedIssuesByKey.clear();\n    this.#hiddenAggregatedIssuesByKey.clear();\n    for (const issue of this.issuesManager.issues()) {\n      this.#aggregateIssue(issue);\n    }\n    this.dispatchEventToListeners(Events.FULL_UPDATE_REQUIRED);\n  }\n\n  #aggregateIssue(issue: Issue): AggregatedIssue|undefined {\n    if (CookieIssue.isThirdPartyCookiePhaseoutRelatedIssue(issue)) {\n      return;\n    }\n\n    const map = issue.isHidden() ? this.#hiddenAggregatedIssuesByKey : this.#aggregatedIssuesByKey;\n    const aggregatedIssue = this.#aggregateIssueByStatus(map, issue);\n    this.dispatchEventToListeners(Events.AGGREGATED_ISSUE_UPDATED, aggregatedIssue);\n    return aggregatedIssue;\n  }\n\n  #aggregateIssueByStatus(aggregatedIssuesMap: Map<AggregationKey, AggregatedIssue>, issue: Issue): AggregatedIssue {\n    const key = issue.code() as unknown as AggregationKey;\n    let aggregatedIssue = aggregatedIssuesMap.get(key);\n    if (!aggregatedIssue) {\n      aggregatedIssue = new AggregatedIssue(issue.code(), key);\n      aggregatedIssuesMap.set(key, aggregatedIssue);\n    }\n    aggregatedIssue.addInstance(issue);\n    return aggregatedIssue;\n  }\n\n  aggregatedIssues(): Iterable<AggregatedIssue> {\n    return [...this.#aggregatedIssuesByKey.values(), ...this.#hiddenAggregatedIssuesByKey.values()];\n  }\n\n  aggregatedIssueCodes(): Set<AggregationKey> {\n    return new Set([...this.#aggregatedIssuesByKey.keys(), ...this.#hiddenAggregatedIssuesByKey.keys()]);\n  }\n\n  aggregatedIssueCategories(): Set<IssueCategory> {\n    const result = new Set<IssueCategory>();\n    for (const issue of this.#aggregatedIssuesByKey.values()) {\n      result.add(issue.getCategory());\n    }\n    return result;\n  }\n\n  aggregatedIssueKinds(): Set<IssueKind> {\n    const result = new Set<IssueKind>();\n    for (const issue of this.#aggregatedIssuesByKey.values()) {\n      result.add(issue.getKind());\n    }\n    return result;\n  }\n\n  numberOfAggregatedIssues(): number {\n    return this.#aggregatedIssuesByKey.size;\n  }\n\n  numberOfHiddenAggregatedIssues(): number {\n    return this.#hiddenAggregatedIssuesByKey.size;\n  }\n\n  keyForIssue(issue: Issue): AggregationKey {\n    return issue.code() as unknown as AggregationKey;\n  }\n}\n\nexport const enum Events {\n  AGGREGATED_ISSUE_UPDATED = 'AggregatedIssueUpdated',\n  FULL_UPDATE_REQUIRED = 'FullUpdateRequired',\n}\n\nexport interface EventTypes {\n  [Events.AGGREGATED_ISSUE_UPDATED]: AggregatedIssue;\n  [Events.FULL_UPDATE_REQUIRED]: void;\n}\n"]}