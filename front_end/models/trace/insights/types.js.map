{"version":3,"file":"types.js","sourceRoot":"","sources":["../../../../../../../front_end/models/trace/insights/types.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAsC7B,MAAM,CAAN,IAAY,cAMX;AAND,WAAY,cAAc;IACxB,iCAAe,CAAA;IACf,mCAAiB,CAAA;IACjB,uEAAuE;IACvE,6DAA2C,CAAA;IAC3C,yCAAuB,CAAA;AACzB,CAAC,EANW,cAAc,KAAd,cAAc,QAMzB;AAYD,MAAM,CAAN,IAAY,eAKX;AALD,WAAY,eAAe;IACzB,8BAAW,CAAA;IACX,8BAAW,CAAA;IACX,8BAAW,CAAA;IACX,8BAAW,CAAA;AACb,CAAC,EALW,eAAe,KAAf,eAAe,QAK1B","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Common from '../../../core/common/common.js';\nimport type * as Lantern from '../lantern/lantern.js';\nimport type * as Types from '../types/types.js';\n\nimport type * as Models from './Models.js';\n\n/**\n * Context for the portion of the trace an insight should look at.\n */\nexport type InsightSetContext = InsightSetContextWithoutNavigation|InsightSetContextWithNavigation;\n\nexport interface InsightSetContextWithoutNavigation {\n  options: Types.Configuration.ParseOptions;\n  bounds: Types.Timing.TraceWindowMicro;\n  frameId: string;\n  navigation?: never;\n}\n\nexport interface InsightSetContextWithNavigation {\n  options: Types.Configuration.ParseOptions;\n  bounds: Types.Timing.TraceWindowMicro;\n  frameId: string;\n  navigation: Types.Events.NavigationStart;\n  navigationId: string;\n  lantern?: LanternContext;\n}\n\nexport interface LanternContext {\n  requests: Array<Lantern.Types.NetworkRequest<Types.Events.SyntheticNetworkRequest>>;\n  graph: Lantern.Graph.Node<Types.Events.SyntheticNetworkRequest>;\n  simulator: Lantern.Simulation.Simulator<Types.Events.SyntheticNetworkRequest>;\n  metrics: Record<string, Lantern.Metrics.MetricResult>;\n}\n\nexport type InsightModelsType = typeof Models;\n\nexport enum InsightWarning {\n  NO_FP = 'NO_FP',\n  NO_LCP = 'NO_LCP',\n  // No network request could be identified as the primary HTML document.\n  NO_DOCUMENT_REQUEST = 'NO_DOCUMENT_REQUEST',\n  NO_LAYOUT = 'NO_LAYOUT',\n}\n\nexport interface MetricSavings {\n  /* eslint-disable @typescript-eslint/naming-convention */\n  FCP?: Types.Timing.Milli;\n  LCP?: Types.Timing.Milli;\n  TBT?: Types.Timing.Milli;\n  CLS?: number;\n  INP?: Types.Timing.Milli;\n  /* eslint-enable @typescript-eslint/naming-convention */\n}\n\nexport enum InsightCategory {\n  ALL = 'All',\n  INP = 'INP',\n  LCP = 'LCP',\n  CLS = 'CLS',\n}\n\nexport type RelatedEventsMap = Map<Types.Events.Event, string[]>;\n\nexport type Checklist<Keys extends string> = Record<Keys, {label: Common.UIString.LocalizedString, value: boolean}>;\n\nexport type InsightModel<UIStrings extends Record<string, string> = Record<string, string>,\n                                           ExtraDetail extends Record<string, unknown> = Record<string, unknown>> =\n    ExtraDetail&{\n      /** Used internally to identify the type of a model, not shown visibly to users **/\n      insightKey: keyof InsightModelsType,\n      /** Not used within DevTools - this is for external consumers (like Lighthouse). */\n      strings: UIStrings,\n      title: Common.UIString.LocalizedString,\n      description: Common.UIString.LocalizedString,\n      docs: string,\n      category: InsightCategory,\n      state: 'pass' | 'fail' | 'informative',\n      /** Used by RelatedInsightChips.ts */\n      relatedEvents?: RelatedEventsMap | Types.Events.Event[],\n      warnings?: InsightWarning[],\n      metricSavings?: MetricSavings,\n      /**\n       * An estimate for the number of bytes that this insight deems to have been wasted.\n       * Bytes are in terms of transfer size: for each component of savings related to an\n       * individual request, the insight will estimate its impact on transfer size by using\n       * the compression ratio of the resource.\n       *\n       * This field is only displayed for informational purposes.\n       */\n      wastedBytes?: number,\n      frameId?: string,\n      /**\n       * If this insight is attached to a navigation, this stores its ID.\n       */\n      navigationId?: string,\n      /** This is lazily-generated because some insights may create many overlays. */\n      createOverlays?: () => Types.Overlays.Overlay[],\n    };\n\nexport type PartialInsightModel<T> =\n    Omit<T, 'strings'|'title'|'description'|'docs'|'category'|'state'|'insightKey'|'navigationId'|'frameId'>;\n\n/**\n * Contains insights for a specific navigation. If a trace began after a navigation already started,\n * this could instead represent the duration from the beginning of the trace up to the first recorded\n * navigation (or the end of the trace).\n */\nexport interface InsightSet {\n  /** If for a navigation, this is of the form \"NAVIGATION_(index)\". Else it is Trace.Types.Events.NO_NAVIGATION. */\n  id: Types.Events.NavigationId;\n  /** The URL to show in the accordion list. */\n  url: URL;\n  frameId: string;\n  bounds: Types.Timing.TraceWindowMicro;\n  model: InsightModels;\n  navigation?: Types.Events.NavigationStart;\n}\n\n/**\n * Contains insights for a specific insight set.\n */\nexport type InsightModels = {\n  [I in keyof InsightModelsType]: ReturnType<InsightModelsType[I]['generateInsight']>;\n};\n\n/**\n * Contains insights for the entire trace. Insights are mostly grouped by `navigationId`, with one exception:\n *\n * If the analyzed trace started after the navigation, and has meaningful work with that span, there is no\n * navigation to map it to. In this case `Types.Events.NO_NAVIGATION` is used for the key.\n */\nexport type TraceInsightSets = Map<Types.Events.NavigationId, InsightSet>;\n\nexport const enum InsightKeys {\n  LCP_BREAKDOWN = 'LCPBreakdown',\n  INP_BREAKDOWN = 'INPBreakdown',\n  CLS_CULPRITS = 'CLSCulprits',\n  THIRD_PARTIES = 'ThirdParties',\n  DOCUMENT_LATENCY = 'DocumentLatency',\n  DOM_SIZE = 'DOMSize',\n  DUPLICATE_JAVASCRIPT = 'DuplicatedJavaScript',\n  FONT_DISPLAY = 'FontDisplay',\n  FORCED_REFLOW = 'ForcedReflow',\n  IMAGE_DELIVERY = 'ImageDelivery',\n  LCP_DISCOVERY = 'LCPDiscovery',\n  LEGACY_JAVASCRIPT = 'LegacyJavaScript',\n  NETWORK_DEPENDENCY_TREE = 'NetworkDependencyTree',\n  RENDER_BLOCKING = 'RenderBlocking',\n  SLOW_CSS_SELECTOR = 'SlowCSSSelector',\n  VIEWPORT = 'Viewport',\n  MODERN_HTTP = 'ModernHTTP',\n  CACHE = 'Cache',\n}\n"]}