{"version":3,"file":"WorkspaceImpl.js","sourceRoot":"","sources":["../../../../../../front_end/models/workspace/WorkspaceImpl.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2012 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport type * as TextUtils from '../text_utils/text_utils.js';\n\nimport type {SearchConfig} from './SearchConfig.js';\nimport {UISourceCode, type UISourceCodeMetadata} from './UISourceCode.js';\n\nexport interface Project {\n  workspace(): WorkspaceImpl;\n  id(): string;\n  type(): projectTypes;\n  isServiceProject(): boolean;\n  displayName(): string;\n  requestMetadata(uiSourceCode: UISourceCode): Promise<UISourceCodeMetadata|null>;\n  requestFileContent(uiSourceCode: UISourceCode): Promise<TextUtils.ContentData.ContentDataOrError>;\n  canSetFileContent(): boolean;\n  setFileContent(uiSourceCode: UISourceCode, newContent: string, isBase64: boolean): Promise<void>;\n  fullDisplayName(uiSourceCode: UISourceCode): string;\n  mimeType(uiSourceCode: UISourceCode): string;\n  canRename(): boolean;\n  rename(\n      uiSourceCode: UISourceCode, newName: Platform.DevToolsPath.RawPathString,\n      callback:\n          (arg0: boolean, arg1?: string, arg2?: Platform.DevToolsPath.UrlString,\n           arg3?: Common.ResourceType.ResourceType) => void): void;\n  excludeFolder(path: Platform.DevToolsPath.UrlString): void;\n  canExcludeFolder(path: Platform.DevToolsPath.EncodedPathString): boolean;\n  createFile(path: Platform.DevToolsPath.EncodedPathString, name: string|null, content: string, isBase64?: boolean):\n      Promise<UISourceCode|null>;\n  canCreateFile(): boolean;\n  deleteFile(uiSourceCode: UISourceCode): void;\n  deleteDirectoryRecursively(path: Platform.DevToolsPath.EncodedPathString): Promise<boolean>;\n  remove(): void;\n  removeUISourceCode(url: Platform.DevToolsPath.UrlString): void;\n  searchInFileContent(uiSourceCode: UISourceCode, query: string, caseSensitive: boolean, isRegex: boolean):\n      Promise<TextUtils.ContentProvider.SearchMatch[]>;\n  findFilesMatchingSearchRequest(\n      searchConfig: SearchConfig, filesMatchingFileQuery: UISourceCode[],\n      progress: Common.Progress.Progress): Promise<Map<UISourceCode, TextUtils.ContentProvider.SearchMatch[]|null>>;\n  indexContent(progress: Common.Progress.Progress): void;\n  uiSourceCodeForURL(url: Platform.DevToolsPath.UrlString): UISourceCode|null;\n\n  /**\n   * Returns an iterator for the currently registered {@link UISourceCode}s for this project. When\n   * new {@link UISourceCode}s are added while iterating, they might show up already. When removing\n   * {@link UISourceCode}s while iterating, these will no longer show up, and will have no effect\n   * on the other entries.\n   *\n   * @returns an iterator for the sources provided by this project.\n   */\n  uiSourceCodes(): Iterable<UISourceCode>;\n}\n\n/* eslint-disable @typescript-eslint/naming-convention -- Used by web_tests. */\nexport enum projectTypes {\n  Debugger = 'debugger',\n  Formatter = 'formatter',\n  Network = 'network',\n  FileSystem = 'filesystem',\n  ConnectableFileSystem = 'connectablefilesystem',\n  ContentScripts = 'contentscripts',\n  Service = 'service',\n}\n/* eslint-enable @typescript-eslint/naming-convention */\n\nexport abstract class ProjectStore implements Project {\n  readonly #workspace: WorkspaceImpl;\n  readonly #id: string;\n  readonly #type: projectTypes;\n  readonly #displayName: string;\n  readonly #uiSourceCodes = new Map<Platform.DevToolsPath.UrlString, UISourceCode>();\n\n  constructor(workspace: WorkspaceImpl, id: string, type: projectTypes, displayName: string) {\n    this.#workspace = workspace;\n    this.#id = id;\n    this.#type = type;\n    this.#displayName = displayName;\n  }\n\n  id(): string {\n    return this.#id;\n  }\n\n  type(): projectTypes {\n    return this.#type;\n  }\n\n  displayName(): string {\n    return this.#displayName;\n  }\n\n  workspace(): WorkspaceImpl {\n    return this.#workspace;\n  }\n\n  createUISourceCode(url: Platform.DevToolsPath.UrlString, contentType: Common.ResourceType.ResourceType):\n      UISourceCode {\n    return new UISourceCode(this, url, contentType);\n  }\n\n  addUISourceCode(uiSourceCode: UISourceCode): boolean {\n    const url = uiSourceCode.url();\n    if (this.uiSourceCodeForURL(url)) {\n      return false;\n    }\n    this.#uiSourceCodes.set(url, uiSourceCode);\n    this.#workspace.dispatchEventToListeners(Events.UISourceCodeAdded, uiSourceCode);\n    return true;\n  }\n\n  removeUISourceCode(url: Platform.DevToolsPath.UrlString): void {\n    const uiSourceCode = this.#uiSourceCodes.get(url);\n    if (uiSourceCode === undefined) {\n      return;\n    }\n    this.#uiSourceCodes.delete(url);\n    this.#workspace.dispatchEventToListeners(Events.UISourceCodeRemoved, uiSourceCode);\n  }\n\n  removeProject(): void {\n    this.#workspace.removeProject(this);\n    this.#uiSourceCodes.clear();\n  }\n\n  uiSourceCodeForURL(url: Platform.DevToolsPath.UrlString): UISourceCode|null {\n    return this.#uiSourceCodes.get(url) ?? null;\n  }\n\n  uiSourceCodes(): Iterable<UISourceCode> {\n    return this.#uiSourceCodes.values();\n  }\n\n  renameUISourceCode(uiSourceCode: UISourceCode, newName: string): void {\n    const oldPath = uiSourceCode.url();\n    const newPath = uiSourceCode.parentURL() ?\n        Common.ParsedURL.ParsedURL.urlFromParentUrlAndName(uiSourceCode.parentURL(), newName) :\n        Common.ParsedURL.ParsedURL.preEncodeSpecialCharactersInPath(newName) as Platform.DevToolsPath.UrlString;\n    this.#uiSourceCodes.set(newPath, uiSourceCode);\n    this.#uiSourceCodes.delete(oldPath);\n  }\n\n  // No-op implementation for a handful of interface methods.\n\n  rename(\n      _uiSourceCode: UISourceCode, _newName: string,\n      _callback:\n          (arg0: boolean, arg1?: string, arg2?: Platform.DevToolsPath.UrlString,\n           arg3?: Common.ResourceType.ResourceType) => void): void {\n  }\n  excludeFolder(_path: Platform.DevToolsPath.UrlString): void {\n  }\n  deleteFile(_uiSourceCode: UISourceCode): void {\n  }\n  deleteDirectoryRecursively(_path: Platform.DevToolsPath.EncodedPathString): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n  remove(): void {\n  }\n  indexContent(_progress: Common.Progress.Progress): void {\n  }\n\n  abstract isServiceProject(): boolean;\n  abstract requestMetadata(uiSourceCode: UISourceCode): Promise<UISourceCodeMetadata|null>;\n  abstract requestFileContent(uiSourceCode: UISourceCode): Promise<TextUtils.ContentData.ContentDataOrError>;\n  abstract canSetFileContent(): boolean;\n  abstract setFileContent(uiSourceCode: UISourceCode, newContent: string, isBase64: boolean): Promise<void>;\n  abstract fullDisplayName(uiSourceCode: UISourceCode): string;\n  abstract mimeType(uiSourceCode: UISourceCode): string;\n  abstract canRename(): boolean;\n  abstract canExcludeFolder(path: Platform.DevToolsPath.EncodedPathString): boolean;\n  abstract createFile(\n      path: Platform.DevToolsPath.EncodedPathString, name: string|null, content: string,\n      isBase64?: boolean): Promise<UISourceCode|null>;\n  abstract canCreateFile(): boolean;\n  abstract searchInFileContent(uiSourceCode: UISourceCode, query: string, caseSensitive: boolean, isRegex: boolean):\n      Promise<TextUtils.ContentProvider.SearchMatch[]>;\n  abstract findFilesMatchingSearchRequest(\n      searchConfig: SearchConfig, filesMatchingFileQuery: UISourceCode[],\n      progress: Common.Progress.Progress): Promise<Map<UISourceCode, TextUtils.ContentProvider.SearchMatch[]|null>>;\n}\n\nexport class WorkspaceImpl extends Common.ObjectWrapper.ObjectWrapper<EventTypes> {\n  #projects = new Map<string, Project>();\n  #hasResourceContentTrackingExtensions = false;\n\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): WorkspaceImpl {\n    const {forceNew} = opts;\n    if (!Root.DevToolsContext.globalInstance().has(WorkspaceImpl) || forceNew) {\n      Root.DevToolsContext.globalInstance().set(WorkspaceImpl, new WorkspaceImpl());\n    }\n\n    return Root.DevToolsContext.globalInstance().get(WorkspaceImpl);\n  }\n\n  static removeInstance(): void {\n    Root.DevToolsContext.globalInstance().delete(WorkspaceImpl);\n  }\n\n  uiSourceCode(projectId: string, url: Platform.DevToolsPath.UrlString): UISourceCode|null {\n    const project = this.#projects.get(projectId);\n    return project ? project.uiSourceCodeForURL(url) : null;\n  }\n\n  uiSourceCodeForURL(url: Platform.DevToolsPath.UrlString): UISourceCode|null {\n    for (const project of this.#projects.values()) {\n      const uiSourceCode = project.uiSourceCodeForURL(url);\n      if (uiSourceCode) {\n        return uiSourceCode;\n      }\n    }\n    return null;\n  }\n\n  findCompatibleUISourceCodes(uiSourceCode: UISourceCode): UISourceCode[] {\n    const url = uiSourceCode.url();\n    const contentType = uiSourceCode.contentType();\n    const result: UISourceCode[] = [];\n    for (const project of this.#projects.values()) {\n      if (uiSourceCode.project().type() !== project.type()) {\n        continue;\n      }\n      const candidate = project.uiSourceCodeForURL(url);\n      if (candidate && candidate.url() === url && candidate.contentType() === contentType) {\n        result.push(candidate);\n      }\n    }\n    return result;\n  }\n\n  uiSourceCodesForProjectType(type: projectTypes): UISourceCode[] {\n    const result: UISourceCode[] = [];\n    for (const project of this.#projects.values()) {\n      if (project.type() === type) {\n        for (const uiSourceCode of project.uiSourceCodes()) {\n          result.push(uiSourceCode);\n        }\n      }\n    }\n    return result;\n  }\n\n  addProject(project: Project): void {\n    console.assert(!this.#projects.has(project.id()), `A project with id ${project.id()} already exists!`);\n    this.#projects.set(project.id(), project);\n    this.dispatchEventToListeners(Events.ProjectAdded, project);\n  }\n\n  removeProject(project: Project): void {\n    this.#projects.delete(project.id());\n    this.dispatchEventToListeners(Events.ProjectRemoved, project);\n  }\n\n  project(projectId: string): Project|null {\n    return this.#projects.get(projectId) || null;\n  }\n\n  projectForFileSystemRoot(root: Platform.DevToolsPath.RawPathString): Project|null {\n    const projectId = Common.ParsedURL.ParsedURL.rawPathToUrlString(root);\n    return this.project(projectId);\n  }\n\n  projects(): Project[] {\n    return [...this.#projects.values()];\n  }\n\n  projectsForType(type: string): Project[] {\n    function filterByType(project: Project): boolean {\n      return project.type() === type;\n    }\n    return this.projects().filter(filterByType);\n  }\n\n  uiSourceCodes(): UISourceCode[] {\n    const result: UISourceCode[] = [];\n    for (const project of this.#projects.values()) {\n      for (const uiSourceCode of project.uiSourceCodes()) {\n        result.push(uiSourceCode);\n      }\n    }\n    return result;\n  }\n\n  setHasResourceContentTrackingExtensions(hasExtensions: boolean): void {\n    this.#hasResourceContentTrackingExtensions = hasExtensions;\n  }\n\n  hasResourceContentTrackingExtensions(): boolean {\n    return this.#hasResourceContentTrackingExtensions;\n  }\n}\n\nexport enum Events {\n  /* eslint-disable @typescript-eslint/naming-convention -- Used by web_tests. */\n  UISourceCodeAdded = 'UISourceCodeAdded',\n  UISourceCodeRemoved = 'UISourceCodeRemoved',\n  UISourceCodeRenamed = 'UISourceCodeRenamed',\n  WorkingCopyChanged = 'WorkingCopyChanged',\n  WorkingCopyCommitted = 'WorkingCopyCommitted',\n  WorkingCopyCommittedByUser = 'WorkingCopyCommittedByUser',\n  ProjectAdded = 'ProjectAdded',\n  ProjectRemoved = 'ProjectRemoved',\n  /* eslint-enable @typescript-eslint/naming-convention */\n}\n\nexport interface UISourceCodeRenamedEvent {\n  oldURL: Platform.DevToolsPath.UrlString;\n  uiSourceCode: UISourceCode;\n}\n\nexport interface WorkingCopyChangedEvent {\n  uiSourceCode: UISourceCode;\n}\n\nexport interface WorkingCopyCommittedEvent {\n  uiSourceCode: UISourceCode;\n  content: string;\n  encoded?: boolean;\n}\n\nexport interface EventTypes {\n  [Events.UISourceCodeAdded]: UISourceCode;\n  [Events.UISourceCodeRemoved]: UISourceCode;\n  [Events.UISourceCodeRenamed]: UISourceCodeRenamedEvent;\n  [Events.WorkingCopyChanged]: WorkingCopyChangedEvent;\n  [Events.WorkingCopyCommitted]: WorkingCopyCommittedEvent;\n  [Events.WorkingCopyCommittedByUser]: WorkingCopyCommittedEvent;\n  [Events.ProjectAdded]: Project;\n  [Events.ProjectRemoved]: Project;\n}\n"]}