{"version":3,"file":"ChatInput.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/ChatInput.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../../ui/components/tooltips/tooltips.js';\n\nimport type * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport * as AiAssistanceModel from '../../../models/ai_assistance/ai_assistance.js';\nimport * as GreenDev from '../../../models/greendev/greendev.js';\nimport * as Trace from '../../../models/trace/trace.js';\nimport * as Workspace from '../../../models/workspace/workspace.js';\nimport * as PanelsCommon from '../../../panels/common/common.js';\nimport * as PanelUtils from '../../../panels/utils/utils.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as Input from '../../../ui/components/input/input.js';\nimport * as Snackbars from '../../../ui/components/snackbars/snackbars.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport chatInputStyles from './chatInput.css.js';\n\nconst {html, Directives: {createRef, ref}} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Label added to the text input to describe the context for screen readers. Not shown visibly on screen.\n   */\n  inputTextAriaDescription: 'You can also use one of the suggested prompts above to start your conversation',\n  /**\n   * @description Label added to the button that reveals the selected context item in DevTools\n   */\n  revealContextDescription: 'Reveal the selected context item in DevTools',\n  /**\n   * @description The footer disclaimer that links to more information about the AI feature.\n   */\n  learnAbout: 'Learn about AI in DevTools',\n} as const;\n\n/*\n* Strings that don't need to be translated at this time.\n*/\nconst UIStringsNotTranslate = {\n  /**\n   * @description Title for the send icon button.\n   */\n  sendButtonTitle: 'Send',\n  /**\n   * @description Title for the start new chat\n   */\n  startNewChat: 'Start new chat',\n  /**\n   * @description Title for the cancel icon button.\n   */\n  cancelButtonTitle: 'Cancel',\n  /**\n   * @description Label for the \"select an element\" button.\n   */\n  selectAnElement: 'Select an element',\n  /**\n   * @description Title for the take screenshot button.\n   */\n  takeScreenshotButtonTitle: 'Take screenshot',\n  /**\n   * @description Title for the remove image input button.\n   */\n  removeImageInputButtonTitle: 'Remove image input',\n  /**\n   * @description Title for the add image button.\n   */\n  addImageButtonTitle: 'Add image',\n  /**\n   * @description Text displayed when the chat input is disabled due to reading past conversation.\n   */\n  pastConversation: 'You\\'re viewing a past conversation.',\n  /**\n   * @description Message displayed in toast in case of any failures while taking a screenshot of the page.\n   */\n  screenshotFailureMessage: 'Failed to take a screenshot. Please try again.',\n  /**\n   * @description Message displayed in toast in case of any failures while uploading an image file as input.\n   */\n  uploadImageFailureMessage: 'Failed to upload image. Please try again.',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/ai_assistance/components/ChatInput.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst lockedString = i18n.i18n.lockedString;\n\nconst SCREENSHOT_QUALITY = 80;\nconst JPEG_MIME_TYPE = 'image/jpeg';\nconst SHOW_LOADING_STATE_TIMEOUT = 100;\n\nconst RELEVANT_DATA_LINK_CHAT_ID = 'relevant-data-link-chat';\nconst RELEVANT_DATA_LINK_FOOTER_ID = 'relevant-data-link-footer';\n\nexport type ImageInputData = {\n  isLoading: true,\n}|{\n  isLoading: false,\n  data: string,\n  mimeType: string,\n  inputType: AiAssistanceModel.AiAgent.MultimodalInputType,\n};\n\nexport interface ViewInput {\n  isLoading: boolean;\n  isTextInputEmpty: boolean;\n  blockedByCrossOrigin: boolean;\n  isTextInputDisabled: boolean;\n  inputPlaceholder: Platform.UIString.LocalizedString;\n  selectedContext: AiAssistanceModel.AiAgent.ConversationContext<unknown>|null;\n  inspectElementToggled: boolean;\n  additionalFloatyContext: UI.Floaty.FloatyContextSelection[];\n  disclaimerText: string;\n  conversationType: AiAssistanceModel.AiHistoryStorage.ConversationType;\n  multimodalInputEnabled: boolean;\n  imageInput?: ImageInputData;\n  uploadImageInputEnabled: boolean;\n  isReadOnly: boolean;\n  textAreaRef: Lit.Directives.Ref<HTMLTextAreaElement>;\n\n  onContextClick: () => void;\n  onInspectElementClick: () => void;\n  onSubmit: (ev: SubmitEvent) => void;\n  onTextAreaKeyDown: (ev: KeyboardEvent) => void;\n  onCancel: (ev: SubmitEvent) => void;\n  onNewConversation: () => void;\n  onTextInputChange: (input: string) => void;\n  onTakeScreenshot: () => void;\n  onRemoveImageInput: () => void;\n  onImageUpload: (ev: Event) => void;\n}\n\nexport type ViewOutput = undefined;\n\nexport const DEFAULT_VIEW = (input: ViewInput, output: ViewOutput, target: HTMLElement): void => {\n  const chatInputContainerCls = Lit.Directives.classMap({\n    'chat-input-container': true,\n    'single-line-layout': !input.selectedContext,\n    disabled: input.isTextInputDisabled,\n  });\n\n  const renderRelevantDataDisclaimer = (tooltipId: string): Lit.LitTemplate => {\n    const classes = Lit.Directives.classMap({\n      'chat-input-disclaimer': true,\n      'hide-divider': !input.isLoading && input.blockedByCrossOrigin,\n    });\n    // clang-format off\n    return html`\n      <div class=${classes}>\n        <button\n          class=\"link\"\n          role=\"link\"\n          aria-details=${tooltipId}\n          jslog=${VisualLogging.link('open-ai-settings').track({\n            click: true,\n          })}\n          @click=${() => {\n            void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n          }}\n        >${lockedString('Relevant data')}</button>&nbsp;${lockedString('is sent to Google')}\n        <devtools-tooltip\n          id=${tooltipId}\n          variant=\"rich\"\n        ><div class=\"info-tooltip-container\">\n          ${input.disclaimerText}\n          <button\n            class=\"link tooltip-link\"\n            role=\"link\"\n            jslog=${VisualLogging.link('open-ai-settings').track({\n              click: true,\n            })}\n            @click=${() => {\n              void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n            }}>${i18nString(UIStrings.learnAbout)}\n          </button>\n        </div></devtools-tooltip>\n      </div>\n    `;\n    // clang-format on\n  };\n\n  // clang-format off\n  Lit.render(html`\n    <style>${Input.textInputStyles}</style>\n    <style>${chatInputStyles}</style>\n    ${input.isReadOnly ?\n      html`\n        <div\n          class=\"chat-readonly-container\"\n          jslog=${VisualLogging.section('read-only')}\n        >\n          <span>${lockedString(UIStringsNotTranslate.pastConversation)}</span>\n          <devtools-button\n            aria-label=${lockedString(UIStringsNotTranslate.startNewChat)}\n            class=\"chat-inline-button\"\n            @click=${input.onNewConversation}\n            .data=${{\n              variant: Buttons.Button.Variant.TEXT,\n              title: lockedString(UIStringsNotTranslate.startNewChat),\n              jslogContext: 'start-new-chat',\n            } as Buttons.Button.ButtonData}\n          >${lockedString(UIStringsNotTranslate.startNewChat)}</devtools-button>\n        </div>`\n      :\n      html`\n        <form class=\"input-form\" @submit=${input.onSubmit}>\n          ${GreenDev.Prototypes.instance().isEnabled('inDevToolsFloaty') ?\n            html`\n              <ul class=\"floaty\">\n                ${input.additionalFloatyContext.map(c => {\n                  return html`\n                    <li>\n                      <span class=\"context-item\">\n                        ${c instanceof SDK.NetworkRequest.NetworkRequest ? html`${c.url()}` :\n                          c instanceof SDK.DOMModel.DOMNode ? html`\n                            <devtools-widget .widgetConfig=${\n                              UI.Widget.widgetConfig(PanelsCommon.DOMLinkifier.DOMNodeLink, {node: c})}\n                            ></devtools-widget>` :\n                          'insight' in c ? html`${c.insight.title}` :\n                          'event' in c && 'traceStartTime' in c ? html`\n                            ${c.event.name} @ ${i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(Trace.Types.Timing.Micro(c.event.ts - c.traceStartTime))}` :\n                          Lit.nothing}\n                      </span>\n                      <devtools-button\n                        class=\"floaty-delete-button\"\n                        @click=${(e: MouseEvent) => {\n                          e.preventDefault();\n                          UI.Floaty.onFloatyContextDelete(c);\n                        }}\n                        .data=${{\n                          variant: Buttons.Button.Variant.ICON,\n                          iconName: 'cross',\n                          title: 'Delete',\n                          size: Buttons.Button.Size.SMALL,\n                        } as Buttons.Button.ButtonData}\n                      ></devtools-button>\n                    </li>`;\n                })}\n                <li class=\"open-floaty\">\n                  <devtools-button\n                    class=\"floaty-add-button\"\n                    @click=${UI.Floaty.onFloatyOpen}\n                    .data=${{\n                      variant: Buttons.Button.Variant.ICON,\n                      iconName: 'select-element',\n                      title: 'Open context picker',\n                      size: Buttons.Button.Size.SMALL,\n                    } as Buttons.Button.ButtonData}\n                  ></devtools-button>\n                </li>\n              </ul>`\n            : Lit.nothing}\n          <div class=${chatInputContainerCls}>\n            ${(input.multimodalInputEnabled && input.imageInput && !input.isTextInputDisabled) ?\n              html`\n                <div class=\"image-input-container\">\n                  <devtools-button\n                    aria-label=${lockedString(UIStringsNotTranslate.removeImageInputButtonTitle)}\n                    @click=${input.onRemoveImageInput}\n                    .data=${{\n                      variant: Buttons.Button.Variant.ICON,\n                      size: Buttons.Button.Size.MICRO,\n                      iconName: 'cross',\n                      title: lockedString(UIStringsNotTranslate.removeImageInputButtonTitle),\n                    } as Buttons.Button.ButtonData}\n                  ></devtools-button>\n                  ${input.imageInput.isLoading ?\n                    html`\n                      <div class=\"loading\">\n                        <devtools-spinner></devtools-spinner>\n                      </div>`\n                    :\n                    html`\n                      <img src=\"data:${input.imageInput.mimeType};base64, ${input.imageInput.data}\" alt=\"Image input\" />`\n                  }\n                </div>`\n              : Lit.nothing}\n            <textarea\n              class=\"chat-input\"\n              .disabled=${input.isTextInputDisabled}\n              wrap=\"hard\"\n              maxlength=\"10000\"\n              @keydown=${input.onTextAreaKeyDown}\n              @input=${(event: KeyboardEvent) => {\n                input.onTextInputChange((event.target as HTMLInputElement).value);\n              }}\n              placeholder=${input.inputPlaceholder}\n              jslog=${VisualLogging.textField('query').track({\n                change: true,\n                keydown: 'Enter',\n              })}\n              aria-description=${i18nString(UIStrings.inputTextAriaDescription)}\n              ${ref(input.textAreaRef)}\n            ></textarea>\n            <div class=\"chat-input-actions\">\n              <div class=\"chat-input-actions-left\">\n                ${input.selectedContext ?\n                  html`\n                    <div class=\"select-element\">\n                      ${input.conversationType === AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING ?\n                        html`\n                          <devtools-button\n                            .data=${{\n                              variant: Buttons.Button.Variant.ICON_TOGGLE,\n                              size: Buttons.Button.Size.SMALL,\n                              iconName: 'select-element',\n                              toggledIconName: 'select-element',\n                              toggleType: Buttons.Button.ToggleType.PRIMARY,\n                              toggled: input.inspectElementToggled,\n                              title: lockedString(UIStringsNotTranslate.selectAnElement),\n                              jslogContext: 'select-element',\n                              disabled: input.isTextInputDisabled,\n                            } as Buttons.Button.ButtonData}\n                            @click=${input.onInspectElementClick}\n                          ></devtools-button>`\n                        : Lit.nothing}\n                      <div\n                        role=button\n                        class=${Lit.Directives.classMap({\n                          'resource-link': true,\n                          'has-picker-behavior': input.conversationType === AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING,\n                          disabled: input.isTextInputDisabled,\n                        })}\n                        tabindex=${(input.conversationType === AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING || input.isTextInputDisabled) ? '-1' : '0'}\n                        @click=${input.onContextClick}\n                        @keydown=${(ev: KeyboardEvent) => {\n                          if (ev.key === 'Enter' || ev.key === ' ') {\n                            void input.onContextClick();\n                          }\n                        }}\n                        aria-description=${i18nString(UIStrings.revealContextDescription)}\n                      >\n                        ${input.selectedContext.getItem() instanceof SDK.NetworkRequest.NetworkRequest ?\n                          PanelUtils.PanelUtils.getIconForNetworkRequest(input.selectedContext.getItem() as SDK.NetworkRequest.NetworkRequest) :\n                          input.selectedContext.getItem() instanceof Workspace.UISourceCode.UISourceCode ?\n                          PanelUtils.PanelUtils.getIconForSourceFile(input.selectedContext.getItem() as Workspace.UISourceCode.UISourceCode) :\n                          input.selectedContext.getItem() instanceof AiAssistanceModel.AIContext.AgentFocus ?\n                          html`<devtools-icon name=\"performance\" title=\"Performance\"></devtools-icon>` :\n                          Lit.nothing}\n                        <span class=\"title\">\n                          ${input.selectedContext.getItem() instanceof SDK.DOMModel.DOMNode ?\n                            html`\n                              <devtools-widget .widgetConfig=${UI.Widget.widgetConfig(PanelsCommon.DOMLinkifier.DOMNodeLink, {\n                                node: input.selectedContext.getItem() as SDK.DOMModel.DOMNode,\n                                options: {\n                                  hiddenClassList: (input.selectedContext.getItem() as SDK.DOMModel.DOMNode).classNames().filter(\n                                    className => className.startsWith(AiAssistanceModel.Injected.AI_ASSISTANCE_CSS_CLASS_NAME)),\n                                  disabled: input.isTextInputDisabled,\n                                },\n                              })}></devtools-widget>`\n                            :\n                            input.selectedContext.getTitle()}\n                        </span>\n                      </div>\n                    </div>`\n                  : Lit.nothing}\n              </div>\n              <div class=\"chat-input-actions-right\">\n                <div class=\"chat-input-disclaimer-container\">\n                  ${renderRelevantDataDisclaimer(RELEVANT_DATA_LINK_CHAT_ID)}\n                </div>\n                ${(input.multimodalInputEnabled && !input.blockedByCrossOrigin) ?\n                  html`\n                    ${input.uploadImageInputEnabled ?\n                      html`\n                        <devtools-button\n                          class=\"chat-input-button\"\n                          aria-label=${lockedString(UIStringsNotTranslate.addImageButtonTitle)}\n                          @click=${input.onImageUpload}\n                          .data=${{\n                            variant: Buttons.Button.Variant.ICON,\n                            size: Buttons.Button.Size.REGULAR,\n                            disabled: input.isTextInputDisabled || input.imageInput?.isLoading,\n                            iconName: 'add-photo',\n                            title: lockedString(UIStringsNotTranslate.addImageButtonTitle),\n                            jslogContext: 'upload-image',\n                          } as Buttons.Button.ButtonData}\n                        ></devtools-button>`\n                      : Lit.nothing}\n                    <devtools-button\n                      class=\"chat-input-button\"\n                      aria-label=${lockedString(UIStringsNotTranslate.takeScreenshotButtonTitle)}\n                      @click=${input.onTakeScreenshot}\n                      .data=${{\n                        variant: Buttons.Button.Variant.ICON,\n                        size: Buttons.Button.Size.REGULAR,\n                        disabled: input.isTextInputDisabled || input.imageInput?.isLoading,\n                        iconName: 'photo-camera',\n                        title: lockedString(UIStringsNotTranslate.takeScreenshotButtonTitle),\n                        jslogContext: 'take-screenshot',\n                      } as Buttons.Button.ButtonData}\n                    ></devtools-button>`\n                  : Lit.nothing}\n                ${input.isLoading ?\n                  html`\n                    <devtools-button\n                      class=\"chat-input-button\"\n                      aria-label=${lockedString(UIStringsNotTranslate.cancelButtonTitle)}\n                      @click=${input.onCancel}\n                      .data=${{\n                        variant: Buttons.Button.Variant.ICON,\n                        size: Buttons.Button.Size.REGULAR,\n                        iconName: 'record-stop',\n                        title: lockedString(UIStringsNotTranslate.cancelButtonTitle),\n                        jslogContext: 'stop',\n                      } as Buttons.Button.ButtonData}\n                    ></devtools-button>`\n                  :\n                  input.blockedByCrossOrigin ?\n                    html`\n                      <devtools-button\n                        class=\"start-new-chat-button\"\n                        aria-label=${lockedString(UIStringsNotTranslate.startNewChat)}\n                        @click=${input.onNewConversation}\n                        .data=${{\n                          variant: Buttons.Button.Variant.OUTLINED,\n                          size: Buttons.Button.Size.SMALL,\n                          title: lockedString(UIStringsNotTranslate.startNewChat),\n                          jslogContext: 'start-new-chat',\n                        } as Buttons.Button.ButtonData}\n                      >${lockedString(UIStringsNotTranslate.startNewChat)}</devtools-button>`\n                    :\n                    html`\n                      <devtools-button\n                        class=\"chat-input-button\"\n                        aria-label=${lockedString(UIStringsNotTranslate.sendButtonTitle)}\n                        .data=${{\n                          type: 'submit',\n                          variant: Buttons.Button.Variant.ICON,\n                          size: Buttons.Button.Size.REGULAR,\n                          disabled: input.isTextInputDisabled || input.isTextInputEmpty || input.imageInput?.isLoading,\n                          iconName: 'send',\n                          title: lockedString(UIStringsNotTranslate.sendButtonTitle),\n                          jslogContext: 'send',\n                        } as Buttons.Button.ButtonData}\n                      ></devtools-button>`\n                }\n              </div>\n            </div>\n          </div>\n        </form>`\n    }\n    <footer\n      class=${Lit.Directives.classMap({\n        'chat-input-footer': true,\n        'is-read-only': input.isReadOnly,\n      })}\n      jslog=${VisualLogging.section('footer')}\n    >\n      ${renderRelevantDataDisclaimer(RELEVANT_DATA_LINK_FOOTER_ID)}\n    </footer>\n  `, target);\n  // clang-format on\n};\n\n/**\n * ChatInput is a presenter for the input area in the AI Assistance panel.\n */\nexport class ChatInput extends UI.Widget.Widget implements SDK.TargetManager.Observer {\n  isLoading = false;\n  blockedByCrossOrigin = false;\n  isTextInputDisabled = false;\n  inputPlaceholder = '' as Platform.UIString.LocalizedString;\n  selectedContext = null as AiAssistanceModel.AiAgent.ConversationContext<unknown>| null;\n  inspectElementToggled = false;\n  additionalFloatyContext = [] as UI.Floaty.FloatyContextSelection[];\n  disclaimerText = '';\n  conversationType = AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING;\n  multimodalInputEnabled = false;\n  uploadImageInputEnabled = false;\n  isReadOnly = false;\n\n  #textAreaRef = createRef<HTMLTextAreaElement>();\n  #imageInput?: ImageInputData;\n\n  setInputValue(text: string): void {\n    if (this.#textAreaRef.value) {\n      this.#textAreaRef.value.value = text;\n    }\n    this.performUpdate();\n  }\n\n  #isTextInputEmpty(): boolean {\n    return !this.#textAreaRef.value?.value?.trim();\n  }\n\n  onTextSubmit:\n      (text: string, imageInput?: Host.AidaClient.Part,\n       multimodalInputType?: AiAssistanceModel.AiAgent.MultimodalInputType) => void = () => {};\n  onContextClick = (): void => {};\n  onInspectElementClick = (): void => {};\n  onCancelClick = (): void => {};\n  onNewConversation = (): void => {};\n\n  async #handleTakeScreenshot(): Promise<void> {\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (!mainTarget) {\n      throw new Error('Could not find main target');\n    }\n    const model = mainTarget.model(SDK.ScreenCaptureModel.ScreenCaptureModel);\n    if (!model) {\n      throw new Error('Could not find model');\n    }\n    const showLoadingTimeout = setTimeout(() => {\n      this.#imageInput = {isLoading: true};\n      this.performUpdate();\n    }, SHOW_LOADING_STATE_TIMEOUT);\n    const bytes = await model.captureScreenshot(\n        Protocol.Page.CaptureScreenshotRequestFormat.Jpeg,\n        SCREENSHOT_QUALITY,\n        SDK.ScreenCaptureModel.ScreenshotMode.FROM_VIEWPORT,\n    );\n    clearTimeout(showLoadingTimeout);\n    if (bytes) {\n      this.#imageInput = {\n        isLoading: false,\n        data: bytes,\n        mimeType: JPEG_MIME_TYPE,\n        inputType: AiAssistanceModel.AiAgent.MultimodalInputType.SCREENSHOT\n      };\n      this.performUpdate();\n      void this.updateComplete.then(() => {\n        this.focusTextInput();\n      });\n    } else {\n      this.#imageInput = undefined;\n      this.performUpdate();\n      Snackbars.Snackbar.Snackbar.show({message: lockedString(UIStringsNotTranslate.screenshotFailureMessage)});\n    }\n  }\n\n  targetAdded(_target: SDK.Target.Target): void {\n  }\n  targetRemoved(_target: SDK.Target.Target): void {\n  }\n\n  #handleRemoveImageInput(): void {\n    this.#imageInput = undefined;\n    this.performUpdate();\n    void this.updateComplete.then(() => {\n      this.focusTextInput();\n    });\n  }\n\n  async #handleLoadImage(file: File): Promise<void> {\n    const showLoadingTimeout = setTimeout(() => {\n      this.#imageInput = {isLoading: true};\n      this.performUpdate();\n    }, SHOW_LOADING_STATE_TIMEOUT);\n    try {\n      const reader = new FileReader();\n      const dataUrl = await new Promise<string>((resolve, reject) => {\n        reader.onload = () => {\n          if (typeof reader.result === 'string') {\n            resolve(reader.result);\n          } else {\n            reject(new Error('FileReader result was not a string.'));\n          }\n        };\n        reader.readAsDataURL(file);\n      });\n      const commaIndex = dataUrl.indexOf(',');\n      const bytes = dataUrl.substring(commaIndex + 1);\n      this.#imageInput = {\n        isLoading: false,\n        data: bytes,\n        mimeType: file.type,\n        inputType: AiAssistanceModel.AiAgent.MultimodalInputType.UPLOADED_IMAGE\n      };\n    } catch {\n      this.#imageInput = undefined;\n      Snackbars.Snackbar.Snackbar.show({message: lockedString(UIStringsNotTranslate.uploadImageFailureMessage)});\n    }\n\n    clearTimeout(showLoadingTimeout);\n    this.performUpdate();\n    void this.updateComplete.then(() => {\n      this.focusTextInput();\n    });\n  }\n\n  #view: typeof DEFAULT_VIEW;\n\n  constructor(element?: HTMLElement, view?: typeof DEFAULT_VIEW) {\n    super(element);\n    this.#view = view ?? DEFAULT_VIEW;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    SDK.TargetManager.TargetManager.instance().addModelListener(\n        SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.PrimaryPageChanged,\n        this.#onPrimaryPageChanged, this);\n  }\n\n  override willHide(): void {\n    super.willHide();\n    SDK.TargetManager.TargetManager.instance().removeModelListener(\n        SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.PrimaryPageChanged,\n        this.#onPrimaryPageChanged, this);\n  }\n\n  #onPrimaryPageChanged(): void {\n    this.#imageInput = undefined;\n    this.performUpdate();\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          inputPlaceholder: this.inputPlaceholder,\n          isLoading: this.isLoading,\n          blockedByCrossOrigin: this.blockedByCrossOrigin,\n          isTextInputDisabled: this.isTextInputDisabled,\n          selectedContext: this.selectedContext,\n          inspectElementToggled: this.inspectElementToggled,\n          isTextInputEmpty: this.#isTextInputEmpty(),\n          additionalFloatyContext: this.additionalFloatyContext,\n          disclaimerText: this.disclaimerText,\n          conversationType: this.conversationType,\n          multimodalInputEnabled: this.multimodalInputEnabled,\n          imageInput: this.#imageInput,\n          uploadImageInputEnabled: this.uploadImageInputEnabled,\n          isReadOnly: this.isReadOnly,\n          textAreaRef: this.#textAreaRef,\n          onContextClick: this.onContextClick,\n          onInspectElementClick: this.onInspectElementClick,\n          onNewConversation: this.onNewConversation,\n          onTextInputChange: () => {\n            this.requestUpdate();\n          },\n          onTakeScreenshot: this.#handleTakeScreenshot.bind(this),\n          onRemoveImageInput: this.#handleRemoveImageInput.bind(this),\n          onSubmit: this.onSubmit,\n          onTextAreaKeyDown: this.onTextAreaKeyDown,\n          onCancel: this.onCancel,\n          onImageUpload: this.onImageUpload,\n        },\n        undefined, this.contentElement);\n  }\n\n  focusTextInput(): void {\n    this.#textAreaRef.value?.focus();\n  }\n\n  onSubmit = (event: SubmitEvent): void => {\n    event.preventDefault();\n    if (this.#imageInput?.isLoading) {\n      return;\n    }\n    const imageInput = !this.#imageInput?.isLoading && this.#imageInput?.data ?\n        {inlineData: {data: this.#imageInput.data, mimeType: this.#imageInput.mimeType}} :\n        undefined;\n    this.onTextSubmit(this.#textAreaRef.value?.value ?? '', imageInput, this.#imageInput?.inputType);\n    this.#imageInput = undefined;\n    this.setInputValue('');\n  };\n\n  onTextAreaKeyDown = (event: KeyboardEvent): void => {\n    if (!event.target || !(event.target instanceof HTMLTextAreaElement)) {\n      return;\n    }\n\n    // Go to a new line on Shift+Enter. On Enter, submit unless the\n    // user is in IME composition.\n    if (event.key === 'Enter' && !event.shiftKey && !event.isComposing) {\n      event.preventDefault();\n      if (!event.target?.value || this.#imageInput?.isLoading) {\n        return;\n      }\n      const imageInput = !this.#imageInput?.isLoading && this.#imageInput?.data ?\n          {inlineData: {data: this.#imageInput.data, mimeType: this.#imageInput.mimeType}} :\n          undefined;\n      this.onTextSubmit(event.target.value, imageInput, this.#imageInput?.inputType);\n      this.#imageInput = undefined;\n      this.setInputValue('');\n    }\n  };\n\n  onCancel = (ev: SubmitEvent): void => {\n    ev.preventDefault();\n\n    if (!this.isLoading) {\n      return;\n    }\n\n    this.onCancelClick();\n  };\n\n  onImageUpload = (ev: Event): void => {\n    ev.stopPropagation();\n    const fileSelector = UI.UIUtils.createFileSelectorElement(this.#handleLoadImage.bind(this), '.jpeg,.jpg,.png');\n    fileSelector.click();\n  };\n}\n"]}