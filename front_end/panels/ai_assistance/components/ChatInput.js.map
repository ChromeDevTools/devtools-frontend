{"version":3,"file":"ChatInput.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/ChatInput.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Platform from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as AiAssistanceModel from '../../../models/ai_assistance/ai_assistance.js';\nimport * as GreenDev from '../../../models/greendev/greendev.js';\nimport * as Trace from '../../../models/trace/trace.js';\nimport * as Workspace from '../../../models/workspace/workspace.js';\nimport * as PanelsCommon from '../../../panels/common/common.js';\nimport * as PanelUtils from '../../../panels/utils/utils.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as Input from '../../../ui/components/input/input.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport chatInputStyles from './chatInput.css.js';\n\nconst {html, Directives: {createRef, ref}} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Label added to the text input to describe the context for screen readers. Not shown visibly on screen.\n   */\n  inputTextAriaDescription: 'You can also use one of the suggested prompts above to start your conversation',\n  /**\n   * @description Label added to the button that reveals the selected context item in DevTools\n   */\n  revealContextDescription: 'Reveal the selected context item in DevTools',\n  /**\n   * @description The footer disclaimer that links to more information about the AI feature.\n   */\n  learnAbout: 'Learn about AI in DevTools',\n} as const;\n\n/*\n* Strings that don't need to be translated at this time.\n*/\nconst UIStringsNotTranslate = {\n  /**\n   * @description Title for the send icon button.\n   */\n  sendButtonTitle: 'Send',\n  /**\n   * @description Title for the start new chat\n   */\n  startNewChat: 'Start new chat',\n  /**\n   * @description Title for the cancel icon button.\n   */\n  cancelButtonTitle: 'Cancel',\n  /**\n   * @description Label for the \"select an element\" button.\n   */\n  selectAnElement: 'Select an element',\n  /**\n   * @description Label for the \"select an element\" button.\n   */\n  noElementSelected: 'No element selected',\n  /**\n   * @description Title for the take screenshot button.\n   */\n  takeScreenshotButtonTitle: 'Take screenshot',\n  /**\n   * @description Title for the remove image input button.\n   */\n  removeImageInputButtonTitle: 'Remove image input',\n  /**\n   * @description Title for the add image button.\n   */\n  addImageButtonTitle: 'Add image',\n  /**\n   * @description Text displayed when the chat input is disabled due to reading past conversation.\n   */\n  pastConversation: 'You\\'re viewing a past conversation.',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/ai_assistance/components/ChatInput.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst lockedString = i18n.i18n.lockedString;\n\nconst RELEVANT_DATA_LINK_CHAT_ID = 'relevant-data-link-chat';\nconst RELEVANT_DATA_LINK_FOOTER_ID = 'relevant-data-link-footer';\n\nexport type ImageInputData = {\n  isLoading: true,\n}|{\n  isLoading: false,\n  data: string,\n  mimeType: string,\n  inputType: AiAssistanceModel.AiAgent.MultimodalInputType,\n};\n\nexport interface ViewInput {\n  isLoading: boolean;\n  isTextInputEmpty: boolean;\n  blockedByCrossOrigin: boolean;\n  isTextInputDisabled: boolean;\n  inputPlaceholder: Platform.UIString.LocalizedString;\n  selectedContext: AiAssistanceModel.AiAgent.ConversationContext<unknown>|null;\n  inspectElementToggled: boolean;\n  additionalFloatyContext: UI.Floaty.FloatyContextSelection[];\n  disclaimerText: string;\n  conversationType: AiAssistanceModel.AiHistoryStorage.ConversationType;\n  multimodalInputEnabled?: boolean;\n  imageInput?: ImageInputData;\n  uploadImageInputEnabled?: boolean;\n  isReadOnly: boolean;\n  textAreaRef: Lit.Directives.Ref<HTMLTextAreaElement>;\n\n  onContextClick: () => void;\n  onInspectElementClick: () => void;\n  onSubmit: (ev: SubmitEvent) => void;\n  onTextAreaKeyDown: (ev: KeyboardEvent) => void;\n  onCancel: (ev: SubmitEvent) => void;\n  onNewConversation: () => void;\n  onTextInputChange: (input: string) => void;\n  onTakeScreenshot: () => void;\n  onRemoveImageInput: () => void;\n  onImageUpload: (ev: Event) => void;\n}\n\nexport type ViewOutput = undefined;\n\nfunction renderRelevantDataDisclaimer({isLoading, blockedByCrossOrigin, tooltipId, disclaimerText}: {\n  isLoading: boolean,\n  blockedByCrossOrigin: boolean,\n  tooltipId: string,\n  disclaimerText: string,\n}): Lit.LitTemplate {\n  const classes = Lit.Directives.classMap({\n    'chat-input-disclaimer': true,\n    'hide-divider': !isLoading && blockedByCrossOrigin,\n  });\n  // clang-format off\n  return html`\n    <p class=${classes}>\n      <button\n        class=\"link\"\n        role=\"link\"\n        aria-details=${tooltipId}\n        jslog=${VisualLogging.link('open-ai-settings').track({\n          click: true,\n        })}\n        @click=${() => {\n          void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n        }}\n      >${lockedString('Relevant data')}</button>&nbsp;${lockedString('is sent to Google')}\n      ${renderDisclaimerTooltip(tooltipId, disclaimerText)}\n    </p>\n  `;\n  // clang-format on\n}\n\nfunction renderFooter(\n    disclaimerText: string, isLoading: boolean, blockedByCrossOrigin: boolean, isReadOnly: boolean): Lit.LitTemplate {\n  const classes = Lit.Directives.classMap({\n    'chat-input-footer': true,\n    'is-read-only': isReadOnly,\n  });\n\n  // clang-format off\n  return html`\n    <footer class=${classes} jslog=${VisualLogging.section('footer')}>\n      ${renderRelevantDataDisclaimer({\n        isLoading,\n        blockedByCrossOrigin,\n        tooltipId: RELEVANT_DATA_LINK_FOOTER_ID,\n        disclaimerText\n      })}\n    </footer>\n  `;\n  // clang-format on\n}\n\nfunction renderDisclaimerTooltip(id: string, disclaimerText: string): Lit.TemplateResult {\n  // clang-format off\n  return html`\n    <devtools-tooltip\n      id=${id}\n      variant=\"rich\"\n    >\n      <div class=\"info-tooltip-container\">\n        ${disclaimerText}\n        <button\n          class=\"link tooltip-link\"\n          role=\"link\"\n          jslog=${VisualLogging.link('open-ai-settings').track({\n            click: true,\n          })}\n          @click=${() => {\n            void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n          }}>${i18nString(UIStrings.learnAbout)}\n        </button>\n      </div>\n    </devtools-tooltip>`;\n  // clang-format on\n}\n\nfunction renderFloatyContext(context: UI.Floaty.FloatyContextSelection): Lit.TemplateResult {\n  if (context instanceof SDK.NetworkRequest.NetworkRequest) {\n    return html`${context.url()}`;\n  }\n\n  if (context instanceof SDK.DOMModel.DOMNode) {\n    return html`<devtools-widget .widgetConfig=${\n        UI.Widget.widgetConfig(PanelsCommon.DOMLinkifier.DOMNodeLink, {node: context})}>`;\n  }\n\n  if ('insight' in context) {\n    return html`${context.insight.title}`;\n  }\n\n  if ('event' in context && 'traceStartTime' in context) {\n    const time = Trace.Types.Timing.Micro(context.event.ts - context.traceStartTime);\n    return html`${context.event.name} @ ${i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(time)}`;\n  }\n\n  Platform.assertNever(context, 'Unsupported context');\n}\n\nfunction renderFloatyExtraContext(contexts: UI.Floaty.FloatyContextSelection[]): Lit.LitTemplate {\n  if (!GreenDev.Prototypes.instance().isEnabled('inDevToolsFloaty')) {\n    return Lit.nothing;\n  }\n\n  // clang-format off\n  return html`\n  <ul class=\"floaty\">\n    ${contexts.map(c => {\n      function onDelete(e: MouseEvent): void {\n        e.preventDefault();\n        UI.Floaty.onFloatyContextDelete(c);\n      }\n\n      return html`<li>\n        <span class=\"context-item\">\n          ${renderFloatyContext(c)}\n        </span>\n        <devtools-button\n          class=\"floaty-delete-button\"\n          @click=${onDelete}\n          .data=${{\n            variant: Buttons.Button.Variant.ICON,\n            iconName: 'cross',\n            title: 'Delete',\n            size: Buttons.Button.Size.SMALL,\n          } as Buttons.Button.ButtonData}\n        ></devtools-button>\n      </li>`;\n    })}\n    <li class=\"open-floaty\">\n      <devtools-button\n        class=\"floaty-add-button\"\n        @click=${UI.Floaty.onFloatyOpen}\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          iconName: 'select-element',\n          title: 'Open context picker',\n          size: Buttons.Button.Size.SMALL,\n        } as Buttons.Button.ButtonData}\n      ></devtools-button>\n    </li>\n  </ul>\n  `;\n  // clang-format on\n}\n\nfunction renderImageInput({\n  multimodalInputEnabled,\n  imageInput,\n  isTextInputDisabled,\n  onRemoveImageInput,\n}: {\n  multimodalInputEnabled?: boolean,\n  imageInput?: ImageInputData,\n  isTextInputDisabled?: boolean,\n  onRemoveImageInput?: () => void,\n}): Lit.LitTemplate {\n  if (!multimodalInputEnabled || !imageInput || isTextInputDisabled) {\n    return Lit.nothing;\n  }\n  // clang-format off\n  const crossButton = html`<devtools-button\n    aria-label=${lockedString(UIStringsNotTranslate.removeImageInputButtonTitle)}\n    @click=${onRemoveImageInput}\n    .data=${\n      {\n        variant: Buttons.Button.Variant.ICON,\n        size: Buttons.Button.Size.MICRO,\n        iconName: 'cross',\n        title: lockedString(UIStringsNotTranslate.removeImageInputButtonTitle),\n      } as Buttons.Button.ButtonData\n    }\n  ></devtools-button>`;\n  // clang-format on\n\n  if (imageInput.isLoading) {\n    // clang-format off\n      return html`<div class=\"image-input-container\">\n        ${crossButton}\n        <div class=\"loading\">\n          <devtools-spinner></devtools-spinner>\n        </div>\n      </div>`;\n    // clang-format on\n  }\n  // clang-format off\n    return  html`\n    <div class=\"image-input-container\">\n      ${crossButton}\n      <img src=\"data:${imageInput.mimeType};base64, ${imageInput.data}\" alt=\"Image input\" />\n    </div>`;\n  // clang-format on\n}\n\nfunction renderContextIcon(context: AiAssistanceModel.AiAgent.ConversationContext<unknown>|null): Lit.LitTemplate {\n  if (!context) {\n    return Lit.nothing;\n  }\n  const item = context.getItem();\n  // FIXME: move this to presenter once PanelUtils are declarative. The instance\n  // checking should be in the presenter and the rendering in the view function.\n  if (item instanceof SDK.NetworkRequest.NetworkRequest) {\n    return PanelUtils.PanelUtils.getIconForNetworkRequest(item);\n  }\n  if (item instanceof Workspace.UISourceCode.UISourceCode) {\n    return PanelUtils.PanelUtils.getIconForSourceFile(item);\n  }\n  if (item instanceof AiAssistanceModel.AIContext.AgentFocus) {\n    return html`<devtools-icon name=\"performance\" title=\"Performance\"></devtools-icon>`;\n  }\n  if (item instanceof SDK.DOMModel.DOMNode) {\n    return Lit.nothing;\n  }\n  return Lit.nothing;\n}\n\nfunction renderContextTitle(\n    context: AiAssistanceModel.AiAgent.ConversationContext<unknown>, disabled: boolean): Lit.TemplateResult|string {\n  const item = context.getItem();\n  if (item instanceof SDK.DOMModel.DOMNode) {\n    // FIXME: move this to the model code.\n    const hiddenClassList = item.classNames().filter(\n        className => className.startsWith(AiAssistanceModel.Injected.AI_ASSISTANCE_CSS_CLASS_NAME));\n    return html`<devtools-widget .widgetConfig=${UI.Widget.widgetConfig(PanelsCommon.DOMLinkifier.DOMNodeLink, {\n      node: item,\n      options: {hiddenClassList, disabled}\n    })}></devtools-widget>`;\n  }\n  return context.getTitle();\n}\n\nfunction renderSelection({\n  selectedContext,\n  inspectElementToggled,\n  conversationType,\n  isTextInputDisabled,\n  onContextClick,\n  onInspectElementClick,\n}: {\n  selectedContext: AiAssistanceModel.AiAgent.ConversationContext<unknown>|null,\n  inspectElementToggled: boolean,\n  isTextInputDisabled: boolean,\n  onContextClick: () => void | Promise<void>,\n  onInspectElementClick: () => void,\n  conversationType: AiAssistanceModel.AiHistoryStorage.ConversationType,\n}): Lit.LitTemplate {\n  if (!selectedContext) {\n    return Lit.nothing;\n  }\n  // TODO: currently the picker behavior is SDKNode specific.\n  const hasPickerBehavior = conversationType === AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING;\n\n  const resourceClass = Lit.Directives.classMap({\n    'not-selected': !selectedContext,\n    'resource-link': true,\n    'has-picker-behavior': hasPickerBehavior,\n    disabled: isTextInputDisabled,\n  });\n\n  const handleKeyDown = (ev: KeyboardEvent): void => {\n    if (ev.key === 'Enter' || ev.key === ' ') {\n      void onContextClick();\n    }\n  };\n\n  // clang-format off\n  return html`<div class=\"select-element\">\n    ${\n      hasPickerBehavior ? html`\n        <devtools-button\n          .data=${{\n              variant: Buttons.Button.Variant.ICON_TOGGLE,\n              size: Buttons.Button.Size.SMALL,\n              iconName: 'select-element',\n              toggledIconName: 'select-element',\n              toggleType: Buttons.Button.ToggleType.PRIMARY,\n              toggled: inspectElementToggled,\n              title: lockedString(UIStringsNotTranslate.selectAnElement),\n              jslogContext: 'select-element',\n              disabled: isTextInputDisabled,\n          } as Buttons.Button.ButtonData}\n          @click=${onInspectElementClick}\n        ></devtools-button>\n      ` : Lit.nothing\n    }\n    <div\n      role=button\n      class=${resourceClass}\n      tabindex=${(hasPickerBehavior || isTextInputDisabled) ? '-1' : '0'}\n      @click=${onContextClick}\n      @keydown=${handleKeyDown}\n      aria-description=${i18nString(UIStrings.revealContextDescription)}\n    >\n      ${renderContextIcon(selectedContext)}\n      <span class=\"title\">${selectedContext ? renderContextTitle(selectedContext, isTextInputDisabled) : lockedString(UIStringsNotTranslate.noElementSelected)}</span>\n    </div>\n  </div>`;\n  // clang-format on\n}\n\nfunction renderMultimodalInputButtons({\n  multimodalInputEnabled,\n  blockedByCrossOrigin,\n  isTextInputDisabled,\n  imageInput,\n  uploadImageInputEnabled,\n  onTakeScreenshot,\n  onImageUpload,\n}: {\n  isTextInputDisabled: boolean,\n  blockedByCrossOrigin: boolean,\n  multimodalInputEnabled?: boolean,\n  imageInput?: ImageInputData,\n  uploadImageInputEnabled?: boolean,\n  onTakeScreenshot?: () => void,\n  onImageUpload?: (ev: Event) => void,\n}): Lit.LitTemplate {\n  if (!multimodalInputEnabled || blockedByCrossOrigin) {\n    return Lit.nothing;\n  }\n  // clang-format off\n  const addImageButton = uploadImageInputEnabled ? html`<devtools-button\n    class=\"chat-input-button\"\n    aria-label=${lockedString(UIStringsNotTranslate.addImageButtonTitle)}\n    @click=${onImageUpload}\n    .data=${\n      {\n        variant: Buttons.Button.Variant.ICON,\n        size: Buttons.Button.Size.REGULAR,\n        disabled: isTextInputDisabled || imageInput?.isLoading,\n        iconName: 'add-photo',\n        title: lockedString(UIStringsNotTranslate.addImageButtonTitle),\n        jslogContext: 'upload-image',\n      } as Buttons.Button.ButtonData\n    }\n  ></devtools-button>` : Lit.nothing;\n\n  return html`${addImageButton}<devtools-button\n    class=\"chat-input-button\"\n    aria-label=${lockedString(UIStringsNotTranslate.takeScreenshotButtonTitle)}\n    @click=${onTakeScreenshot}\n    .data=${\n      {\n        variant: Buttons.Button.Variant.ICON,\n        size: Buttons.Button.Size.REGULAR,\n        disabled: isTextInputDisabled || imageInput?.isLoading,\n        iconName: 'photo-camera',\n        title: lockedString(UIStringsNotTranslate.takeScreenshotButtonTitle),\n        jslogContext: 'take-screenshot',\n      } as Buttons.Button.ButtonData\n    }\n  ></devtools-button>`;\n  // clang-format on\n}\n\nfunction renderChatInputButtons(\n    {isLoading, blockedByCrossOrigin, isTextInputDisabled, isTextInputEmpty, imageInput, onCancel, onNewConversation}: {\n      isLoading: boolean,\n      blockedByCrossOrigin: boolean,\n      isTextInputDisabled: boolean,\n      isTextInputEmpty: boolean,\n      onCancel: (ev: SubmitEvent) => void,\n      onNewConversation: () => void,\n      imageInput?: ImageInputData,\n    }): Lit.TemplateResult {\n  if (isLoading) {\n    // clang-format off\n    return html`<devtools-button\n      class=\"chat-input-button\"\n      aria-label=${lockedString(UIStringsNotTranslate.cancelButtonTitle)}\n      @click=${onCancel}\n      .data=${\n        {\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.REGULAR,\n          iconName: 'record-stop',\n          title: lockedString(UIStringsNotTranslate.cancelButtonTitle),\n          jslogContext: 'stop',\n        } as Buttons.Button.ButtonData\n      }\n    ></devtools-button>`;\n    // clang-format on\n  }\n  if (blockedByCrossOrigin) {\n    // clang-format off\n    return html`\n      <devtools-button\n        class=\"start-new-chat-button\"\n        aria-label=${lockedString(UIStringsNotTranslate.startNewChat)}\n        @click=${onNewConversation}\n        .data=${\n          {\n            variant: Buttons.Button.Variant.OUTLINED,\n            size: Buttons.Button.Size.SMALL,\n            title: lockedString(UIStringsNotTranslate.startNewChat),\n            jslogContext: 'start-new-chat',\n          } as Buttons.Button.ButtonData\n        }\n      >${lockedString(UIStringsNotTranslate.startNewChat)}</devtools-button>\n    `;\n    // clang-format on\n  }\n  // clang-format off\n  return html`<devtools-button\n    class=\"chat-input-button\"\n    aria-label=${lockedString(UIStringsNotTranslate.sendButtonTitle)}\n    .data=${\n      {\n        type: 'submit',\n        variant: Buttons.Button.Variant.ICON,\n        size: Buttons.Button.Size.REGULAR,\n        disabled: isTextInputDisabled || isTextInputEmpty || imageInput?.isLoading,\n        iconName: 'send',\n        title: lockedString(UIStringsNotTranslate.sendButtonTitle),\n        jslogContext: 'send',\n      } as Buttons.Button.ButtonData\n    }\n  ></devtools-button>`;\n}\n\nfunction renderReadOnlySection({onNewConversation}: {\n  onNewConversation: () => void,\n}): Lit.LitTemplate {\n  // clang-format off\n  return html`<div\n    class=\"chat-readonly-container\"\n    jslog=${VisualLogging.section('read-only')}\n  >\n    <span>${lockedString(UIStringsNotTranslate.pastConversation)}</span>\n    <devtools-button\n      aria-label=${lockedString(UIStringsNotTranslate.startNewChat)}\n      class=\"chat-inline-button\"\n      @click=${onNewConversation}\n      .data=${{\n        variant: Buttons.Button.Variant.TEXT,\n        title: lockedString(UIStringsNotTranslate.startNewChat),\n        jslogContext: 'start-new-chat',\n      } as Buttons.Button.ButtonData}\n    >${lockedString(UIStringsNotTranslate.startNewChat)}</devtools-button>\n  </div>`;\n  // clang-format on\n}\n\nexport const DEFAULT_VIEW = (input: ViewInput, output: ViewOutput, target: HTMLElement): void => {\n  const chatInputContainerCls = Lit.Directives.classMap({\n    'chat-input-container': true,\n    'single-line-layout': !input.selectedContext,\n    disabled: input.isTextInputDisabled,\n  });\n\n  if (input.isReadOnly) {\n    Lit.render(\n        html`<style>${chatInputStyles}</style>\n        ${renderReadOnlySection({\n          onNewConversation: input.onNewConversation\n        })}\n        ${renderFooter(input.disclaimerText, input.isLoading, input.blockedByCrossOrigin, input.isReadOnly)}`,\n        target);\n    return;\n  }\n\n  // clang-format off\n  Lit.render(html`\n  <style>${Input.textInputStyles}</style>\n  <style>${chatInputStyles}</style>\n  <form class=\"input-form\" @submit=${input.onSubmit}>\n  ${renderFloatyExtraContext(input.additionalFloatyContext)}\n    <div class=${chatInputContainerCls}>\n      ${renderImageInput({\n        multimodalInputEnabled: input.multimodalInputEnabled,\n        imageInput: input.imageInput,\n        isTextInputDisabled: input.isTextInputDisabled,\n        onRemoveImageInput: input.onRemoveImageInput,\n      })}\n      <textarea\n        class=\"chat-input\"\n        .disabled=${input.isTextInputDisabled}\n        wrap=\"hard\"\n        maxlength=\"10000\"\n        @keydown=${input.onTextAreaKeyDown}\n        @input=${(event: KeyboardEvent) => {\n          input.onTextInputChange((event.target as HTMLInputElement).value);\n        }}\n        placeholder=${input.inputPlaceholder}\n        jslog=${VisualLogging.textField('query').track({\n          change: true,\n          keydown: 'Enter',\n        })}\n        aria-description=${i18nString(UIStrings.inputTextAriaDescription)}\n        ${ref(input.textAreaRef)}\n      ></textarea>\n      <div class=\"chat-input-actions\">\n        <div class=\"chat-input-actions-left\">\n          ${renderSelection({\n            selectedContext: input.selectedContext,\n            inspectElementToggled: input.inspectElementToggled,\n            conversationType: input.conversationType,\n            isTextInputDisabled: input.isTextInputDisabled,\n            onContextClick: input.onContextClick,\n            onInspectElementClick: input.onInspectElementClick,\n          })}\n        </div>\n        <div class=\"chat-input-actions-right\">\n          <div class=\"chat-input-disclaimer-container\">\n            ${renderRelevantDataDisclaimer({\n              isLoading: input.isLoading,\n              blockedByCrossOrigin: input.blockedByCrossOrigin,\n              tooltipId: RELEVANT_DATA_LINK_CHAT_ID,\n              disclaimerText: input.disclaimerText,\n            })}\n          </div>\n          ${renderMultimodalInputButtons({\n            multimodalInputEnabled: input.multimodalInputEnabled,\n            blockedByCrossOrigin: input.blockedByCrossOrigin,\n            isTextInputDisabled: input.isTextInputDisabled,\n            imageInput: input.imageInput,\n            uploadImageInputEnabled: input.uploadImageInputEnabled,\n            onTakeScreenshot: input.onTakeScreenshot,\n            onImageUpload: input.onImageUpload,\n          })}\n          ${renderChatInputButtons({\n            isLoading: input.isLoading,\n            blockedByCrossOrigin: input.blockedByCrossOrigin,\n            isTextInputDisabled: input.isTextInputDisabled,\n            isTextInputEmpty: input.isTextInputEmpty,\n            imageInput: input.imageInput,\n            onCancel: input.onCancel,\n            onNewConversation: input.onNewConversation,\n          })}\n        </div>\n      </div>\n    </div>\n    </div>\n  </form>\n  ${renderFooter(input.disclaimerText, input.isLoading, input.blockedByCrossOrigin, input.isReadOnly)}\n  `, target);\n  // clang-format on\n};\n\n/**\n * ChatInput is a presenter for the input area in the AI Assistance panel.\n */\nexport class ChatInput extends UI.Widget.Widget {\n  isLoading = false;\n  blockedByCrossOrigin = false;\n  isTextInputDisabled = false;\n  inputPlaceholder = '' as Platform.UIString.LocalizedString;\n  selectedContext = null as AiAssistanceModel.AiAgent.ConversationContext<unknown>| null;\n  inspectElementToggled = false;\n  additionalFloatyContext = [] as UI.Floaty.FloatyContextSelection[];\n  disclaimerText = '';\n  conversationType = AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING;\n  multimodalInputEnabled?: boolean = false;\n  imageInput = undefined as ImageInputData | undefined;\n  uploadImageInputEnabled?: boolean = false;\n  isReadOnly = false;\n  #textAreaRef = createRef<HTMLTextAreaElement>();\n\n  setInputValue(text: string): void {\n    if (this.#textAreaRef.value) {\n      this.#textAreaRef.value.value = text;\n    }\n    this.performUpdate();\n  }\n\n  #isTextInputEmpty(): boolean {\n    return !this.#textAreaRef.value?.value?.trim();\n  }\n\n  onTextSubmit:\n      (text: string, imageInput?: Host.AidaClient.Part,\n       multimodalInputType?: AiAssistanceModel.AiAgent.MultimodalInputType) => void = () => {};\n  onContextClick = (): void => {};\n  onInspectElementClick = (): void => {};\n  onCancelClick = (): void => {};\n  onNewConversation = (): void => {};\n  onTakeScreenshot: () => void = () => {};\n  onRemoveImageInput: () => void = () => {};\n  onLoadImage: (_file: File) => Promise<void> = () => Promise.resolve();\n\n  #view: typeof DEFAULT_VIEW;\n\n  constructor(element?: HTMLElement, view?: typeof DEFAULT_VIEW) {\n    super(element);\n    this.#view = view ?? DEFAULT_VIEW;\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          inputPlaceholder: this.inputPlaceholder,\n          isLoading: this.isLoading,\n          blockedByCrossOrigin: this.blockedByCrossOrigin,\n          isTextInputDisabled: this.isTextInputDisabled,\n          selectedContext: this.selectedContext,\n          inspectElementToggled: this.inspectElementToggled,\n          isTextInputEmpty: this.#isTextInputEmpty(),\n          additionalFloatyContext: this.additionalFloatyContext,\n          disclaimerText: this.disclaimerText,\n          conversationType: this.conversationType,\n          multimodalInputEnabled: this.multimodalInputEnabled,\n          imageInput: this.imageInput,\n          uploadImageInputEnabled: this.uploadImageInputEnabled,\n          isReadOnly: this.isReadOnly,\n          textAreaRef: this.#textAreaRef,\n          onContextClick: this.onContextClick,\n          onInspectElementClick: this.onInspectElementClick,\n          onNewConversation: this.onNewConversation,\n          onTextInputChange: () => {\n            this.requestUpdate();\n          },\n          onTakeScreenshot: this.onTakeScreenshot,\n          onRemoveImageInput: this.onRemoveImageInput,\n          onSubmit: this.onSubmit,\n          onTextAreaKeyDown: this.onTextAreaKeyDown,\n          onCancel: this.onCancel,\n          onImageUpload: this.onImageUpload,\n        },\n        undefined, this.contentElement);\n  }\n\n  focusTextInput(): void {\n    this.#textAreaRef.value?.focus();\n  }\n\n  onSubmit = (event: SubmitEvent): void => {\n    event.preventDefault();\n    if (this.imageInput?.isLoading) {\n      return;\n    }\n    const imageInput = !this.imageInput?.isLoading && this.imageInput?.data ?\n        {inlineData: {data: this.imageInput.data, mimeType: this.imageInput.mimeType}} :\n        undefined;\n    this.onTextSubmit(this.#textAreaRef.value?.value ?? '', imageInput, this.imageInput?.inputType);\n    this.setInputValue('');\n  };\n\n  onTextAreaKeyDown = (event: KeyboardEvent): void => {\n    if (!event.target || !(event.target instanceof HTMLTextAreaElement)) {\n      return;\n    }\n\n    // Go to a new line on Shift+Enter. On Enter, submit unless the\n    // user is in IME composition.\n    if (event.key === 'Enter' && !event.shiftKey && !event.isComposing) {\n      event.preventDefault();\n      if (!event.target?.value || this.imageInput?.isLoading) {\n        return;\n      }\n      const imageInput = !this.imageInput?.isLoading && this.imageInput?.data ?\n          {inlineData: {data: this.imageInput.data, mimeType: this.imageInput.mimeType}} :\n          undefined;\n      this.onTextSubmit(event.target.value, imageInput, this.imageInput?.inputType);\n      this.setInputValue('');\n    }\n  };\n\n  onCancel = (ev: SubmitEvent): void => {\n    ev.preventDefault();\n\n    if (!this.isLoading) {\n      return;\n    }\n\n    this.onCancelClick();\n  };\n\n  onImageUpload = (ev: Event): void => {\n    ev.stopPropagation();\n    if (this.onLoadImage) {\n      const fileSelector = UI.UIUtils.createFileSelectorElement(this.onLoadImage.bind(this), '.jpeg,.jpg,.png');\n      fileSelector.click();\n    }\n  };\n}\n"]}