{"version":3,"file":"DisabledWidget.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/DisabledWidget.ts"],"names":[],"mappings":"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","sourcesContent":["\n// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Root from '../../../core/root/root.js';\nimport * as uiI18n from '../../../ui/i18n/i18n.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport {html, type LitTemplate, render} from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport disabledWidgetStyles from './disabledWidget.css.js';\n\nconst UIStrings = {\n  /**\n   * @description The error message when the user is not logged in into Chrome.\n   */\n  notLoggedIn: 'This feature is only available when you are signed into Chrome with your Google account',\n  /**\n   * @description Message shown when the user is offline.\n   */\n  offline: 'Check your internet connection and try again',\n  /**\n   * @description Text for a link to Chrome DevTools Settings.\n   */\n  settingsLink: 'AI assistance in Settings',\n  /**\n   * @description Text for asking the user to turn the AI assistance feature in settings first before they are able to use it.\n   * @example {AI assistance in Settings} PH1\n   */\n  turnOnForStyles: 'Turn on {PH1} to get help with understanding CSS styles',\n  /**\n   * @description Text for asking the user to turn the AI assistance feature in settings first before they are able to use it.\n   * @example {AI assistance in Settings} PH1\n   */\n  turnOnForStylesAndRequests: 'Turn on {PH1} to get help with styles and network requests',\n  /**\n   * @description Text for asking the user to turn the AI assistance feature in settings first before they are able to use it.\n   * @example {AI assistance in Settings} PH1\n   */\n  turnOnForStylesRequestsAndFiles: 'Turn on {PH1} to get help with styles, network requests, and files',\n  /**\n   * @description Text for asking the user to turn the AI assistance feature in settings first before they are able to use it.\n   * @example {AI assistance in Settings} PH1\n   */\n  turnOnForStylesRequestsPerformanceAndFiles:\n      'Turn on {PH1} to get help with styles, network requests, performance, and files',\n  /**\n   * @description Text informing the user that AI assistance is not available in Incognito mode or Guest mode.\n   */\n  notAvailableInIncognitoMode: 'AI assistance is not available in Incognito mode or Guest mode',\n\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/ai_assistance/components/DisabledWidget.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface ViewProps {\n  aidaAvailability: Host.AidaClient.AidaAccessPreconditions;\n  hostConfig: Root.Runtime.HostConfig;\n}\n\nfunction renderAidaUnavailableContents(\n    aidaAvailability:\n        Exclude<Host.AidaClient.AidaAccessPreconditions, Host.AidaClient.AidaAccessPreconditions.AVAILABLE>):\n    LitTemplate {\n  switch (aidaAvailability) {\n    case Host.AidaClient.AidaAccessPreconditions.NO_ACCOUNT_EMAIL:\n    case Host.AidaClient.AidaAccessPreconditions.SYNC_IS_PAUSED: {\n      return html`${i18nString(UIStrings.notLoggedIn)}`;\n    }\n    case Host.AidaClient.AidaAccessPreconditions.NO_INTERNET: {\n      return html`${i18nString(UIStrings.offline)}`;\n    }\n  }\n}\n\nfunction renderConsentViewContents(\n    hostConfig: Root.Runtime.HostConfig,\n    ): LitTemplate {\n  if (hostConfig.isOffTheRecord) {\n    return html`${i18nString(UIStrings.notAvailableInIncognitoMode)}`;\n  }\n\n  // eslint-disable-next-line @devtools/no-imperative-dom-api\n  const settingsLink = document.createElement('span');\n  settingsLink.textContent = i18nString(UIStrings.settingsLink);\n  settingsLink.classList.add('link');\n  UI.ARIAUtils.markAsLink(settingsLink);\n  settingsLink.addEventListener('click', () => {\n    void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n  });\n  settingsLink.setAttribute('jslog', `${VisualLogging.action('open-ai-settings').track({click: true})}`);\n\n  let consentViewContents: HTMLSpanElement;\n  if (hostConfig.devToolsAiAssistancePerformanceAgent?.enabled) {\n    consentViewContents = uiI18n.getFormatLocalizedString(\n        str_, UIStrings.turnOnForStylesRequestsPerformanceAndFiles, {PH1: settingsLink});\n  } else if (hostConfig.devToolsAiAssistanceFileAgent?.enabled) {\n    consentViewContents =\n        uiI18n.getFormatLocalizedString(str_, UIStrings.turnOnForStylesRequestsAndFiles, {PH1: settingsLink});\n  } else if (hostConfig.devToolsAiAssistanceNetworkAgent?.enabled) {\n    consentViewContents =\n        uiI18n.getFormatLocalizedString(str_, UIStrings.turnOnForStylesAndRequests, {PH1: settingsLink});\n  } else {\n    consentViewContents = uiI18n.getFormatLocalizedString(str_, UIStrings.turnOnForStyles, {PH1: settingsLink});\n  }\n\n  return html`${consentViewContents}`;\n}\n\nexport const DEFAULT_VIEW = (\n    input: ViewProps,\n    _output: Record<string, unknown>,\n    target: HTMLElement,\n    ): void => {\n  // clang-format off\n  render(\n    html`\n      <style>\n        ${disabledWidgetStyles}\n      </style>\n      <div class=\"disabled-view\">\n        <div class=\"disabled-view-icon-container\">\n          <devtools-icon name=\"smart-assistant\"></devtools-icon>\n        </div>\n        <div>\n          ${input.aidaAvailability ===\n          Host.AidaClient.AidaAccessPreconditions.AVAILABLE\n            ? renderConsentViewContents(input.hostConfig)\n            : renderAidaUnavailableContents(input.aidaAvailability)}\n        </div>\n      </div>\n    `,\n    target\n  );\n  // clang-format on\n};\n\nexport type View = typeof DEFAULT_VIEW;\n\nexport class DisabledWidget extends UI.Widget.Widget {\n  aidaAvailability: Host.AidaClient.AidaAccessPreconditions = Host.AidaClient.AidaAccessPreconditions.NO_ACCOUNT_EMAIL;\n\n  #view: View;\n  constructor(element?: HTMLElement, view = DEFAULT_VIEW) {\n    super(element);\n    this.#view = view;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    void this.requestUpdate();\n  }\n\n  override performUpdate(): Promise<void>|void {\n    const hostConfig = Root.Runtime.hostConfig;\n\n    this.#view(\n        {\n          aidaAvailability: this.aidaAvailability,\n          hostConfig,\n        },\n        {},\n        this.contentElement,\n    );\n  }\n}\n"]}