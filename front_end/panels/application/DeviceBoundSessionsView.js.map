{"version":3,"file":"DeviceBoundSessionsView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/application/DeviceBoundSessionsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2026 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/components/report_view/report_view.js';\nimport '../../ui/legacy/components/data_grid/data_grid.js';\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {html, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport {\n  DeviceBoundSessionModelEvents,\n  type DeviceBoundSessionsModel,\n  type SessionAndEvents\n} from './DeviceBoundSessionsModel.js';\nimport deviceBoundSessionsViewStyles from './deviceBoundSessionsView.css.js';\n\nconst UIStrings = {\n  /**\n   *@description Label for a site, e.g. https://example.com/.\n   */\n  keySite: 'Site',\n  /**\n   *@description Label for the ID of a session.\n   */\n  keyId: 'ID',\n  /**\n   *@description Label that shows the URL that can be used to refresh a session.\n   */\n  refreshUrl: 'Refresh URL',\n  /**\n   *@description Section header for how a session's scope is defined.\n   */\n  scope: 'Scope',\n  /**\n   *@description Section header for HTTP cookies.\n   */\n  cookieCravings: 'Cookies',\n  /**\n   *@description Label for the name of an HTTP cookie.\n   */\n  name: 'Name',\n  /**\n   *@description Label for an expiration date.\n   */\n  expiryDate: 'Expiry date',\n  /**\n   *@description Label for a cryptographic string challenge that has been cached for a session.\n   */\n  cachedChallenge: 'Cached challenge',\n  /**\n   *@description Label for the HTTP initiator that is allowed to trigger a refresh of a session.\n   */\n  allowedRefreshInitiators: 'Allowed refresh initiators',\n  /**\n   *@description Section header for a session's basic configuration.\n   */\n  sessionConfig: 'Session config',\n  /**\n   *@description Label for an HTTP origin.\n   */\n  origin: 'Origin',\n  /**\n   *@description Text for whether a site is included.\n   */\n  includeSite: 'Include site',\n  /**\n   *@description Value for a label that indicates that a site is included.\n   */\n  yes: 'Yes',\n  /**\n   *@description Value for a label that indicates that a site is not included.\n   */\n  no: 'No',\n  /**\n   *@description Label the host pattern of a URL, e.g. *.example.com\n   */\n  ruleHostPattern: 'Host pattern',\n  /**\n   *@description Label for the path prefix of a URL, e.g. /path/1/2/3\n   */\n  rulePathPrefix: 'Path prefix',\n  /**\n   *@description The type of a rule. The possible types are \"exclude\" or \"include\".\n   */\n  ruleType: 'Rule type',\n  /**\n   *@description Text describing that a rule excludes something.\n   */\n  ruleTypeExclude: 'Exclude',\n  /**\n   *@description Text describing that a rule includes something.\n   */\n  ruleTypeInclude: 'Include',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/application/DeviceBoundSessionsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface ViewInput {\n  sessionAndEvents?: SessionAndEvents;\n}\n\ntype ViewOutput = object;\n\nfunction ruleTypeToString(ruleType: Protocol.Network.DeviceBoundSessionUrlRuleRuleType): string {\n  switch (ruleType) {\n    case Protocol.Network.DeviceBoundSessionUrlRuleRuleType.Exclude:\n      return i18nString(UIStrings.ruleTypeExclude);\n    case Protocol.Network.DeviceBoundSessionUrlRuleRuleType.Include:\n      return i18nString(UIStrings.ruleTypeInclude);\n    default:\n      return ruleType;\n  }\n}\n\nexport const DEFAULT_VIEW = (input: ViewInput, _output: ViewOutput, target: HTMLElement): void => {\n  const {sessionAndEvents} = input;\n\n  if (!sessionAndEvents?.session) {\n    render(nothing, target);\n    return;\n  }\n\n  const {key, inclusionRules, cookieCravings} = sessionAndEvents.session;\n  const sessionDetails = html`\n      <devtools-report>\n        <devtools-report-section-header>${i18nString(UIStrings.sessionConfig)}</devtools-report-section-header>\n        <devtools-report-key>${i18nString(UIStrings.keySite)}</devtools-report-key>\n        <devtools-report-value>${key.site}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.keyId)}</devtools-report-key>\n        <devtools-report-value>${key.id}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.refreshUrl)}</devtools-report-key>\n        <devtools-report-value>${sessionAndEvents.session.refreshUrl}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.expiryDate)}</devtools-report-key>\n        <devtools-report-value>${\n      new Date(sessionAndEvents.session.expiryDate * 1000).toLocaleString()}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.cachedChallenge)}</devtools-report-key>\n        <devtools-report-value>${sessionAndEvents.session.cachedChallenge || ''}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.allowedRefreshInitiators)}</devtools-report-key>\n        <devtools-report-value>${sessionAndEvents.session.allowedRefreshInitiators.join(', ')}</devtools-report-value>\n        <devtools-report-section-header>${i18nString(UIStrings.scope)}</devtools-report-section-header>\n        <devtools-report-key>${i18nString(UIStrings.origin)}</devtools-report-key>\n        <devtools-report-value>${inclusionRules.origin}</devtools-report-value>\n        <devtools-report-key>${i18nString(UIStrings.includeSite)}</devtools-report-key>\n        <devtools-report-value>${\n      inclusionRules.includeSite ? i18nString(UIStrings.yes) : i18nString(UIStrings.no)}</devtools-report-value>\n      </devtools-report>\n      ${\n      inclusionRules.urlRules.length > 0 ? html`\n        <div class=\"device-bound-session-grid-wrapper\">\n          <devtools-data-grid class=\"device-bound-session-url-rules-grid\" striped inline>\n            <table>\n              <thead>\n                <tr>\n                  <th id=\"should-include\" weight=\"1\" sortable>${i18nString(UIStrings.ruleType)}</th>\n                  <th id=\"host-pattern\" weight=\"2\" sortable>${i18nString(UIStrings.ruleHostPattern)}</th>\n                  <th id=\"path-prefix\" weight=\"2\" sortable>${i18nString(UIStrings.rulePathPrefix)}</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${inclusionRules.urlRules.map(rule => html`\n                  <tr>\n                    <td>${ruleTypeToString(rule.ruleType)}</td>\n                    <td>${rule.hostPattern}</td>\n                    <td>${rule.pathPrefix}</td>\n                  </tr>\n                `)}\n              </tbody>\n            </table>\n          </devtools-data-grid>\n        </div>\n      ` :\n                                           nothing}\n      <devtools-report-section-header>${i18nString(UIStrings.cookieCravings)}</devtools-report-section-header>\n      ${\n      cookieCravings.length > 0 ? html`\n        <div class=\"device-bound-session-grid-wrapper\">\n          <devtools-data-grid class=\"device-bound-session-cookie-cravings-grid\" striped inline>\n            <table>\n              <thead>\n                <tr>\n                  <th id=\"name\" weight=\"2\" sortable>${i18nString(UIStrings.name)}</th>\n                  <th id=\"domain\" weight=\"2\" sortable>${i18n.i18n.lockedString('Domain')}</th>\n                  <th id=\"path\" weight=\"2\" sortable>${i18n.i18n.lockedString('Path')}</th>\n                  <th id=\"secure\" type=\"boolean\" align=\"center\" weight=\"1\" sortable>${\n                                      i18n.i18n.lockedString('Secure')}</th>\n                  <th id=\"http-only\" type=\"boolean\" align=\"center\" weight=\"1\" sortable>${\n                                      i18n.i18n.lockedString('HttpOnly')}</th>\n                  <th id=\"same-site\" weight=\"1\" sortable>${i18n.i18n.lockedString('SameSite')}</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${cookieCravings.map(craving => html`\n                  <tr>\n                    <td>${craving.name}</td>\n                    <td>${craving.domain}</td>\n                    <td>${craving.path}</td>\n                    <td>${craving.secure}</td>\n                    <td>${craving.httpOnly}</td>\n                    <td>${craving.sameSite}</td>\n                  </tr>\n                `)}\n              </tbody>\n            </table>\n          </devtools-data-grid>\n        </div>\n      ` :\n                                  nothing}`;\n\n  render(\n      html`\n        <style>${UI.inspectorCommonStyles}</style>\n        <style>${deviceBoundSessionsViewStyles}</style>\n        <div class=\"device-bound-session-view-wrapper\">\n          ${sessionDetails}\n        </div>`,\n      target);\n};\n\nexport class DeviceBoundSessionsView extends UI.Widget.VBox {\n  #site?: string;\n  #sessionId?: string;\n  #model?: DeviceBoundSessionsModel;\n  #view: typeof DEFAULT_VIEW;\n\n  constructor(view: typeof DEFAULT_VIEW = DEFAULT_VIEW) {\n    super({jslog: `${VisualLogging.pane('device-bound-sessions')}`});\n    this.#view = view;\n  }\n\n  showSession(model: DeviceBoundSessionsModel, site: string, sessionId?: string): void {\n    this.#site = site;\n    this.#sessionId = sessionId;\n    if (this.#model) {\n      this.#model.removeEventListener(DeviceBoundSessionModelEvents.EVENT_OCCURRED, this.performUpdate, this);\n    }\n    this.#model = model;\n    this.#model.addEventListener(DeviceBoundSessionModelEvents.EVENT_OCCURRED, this.performUpdate, this);\n    this.performUpdate();\n  }\n\n  override performUpdate(): void {\n    let sessionAndEvents: SessionAndEvents|undefined;\n    if (this.#site && this.#model) {\n      sessionAndEvents = this.#model.getSession(this.#site, this.#sessionId);\n    }\n    this.#view({sessionAndEvents}, {}, this.contentElement);\n  }\n}\n"]}