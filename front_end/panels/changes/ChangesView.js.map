{"version":3,"file":"ChangesView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/changes/ChangesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/legacy/legacy.js';\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport type * as Workspace from '../../models/workspace/workspace.js';\nimport * as WorkspaceDiff from '../../models/workspace_diff/workspace_diff.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as Lit from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport {ChangesSidebar, Events} from './ChangesSidebar.js';\nimport changesViewStyles from './changesView.css.js';\nimport * as CombinedDiffView from './CombinedDiffView.js';\n\nconst CHANGES_VIEW_URL = 'https://developer.chrome.com/docs/devtools/changes' as Platform.DevToolsPath.UrlString;\n\nconst UIStrings = {\n  /**\n   * @description Text in Changes View of the Changes tab if no change has been made so far.\n   */\n  noChanges: 'No changes yet',\n  /**\n   * @description Text in Changes View of the Changes tab to explain the Changes panel.\n   */\n  changesViewDescription: 'On this page you can track code changes made within DevTools.',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/changes/ChangesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html} = Lit;\ninterface ViewInput {\n  selectedSourceCode: Workspace.UISourceCode.UISourceCode|null;\n  onSelect(sourceCode: Workspace.UISourceCode.UISourceCode|null): void;\n  workspaceDiff: WorkspaceDiff.WorkspaceDiff.WorkspaceDiffImpl;\n}\ntype View = (input: ViewInput, output: object, target: HTMLElement) => void;\nexport const DEFAULT_VIEW: View = (input, output, target) => {\n  const onSidebar = (sidebar: ChangesSidebar): void => {\n    sidebar.addEventListener(\n        Events.SELECTED_UI_SOURCE_CODE_CHANGED, () => input.onSelect(sidebar.selectedUISourceCode()));\n  };\n  render(\n      // clang-format off\n      html`\n      <style>${changesViewStyles}</style>\n      <devtools-split-view direction=column>\n        <div class=vbox slot=\"main\">\n          <devtools-widget\n            ?hidden=${input.workspaceDiff.modifiedUISourceCodes().length > 0}\n            .widgetConfig=${UI.Widget.widgetConfig(UI.EmptyWidget.EmptyWidget, {\n                              header: i18nString(UIStrings.noChanges),\n                              text: i18nString(UIStrings.changesViewDescription),\n                              link: CHANGES_VIEW_URL,\n                            })}>\n          </devtools-widget>\n          <div class=diff-container role=tabpanel ?hidden=${input.workspaceDiff.modifiedUISourceCodes().length === 0}>\n            <devtools-widget .widgetConfig=${UI.Widget.widgetConfig(CombinedDiffView.CombinedDiffView, {\n                                              selectedFileUrl: input.selectedSourceCode?.url(),\n                                              workspaceDiff: input.workspaceDiff\n                                            })}></devtools-widget>\n          </div>\n        </div>\n        <devtools-widget\n          slot=\"sidebar\"\n          .widgetConfig=${UI.Widget.widgetConfig(ChangesSidebar, {\n                           workspaceDiff: input.workspaceDiff\n                         })}\n          ${UI.Widget.widgetRef(ChangesSidebar, onSidebar)}>\n        </devtools-widget>\n      </devtools-split-view>`,\n      // clang-format on\n      target);\n};\n\nexport class ChangesView extends UI.Widget.VBox {\n  readonly #workspaceDiff: WorkspaceDiff.WorkspaceDiff.WorkspaceDiffImpl;\n  #selectedUISourceCode: Workspace.UISourceCode.UISourceCode|null = null;\n  readonly #view: View;\n\n  constructor(target?: HTMLElement, view = DEFAULT_VIEW) {\n    super(target, {\n      jslog: `${VisualLogging.panel('changes').track({resize: true})}`,\n      useShadowDom: true,\n    });\n\n    this.#workspaceDiff = WorkspaceDiff.WorkspaceDiff.workspaceDiff();\n    this.#view = view;\n\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          workspaceDiff: this.#workspaceDiff,\n          selectedSourceCode: this.#selectedUISourceCode,\n          onSelect: sourceCode => {\n            this.#selectedUISourceCode = sourceCode;\n            this.requestUpdate();\n          },\n        },\n        {}, this.contentElement);\n  }\n\n  override wasShown(): void {\n    UI.Context.Context.instance().setFlavor(ChangesView, this);\n    super.wasShown();\n    this.requestUpdate();\n    this.#workspaceDiff.addEventListener(\n        WorkspaceDiff.WorkspaceDiff.Events.MODIFIED_STATUS_CHANGED, this.requestUpdate, this);\n  }\n\n  override willHide(): void {\n    super.willHide();\n    UI.Context.Context.instance().setFlavor(ChangesView, null);\n    this.#workspaceDiff.removeEventListener(\n        WorkspaceDiff.WorkspaceDiff.Events.MODIFIED_STATUS_CHANGED, this.requestUpdate, this);\n  }\n}\n"]}