{"version":3,"file":"AiCodeGenerationTeaser.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/AiCodeGenerationTeaser.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport '../../ui/components/tooltips/tooltips.js';\n\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Root from '../../core/root/root.js';\nimport * as AiCodeCompletion from '../../models/ai_code_completion/ai_code_completion.js';\nimport * as Buttons from '../../ui/components/buttons/buttons.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives, html, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport styles from './aiCodeGenerationTeaser.css.js';\n\nconst UIStringsNotTranslate = {\n  /**\n   * @description Text for teaser to generate code.\n   */\n  ctrlItoGenerateCode: 'Ctrl+I to generate code',\n  /**\n   * @description Text for teaser to generate code in Mac.\n   */\n  cmdItoGenerateCode: 'Cmd+I to generate code',\n  /**\n   * Text for teaser when generating suggestion.\n   */\n  generating: 'Generating... (esc to cancel)',\n  /**\n   * Text for teaser for discoverability.\n   */\n  writeACommentToGenerateCode: 'Write a comment to generate code',\n  /**\n   * @description Text for tooltip shown on hovering over \"Relevant Data\" in the disclaimer text for AI code generation in Console panel.\n   */\n  tooltipDisclaimerTextForAiCodeGenerationInConsole:\n      'To generate code suggestions, your console input and the history of your current console session are shared with Google. This data may be seen by human reviewers to improve this feature.',\n  /**\n   * @description Text for tooltip shown on hovering over \"Relevant Data\" in the disclaimer text for AI code generation in Console panel.\n   */\n  tooltipDisclaimerTextForAiCodeGenerationNoLoggingInConsole:\n      'To generate code suggestions, your console input and the history of your current console session are shared with Google. This data will not be used to improve Google’s AI models. Your organization may change these settings at any time.',\n  /**\n   * @description Text for tooltip shown on hovering over \"Relevant Data\" in the disclaimer text for AI code generation in Sources panel.\n   */\n  tooltipDisclaimerTextForAiCodeGenerationInSources:\n      'To generate code suggestions, the contents of the currently open file are shared with Google. This data may be seen by human reviewers to improve this feature.',\n  /**\n   * @description Text for tooltip shown on hovering over \"Relevant Data\" in the disclaimer text for AI code generation in Sources panel.\n   */\n  tooltipDisclaimerTextForAiCodeGenerationNoLoggingInSources:\n      'To generate code suggestions, the contents of the currently open file are shared with Google. This data will not be used to improve Google’s AI models. Your organization may change these settings at any time.',\n  /**\n   * @description Text for tooltip button which redirects to AI settings\n   */\n  manageInSettings: 'Manage in settings',\n  /**\n   * @description Title for disclaimer info button in the teaser to generate code.\n   */\n  learnMoreAboutHowYourDataIsBeingUsed: 'Learn more about how your data is being used',\n} as const;\n\nconst lockedString = i18n.i18n.lockedString;\nconst PROMOTION_ID = 'ai-code-generation';\n\nexport enum AiCodeGenerationTeaserDisplayState {\n  TRIGGER = 'trigger',\n  DISCOVERY = 'discovery',\n  LOADING = 'loading',\n}\n\nfunction getTooltipDisclaimerText(noLogging: boolean, panel: AiCodeCompletion.AiCodeCompletion.ContextFlavor): string {\n  switch (panel) {\n    case AiCodeCompletion.AiCodeCompletion.ContextFlavor.CONSOLE:\n      return noLogging ?\n          lockedString(UIStringsNotTranslate.tooltipDisclaimerTextForAiCodeGenerationNoLoggingInConsole) :\n          lockedString(UIStringsNotTranslate.tooltipDisclaimerTextForAiCodeGenerationInConsole);\n    case AiCodeCompletion.AiCodeCompletion.ContextFlavor.SOURCES:\n      return noLogging ?\n          lockedString(UIStringsNotTranslate.tooltipDisclaimerTextForAiCodeGenerationNoLoggingInSources) :\n          lockedString(UIStringsNotTranslate.tooltipDisclaimerTextForAiCodeGenerationInSources);\n  }\n}\n\nexport interface ViewInput {\n  displayState: AiCodeGenerationTeaserDisplayState;\n  disclaimerTooltipId?: string;\n  noLogging: boolean;\n  onManageInSettingsTooltipClick: (event: Event) => void;\n  // TODO(b/472268298): Remove ContextFlavor explicitly and pass required values\n  panel?: AiCodeCompletion.AiCodeCompletion.ContextFlavor;\n}\n\nexport interface ViewOutput {\n  hideTooltip?: () => void;\n}\n\nexport type View = (input: ViewInput, output: ViewOutput, target: HTMLElement) => void;\n\nexport const DEFAULT_VIEW: View = (input, output, target) => {\n  if (!input.panel) {\n    render(nothing, target);\n    return;\n  }\n\n  let teaserLabel;\n  switch (input.displayState) {\n    case AiCodeGenerationTeaserDisplayState.TRIGGER: {\n      if (!input.disclaimerTooltipId) {\n        render(nothing, target);\n        return;\n      }\n      const toGenerateCode = Host.Platform.isMac() ? lockedString(UIStringsNotTranslate.cmdItoGenerateCode) :\n                                                     lockedString(UIStringsNotTranslate.ctrlItoGenerateCode);\n      const tooltipDisclaimerText = getTooltipDisclaimerText(input.noLogging, input.panel);\n      // TODO(b/472291834): Disclaimer icon should match the placeholder's color\n      // clang-format off\n      teaserLabel = html`<div class=\"ai-code-generation-teaser-trigger\">\n        ${toGenerateCode}&nbsp;<devtools-button\n          .data=${{\n              title: lockedString(UIStringsNotTranslate.learnMoreAboutHowYourDataIsBeingUsed),\n              size: Buttons.Button.Size.MICRO,\n              iconName: 'info',\n              variant: Buttons.Button.Variant.ICON,\n              jslogContext: 'ai-code-generation-teaser.info-button',\n            } as Buttons.Button.ButtonData}\n            aria-details=${input.disclaimerTooltipId}\n            aria-describedby=${input.disclaimerTooltipId}\n          ></devtools-button>\n          <devtools-tooltip\n              id=${input.disclaimerTooltipId}\n              variant=\"rich\"\n              jslogContext=\"ai-code-generation-disclaimer\"\n              ${Directives.ref(el => {\n                if (el instanceof HTMLElement) {\n                  output.hideTooltip = () => {\n                    el.hidePopover();\n                  };\n                }\n              })}>\n            <div class=\"disclaimer-tooltip-container\"><div class=\"tooltip-text\">\n                ${tooltipDisclaimerText}\n                </div>\n                <span\n                    tabIndex=\"0\"\n                    class=\"link\"\n                    role=\"link\"\n                    jslog=${VisualLogging.link('open-ai-settings').track({\n                      click: true,\n                    })}\n                    @click=${input.onManageInSettingsTooltipClick}\n                >${lockedString(UIStringsNotTranslate.manageInSettings)}</span></div></devtools-tooltip>\n                  </div>`;\n      // clang-format on\n      break;\n    }\n\n    case AiCodeGenerationTeaserDisplayState.DISCOVERY: {\n      const newBadge = UI.UIUtils.maybeCreateNewBadge(PROMOTION_ID);\n      teaserLabel = newBadge ?\n          html`${lockedString(UIStringsNotTranslate.writeACommentToGenerateCode)}&nbsp;${newBadge}` :\n          nothing;\n      break;\n    }\n\n    case AiCodeGenerationTeaserDisplayState.LOADING: {\n      teaserLabel = html`${lockedString(UIStringsNotTranslate.generating)}`;\n      break;\n    }\n  }\n\n  // clang-format off\n  render(\n        html`\n          <style>${styles}</style>\n          <style>@scope to (devtools-widget > *) { ${UI.inspectorCommonStyles} }</style>\n          <div class=\"ai-code-generation-teaser\">\n            ${teaserLabel}\n          </div>\n        `, target\n      );\n  // clang-format on\n};\n\n// TODO(b/448063927): Add \"Dont show again\" for discovery teaser.\nexport class AiCodeGenerationTeaser extends UI.Widget.Widget {\n  readonly #view: View;\n  #viewOutput: ViewOutput = {};\n\n  #displayState = AiCodeGenerationTeaserDisplayState.TRIGGER;\n  #disclaimerTooltipId?: string;\n  #noLogging: boolean;  // Whether the enterprise setting is `ALLOW_WITHOUT_LOGGING` or not.\n  #panel?: AiCodeCompletion.AiCodeCompletion.ContextFlavor;\n\n  constructor(view?: View) {\n    super();\n    this.markAsExternallyManaged();\n    this.#noLogging = Root.Runtime.hostConfig.aidaAvailability?.enterprisePolicyValue ===\n        Root.Runtime.GenAiEnterprisePolicyValue.ALLOW_WITHOUT_LOGGING;\n    this.#view = view ?? DEFAULT_VIEW;\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          displayState: this.#displayState,\n          onManageInSettingsTooltipClick: this.#onManageInSettingsTooltipClick.bind(this),\n          disclaimerTooltipId: this.#disclaimerTooltipId,\n          noLogging: this.#noLogging,\n          panel: this.#panel,\n        },\n        this.#viewOutput, this.contentElement);\n  }\n\n  get displayState(): AiCodeGenerationTeaserDisplayState {\n    return this.#displayState;\n  }\n\n  set displayState(displayState: AiCodeGenerationTeaserDisplayState) {\n    if (displayState === this.#displayState) {\n      return;\n    }\n    this.#displayState = displayState;\n    this.requestUpdate();\n  }\n\n  set disclaimerTooltipId(disclaimerTooltipId: string) {\n    this.#disclaimerTooltipId = disclaimerTooltipId;\n    this.requestUpdate();\n  }\n\n  set panel(panel: AiCodeCompletion.AiCodeCompletion.ContextFlavor) {\n    this.#panel = panel;\n    this.requestUpdate();\n  }\n\n  #onManageInSettingsTooltipClick(event: Event): void {\n    event.stopPropagation();\n    this.#viewOutput.hideTooltip?.();\n    void UI.ViewManager.ViewManager.instance().showView('chrome-ai');\n    event.consume(true);\n  }\n}\n"]}