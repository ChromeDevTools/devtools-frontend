{"version":3,"file":"Annotation.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/Annotation.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n/* eslint-disable @devtools/no-lit-render-outside-of-view */\n\nimport * as Annotations from '../../ui/components/annotations/annotations.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {html, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport annotationStyles from './annotation.css.js';\n\n// This class handles drawing of Annotations for the GreenDev project, but\n// is not for general use (at the moment).\n//\n// **Important**: all of this functionality is behind the GreenDev flag. We\n// have **no intention** of pushing this feature live in this state. This\n// is code landing to user test in Canary that will not ship without an\n// additional project to make this code fully production worthy. That is\n// why this CL has no tests, for example.\n\ninterface ViewInput {\n  inputText: string;\n  isExpanded: boolean;\n  clickHandler: () => void;\n}\n\ntype View = (input: ViewInput, output: undefined, target: HTMLElement) => void;\n\nexport const DEFAULT_VIEW: View = (input, _, target) => {\n  const {inputText: label, isExpanded, clickHandler} = input;\n\n  // TODO(finnur): Use `x`, and `y` passed via `input` to set the coordinates for the\n  // *Widget* (not the `overlay` div), then remove the `this.element.style` calls and\n  // remove the lint override no-imperative-dom-api from the top.\n\n  // clang-format off\n  render(html`\n    <style>${annotationStyles}</style>\n    <div class='overlay' @click=${clickHandler}>${isExpanded ? label : '!'}</div>\n    `, target);\n  // clang-format on\n};\n\nexport class Annotation extends UI.Widget.Widget {\n  readonly #view: View;\n  readonly #type: Annotations.AnnotationType;\n  #inputText: string;\n  #x = 0;\n  #y = 0;\n  #isExpanded = false;\n\n  constructor(label: string, type: Annotations.AnnotationType, element?: HTMLElement, view = DEFAULT_VIEW) {\n    super({jslog: `${VisualLogging.panel('annotation').track({resize: true})}`, useShadowDom: true});\n    this.#view = view;\n    this.#type = type;\n    this.#isExpanded = this.#type === Annotations.AnnotationType.STYLE_RULE;\n    this.#inputText = label;\n  }\n\n  #toggle(): void {\n    this.#isExpanded = !this.#isExpanded;\n    this.element.style.left = this.#isExpanded ? `${this.#x}px` : '0px';\n    this.requestUpdate();\n  }\n\n  override wasShown(): void {\n    this.element.style.position = 'absolute';\n    this.element.style.left = this.#isExpanded ? `${this.#x}px` : '0px';\n    this.element.style.top = `${this.#y}px`;\n    super.wasShown();\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    if (!this.isShowing()) {\n      return;\n    }\n    const input = {\n      inputText: this.#inputText,\n      isExpanded: this.#isExpanded,\n      x: this.#x,\n      y: this.#y,\n      clickHandler: this.#toggle.bind(this),\n    };\n    this.#view(input, undefined, this.contentElement);\n  }\n\n  hide(): void {\n    this.detach();\n  }\n\n  getCoordinates(): {x: number, y: number} {\n    return {x: this.#x, y: this.#y};\n  }\n\n  setCoordinates(x: number, y: number): void {\n    this.#x = x;\n    this.#y = y;\n    if (this.isShowing()) {\n      this.element.style.left = this.#isExpanded ? `${this.#x}px` : '0px';\n      this.element.style.top = `${this.#y}px`;\n    }\n    this.requestUpdate();\n  }\n}\n"]}