{"version":3,"file":"DOMLinkifier.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/DOMLinkifier.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2018 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives, html, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport domLinkifierStyles from './domLinkifier.css.js';\n\nconst {classMap} = Directives;\n\nconst UIStrings = {\n  /**\n   * @description Text displayed when trying to create a link to a node in the UI, but the node\n   * location could not be found so we display this placeholder instead. Node refers to a DOM node.\n   * This should be translated if appropriate.\n   */\n  node: '<node>',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/common/DOMLinkifier.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface Options extends Common.Linkifier.Options {\n  hiddenClassList?: string[];\n  disabled?: boolean;\n}\n\ninterface ViewInput {\n  dynamic?: boolean;\n  disabled?: boolean;\n  preventKeyboardFocus?: boolean;\n  tagName?: string;\n  id?: string;\n  classes: string[];\n  pseudo?: string;\n  onClick: () => void;\n  onMouseOver: () => void;\n  onMouseLeave: () => void;\n}\n\nexport type View = (input: ViewInput, output: object, target: HTMLElement) => void;\n\nconst DEFAULT_VIEW: View = (input, _output, target: HTMLElement) => {\n  // clang-format off\n  render(html`${(input.tagName || input.pseudo) ?  html`\n    <style>${domLinkifierStyles}</style>\n    <span class=\"monospace\">\n      <button class=\"node-link text-button link-style ${classMap({\n            'dynamic-link': Boolean(input.dynamic),\n            disabled: Boolean(input.disabled)\n          })}\"\n          jslog=${VisualLogging.link('node').track({click: true, keydown: 'Enter'})}\n          tabindex=${input.preventKeyboardFocus ? -1 : 0}\n          @click=${input.onClick}\n          @mouseover=${input.onMouseOver}\n          @mouseleave=${input.onMouseLeave}\n          title=${[\n            input.tagName ?? '',\n            input.id ? `#${input.id}` : '',\n            ...input.classes.map(c => `.${c}`),\n            input.pseudo ? `::${input.pseudo}` : '',\n          ].join(' ')}>${\n         [\n          input.tagName ? html`<span class=\"node-label-name\">${input.tagName}</span>` : nothing,\n          input.id ? html`<span class=\"node-label-id\">#${input.id}</span>` : nothing,\n          ...input.classes.map(className => html`<span class=\"extra node-label-class\">.${className}</span>`),\n          input.pseudo ? html`<span class=\"extra node-label-pseudo\">${input.pseudo}</span>` : nothing,\n        ]\n      }</button>\n    </span>` : i18nString(UIStrings.node)}`, target);\n  // clang-format on\n};\n\nexport class DOMNodeLink extends UI.Widget.Widget {\n  #node: SDK.DOMModel.DOMNode|undefined = undefined;\n  #options: Options|undefined = undefined;\n  #view: View;\n\n  constructor(element?: HTMLElement, node?: SDK.DOMModel.DOMNode, options?: Options, view = DEFAULT_VIEW) {\n    super(element, {useShadowDom: true});\n    this.element.classList.remove('vbox');\n    this.#node = node;\n    this.#options = options;\n    this.#view = view;\n    this.performUpdate();\n  }\n\n  set node(node: SDK.DOMModel.DOMNode|undefined) {\n    this.#node = node;\n    this.performUpdate();\n  }\n\n  set options(options: Options|undefined) {\n    this.#options = options;\n    this.performUpdate();\n  }\n\n  override performUpdate(): void {\n    const options = this.#options ?? {\n      tooltip: undefined,\n      preventKeyboardFocus: undefined,\n      textContent: undefined,\n      isDynamicLink: false,\n      disabled: false,\n    };\n    const viewInput: ViewInput = {\n      dynamic: options.isDynamicLink,\n      disabled: options.disabled,\n      preventKeyboardFocus: options.preventKeyboardFocus,\n      classes: [],\n      onClick: () => {\n        void Common.Revealer.reveal(this.#node);\n        void this.#node?.scrollIntoView();\n        return false;\n      },\n      onMouseOver: () => {\n        this.#node?.highlight?.();\n      },\n      onMouseLeave: () => {\n        SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n      },\n    };\n    if (!this.#node) {\n      this.#view(viewInput, {}, this.contentElement);\n      return;\n    }\n\n    let node = this.#node;\n    const isPseudo = node.nodeType() === Node.ELEMENT_NODE && node.pseudoType();\n    if (isPseudo && node.parentNode) {\n      node = node.parentNode;\n    }\n\n    // Special case rendering the node links for view transition pseudo elements.\n    // We don't include the ancestor name in the node link because\n    // they always have the same ancestor. See crbug.com/340633630.\n    if (node.isViewTransitionPseudoNode()) {\n      viewInput.pseudo = `::${this.#node.pseudoType()}(${this.#node.pseudoIdentifier()})`;\n      this.#view(viewInput, {}, this.contentElement);\n      return;\n    }\n\n    if (options.textContent) {\n      viewInput.tagName = options.textContent;\n      this.#view(viewInput, {}, this.contentElement);\n      return;\n    }\n\n    viewInput.tagName = node.nodeNameInCorrectCase();\n\n    const idAttribute = node.getAttribute('id');\n    if (idAttribute) {\n      viewInput.id = idAttribute;\n    }\n\n    const classAttribute = node.getAttribute('class');\n    if (classAttribute) {\n      const classes = classAttribute.split(/\\s+/);\n      if (classes.length) {\n        const foundClasses = new Set<string>();\n        for (let i = 0; i < classes.length; ++i) {\n          const className = classes[i];\n          if (className && !options.hiddenClassList?.includes(className) && !foundClasses.has(className)) {\n            foundClasses.add(className);\n          }\n        }\n        viewInput.classes = [...foundClasses];\n      }\n    }\n    if (isPseudo) {\n      const pseudoIdentifier = this.#node.pseudoIdentifier();\n      let pseudoText = '::' + this.#node.pseudoType();\n      if (pseudoIdentifier) {\n        pseudoText += `(${pseudoIdentifier})`;\n      }\n      viewInput.pseudo = pseudoText;\n    }\n    this.#view(viewInput, {}, this.contentElement);\n  }\n}\n\ninterface DeferredViewInput {\n  preventKeyboardFocus?: boolean;\n  onClick: () => void;\n}\n\ntype DeferredView = (input: DeferredViewInput, output: object, target: HTMLElement) => void;\n\nconst DEFERRED_DEFAULT_VIEW: DeferredView = (input, _output, target: HTMLElement) => {\n  // clang-format off\n  render(html`\n      <style>${domLinkifierStyles}</style>\n      <button class=\"node-link text-button link-style\"\n          jslog=${VisualLogging.link('node').track({click: true})}\n          tabindex=${input.preventKeyboardFocus ? -1 : 0}\n          @click=${input.onClick}\n          @mousedown=${(e: Event) => e.consume()}>\n        <slot></slot>\n      </button>`, target);\n  // clang-format on\n};\n\nexport class DeferredDOMNodeLink extends UI.Widget.Widget {\n  #deferredNode: SDK.DOMModel.DeferredDOMNode|undefined = undefined;\n  #options: Options|undefined = undefined;\n  #view: DeferredView;\n\n  constructor(\n      element?: HTMLElement, deferredNode?: SDK.DOMModel.DeferredDOMNode, options?: Options,\n      view: DeferredView = DEFERRED_DEFAULT_VIEW) {\n    super(element, {useShadowDom: true});\n    this.element.classList.remove('vbox');\n    this.#deferredNode = deferredNode;\n    this.#options = options;\n    this.#view = view;\n    this.performUpdate();\n  }\n\n  override performUpdate(): void {\n    const viewInput = {\n      preventKeyboardFocus: this.#options?.preventKeyboardFocus,\n      onClick: () => {\n        this.#deferredNode?.resolve?.(node => {\n          void Common.Revealer.reveal(node);\n          void node?.scrollIntoView();\n        });\n      },\n    };\n    this.#view(viewInput, {}, this.contentElement);\n  }\n}\n\nlet linkifierInstance: Linkifier;\n\nexport class Linkifier implements Common.Linkifier.Linkifier {\n  static instance(opts: {\n    forceNew: boolean|null,\n  } = {forceNew: null}): Linkifier {\n    const {forceNew} = opts;\n    if (!linkifierInstance || forceNew) {\n      linkifierInstance = new Linkifier();\n    }\n\n    return linkifierInstance;\n  }\n  linkify(node: SDK.DOMModel.DOMNode|SDK.DOMModel.DeferredDOMNode, options?: Options): HTMLElement {\n    if (node instanceof SDK.DOMModel.DOMNode) {\n      const link = document.createElement('devtools-widget') as UI.Widget.WidgetElement<DOMNodeLink>;\n      link.widgetConfig = UI.Widget.widgetConfig(e => new DOMNodeLink(e, node, options));\n      return link;\n    }\n    if (node instanceof SDK.DOMModel.DeferredDOMNode) {\n      const link = document.createElement('devtools-widget') as UI.Widget.WidgetElement<DeferredDOMNodeLink>;\n      link.widgetConfig = UI.Widget.widgetConfig(e => new DeferredDOMNodeLink(e, node, options));\n      return link;\n    }\n    throw new Error('Can\\'t linkify non-node');\n  }\n}\n"]}