{"version":3,"file":"ExtensionServer.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/ExtensionServer.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2011 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n// TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n/* eslint-disable @typescript-eslint/naming-convention */\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport type {Chrome} from '../../../extension-api/ExtensionAPI.js';\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as _ProtocolClient from '../../core/protocol_client/protocol_client.js';  // eslint-disable-line @typescript-eslint/no-unused-vars\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport * as Extensions from '../../models/extensions/extensions.js';\nimport * as HAR from '../../models/har/har.js';\nimport * as Logs from '../../models/logs/logs.js';\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as ThemeSupport from '../../ui/legacy/theme_support/theme_support.js';\n\nimport {ExtensionButton, ExtensionPanel, ExtensionSidebarPane} from './ExtensionPanel.js';\n\nconst extensionOrigins = new WeakMap<MessagePort, Platform.DevToolsPath.UrlString>();\nconst kPermittedSchemes = ['http:', 'https:', 'file:', 'data:', 'chrome-extension:', 'about:'];\n\ndeclare global {\n  interface Window {\n    DevToolsAPI?: {getInspectedTabId?(): string|undefined, getOriginsForbiddenForExtensions?(): string[]};\n  }\n}\n\nlet extensionServerInstance: ExtensionServer|null;\n\nexport class HostsPolicy {\n  static create(policy?: Host.InspectorFrontendHostAPI.ExtensionHostsPolicy): HostsPolicy|null {\n    const runtimeAllowedHosts = [];\n    const runtimeBlockedHosts = [];\n    if (policy) {\n      for (const pattern of policy.runtimeAllowedHosts) {\n        const parsedPattern = Extensions.HostUrlPattern.HostUrlPattern.parse(pattern);\n        if (!parsedPattern) {\n          return null;\n        }\n        runtimeAllowedHosts.push(parsedPattern);\n      }\n      for (const pattern of policy.runtimeBlockedHosts) {\n        const parsedPattern = Extensions.HostUrlPattern.HostUrlPattern.parse(pattern);\n        if (!parsedPattern) {\n          return null;\n        }\n        runtimeBlockedHosts.push(parsedPattern);\n      }\n    }\n    return new HostsPolicy(runtimeAllowedHosts, runtimeBlockedHosts);\n  }\n  private constructor(\n      readonly runtimeAllowedHosts: Extensions.HostUrlPattern.HostUrlPattern[],\n      readonly runtimeBlockedHosts: Extensions.HostUrlPattern.HostUrlPattern[]) {\n  }\n\n  isAllowedOnURL(inspectedURL?: Platform.DevToolsPath.UrlString): boolean {\n    if (!inspectedURL) {\n      // If there aren't any blocked hosts retain the old behavior and don't worry about the inspectedURL\n      return this.runtimeBlockedHosts.length === 0;\n    }\n    if (this.runtimeBlockedHosts.some(pattern => pattern.matchesUrl(inspectedURL)) &&\n        !this.runtimeAllowedHosts.some(pattern => pattern.matchesUrl(inspectedURL))) {\n      return false;\n    }\n    return true;\n  }\n}\n\nclass RegisteredExtension {\n  openResourceScheme: null|string = null;\n  constructor(readonly name: string, readonly hostsPolicy: HostsPolicy, readonly allowFileAccess: boolean) {\n  }\n\n  isAllowedOnTarget(inspectedURL?: Platform.DevToolsPath.UrlString): boolean {\n    if (!inspectedURL) {\n      inspectedURL = SDK.TargetManager.TargetManager.instance().primaryPageTarget()?.inspectedURL();\n    }\n\n    if (!inspectedURL) {\n      return false;\n    }\n\n    if (this.openResourceScheme && inspectedURL.startsWith(this.openResourceScheme)) {\n      return true;\n    }\n\n    if (!ExtensionServer.canInspectURL(inspectedURL)) {\n      return false;\n    }\n\n    if (!this.hostsPolicy.isAllowedOnURL(inspectedURL)) {\n      return false;\n    }\n\n    if (!this.allowFileAccess) {\n      let parsedURL;\n      try {\n        parsedURL = new URL(inspectedURL);\n      } catch {\n        return false;\n      }\n      return parsedURL.protocol !== 'file:';\n    }\n\n    return true;\n  }\n}\n\nexport class RevealableNetworkRequestFilter {\n  constructor(readonly filter: string|undefined) {\n  }\n}\n\nexport class ExtensionServer extends Common.ObjectWrapper.ObjectWrapper<EventTypes> {\n  private readonly clientObjects: Map<string, unknown>;\n  private readonly handlers:\n      Map<string,\n          (message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort) => unknown>;\n  private readonly subscribers: Map<string, Set<MessagePort>>;\n  private readonly subscriptionStartHandlers: Map<string, () => unknown>;\n  private readonly subscriptionStopHandlers: Map<string, () => unknown>;\n  private readonly extraHeaders: Map<string, Map<string, unknown>>;\n  private requests: Map<number, TextUtils.ContentProvider.ContentProvider>;\n  private readonly requestIds: Map<TextUtils.ContentProvider.ContentProvider, number>;\n  private lastRequestId: number;\n  private registeredExtensions: Map<string, RegisteredExtension>;\n  private status: ExtensionStatus;\n  readonly #sidebarPanes: ExtensionSidebarPane[];\n  private extensionsEnabled: boolean;\n  private inspectedTabId?: string;\n  private readonly extensionAPITestHook?: (server: unknown, api: unknown) => unknown;\n  private themeChangeHandlers = new Map<string, MessagePort>();\n  readonly #pendingExtensions: Host.InspectorFrontendHostAPI.ExtensionDescriptor[] = [];\n\n  private constructor() {\n    super();\n    this.clientObjects = new Map();\n    this.handlers = new Map();\n    this.subscribers = new Map();\n    this.subscriptionStartHandlers = new Map();\n    this.subscriptionStopHandlers = new Map();\n    this.extraHeaders = new Map();\n    this.requests = new Map();\n    this.requestIds = new Map();\n    this.lastRequestId = 0;\n    this.registeredExtensions = new Map();\n    this.status = new ExtensionStatus();\n    this.#sidebarPanes = [];\n    // TODO(caseq): properly unload extensions when we disable them.\n    this.extensionsEnabled = true;\n\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.AddRequestHeaders, this.onAddRequestHeaders.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.CreatePanel, this.onCreatePanel.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.CreateSidebarPane, this.onCreateSidebarPane.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.CreateToolbarButton, this.onCreateToolbarButton.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.EvaluateOnInspectedPage, this.onEvaluateOnInspectedPage.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.ForwardKeyboardEvent, this.onForwardKeyboardEvent.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.GetHAR, this.onGetHAR.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.GetPageResources, this.onGetPageResources.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.GetRequestContent, this.onGetRequestContent.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.GetResourceContent, this.onGetResourceContent.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.Reload, this.onReload.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetOpenResourceHandler, this.onSetOpenResourceHandler.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetThemeChangeHandler, this.onSetThemeChangeHandler.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetResourceContent, this.onSetResourceContent.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.AttachSourceMapToResource,\n        this.onAttachSourceMapToResource.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarHeight, this.onSetSidebarHeight.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarContent, this.onSetSidebarContent.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarPage, this.onSetSidebarPage.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.ShowPanel, this.onShowPanel.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.Subscribe, this.onSubscribe.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.OpenResource, this.onOpenResource.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.Unsubscribe, this.onUnsubscribe.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.UpdateButton, this.onUpdateButton.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterLanguageExtensionPlugin,\n        this.registerLanguageExtensionEndpoint.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLinearMemory, this.onGetWasmLinearMemory.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmGlobal, this.onGetWasmGlobal.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLocal, this.onGetWasmLocal.bind(this));\n    this.registerHandler(Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmOp, this.onGetWasmOp.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterRecorderExtensionPlugin,\n        this.registerRecorderExtensionEndpoint.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.ReportResourceLoad, this.onReportResourceLoad.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.SetFunctionRangesForScript,\n        this.onSetFunctionRangesForScript.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.CreateRecorderView, this.onCreateRecorderView.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.ShowRecorderView, this.onShowRecorderView.bind(this));\n    this.registerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Commands.ShowNetworkPanel, this.onShowNetworkPanel.bind(this));\n    window.addEventListener('message', this.onWindowMessage, false);  // Only for main window.\n\n    const existingTabId = window.DevToolsAPI?.getInspectedTabId?.();\n\n    if (existingTabId) {\n      this.setInspectedTabId({data: existingTabId});\n    }\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.events.addEventListener(\n        Host.InspectorFrontendHostAPI.Events.SetInspectedTabId, this.setInspectedTabId, this);\n\n    this.initExtensions();\n\n    ThemeSupport.ThemeSupport.instance().addEventListener(ThemeSupport.ThemeChangeEvent.eventName, this.#onThemeChange);\n  }\n\n  get isEnabledForTest(): boolean {\n    return this.extensionsEnabled;\n  }\n\n  dispose(): void {\n    ThemeSupport.ThemeSupport.instance().removeEventListener(\n        ThemeSupport.ThemeChangeEvent.eventName, this.#onThemeChange);\n\n    // Set up by this.initExtensions in the constructor.\n    SDK.TargetManager.TargetManager.instance().removeEventListener(\n        SDK.TargetManager.Events.INSPECTED_URL_CHANGED, this.inspectedURLChanged, this);\n\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.events.removeEventListener(\n        Host.InspectorFrontendHostAPI.Events.SetInspectedTabId, this.setInspectedTabId, this);\n\n    window.removeEventListener('message', this.onWindowMessage, false);\n  }\n\n  #onThemeChange = (): void => {\n    const themeName = ThemeSupport.ThemeSupport.instance().themeName();\n    for (const port of this.themeChangeHandlers.values()) {\n      port.postMessage({command: Extensions.ExtensionAPI.PrivateAPI.Events.ThemeChange, themeName});\n    }\n  };\n\n  static instance(opts: {\n    forceNew: boolean|null,\n  } = {forceNew: null}): ExtensionServer {\n    const {forceNew} = opts;\n    if (!extensionServerInstance || forceNew) {\n      extensionServerInstance?.dispose();\n      extensionServerInstance = new ExtensionServer();\n    }\n\n    return extensionServerInstance;\n  }\n\n  initializeExtensions(): void {\n    // Defer initialization until DevTools is fully loaded.\n    if (this.inspectedTabId !== null) {\n      Host.InspectorFrontendHost.InspectorFrontendHostInstance.setAddExtensionCallback(this.addExtension.bind(this));\n    }\n  }\n\n  hasExtensions(): boolean {\n    return Boolean(this.registeredExtensions.size);\n  }\n\n  notifySearchAction(panelId: string, action: string, searchString?: string): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.PanelSearch + panelId, [action, searchString]);\n  }\n\n  notifyViewShown(identifier: string, frameIndex?: number): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.ViewShown + identifier, [frameIndex]);\n  }\n\n  notifyViewHidden(identifier: string): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.ViewHidden + identifier, []);\n  }\n\n  notifyButtonClicked(identifier: string): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.ButtonClicked + identifier, []);\n  }\n\n  profilingStarted(): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.ProfilingStarted, []);\n  }\n\n  profilingStopped(): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.ProfilingStopped, []);\n  }\n\n  private registerLanguageExtensionEndpoint(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, _shared_port: MessagePort): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterLanguageExtensionPlugin) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterLanguageExtensionPlugin}`);\n    }\n    const {pluginManager} = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n    const {pluginName, port, supportedScriptTypes: {language, symbol_types}} = message;\n    const symbol_types_array =\n        (Array.isArray(symbol_types) && symbol_types.every(e => typeof e === 'string') ? symbol_types : []);\n    const extensionOrigin = this.getExtensionOrigin(_shared_port);\n    const registration = this.registeredExtensions.get(extensionOrigin);\n    if (!registration) {\n      throw new Error('Received a message from an unregistered extension');\n    }\n    const endpoint = new Extensions.LanguageExtensionEndpoint.LanguageExtensionEndpoint(\n        registration.allowFileAccess, extensionOrigin, pluginName, {language, symbol_types: symbol_types_array}, port);\n    pluginManager.addPlugin(endpoint);\n    return this.status.OK();\n  }\n\n  private async loadWasmValue<T>(\n      expectValue: boolean, convert: (result: Protocol.Runtime.RemoteObject) => Record | T, expression: string,\n      stopId: unknown): Promise<Record|T> {\n    const {pluginManager} = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n    const callFrame = pluginManager.callFrameForStopId(stopId as Bindings.DebuggerLanguagePlugins.StopId);\n    if (!callFrame) {\n      return this.status.E_BADARG('stopId', 'Unknown stop id');\n    }\n    const result = await callFrame.debuggerModel.agent.invoke_evaluateOnCallFrame({\n      callFrameId: callFrame.id,\n      expression,\n      silent: true,\n      returnByValue: !expectValue,\n      generatePreview: expectValue,\n      throwOnSideEffect: true,\n    });\n\n    if (!result.exceptionDetails && !result.getError()) {\n      return convert(result.result);\n    }\n\n    return this.status.E_FAILED('Failed');\n  }\n\n  private async onGetWasmLinearMemory(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage):\n      Promise<Record|number[]> {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLinearMemory) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLinearMemory}`);\n    }\n    return await this.loadWasmValue<number[]>(\n        false, result => result.value,\n        `[].slice.call(new Uint8Array(memories[0].buffer, ${Number(message.offset)}, ${Number(message.length)}))`,\n        message.stopId);\n  }\n\n  private convertWasmValue(valueClass: 'local'|'global'|'operand', index: number):\n      (obj: Protocol.Runtime.RemoteObject) => Chrome.DevTools.WasmValue | undefined | Record {\n    return obj => {\n      if (obj.type === 'undefined') {\n        return;\n      }\n      if (obj.type !== 'object' || obj.subtype !== 'wasmvalue') {\n        return this.status.E_FAILED('Bad object type');\n      }\n      const type = obj?.description;\n      const value: string = obj.preview?.properties?.find(o => o.name === 'value')?.value ?? '';\n      switch (type) {\n        case 'i32':\n        case 'f32':\n        case 'f64':\n          return {type, value: Number(value)};\n        case 'i64':\n          return {type, value: BigInt(value.replace(/n$/, ''))};\n        case 'v128':\n          return {type, value};\n        default:\n          return {type: 'reftype', valueClass, index};\n      }\n    };\n  }\n\n  private async onGetWasmGlobal(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage):\n      Promise<Record|Chrome.DevTools.WasmValue> {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmGlobal) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmGlobal}`);\n    }\n    const global = Number(message.global);\n    const result = await this.loadWasmValue<Chrome.DevTools.WasmValue|undefined>(\n        true, this.convertWasmValue('global', global), `globals[${global}]`, message.stopId);\n    return result ?? this.status.E_BADARG('global', `No global with index ${global}`);\n  }\n\n  private async onGetWasmLocal(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage):\n      Promise<Record|Chrome.DevTools.WasmValue> {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLocal) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmLocal}`);\n    }\n    const local = Number(message.local);\n    const result = await this.loadWasmValue<Chrome.DevTools.WasmValue|undefined>(\n        true, this.convertWasmValue('local', local), `locals[${local}]`, message.stopId);\n    return result ?? this.status.E_BADARG('local', `No local with index ${local}`);\n  }\n\n  private async onGetWasmOp(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage):\n      Promise<Record|Chrome.DevTools.WasmValue> {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmOp) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetWasmOp}`);\n    }\n    const op = Number(message.op);\n    const result = await this.loadWasmValue<Chrome.DevTools.WasmValue|undefined>(\n        true, this.convertWasmValue('operand', op), `stack[${op}]`, message.stopId);\n    return result ?? this.status.E_BADARG('op', `No operand with index ${op}`);\n  }\n\n  private registerRecorderExtensionEndpoint(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, _shared_port: MessagePort): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterRecorderExtensionPlugin) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.RegisterRecorderExtensionPlugin}`);\n    }\n    const {pluginName, mediaType, port, capabilities} = message;\n    Extensions.RecorderPluginManager.RecorderPluginManager.instance().addPlugin(\n        new Extensions.RecorderExtensionEndpoint.RecorderExtensionEndpoint(pluginName, port, capabilities, mediaType));\n    return this.status.OK();\n  }\n\n  private onReportResourceLoad(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.ReportResourceLoad) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.ReportResourceLoad}`);\n    }\n    const {resourceUrl, extensionId, status} = message;\n    const url = resourceUrl as Platform.DevToolsPath.UrlString;\n    const initiator: SDK.PageResourceLoader.ExtensionInitiator =\n        {target: null, frameId: null, initiatorUrl: extensionId as Platform.DevToolsPath.UrlString, extensionId};\n\n    const pageResource: SDK.PageResourceLoader.PageResource = {\n      url,\n      initiator,\n      errorMessage: status.errorMessage,\n      success: status.success ?? null,\n      size: status.size ?? null,\n      duration: null,\n    };\n    SDK.PageResourceLoader.PageResourceLoader.instance().resourceLoadedThroughExtension(pageResource);\n    return this.status.OK();\n  }\n\n  private onSetFunctionRangesForScript(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetFunctionRangesForScript) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetFunctionRangesForScript}`);\n    }\n    const {scriptUrl, ranges} = message;\n    if (!scriptUrl || !ranges?.length) {\n      return this.status.E_BADARG('command', 'expected valid scriptUrl and non-empty NamedFunctionRanges');\n    }\n    const resource = this.lookupAllowedUISourceCode(scriptUrl as Platform.DevToolsPath.UrlString, port);\n    if ('error' in resource) {\n      return resource.error;\n    }\n    const {uiSourceCode} = resource;\n    if (!uiSourceCode.contentType().isScript() || !uiSourceCode.contentType().isFromSourceMap()) {\n      return this.status.E_BADARG('command', `expected a source map script resource for url: ${scriptUrl}`);\n    }\n    try {\n      Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance().setFunctionRanges(uiSourceCode, ranges);\n    } catch (e) {\n      return this.status.E_FAILED(e);\n    }\n    return this.status.OK();\n  }\n\n  private onShowRecorderView(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record\n      |undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.ShowRecorderView) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.ShowRecorderView}`);\n    }\n    Extensions.RecorderPluginManager.RecorderPluginManager.instance().showView(message.id);\n    return undefined;\n  }\n\n  private onShowNetworkPanel(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record\n      |undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.ShowNetworkPanel) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.ShowNetworkPanel}`);\n    }\n    void Common.Revealer.reveal(new RevealableNetworkRequestFilter(message.filter));\n    return this.status.OK();\n  }\n\n  private onCreateRecorderView(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.CreateRecorderView) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.CreateRecorderView}`);\n    }\n    const id = message.id;\n    // The ids are generated on the client API side and must be unique, so the check below\n    // shouldn't be hit unless someone is bypassing the API.\n    if (this.clientObjects.has(id)) {\n      return this.status.E_EXISTS(id);\n    }\n\n    const pagePath = ExtensionServer.expandResourcePath(this.getExtensionOrigin(port), message.pagePath);\n    if (pagePath === undefined) {\n      return this.status.E_BADARG('pagePath', 'Resources paths cannot point to non-extension resources');\n    }\n    const onShown = (): void => this.notifyViewShown(id);\n    const onHidden = (): void => this.notifyViewHidden(id);\n    Extensions.RecorderPluginManager.RecorderPluginManager.instance().registerView({\n      id,\n      pagePath,\n      title: message.title,\n      onShown,\n      onHidden,\n    });\n    return this.status.OK();\n  }\n\n  private inspectedURLChanged(event: Common.EventTarget.EventTargetEvent<SDK.Target.Target>): void {\n    if (!ExtensionServer.canInspectURL(event.data.inspectedURL())) {\n      this.disableExtensions();\n      return;\n    }\n    if (event.data !== SDK.TargetManager.TargetManager.instance().primaryPageTarget()) {\n      return;\n    }\n    this.requests = new Map();\n    this.enableExtensions();\n    const url = event.data.inspectedURL();\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.InspectedURLChanged, [url]);\n    const extensions = this.#pendingExtensions.splice(0);\n    extensions.forEach(e => this.addExtension(e));\n  }\n\n  hasSubscribers(type: string): boolean {\n    return this.subscribers.has(type);\n  }\n\n  private postNotification(type: string, args: unknown[], filter?: (extension: RegisteredExtension) => boolean): void {\n    if (!this.extensionsEnabled) {\n      return;\n    }\n    const subscribers = this.subscribers.get(type);\n    if (!subscribers) {\n      return;\n    }\n    const message = {command: 'notify-' + type, arguments: args};\n    for (const subscriber of subscribers) {\n      if (!this.extensionEnabled(subscriber)) {\n        continue;\n      }\n      if (filter) {\n        const origin = extensionOrigins.get(subscriber);\n        const extension = origin && this.registeredExtensions.get(origin);\n        if (!extension || !filter(extension)) {\n          continue;\n        }\n      }\n      subscriber.postMessage(message);\n    }\n  }\n\n  private onSubscribe(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.Subscribe) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.Subscribe}`);\n    }\n    const subscribers = this.subscribers.get(message.type);\n    if (subscribers) {\n      subscribers.add(port);\n    } else {\n      this.subscribers.set(message.type, new Set([port]));\n      const handler = this.subscriptionStartHandlers.get(message.type);\n      if (handler) {\n        handler();\n      }\n    }\n    return undefined;\n  }\n\n  private onUnsubscribe(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.Unsubscribe) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.Unsubscribe}`);\n    }\n    const subscribers = this.subscribers.get(message.type);\n    if (!subscribers) {\n      return;\n    }\n    subscribers.delete(port);\n    if (!subscribers.size) {\n      this.subscribers.delete(message.type);\n      const handler = this.subscriptionStopHandlers.get(message.type);\n      if (handler) {\n        handler();\n      }\n    }\n    return undefined;\n  }\n\n  private onAddRequestHeaders(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record\n      |undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.AddRequestHeaders) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.AddRequestHeaders}`);\n    }\n    const id = message.extensionId;\n    if (typeof id !== 'string') {\n      return this.status.E_BADARGTYPE('extensionId', typeof id, 'string');\n    }\n    let extensionHeaders = this.extraHeaders.get(id);\n    if (!extensionHeaders) {\n      extensionHeaders = new Map();\n      this.extraHeaders.set(id, extensionHeaders);\n    }\n    for (const name in message.headers) {\n      extensionHeaders.set(name, message.headers[name]);\n    }\n    const allHeaders = ({} as Protocol.Network.Headers);\n    for (const headers of this.extraHeaders.values()) {\n      for (const [name, value] of headers) {\n        if (name !== '__proto__' && typeof value === 'string') {\n          allHeaders[name] = value;\n        }\n      }\n    }\n\n    SDK.NetworkManager.MultitargetNetworkManager.instance().setExtraHTTPHeaders(allHeaders);\n    return undefined;\n  }\n\n  private getExtensionOrigin(port: MessagePort): Platform.DevToolsPath.UrlString {\n    const origin = extensionOrigins.get(port);\n    if (!origin) {\n      throw new Error('Received a message from an unregistered extension');\n    }\n    return origin;\n  }\n\n  private onCreatePanel(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.CreatePanel) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.CreatePanel}`);\n    }\n    const id = message.id;\n    // The ids are generated on the client API side and must be unique, so the check below\n    // shouldn't be hit unless someone is bypassing the API.\n    if (this.clientObjects.has(id) || UI.InspectorView.InspectorView.instance().hasPanel(id)) {\n      return this.status.E_EXISTS(id);\n    }\n\n    const page = ExtensionServer.expandResourcePath(this.getExtensionOrigin(port), message.page);\n    if (page === undefined) {\n      return this.status.E_BADARG('page', 'Resources paths cannot point to non-extension resources');\n    }\n    let persistentId = this.getExtensionOrigin(port) + message.title;\n    persistentId = persistentId.replace(/\\s|:\\d+/g, '');\n    const panelView = new ExtensionServerPanelView(\n        persistentId, i18n.i18n.lockedString(message.title), new ExtensionPanel(this, persistentId, id, page));\n    this.clientObjects.set(id, panelView);\n    UI.InspectorView.InspectorView.instance().addPanel(panelView);\n    return this.status.OK();\n  }\n\n  private onShowPanel(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.ShowPanel) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.ShowPanel}`);\n    }\n\n    let panelViewId = message.id;\n    const panelView = this.clientObjects.get(message.id);\n    if (panelView && panelView instanceof ExtensionServerPanelView) {\n      panelViewId = panelView.viewId();\n    }\n    void UI.InspectorView.InspectorView.instance().showPanel(panelViewId);\n    return undefined;\n  }\n\n  private onCreateToolbarButton(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.CreateToolbarButton) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.CreateToolbarButton}`);\n    }\n    const panelView = this.clientObjects.get(message.panel);\n    if (!panelView || !(panelView instanceof ExtensionServerPanelView)) {\n      return this.status.E_NOTFOUND(message.panel);\n    }\n    const resourcePath = ExtensionServer.expandResourcePath(this.getExtensionOrigin(port), message.icon);\n    if (resourcePath === undefined) {\n      return this.status.E_BADARG('icon', 'Resources paths cannot point to non-extension resources');\n    }\n    const button = new ExtensionButton(this, message.id, resourcePath, message.tooltip, message.disabled);\n    this.clientObjects.set(message.id, button);\n\n    void panelView.widget().then(appendButton);\n\n    function appendButton(panel: UI.Widget.Widget): void {\n      (panel as ExtensionPanel).addToolbarItem(button.toolbarButton());\n    }\n\n    return this.status.OK();\n  }\n\n  private onUpdateButton(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.UpdateButton) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.UpdateButton}`);\n    }\n    const button = this.clientObjects.get(message.id);\n    if (!button || !(button instanceof ExtensionButton)) {\n      return this.status.E_NOTFOUND(message.id);\n    }\n    const resourcePath =\n        message.icon && ExtensionServer.expandResourcePath(this.getExtensionOrigin(port), message.icon);\n    if (message.icon && resourcePath === undefined) {\n      return this.status.E_BADARG('icon', 'Resources paths cannot point to non-extension resources');\n    }\n    button.update(resourcePath, message.tooltip, message.disabled);\n    return this.status.OK();\n  }\n\n  private onCreateSidebarPane(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.CreateSidebarPane) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.CreateSidebarPane}`);\n    }\n    const id = message.id;\n    const sidebar = new ExtensionSidebarPane(this, message.panel, i18n.i18n.lockedString(message.title), id);\n    this.#sidebarPanes.push(sidebar);\n    this.clientObjects.set(id, sidebar);\n    this.dispatchEventToListeners(Events.SidebarPaneAdded, sidebar);\n\n    return this.status.OK();\n  }\n\n  sidebarPanes(): ExtensionSidebarPane[] {\n    return this.#sidebarPanes;\n  }\n\n  private onSetSidebarHeight(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarHeight) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarHeight}`);\n    }\n    const sidebar = this.clientObjects.get(message.id);\n    if (!sidebar || !(sidebar instanceof ExtensionSidebarPane)) {\n      return this.status.E_NOTFOUND(message.id);\n    }\n    sidebar.setHeight(message.height);\n    return this.status.OK();\n  }\n\n  private onSetSidebarContent(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarContent) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarContent}`);\n    }\n    const {requestId, id, rootTitle, expression, evaluateOptions, evaluateOnPage} = message;\n    const sidebar = this.clientObjects.get(id);\n    if (!sidebar || !(sidebar instanceof ExtensionSidebarPane)) {\n      return this.status.E_NOTFOUND(message.id);\n    }\n\n    function callback(this: ExtensionServer, error: unknown): void {\n      const result = error ? this.status.E_FAILED(error) : this.status.OK();\n      this.dispatchCallback(requestId, port, result);\n    }\n    if (evaluateOnPage) {\n      sidebar.setExpression(expression, rootTitle, evaluateOptions, this.getExtensionOrigin(port), callback.bind(this));\n      return undefined;\n    }\n    sidebar.setObject(message.expression, message.rootTitle, callback.bind(this));\n    return undefined;\n  }\n\n  private onSetSidebarPage(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarPage) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetSidebarPage}`);\n    }\n    const sidebar = this.clientObjects.get(message.id);\n    if (!sidebar || !(sidebar instanceof ExtensionSidebarPane)) {\n      return this.status.E_NOTFOUND(message.id);\n    }\n    const resourcePath = ExtensionServer.expandResourcePath(this.getExtensionOrigin(port), message.page);\n    if (resourcePath === undefined) {\n      return this.status.E_BADARG('page', 'Resources paths cannot point to non-extension resources');\n    }\n    sidebar.setPage(resourcePath);\n    return undefined;\n  }\n\n  private onOpenResource(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.OpenResource) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.OpenResource}`);\n    }\n    const uiSourceCode = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(message.url);\n    if (uiSourceCode) {\n      void Common.Revealer.reveal(uiSourceCode.uiLocation(message.lineNumber, message.columnNumber));\n      return this.status.OK();\n    }\n\n    const resource = Bindings.ResourceUtils.resourceForURL(message.url);\n    if (resource) {\n      void Common.Revealer.reveal(resource);\n      return this.status.OK();\n    }\n\n    const request = Logs.NetworkLog.NetworkLog.instance().requestForURL(message.url);\n    if (request) {\n      void Common.Revealer.reveal(request);\n      return this.status.OK();\n    }\n\n    return this.status.E_NOTFOUND(message.url);\n  }\n\n  private onSetOpenResourceHandler(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetOpenResourceHandler) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetOpenResourceHandler}`);\n    }\n    const extension = this.registeredExtensions.get(this.getExtensionOrigin(port));\n    if (!extension) {\n      throw new Error('Received a message from an unregistered extension');\n    }\n    if (message.urlScheme) {\n      extension.openResourceScheme = message.urlScheme;\n    }\n    const extensionOrigin = this.getExtensionOrigin(port);\n    const {name} = extension;\n    const registration = {\n      title: name,\n      origin: extensionOrigin,\n      scheme: message.urlScheme,\n      handler: this.handleOpenURL.bind(this, port),\n      shouldHandleOpenResource: (url: Platform.DevToolsPath.UrlString, schemes: Set<string>) =>\n          Components.Linkifier.Linkifier.shouldHandleOpenResource(extension.openResourceScheme, url, schemes),\n    };\n    if (message.handlerPresent) {\n      Components.Linkifier.Linkifier.registerLinkHandler(registration);\n    } else {\n      Components.Linkifier.Linkifier.unregisterLinkHandler(registration);\n    }\n    return undefined;\n  }\n\n  private onSetThemeChangeHandler(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetThemeChangeHandler) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetThemeChangeHandler}`);\n    }\n    const extensionOrigin = this.getExtensionOrigin(port);\n    const extension = this.registeredExtensions.get(extensionOrigin);\n    if (!extension) {\n      throw new Error('Received a message from an unregistered extension');\n    }\n\n    if (message.handlerPresent) {\n      this.themeChangeHandlers.set(extensionOrigin, port);\n    } else {\n      this.themeChangeHandlers.delete(extensionOrigin);\n    }\n    return undefined;\n  }\n\n  private handleOpenURL(\n      port: MessagePort, contentProviderOrUrl: TextUtils.ContentProvider.ContentProvider|string, lineNumber?: number,\n      columnNumber?: number): void {\n    let resource: {url: string, type: string};\n    let isAllowed: boolean;\n    if (typeof contentProviderOrUrl !== 'string') {\n      resource = this.makeResource(contentProviderOrUrl);\n      isAllowed = this.extensionAllowedOnContentProvider(contentProviderOrUrl, port);\n    } else {\n      const url = contentProviderOrUrl as Platform.DevToolsPath.UrlString;\n      resource = {url, type: Common.ResourceType.resourceTypes.Other.name()};\n      isAllowed = this.extensionAllowedOnURL(url, port);\n    }\n\n    if (isAllowed) {\n      port.postMessage({\n        command: 'open-resource',\n        resource,\n        lineNumber: lineNumber ? lineNumber + 1 : undefined,\n        columnNumber: columnNumber ? columnNumber + 1 : undefined,\n      });\n    }\n  }\n\n  private extensionAllowedOnURL(url: Platform.DevToolsPath.UrlString, port: MessagePort): boolean {\n    const origin = extensionOrigins.get(port);\n    const extension = origin && this.registeredExtensions.get(origin);\n    return Boolean(extension?.isAllowedOnTarget(url));\n  }\n\n  /**\n   * Slightly more permissive as {@link extensionAllowedOnURL}: This method also permits\n   * UISourceCodes that originate from a {@link SDK.Script.Script} with a sourceURL magic comment as\n   * long as the corresponding target is permitted.\n   */\n  private extensionAllowedOnContentProvider(\n      contentProvider: TextUtils.ContentProvider.ContentProvider, port: MessagePort): boolean {\n    if (!(contentProvider instanceof Workspace.UISourceCode.UISourceCode)) {\n      return this.extensionAllowedOnURL(contentProvider.contentURL(), port);\n    }\n\n    if (contentProvider.contentType() !== Common.ResourceType.resourceTypes.Script) {\n      // We only check sourceURL magic comments for scripts (excluding ones coming from source maps).\n      return this.extensionAllowedOnURL(contentProvider.contentURL(), port);\n    }\n\n    const scripts =\n        Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance().scriptsForUISourceCode(contentProvider);\n    if (scripts.length === 0) {\n      return this.extensionAllowedOnURL(contentProvider.contentURL(), port);\n    }\n\n    return scripts.every(script => {\n      if (script.hasSourceURL) {\n        return this.extensionAllowedOnTarget(script.target(), port);\n      }\n      return this.extensionAllowedOnURL(script.contentURL(), port);\n    });\n  }\n\n  /**\n   * This method prefers returning 'Permission denied' errors if restricted resources are not found,\n   * rather then NOTFOUND. This prevents extensions from being able to fish for restricted resources.\n   */\n  private lookupAllowedUISourceCode(url: Platform.DevToolsPath.UrlString, port: MessagePort):\n      {uiSourceCode: Workspace.UISourceCode.UISourceCode}|{\n    error: Record,\n  }\n  {\n    const uiSourceCode = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(url);\n    if (!uiSourceCode && !this.extensionAllowedOnURL(url, port)) {\n      return {error: this.status.E_FAILED('Permission denied')};\n    }\n    if (!uiSourceCode) {\n      return {error: this.status.E_NOTFOUND(url)};\n    }\n    if (!this.extensionAllowedOnContentProvider(uiSourceCode, port)) {\n      return {error: this.status.E_FAILED('Permission denied')};\n    }\n    return {uiSourceCode};\n  }\n\n  private extensionAllowedOnTarget(target: SDK.Target.Target, port: MessagePort): boolean {\n    return this.extensionAllowedOnURL(target.inspectedURL(), port);\n  }\n\n  private onReload(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Record {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.Reload) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.Reload}`);\n    }\n    const options = (message.options || {});\n\n    SDK.NetworkManager.MultitargetNetworkManager.instance().setUserAgentOverride(\n        typeof options.userAgent === 'string' ? options.userAgent : '', null);\n    let injectedScript;\n    if (options.injectedScript) {\n      injectedScript = '(function(){' + options.injectedScript + '})()';\n    }\n    const target = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (!target) {\n      return this.status.OK();\n    }\n    const resourceTreeModel = target.model(SDK.ResourceTreeModel.ResourceTreeModel);\n    if (!this.extensionAllowedOnTarget(target, port)) {\n      return this.status.E_FAILED('Permission denied');\n    }\n    resourceTreeModel?.reloadPage(Boolean(options.ignoreCache), injectedScript);\n    return this.status.OK();\n  }\n\n  private onEvaluateOnInspectedPage(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.EvaluateOnInspectedPage) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.EvaluateOnInspectedPage}`);\n    }\n\n    const {requestId, expression, evaluateOptions} = message;\n    function callback(\n        this: ExtensionServer, error: string|null, object: SDK.RemoteObject.RemoteObject|null,\n        wasThrown: boolean): void {\n      let result;\n      if (error || !object) {\n        result = this.status.E_PROTOCOLERROR(error?.toString());\n      } else if (wasThrown) {\n        result = {isException: true, value: object.description};\n      } else {\n        result = {value: object.value};\n      }\n\n      this.dispatchCallback(requestId, port, result);\n    }\n    return this.evaluate(expression, true, true, evaluateOptions, this.getExtensionOrigin(port), callback.bind(this));\n  }\n\n  private async onGetHAR(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort):\n      Promise<Record|HAR.Log.LogDTO> {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetHAR) {\n      return this.status.E_BADARG('command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetHAR}`);\n    }\n    const requests =\n        Logs.NetworkLog.NetworkLog.instance().requests().filter(r => this.extensionAllowedOnURL(r.url(), port));\n    const harLog = await HAR.Log.Log.build(requests, {sanitize: false});\n    for (let i = 0; i < harLog.entries.length; ++i) {\n      // @ts-expect-error\n      harLog.entries[i]._requestId = this.requestId(requests[i]);\n    }\n    return harLog;\n  }\n\n  private makeResource(contentProvider: TextUtils.ContentProvider.ContentProvider):\n      {url: string, type: string, buildId?: string} {\n    let buildId: string|undefined = undefined;\n    if (contentProvider instanceof Workspace.UISourceCode.UISourceCode) {\n      // We use the first buildId we find searching in all Script objects that correspond to this UISourceCode.\n      buildId = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance()\n                    .scriptsForUISourceCode(contentProvider)\n                    .find(script => Boolean(script.buildId))\n                    ?.buildId ??\n          undefined;\n    }\n    return {url: contentProvider.contentURL(), type: contentProvider.contentType().name(), buildId};\n  }\n\n  private onGetPageResources(_message: unknown, port: MessagePort): Array<{url: string, type: string}> {\n    const resources = new Map<unknown, {\n      url: string,\n      type: string,\n    }>();\n    function pushResourceData(\n        this: ExtensionServer, contentProvider: TextUtils.ContentProvider.ContentProvider): boolean {\n      if (!resources.has(contentProvider.contentURL()) &&\n          this.extensionAllowedOnContentProvider(contentProvider, port)) {\n        resources.set(contentProvider.contentURL(), this.makeResource(contentProvider));\n      }\n      return false;\n    }\n    let uiSourceCodes = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodesForProjectType(\n        Workspace.Workspace.projectTypes.Network);\n    uiSourceCodes = uiSourceCodes.concat(Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodesForProjectType(\n        Workspace.Workspace.projectTypes.ContentScripts));\n    uiSourceCodes.forEach(pushResourceData.bind(this));\n    for (const resourceTreeModel of SDK.TargetManager.TargetManager.instance().models(\n             SDK.ResourceTreeModel.ResourceTreeModel)) {\n      if (this.extensionAllowedOnTarget(resourceTreeModel.target(), port)) {\n        resourceTreeModel.forAllResources(pushResourceData.bind(this));\n      }\n    }\n\n    return [...resources.values()];\n  }\n\n  private async getResourceContent(\n      contentProvider: TextUtils.ContentProvider.ContentProvider,\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Promise<void> {\n    if (!this.extensionAllowedOnContentProvider(contentProvider, port)) {\n      this.dispatchCallback(message.requestId, port, this.status.E_FAILED('Permission denied'));\n      return undefined;\n    }\n    const contentData = await contentProvider.requestContentData();\n    if (TextUtils.ContentData.ContentData.isError(contentData)) {\n      this.dispatchCallback(message.requestId, port, {encoding: '', content: null});\n      return;\n    }\n    const encoding = !contentData.isTextContent ? 'base64' : '';\n    const content = contentData.isTextContent ? contentData.text : contentData.base64;\n    this.dispatchCallback(message.requestId, port, {encoding, content});\n  }\n\n  private onGetRequestContent(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetRequestContent) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetRequestContent}`);\n    }\n    const request = this.requestById(message.id);\n    if (!request) {\n      return this.status.E_NOTFOUND(message.id);\n    }\n    void this.getResourceContent(request, message, port);\n    return undefined;\n  }\n\n  private onGetResourceContent(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.GetResourceContent) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetResourceContent}`);\n    }\n    const url = message.url as Platform.DevToolsPath.UrlString;\n    const contentProvider = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(url) ||\n        Bindings.ResourceUtils.resourceForURL(url);\n    if (!contentProvider) {\n      return this.status.E_NOTFOUND(url);\n    }\n    void this.getResourceContent(contentProvider, message, port);\n    return undefined;\n  }\n\n  private onAttachSourceMapToResource(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.AttachSourceMapToResource) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.GetResourceContent}`);\n    }\n\n    if (!message.sourceMapURL) {\n      return this.status.E_FAILED('Expected a source map URL but got null');\n    }\n\n    const resource = this.lookupAllowedUISourceCode(message.contentUrl as Platform.DevToolsPath.UrlString, port);\n    if ('error' in resource) {\n      return resource.error;\n    }\n\n    const debuggerBindingsInstance = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n    const scriptFiles = debuggerBindingsInstance.scriptsForUISourceCode(resource.uiSourceCode);\n    if (scriptFiles.length > 0) {\n      for (const script of scriptFiles) {\n        const resourceFile = debuggerBindingsInstance.scriptFile(resource.uiSourceCode, script.debuggerModel);\n        resourceFile?.addSourceMapURL(message.sourceMapURL as Platform.DevToolsPath.UrlString);\n      }\n    }\n\n    return this.status.OK();\n  }\n\n  private onSetResourceContent(\n      message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort): Record|undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.SetResourceContent) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.SetResourceContent}`);\n    }\n\n    const {url, requestId, content, commit} = message;\n    function callbackWrapper(this: ExtensionServer, error: string|null): void {\n      const response = error ? this.status.E_FAILED(error) : this.status.OK();\n      this.dispatchCallback(requestId, port, response);\n    }\n\n    const resource = this.lookupAllowedUISourceCode(url as Platform.DevToolsPath.UrlString, port);\n    if ('error' in resource) {\n      return resource.error;\n    }\n    const {uiSourceCode} = resource;\n    if (!uiSourceCode.contentType().isDocumentOrScriptOrStyleSheet()) {\n      const resource = SDK.ResourceTreeModel.ResourceTreeModel.resourceForURL(url as Platform.DevToolsPath.UrlString);\n      if (!resource) {\n        return this.status.E_NOTFOUND(url);\n      }\n      return this.status.E_NOTSUPPORTED('Resource is not editable');\n    }\n    uiSourceCode.setWorkingCopy(content);\n    if (commit) {\n      uiSourceCode.commitWorkingCopy();\n    }\n    callbackWrapper.call(this, null);\n    return undefined;\n  }\n\n  private requestId(request: TextUtils.ContentProvider.ContentProvider): number {\n    const requestId = this.requestIds.get(request);\n    if (requestId === undefined) {\n      const newId = ++this.lastRequestId;\n      this.requestIds.set(request, newId);\n      this.requests.set(newId, request);\n      return newId;\n    }\n    return requestId;\n  }\n\n  private requestById(id: number): TextUtils.ContentProvider.ContentProvider|undefined {\n    return this.requests.get(id);\n  }\n\n  private onForwardKeyboardEvent(message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage): Record\n      |undefined {\n    if (message.command !== Extensions.ExtensionAPI.PrivateAPI.Commands.ForwardKeyboardEvent) {\n      return this.status.E_BADARG(\n          'command', `expected ${Extensions.ExtensionAPI.PrivateAPI.Commands.ForwardKeyboardEvent}`);\n    }\n    message.entries.forEach(handleEventEntry);\n\n    function handleEventEntry(entry: KeyboardEventInit&{eventType: string}): void {\n      // Fool around closure compiler -- it has its own notion of both KeyboardEvent constructor\n      // and initKeyboardEvent methods and overriding these in externs.js does not have effect.\n      const event = new window.KeyboardEvent(entry.eventType, {\n        key: entry.key,\n        code: entry.code,\n        keyCode: entry.keyCode,\n        location: entry.location,\n        ctrlKey: entry.ctrlKey,\n        altKey: entry.altKey,\n        shiftKey: entry.shiftKey,\n        metaKey: entry.metaKey,\n      });\n\n      // @ts-expect-error\n      event.__keyCode = keyCodeForEntry(entry);\n      document.dispatchEvent(event);\n    }\n\n    function keyCodeForEntry(entry: KeyboardEventInit): unknown {\n      let keyCode = entry.keyCode;\n      if (!keyCode) {\n        // This is required only for synthetic events (e.g. dispatched in tests).\n        if (entry.key === Platform.KeyboardUtilities.ESCAPE_KEY) {\n          keyCode = 27;\n        }\n      }\n      return keyCode || 0;\n    }\n    return undefined;\n  }\n\n  private dispatchCallback(requestId: unknown, port: MessagePort, result: unknown): void {\n    if (requestId) {\n      port.postMessage({command: 'callback', requestId, result});\n    }\n  }\n\n  private initExtensions(): void {\n    this.registerAutosubscriptionHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Events.ResourceAdded, Workspace.Workspace.WorkspaceImpl.instance(),\n        Workspace.Workspace.Events.UISourceCodeAdded, this.notifyResourceAdded);\n    this.registerAutosubscriptionTargetManagerHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Events.NetworkRequestFinished, SDK.NetworkManager.NetworkManager,\n        SDK.NetworkManager.Events.RequestFinished, this.notifyRequestFinished);\n\n    function onElementsSubscriptionStarted(this: ExtensionServer): void {\n      UI.Context.Context.instance().addFlavorChangeListener(\n          SDK.DOMModel.DOMNode, this.notifyElementsSelectionChanged, this);\n    }\n\n    function onElementsSubscriptionStopped(this: ExtensionServer): void {\n      UI.Context.Context.instance().removeFlavorChangeListener(\n          SDK.DOMModel.DOMNode, this.notifyElementsSelectionChanged, this);\n    }\n\n    this.registerSubscriptionHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Events.PanelObjectSelected + 'elements',\n        onElementsSubscriptionStarted.bind(this), onElementsSubscriptionStopped.bind(this));\n    this.registerResourceContentCommittedHandler(this.notifyUISourceCodeContentCommitted);\n\n    SDK.TargetManager.TargetManager.instance().addEventListener(\n        SDK.TargetManager.Events.INSPECTED_URL_CHANGED, this.inspectedURLChanged, this);\n  }\n\n  private notifyResourceAdded(event: Common.EventTarget.EventTargetEvent<Workspace.UISourceCode.UISourceCode>): void {\n    const uiSourceCode = event.data;\n    this.postNotification(\n        Extensions.ExtensionAPI.PrivateAPI.Events.ResourceAdded, [this.makeResource(uiSourceCode)],\n        extension => extension.isAllowedOnTarget(uiSourceCode.url()));\n  }\n\n  private notifyUISourceCodeContentCommitted(\n      event: Common.EventTarget.EventTargetEvent<Workspace.Workspace.WorkingCopyCommittedEvent>): void {\n    const {uiSourceCode, content} = event.data;\n    this.postNotification(\n        Extensions.ExtensionAPI.PrivateAPI.Events.ResourceContentCommitted, [this.makeResource(uiSourceCode), content],\n        extension => extension.isAllowedOnTarget(uiSourceCode.url()));\n  }\n\n  private async notifyRequestFinished(event: Common.EventTarget.EventTargetEvent<SDK.NetworkRequest.NetworkRequest>):\n      Promise<void> {\n    const request = event.data;\n    const entry = await HAR.Log.Entry.build(request, {sanitize: false});\n    this.postNotification(\n        Extensions.ExtensionAPI.PrivateAPI.Events.NetworkRequestFinished, [this.requestId(request), entry],\n        extension => extension.isAllowedOnTarget(entry.request.url));\n  }\n\n  private notifyElementsSelectionChanged(): void {\n    this.postNotification(Extensions.ExtensionAPI.PrivateAPI.Events.PanelObjectSelected + 'elements', []);\n  }\n\n  sourceSelectionChanged(url: Platform.DevToolsPath.UrlString, range: TextUtils.TextRange.TextRange): void {\n    this.postNotification(\n        Extensions.ExtensionAPI.PrivateAPI.Events.PanelObjectSelected + 'sources', [{\n          startLine: range.startLine,\n          startColumn: range.startColumn,\n          endLine: range.endLine,\n          endColumn: range.endColumn,\n          url,\n        }],\n        extension => extension.isAllowedOnTarget(url));\n  }\n\n  private setInspectedTabId(event: Common.EventTarget.EventTargetEvent<string>): void {\n    const oldId = this.inspectedTabId;\n    this.inspectedTabId = event.data;\n    if (oldId === null) {\n      // Run deferred init\n      this.initializeExtensions();\n    }\n  }\n\n  addExtensionFrame({startPage, name}: Host.InspectorFrontendHostAPI.ExtensionDescriptor): void {\n    const iframe = document.createElement('iframe');\n    iframe.src = startPage;\n    iframe.dataset.devtoolsExtension = name;\n    iframe.style.display = 'none';\n    document.body.appendChild(iframe);  // Only for main window.\n  }\n\n  addExtension(extensionInfo: Host.InspectorFrontendHostAPI.ExtensionDescriptor): boolean|undefined {\n    const startPage = extensionInfo.startPage;\n\n    const inspectedURL = SDK.TargetManager.TargetManager.instance().primaryPageTarget()?.inspectedURL() ?? '';\n    if (inspectedURL === '') {\n      this.#pendingExtensions.push(extensionInfo);\n      return;\n    }\n    if (!ExtensionServer.canInspectURL(inspectedURL)) {\n      this.disableExtensions();\n    }\n    if (!this.extensionsEnabled) {\n      this.#pendingExtensions.push(extensionInfo);\n      return;\n    }\n    const hostsPolicy = HostsPolicy.create(extensionInfo.hostsPolicy);\n    if (!hostsPolicy) {\n      return;\n    }\n    try {\n      const startPageURL = new URL((startPage));\n      const extensionOrigin = startPageURL.origin;\n      const name = extensionInfo.name || `Extension ${extensionOrigin}`;\n      const extensionRegistration = new RegisteredExtension(name, hostsPolicy, Boolean(extensionInfo.allowFileAccess));\n      if (!extensionRegistration.isAllowedOnTarget(inspectedURL)) {\n        this.#pendingExtensions.push(extensionInfo);\n        return;\n      }\n      if (!this.registeredExtensions.get(extensionOrigin)) {\n        // See ExtensionAPI.js for details.\n        const injectedAPI = self.buildExtensionAPIInjectedScript(\n            extensionInfo, this.inspectedTabId as string, ThemeSupport.ThemeSupport.instance().themeName(),\n            UI.ShortcutRegistry.ShortcutRegistry.instance().globalShortcutKeys(),\n            ExtensionServer.instance().extensionAPITestHook);\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance.setInjectedScriptForOrigin(\n            extensionOrigin, injectedAPI);\n        this.registeredExtensions.set(extensionOrigin, extensionRegistration);\n      }\n      this.addExtensionFrame(extensionInfo);\n    } catch (e) {\n      console.error('Failed to initialize extension ' + startPage + ':' + e);\n      return false;\n    }\n    return true;\n  }\n\n  private registerExtension(origin: Platform.DevToolsPath.UrlString, port: MessagePort): void {\n    if (!this.registeredExtensions.has(origin)) {\n      if (origin !== window.location.origin) {  // Just ignore inspector frames.\n        console.error('Ignoring unauthorized client request from ' + origin);\n      }\n      return;\n    }\n    extensionOrigins.set(port, origin);\n    port.addEventListener('message', this.onmessage.bind(this), false);\n    port.start();\n  }\n\n  private onWindowMessage = (event: MessageEvent): void => {\n    if (event.data === 'registerExtension') {\n      this.registerExtension(event.origin as Platform.DevToolsPath.UrlString, event.ports[0]);\n    }\n  };\n\n  private extensionEnabled(port: MessagePort): boolean {\n    if (!this.extensionsEnabled) {\n      return false;\n    }\n    const origin = extensionOrigins.get(port);\n    if (!origin) {\n      return false;\n    }\n    const extension = this.registeredExtensions.get(origin);\n    if (!extension) {\n      return false;\n    }\n    return extension.isAllowedOnTarget();\n  }\n\n  private async onmessage(event: MessageEvent): Promise<void> {\n    const message = event.data;\n    let result;\n\n    const port = event.currentTarget as MessagePort;\n    const handler = this.handlers.get(message.command);\n\n    if (!handler) {\n      result = this.status.E_NOTSUPPORTED(message.command);\n    } else if (!this.extensionEnabled(port)) {\n      result = this.status.E_FAILED('Permission denied');\n    } else {\n      try {\n        result = await handler(message, event.target as MessagePort);\n      } catch (e) {\n        result = this.status.E_FAILED(e.message);\n      }\n    }\n\n    if (result && message.requestId) {\n      this.dispatchCallback(message.requestId, event.target as MessagePort, result);\n    }\n  }\n\n  private registerHandler(\n      command: string,\n      callback:\n          (message: Extensions.ExtensionAPI.PrivateAPI.ExtensionServerRequestMessage, port: MessagePort) => unknown):\n      void {\n    console.assert(Boolean(command));\n    this.handlers.set(command, callback);\n  }\n\n  private registerSubscriptionHandler(\n      eventTopic: string, onSubscribeFirst: () => unknown, onUnsubscribeLast: () => unknown): void {\n    this.subscriptionStartHandlers.set(eventTopic, onSubscribeFirst);\n    this.subscriptionStopHandlers.set(eventTopic, onUnsubscribeLast);\n  }\n\n  private registerAutosubscriptionHandler<Events, T extends keyof Events>(\n      eventTopic: string, eventTarget: Common.EventTarget.EventTarget<Events>, frontendEventType: T,\n      handler: Common.EventTarget.EventListener<Events, T>): void {\n    this.registerSubscriptionHandler(\n        eventTopic, () => eventTarget.addEventListener(frontendEventType, handler, this),\n        () => eventTarget.removeEventListener(frontendEventType, handler, this));\n  }\n\n  private registerAutosubscriptionTargetManagerHandler<Events, T extends keyof Events>(\n      eventTopic: string, modelClass: new(arg1: SDK.Target.Target) => SDK.SDKModel.SDKModel<Events>,\n      frontendEventType: T, handler: Common.EventTarget.EventListener<Events, T>): void {\n    this.registerSubscriptionHandler(\n        eventTopic,\n        () => SDK.TargetManager.TargetManager.instance().addModelListener(modelClass, frontendEventType, handler, this),\n        () => SDK.TargetManager.TargetManager.instance().removeModelListener(\n            modelClass, frontendEventType, handler, this));\n  }\n\n  private registerResourceContentCommittedHandler(\n      handler: (arg0: Common.EventTarget.EventTargetEvent<Workspace.Workspace.WorkingCopyCommittedEvent>) => unknown):\n      void {\n    function addFirstEventListener(this: ExtensionServer): void {\n      Workspace.Workspace.WorkspaceImpl.instance().addEventListener(\n          Workspace.Workspace.Events.WorkingCopyCommittedByUser, handler, this);\n      Workspace.Workspace.WorkspaceImpl.instance().setHasResourceContentTrackingExtensions(true);\n    }\n\n    function removeLastEventListener(this: ExtensionServer): void {\n      Workspace.Workspace.WorkspaceImpl.instance().setHasResourceContentTrackingExtensions(false);\n      Workspace.Workspace.WorkspaceImpl.instance().removeEventListener(\n          Workspace.Workspace.Events.WorkingCopyCommittedByUser, handler, this);\n    }\n\n    this.registerSubscriptionHandler(\n        Extensions.ExtensionAPI.PrivateAPI.Events.ResourceContentCommitted, addFirstEventListener.bind(this),\n        removeLastEventListener.bind(this));\n  }\n\n  static expandResourcePath(extensionOrigin: Platform.DevToolsPath.UrlString, resourcePath: string):\n      Platform.DevToolsPath.UrlString|undefined {\n    const strippedOrigin = new URL(extensionOrigin).origin;\n    const resourceURL = new URL(Common.ParsedURL.normalizePath(resourcePath), strippedOrigin);\n    if (resourceURL.origin !== strippedOrigin) {\n      return undefined;\n    }\n    return resourceURL.href as Platform.DevToolsPath.UrlString;\n  }\n\n  evaluate(\n      expression: string, exposeCommandLineAPI: boolean, returnByValue: boolean,\n      options: Extensions.ExtensionAPI.PrivateAPI.EvaluateOptions|undefined, securityOrigin: string,\n      callback: (arg0: string|null, arg1: SDK.RemoteObject.RemoteObject|null, arg2: boolean) => unknown): Record\n      |undefined {\n    let context;\n\n    function resolveURLToFrame(url: Platform.DevToolsPath.UrlString): SDK.ResourceTreeModel.ResourceTreeFrame|null {\n      let found = null;\n      function hasMatchingURL(frame: SDK.ResourceTreeModel.ResourceTreeFrame): SDK.ResourceTreeModel.ResourceTreeFrame|\n          null {\n        found = (frame.url === url) ? frame : null;\n        return found;\n      }\n      SDK.ResourceTreeModel.ResourceTreeModel.frames().some(hasMatchingURL);\n      return found;\n    }\n\n    options = options || {};\n    let frame;\n    if (options.frameURL) {\n      frame = resolveURLToFrame(options.frameURL as Platform.DevToolsPath.UrlString);\n    } else {\n      const target = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n      const resourceTreeModel = target?.model(SDK.ResourceTreeModel.ResourceTreeModel);\n      frame = resourceTreeModel?.mainFrame;\n    }\n    if (!frame) {\n      if (options.frameURL) {\n        console.warn('evaluate: there is no frame with URL ' + options.frameURL);\n      } else {\n        console.warn('evaluate: the main frame is not yet available');\n      }\n      return this.status.E_NOTFOUND(options.frameURL || '<top>');\n    }\n    // We shouldn't get here if the outermost frame can't be inspected by an extension, but\n    // let's double check for subframes.\n    const extension = this.registeredExtensions.get(securityOrigin);\n    if (!extension?.isAllowedOnTarget(frame.url)) {\n      return this.status.E_FAILED('Permission denied');\n    }\n\n    let contextSecurityOrigin;\n    if (options.useContentScriptContext) {\n      contextSecurityOrigin = securityOrigin;\n    } else if (options.scriptExecutionContext) {\n      contextSecurityOrigin = options.scriptExecutionContext;\n    }\n\n    const runtimeModel = frame.resourceTreeModel().target().model(SDK.RuntimeModel.RuntimeModel);\n    const executionContexts = runtimeModel ? runtimeModel.executionContexts() : [];\n    if (contextSecurityOrigin) {\n      for (let i = 0; i < executionContexts.length; ++i) {\n        const executionContext = executionContexts[i];\n        if (executionContext.frameId === frame.id && executionContext.origin === contextSecurityOrigin &&\n            !executionContext.isDefault) {\n          context = executionContext;\n        }\n      }\n      if (!context) {\n        console.warn('The JavaScript context ' + contextSecurityOrigin + ' was not found in the frame ' + frame.url);\n        return this.status.E_NOTFOUND(contextSecurityOrigin);\n      }\n    } else {\n      for (let i = 0; i < executionContexts.length; ++i) {\n        const executionContext = executionContexts[i];\n        if (executionContext.frameId === frame.id && executionContext.isDefault) {\n          context = executionContext;\n        }\n      }\n      if (!context) {\n        return this.status.E_FAILED(frame.url + ' has no execution context');\n      }\n    }\n    if (!extension?.isAllowedOnTarget(context.origin)) {\n      return this.status.E_FAILED('Permission denied');\n    }\n\n    void context\n        .evaluate(\n            {\n              expression,\n              objectGroup: 'extension',\n              includeCommandLineAPI: exposeCommandLineAPI,\n              silent: true,\n              returnByValue,\n              generatePreview: false,\n            },\n            /* userGesture */ false, /* awaitPromise */ false)\n        .then(onEvaluate);\n\n    function onEvaluate(result: SDK.RuntimeModel.EvaluationResult): void {\n      if ('error' in result) {\n        callback(result.error, null, false);\n        return;\n      }\n      callback(null, result.object || null, Boolean(result.exceptionDetails));\n    }\n    return undefined;\n  }\n\n  static canInspectURL(url: Platform.DevToolsPath.UrlString): boolean {\n    let parsedURL;\n    // This is only to work around invalid URLs we're occasionally getting from some tests.\n    // TODO(caseq): make sure tests supply valid URLs or we specifically handle invalid ones.\n    try {\n      parsedURL = new URL(url);\n    } catch {\n      return false;\n    }\n\n    if (!kPermittedSchemes.includes(parsedURL.protocol)) {\n      return false;\n    }\n\n    if ((window.DevToolsAPI?.getOriginsForbiddenForExtensions?.() || []).includes(parsedURL.origin)) {\n      return false;\n    }\n\n    if (this.#isUrlFromChromeWebStore(parsedURL)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Tests whether a given URL is from the Chrome web store to prevent the extension server from\n   * being injected. This is treated as separate from the `getOriginsForbiddenForExtensions` API because\n   * DevTools might not be being run from a native origin and we still want to lock down this specific\n   * origin from DevTools extensions.\n   *\n   * @param parsedURL The URL to check\n   * @returns `true` if the URL corresponds to the Chrome web store; otherwise `false`\n   */\n  static #isUrlFromChromeWebStore(parsedURL: URL): boolean {\n    if (parsedURL.protocol.startsWith('http') && parsedURL.hostname.match(/^chrome\\.google\\.com\\.?$/) &&\n        parsedURL.pathname.startsWith('/webstore')) {\n      return true;\n    }\n    if (parsedURL.protocol.startsWith('http') && parsedURL.hostname.match(/^chromewebstore\\.google\\.com\\.?$/)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private disableExtensions(): void {\n    this.extensionsEnabled = false;\n  }\n\n  private enableExtensions(): void {\n    this.extensionsEnabled = true;\n  }\n}\n\nexport const enum Events {\n  SidebarPaneAdded = 'SidebarPaneAdded',\n}\n\nexport interface EventTypes {\n  [Events.SidebarPaneAdded]: ExtensionSidebarPane;\n}\n\nclass ExtensionServerPanelView extends UI.View.SimpleView {\n  private readonly name: string;\n  private readonly panel: UI.Panel.Panel;\n\n  constructor(name: string, title: Platform.UIString.LocalizedString, panel: UI.Panel.Panel) {\n    // The `viewId` here is to satisfy the `SimpleView` constructor needs, but isn't actually\n    // used anywhere, since we override the `viewId()` method below.  Ideally we'd pass the\n    // `name` as `viewId` to the constructor, but that doesn't work, since the `name` is not\n    // necessarily in Kebab case.\n    //\n    // For non-ASCII titles (e.g., Chinese, Japanese, Arabic), the kebab-cased result may not\n    // pass isExtendedKebabCase validation, so we fall back to 'extension-panel'.\n    const kebabTitle = Platform.StringUtilities.toKebabCase(title);\n    const viewId =\n        Platform.StringUtilities.isExtendedKebabCase(kebabTitle) ? kebabTitle : 'extension-panel' as Lowercase<string>;\n    super({title, viewId});\n    this.name = name;\n    this.panel = panel;\n  }\n\n  override viewId(): string {\n    return this.name;\n  }\n\n  override widget(): Promise<UI.Widget.Widget> {\n    return Promise.resolve(this.panel) as Promise<UI.Widget.Widget>;\n  }\n}\n\nexport class ExtensionStatus {\n  OK: (...args: unknown[]) => Record;\n  E_EXISTS: (...args: unknown[]) => Record;\n  E_BADARG: (...args: unknown[]) => Record;\n  E_BADARGTYPE: (...args: unknown[]) => Record;\n  E_NOTFOUND: (...args: unknown[]) => Record;\n  E_NOTSUPPORTED: (...args: unknown[]) => Record;\n  E_PROTOCOLERROR: (...args: unknown[]) => Record;\n  E_FAILED: (...args: unknown[]) => Record;\n\n  constructor() {\n    function makeStatus(code: string, description: string, ...details: unknown[]): Record {\n      const status: Record = {code, description, details};\n      if (code !== 'OK') {\n        status.isError = true;\n        console.error('Extension server error: ' + Platform.StringUtilities.sprintf(description, ...details));\n      }\n      return status;\n    }\n\n    this.OK = makeStatus.bind(null, 'OK', 'OK');\n    this.E_EXISTS = makeStatus.bind(null, 'E_EXISTS', 'Object already exists: %s');\n    this.E_BADARG = makeStatus.bind(null, 'E_BADARG', 'Invalid argument %s: %s');\n    this.E_BADARGTYPE = makeStatus.bind(null, 'E_BADARGTYPE', 'Invalid type for argument %s: got %s, expected %s');\n    this.E_NOTFOUND = makeStatus.bind(null, 'E_NOTFOUND', 'Object not found: %s');\n    this.E_NOTSUPPORTED = makeStatus.bind(null, 'E_NOTSUPPORTED', 'Object does not support requested operation: %s');\n    this.E_PROTOCOLERROR = makeStatus.bind(null, 'E_PROTOCOLERROR', 'Inspector protocol error: %s');\n    this.E_FAILED = makeStatus.bind(null, 'E_FAILED', 'Operation failed: %s');\n  }\n}\nexport interface Record {\n  code: string;\n  description: string;\n  details: unknown[];\n  isError?: boolean;\n}\n"]}