{"version":3,"file":"PersistenceUtils.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/PersistenceUtils.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/kit/kit.js';\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Persistence from '../../models/persistence/persistence.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport {html, type LitTemplate} from '../../ui/lit/lit.js';\n\nconst UIStrings = {\n  /**\n   * @description Text in Persistence Utils of the Workspace settings in Settings\n   * @example {example.url} PH1\n   */\n  linkedToSourceMapS: 'Linked to source map: {PH1}',\n  /**\n   * @description Text to show something is linked to another\n   * @example {example.url} PH1\n   */\n  linkedToS: 'Linked to {PH1}',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/common/PersistenceUtils.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class PersistenceUtils {\n  static tooltipForUISourceCode(uiSourceCode: Workspace.UISourceCode.UISourceCode): string {\n    const binding = Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode);\n    if (!binding) {\n      return '';\n    }\n    if (uiSourceCode === binding.network) {\n      return Persistence.FileSystemWorkspaceBinding.FileSystemWorkspaceBinding.tooltipForUISourceCode(\n          binding.fileSystem);\n    }\n    if (binding.network.contentType().isFromSourceMap()) {\n      return i18nString(\n          UIStrings.linkedToSourceMapS, {PH1: Platform.StringUtilities.trimMiddle(binding.network.url(), 150)});\n    }\n    return i18nString(UIStrings.linkedToS, {PH1: Platform.StringUtilities.trimMiddle(binding.network.url(), 150)});\n  }\n\n  static iconForUISourceCode(uiSourceCode: Workspace.UISourceCode.UISourceCode): LitTemplate|null {\n    const binding = Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode);\n    if (binding) {\n      if (!Common.ParsedURL.schemeIs(binding.fileSystem.url(), 'file:')) {\n        return null;\n      }\n      const dotClass = Persistence.NetworkPersistenceManager.NetworkPersistenceManager.instance().project() ===\n              binding.fileSystem.project() ?\n          'purple' :\n          'green';\n      // clang-format off\n      return html`<devtools-icon class=\"small dot ${dotClass}\" name=\"document\"\n                                 title=${PersistenceUtils.tooltipForUISourceCode(binding.network)}>\n                  </devtools-icon>`;\n      // clang-format on\n    }\n\n    if (uiSourceCode.project().type() !== Workspace.Workspace.projectTypes.FileSystem ||\n        !Common.ParsedURL.schemeIs(uiSourceCode.url(), 'file:')) {\n      return null;\n    }\n\n    if (Persistence.NetworkPersistenceManager.NetworkPersistenceManager.instance().isActiveHeaderOverrides(\n            uiSourceCode)) {\n      // clang-format off\n      return html`<devtools-icon class=\"small dot purple\" name=\"document\"></devtools-icon>`;\n      // clang-format on\n    }\n\n    // clang-format off\n    return html`<devtools-icon class=\"small\" name=\"document\"\n                               title=${PersistenceUtils.tooltipForUISourceCode(uiSourceCode)}>\n                </devtools-icon>`;\n    // clang-format on\n  }\n}\n\nexport class LinkDecorator extends Common.ObjectWrapper.ObjectWrapper<Components.Linkifier.LinkDecorator.EventTypes>\n    implements Components.Linkifier.LinkDecorator {\n  constructor(persistence: Persistence.Persistence.PersistenceImpl) {\n    super();\n    persistence.addEventListener(Persistence.Persistence.Events.BindingCreated, this.bindingChanged, this);\n    persistence.addEventListener(Persistence.Persistence.Events.BindingRemoved, this.bindingChanged, this);\n  }\n\n  private bindingChanged(event: Common.EventTarget.EventTargetEvent<Persistence.Persistence.PersistenceBinding>): void {\n    const binding = event.data;\n    this.dispatchEventToListeners(Components.Linkifier.LinkDecorator.Events.LINK_ICON_CHANGED, binding.network);\n  }\n\n  linkIcon(uiSourceCode: Workspace.UISourceCode.UISourceCode): LitTemplate|null {\n    return PersistenceUtils.iconForUISourceCode(uiSourceCode);\n  }\n}\n"]}