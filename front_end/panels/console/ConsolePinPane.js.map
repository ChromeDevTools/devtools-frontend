{"version":3,"file":"ConsolePinPane.js","sourceRoot":"","sources":["../../../../../../front_end/panels/console/ConsolePinPane.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2018 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as CodeMirror from '../../third_party/codemirror.next/codemirror.next.js';\nimport * as Buttons from '../../ui/components/buttons/buttons.js';\nimport * as TextEditor from '../../ui/components/text_editor/text_editor.js';\nimport * as ObjectUI from '../../ui/legacy/components/object_ui/object_ui.js';\n// eslint-disable-next-line @devtools/es-modules-import\nimport objectValueStyles from '../../ui/legacy/components/object_ui/objectValue.css.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives, html, type LitTemplate, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport consolePinPaneStyles from './consolePinPane.css.js';\n\nconst {createRef, ref} = Directives;\n\nconst UIStrings = {\n  /**\n   * @description A context menu item in the Console Pin Pane of the Console panel\n   */\n  removeExpression: 'Remove expression',\n  /**\n   * @description A context menu item in the Console Pin Pane of the Console panel\n   */\n  removeAllExpressions: 'Remove all expressions',\n  /**\n   * @description Screen reader label for delete button on a non-blank live expression\n   * @example {document} PH1\n   */\n  removeExpressionS: 'Remove expression: {PH1}',\n  /**\n   * @description Screen reader label for delete button on a blank live expression\n   */\n  removeBlankExpression: 'Remove blank expression',\n  /**\n   * @description Text in Console Pin Pane of the Console panel\n   */\n  liveExpressionEditor: 'Live expression editor',\n  /**\n   * @description Text in Console Pin Pane of the Console panel\n   */\n  expression: 'Expression',\n  /**\n   * @description Side effect label title in Console Pin Pane of the Console panel\n   */\n  evaluateAllowingSideEffects: 'Evaluate, allowing side effects',\n  /**\n   * @description Text of a DOM element in Console Pin Pane of the Console panel\n   */\n  notAvailable: 'not available',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/console/ConsolePinPane.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface PaneViewInput {\n  pins: ConsolePin[];\n  focusOut: () => void;\n  onRemove: (pin: ConsolePin) => void;\n  onContextMenu: (event: Event) => void;\n}\n\nexport const DEFAULT_PANE_VIEW = (input: PaneViewInput, _output: object, target: HTMLElement): void => {\n  // clang-format off\n  render(html`\n    <style>${consolePinPaneStyles}</style>\n    <div class='console-pins monospace' jslog=${VisualLogging.pane('console-pins')} @contextmenu=${input.onContextMenu}>\n    ${input.pins.map(pin => html`\n        <devtools-widget .widgetConfig=${UI.Widget.widgetConfig(ConsolePinPresenter, {\n          pin,\n          focusOut: input.focusOut,\n          onRemove: () => input.onRemove(pin),\n        })}></devtools-widget>`\n    )}\n    </div>`, target);\n  // clang-format on\n};\nexport class ConsolePinPane extends UI.Widget.VBox {\n  readonly #view: typeof DEFAULT_PANE_VIEW;\n  /** When creating a new pin, we'll focus it after rendering the editor */\n  #newPin?: ConsolePin;\n  readonly #pinModel: ConsolePinModel;\n  readonly #focusOut: () => void;\n\n  constructor(focusOut: () => void, view = DEFAULT_PANE_VIEW) {\n    super({useShadowDom: true});\n    this.#focusOut = focusOut;\n    this.#view = view;\n    this.#pinModel = new ConsolePinModel(Common.Settings.Settings.instance());\n  }\n\n  override willHide(): void {\n    super.willHide();\n    this.#pinModel.stopPeriodicEvaluate();\n  }\n\n  private contextMenuEventFired(event: Event): void {\n    const contextMenu = new UI.ContextMenu.ContextMenu(event);\n    const target = UI.UIUtils.deepElementFromEvent(event);\n    if (target) {\n      const targetPinElement = target.enclosingNodeOrSelfWithClass('widget');\n      if (targetPinElement) {\n        const targetPin = UI.Widget.Widget.get(targetPinElement);\n        if (targetPin instanceof ConsolePinPresenter) {\n          contextMenu.editSection().appendItem(\n              i18nString(UIStrings.removeExpression), () => targetPin.pin ? this.removePin(targetPin.pin) : undefined,\n              {jslogContext: 'remove-expression'});\n          targetPin.appendToContextMenu(contextMenu);\n        }\n      }\n    }\n    contextMenu.editSection().appendItem(\n        i18nString(UIStrings.removeAllExpressions), this.removeAllPins.bind(this),\n        {jslogContext: 'remove-all-expressions'});\n    void contextMenu.show();\n  }\n\n  private removeAllPins(): void {\n    this.#pinModel.removeAll();\n    this.requestUpdate();\n  }\n\n  removePin(pin: ConsolePin): void {\n    this.#pinModel.remove(pin);\n    this.requestUpdate();\n  }\n\n  addPin(expression: string, userGesture?: boolean): void {\n    const pin = this.#pinModel.add(expression);\n    if (userGesture) {\n      this.#newPin = pin;\n    }\n    this.requestUpdate();\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.#pinModel.startPeriodicEvaluate();\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          pins: [...this.#pinModel.pins],\n          focusOut: this.#focusOut,\n          onRemove: (pin: ConsolePin) => this.removePin(pin),\n          onContextMenu: this.contextMenuEventFired.bind(this),\n        },\n        {}, this.contentElement);\n\n    // Focus the freshly created pin if the user clicked the button.\n    // We need to give it a tick though, so the child can also finish rendering.\n    for (const child of this.children()) {\n      if (child instanceof ConsolePinPresenter && child.pin === this.#newPin) {\n        void child.updateComplete.then(() => child.focus());\n      }\n    }\n    this.#newPin = undefined;\n  }\n}\n\nexport interface ViewInput {\n  expression: string;\n  editorState: CodeMirror.EditorState;\n  result: SDK.RuntimeModel.EvaluationResult|null;\n  isEditing: boolean;\n  onDelete: () => void;\n  onPreviewHoverChange: (hovered: boolean) => void;\n  onPreviewClick: (event: MouseEvent) => void;\n}\n\nexport interface ViewOutput {\n  deletePinIcon?: Buttons.Button.Button;\n  editor?: TextEditor.TextEditor.TextEditor;\n}\n\nexport const DEFAULT_VIEW = (input: ViewInput, output: ViewOutput, target: HTMLElement): void => {\n  const deleteIconLabel = input.expression ? i18nString(UIStrings.removeExpressionS, {PH1: input.expression}) :\n                                             i18nString(UIStrings.removeBlankExpression);\n  const deleteRef = createRef<Buttons.Button.Button>();\n  const editorRef = createRef<TextEditor.TextEditor.TextEditor>();\n  const isError = input.result && !('error' in input.result) && input.result?.exceptionDetails &&\n      !SDK.RuntimeModel.RuntimeModel.isSideEffectFailure(input.result);\n  // clang-format off\n  render(html`\n    <style>${consolePinPaneStyles}</style>\n    <style>${objectValueStyles}</style>\n    <div class='console-pin ${isError ? 'error-level' : ''}'>\n      <devtools-button class='close-button'\n          .iconName=${'cross'}\n          .variant=${Buttons.Button.Variant.ICON}\n          .size=${Buttons.Button.Size.MICRO}\n          tabindex=0\n          aria-label=${deleteIconLabel}\n          @click=${(event: MouseEvent) => {\n            input.onDelete();\n            event.consume(true);\n          }}\n          @keydown=${(event: KeyboardEvent) => {\n            if (Platform.KeyboardUtilities.isEnterOrSpaceKey(event)) {\n              input.onDelete();\n              event.consume(true);\n            }\n          }}\n          ${ref(deleteRef)}\n      ></devtools-button>\n      <div class='console-pin-name'\n          title=${input.expression}\n          jslog=${VisualLogging.textField().track({change: true})}\n          @keydown=${(event: KeyboardEvent) => {\n            // Prevent Esc from toggling the drawer.\n            if (event.key === 'Escape') {\n              event.consume();\n            }\n          }}\n      >\n        <devtools-text-editor .state=${input.editorState} ${ref(editorRef)} tabindex=0\n        ></devtools-text-editor>\n      </div>\n      <div class='console-pin-preview'\n          @mouseenter=${() => input.onPreviewHoverChange(true)}\n          @mouseleave=${() => input.onPreviewHoverChange(false)}\n          @click=${(event: MouseEvent) => input.onPreviewClick(event)}\n      >\n        ${renderResult(input.result, input.isEditing)}\n      </div>\n    </div>\n    `, target);\n  // clang-format on\n  Object.assign(output, {\n    deletePinIcon: deleteRef.value,\n    editor: editorRef.value,\n  });\n};\n\n// RemoteObjectPreviewFormatter is stateless, so we can just keep a global copy around.\nconst FORMATTER = new ObjectUI.RemoteObjectPreviewFormatter.RemoteObjectPreviewFormatter();\n\nfunction renderResult(result: SDK.RuntimeModel.EvaluationResult|null, isEditing: boolean): LitTemplate {\n  if (!result) {\n    return nothing;\n  }\n\n  if (result && SDK.RuntimeModel.RuntimeModel.isSideEffectFailure(result)) {\n    return html`<span class='object-value-calculate-value-button' title=${\n        i18nString(UIStrings.evaluateAllowingSideEffects)}>(â€¦)</span>`;\n  }\n\n  const renderedPreview = FORMATTER.renderEvaluationResultPreview(result, !isEditing);\n  if (renderedPreview === nothing && !isEditing) {\n    return html`${i18nString(UIStrings.notAvailable)}`;\n  }\n  return renderedPreview;\n}\n\nexport class ConsolePinPresenter extends UI.Widget.Widget {\n  #pin?: ConsolePin;\n  #focusOut?: () => void;\n  #onRemove?: () => void;\n\n  readonly #view: typeof DEFAULT_VIEW;\n  readonly #pinEditor: ConsolePinEditor;\n  #editor?: TextEditor.TextEditor.TextEditor;\n  #hovered = false;\n  #lastNode: SDK.RemoteObject.RemoteObject|null = null;\n  #deletePinIcon!: Buttons.Button.Button;\n\n  constructor(element?: HTMLElement, view = DEFAULT_VIEW) {\n    super(element);\n    this.#view = view;\n\n    this.#pinEditor = {\n      workingCopy: () => this.#editor?.state.doc.toString() ?? '',\n      workingCopyWithHint: () => this.#editor ? TextEditor.Config.contentIncludingHint(this.#editor.editor) : '',\n      isEditing: () => Boolean(this.#editor?.editor.hasFocus),\n    };\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.#pin?.addEventListener(ConsolePinEvent.EVALUATE_RESULT_READY, this.requestUpdate, this);\n    this.requestUpdate();\n  }\n\n  override willHide(): void {\n    super.willHide();\n    this.#pin?.removeEventListener(ConsolePinEvent.EVALUATE_RESULT_READY, this.requestUpdate, this);\n    this.setHovered(false);\n  }\n\n  set pin(pin: ConsolePin) {\n    this.#pin?.removeEventListener(ConsolePinEvent.EVALUATE_RESULT_READY, this.requestUpdate, this);\n    this.#pin = pin;\n    this.#pin.setEditor(this.#pinEditor);\n    this.#pin.addEventListener(ConsolePinEvent.EVALUATE_RESULT_READY, this.requestUpdate, this);\n    this.requestUpdate();\n  }\n\n  get pin(): ConsolePin|undefined {\n    return this.#pin;\n  }\n\n  set focusOut(focusOut: () => void) {\n    this.#focusOut = focusOut;\n  }\n\n  set onRemove(onRemove: () => void) {\n    this.#onRemove = onRemove;\n  }\n\n  #createInitialEditorState(doc: string): CodeMirror.EditorState {\n    const extensions = [\n      CodeMirror.EditorView.contentAttributes.of({'aria-label': i18nString(UIStrings.liveExpressionEditor)}),\n      CodeMirror.EditorView.lineWrapping,\n      CodeMirror.javascript.javascriptLanguage,\n      TextEditor.Config.showCompletionHint,\n      CodeMirror.placeholder(i18nString(UIStrings.expression)),\n      CodeMirror.keymap.of([\n        {\n          key: 'Escape',\n          run: (view: CodeMirror.EditorView) => {\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.#pin?.expression ?? ''}});\n            this.#focusOut?.();\n            return true;\n          },\n        },\n        {\n          key: 'Enter',\n          run: () => {\n            this.#focusOut?.();\n            return true;\n          },\n        },\n        {\n          key: 'Mod-Enter',\n          run: () => {\n            this.#focusOut?.();\n            return true;\n          },\n        },\n        {\n          key: 'Tab',\n          run: (view: CodeMirror.EditorView) => {\n            if (CodeMirror.completionStatus(view.state) !== null) {\n              return false;\n            }\n            // User should be able to tab out of edit field after auto complete is done\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.#pin?.expression ?? ''}});\n            this.#focusOut?.();\n            return true;\n          },\n        },\n        {\n          key: 'Shift-Tab',\n          run: (view: CodeMirror.EditorView) => {\n            if (CodeMirror.completionStatus(view.state) !== null) {\n              return false;\n            }\n            // User should be able to tab out of edit field after auto complete is done\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.#pin?.expression ?? ''}});\n            this.#editor?.blur();\n            this.#deletePinIcon.focus();\n            return true;\n          },\n        },\n      ]),\n      CodeMirror.EditorView.domEventHandlers({blur: (_e, view) => this.#onBlur(view)}),\n      TextEditor.Config.baseConfiguration(doc),\n      TextEditor.Config.closeBrackets.instance(),\n      TextEditor.Config.autocompletion.instance(),\n    ];\n    if (Root.Runtime.Runtime.queryParam('noJavaScriptCompletion') !== 'true') {\n      extensions.push(TextEditor.JavaScript.completion());\n    }\n    return CodeMirror.EditorState.create({doc, extensions});\n  }\n\n  #onBlur(editor: CodeMirror.EditorView): void {\n    if (!this.#pin) {\n      return;\n    }\n    const commitedAsIs = this.#pin.commit();\n    editor.dispatch({\n      selection: {anchor: this.#pin.expression.length},\n      changes: !commitedAsIs ? {from: 0, to: editor.state.doc.length, insert: this.#pin.expression} : undefined,\n    });\n    this.requestUpdate();\n  }\n\n  setHovered(hovered: boolean): void {\n    if (this.#hovered === hovered) {\n      return;\n    }\n    this.#hovered = hovered;\n    if (!hovered && this.#lastNode) {\n      SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    }\n  }\n\n  override async focus(): Promise<void> {\n    const editor = this.#editor;\n    if (editor) {\n      editor.editor.focus();\n      editor.dispatch({selection: {anchor: editor.state.doc.length}});\n    }\n  }\n\n  appendToContextMenu(contextMenu: UI.ContextMenu.ContextMenu): void {\n    if (!this.#pin) {\n      return;\n    }\n    const {lastResult} = this.#pin;\n    if (lastResult && !('error' in lastResult) && lastResult.object) {\n      contextMenu.appendApplicableItems(lastResult.object);\n      // Prevent result from being released automatically, since it may be used by\n      // the context menu action. It will be released when the console is cleared,\n      // where we release the 'live-expression' object group.\n      this.#pin.skipReleaseLastResult();\n    }\n  }\n\n  override performUpdate(): void {\n    if (!this.#pin) {\n      return;\n    }\n\n    const output: ViewOutput = {};\n    this.#view(\n        {\n          expression: this.#pin.expression,\n          editorState: this.#editor?.state ?? this.#createInitialEditorState(this.#pin.expression),\n          result: this.#pin.lastResult,\n          isEditing: this.#pinEditor.isEditing(),\n          onDelete: () => this.#onRemove?.(),\n          onPreviewHoverChange: hovered => this.setHovered(hovered),\n          onPreviewClick: event => {\n            if (this.#lastNode) {\n              void Common.Revealer.reveal(this.#lastNode);\n              event.consume();\n            }\n          },\n        },\n        output, this.contentElement);\n\n    const {deletePinIcon, editor} = output;\n    if (!deletePinIcon || !editor) {\n      throw new Error('Broken view function, expected output');\n    }\n    this.#deletePinIcon = deletePinIcon;\n    this.#editor = editor;\n\n    const node = this.#pin.lastNode;\n    if (this.#hovered) {\n      if (node) {\n        SDK.OverlayModel.OverlayModel.highlightObjectAsDOMNode(node);\n      } else if (this.#lastNode) {\n        SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n      }\n    }\n    this.#lastNode = node || null;\n  }\n}\n\nexport class ConsolePinModel {\n  readonly #setting: Common.Settings.Setting<string[]>;\n  readonly #pins = new Set<ConsolePin>();\n\n  readonly #throttler = new Common.Throttler.Throttler(250);\n  #active = false;\n\n  constructor(settings: Common.Settings.Settings) {\n    this.#setting = settings.createLocalSetting('console-pins', []);\n    for (const expression of this.#setting.get()) {\n      this.add(expression);\n    }\n  }\n\n  get pins(): ReadonlySet<ConsolePin> {\n    return this.#pins;\n  }\n\n  add(expression: string): ConsolePin {\n    const pin = new ConsolePin(expression, () => this.#save());\n    this.#pins.add(pin);\n    this.#save();\n    return pin;\n  }\n\n  remove(pin: ConsolePin): void {\n    this.#pins.delete(pin);\n    this.#save();\n  }\n\n  removeAll(): void {\n    this.#pins.clear();\n    this.#save();\n  }\n\n  startPeriodicEvaluate(): void {\n    this.#active = true;\n    void this.#evaluateAllPins();\n  }\n\n  stopPeriodicEvaluate(): void {\n    this.#active = false;\n  }\n\n  async #evaluateAllPins(): Promise<void> {\n    if (!this.#active) {\n      return;\n    }\n\n    const executionContext = UI.Context.Context.instance().flavor(SDK.RuntimeModel.ExecutionContext);\n    if (executionContext) {\n      await Promise.all(this.#pins.values().map(pin => pin.evaluate(executionContext)));\n    }\n    void this.#throttler.schedule(this.#evaluateAllPins.bind(this));\n  }\n\n  #save(): void {\n    const expressions = this.#pins.values().map(pin => pin.expression).toArray();\n    this.#setting.set(expressions);\n  }\n}\n\n/**\n * Small helper interface to allow `ConsolePin` to retrieve the current working copy.\n */\ninterface ConsolePinEditor {\n  workingCopy(): string;\n  workingCopyWithHint(): string;\n  isEditing(): boolean;\n}\n\n/**\n * A pinned console expression.\n */\nexport class ConsolePin extends Common.ObjectWrapper.ObjectWrapper<ConsolePinEvents> {\n  #expression: string;\n  readonly #onCommit: () => void;\n\n  #editor?: ConsolePinEditor;\n\n  // We track the last evaluation result for this pin so we can release the RemoteObject.\n  #lastResult: SDK.RuntimeModel.EvaluationResult|null = null;\n  #lastNode: SDK.RemoteObject.RemoteObject|null = null;\n  #lastExecutionContext: SDK.RuntimeModel.ExecutionContext|null = null;\n  #releaseLastResult = true;\n\n  constructor(expression: string, onCommit: () => void) {\n    super();\n    this.#expression = expression;\n    this.#onCommit = onCommit;\n  }\n\n  get expression(): string {\n    return this.#expression;\n  }\n\n  get lastResult(): SDK.RuntimeModel.EvaluationResult|null {\n    return this.#lastResult;\n  }\n\n  /** A short cut in case `lastResult` is a DOM node */\n  get lastNode(): SDK.RemoteObject.RemoteObject|null {\n    return this.#lastNode;\n  }\n\n  skipReleaseLastResult(): void {\n    this.#releaseLastResult = false;\n  }\n\n  setEditor(editor: ConsolePinEditor): void {\n    this.#editor = editor;\n  }\n\n  /**\n   * Commit the current working copy from the editor.\n   * @returns true, iff the working copy was commited as-is.\n   */\n  commit(): boolean {\n    if (!this.#editor) {\n      return false;\n    }\n    const text = this.#editor.workingCopy();\n    const trimmedText = text.trim();\n    this.#expression = trimmedText;\n    this.#onCommit();\n    return this.#expression === text;\n  }\n\n  /** Evaluates the current working copy of the pinned expression. If the result is a DOM node, we return that separately for convenience.  */\n  async evaluate(executionContext: SDK.RuntimeModel.ExecutionContext): Promise<void> {\n    const editorText = this.#editor?.workingCopyWithHint() ?? '';\n    const throwOnSideEffect = Boolean(this.#editor?.isEditing()) && editorText !== this.#expression;\n    const timeout = throwOnSideEffect ? 250 : undefined;\n\n    const result = await ObjectUI.JavaScriptREPL.JavaScriptREPL.evaluate(\n        editorText, executionContext, throwOnSideEffect, /* replMode*/ true, timeout, 'live-expression',\n        /* awaitPromise */ true, /* silent */ true);\n\n    if (this.#lastResult && this.#releaseLastResult) {\n      this.#lastExecutionContext?.runtimeModel.releaseEvaluationResult(this.#lastResult);\n    }\n\n    this.#lastResult = result;\n    this.#lastExecutionContext = executionContext;\n    this.#releaseLastResult = true;\n\n    if (result && !('error' in result) && result.object.type === 'object' && result.object.subtype === 'node') {\n      this.#lastNode = result.object;\n    } else {\n      this.#lastNode = null;\n    }\n\n    this.dispatchEventToListeners(ConsolePinEvent.EVALUATE_RESULT_READY, this);\n  }\n}\n\nexport const enum ConsolePinEvent {\n  EVALUATE_RESULT_READY = 'EVALUATE_RESULT_READY',\n}\n\nexport interface ConsolePinEvents {\n  [ConsolePinEvent.EVALUATE_RESULT_READY]: ConsolePin;\n}\n"]}