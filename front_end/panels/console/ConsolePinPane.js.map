{"version":3,"file":"ConsolePinPane.js","sourceRoot":"","sources":["../../../../../../front_end/panels/console/ConsolePinPane.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2018 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as CodeMirror from '../../third_party/codemirror.next/codemirror.next.js';\nimport * as Buttons from '../../ui/components/buttons/buttons.js';\nimport * as TextEditor from '../../ui/components/text_editor/text_editor.js';\nimport * as ObjectUI from '../../ui/legacy/components/object_ui/object_ui.js';\n// eslint-disable-next-line @devtools/es-modules-import\nimport objectValueStyles from '../../ui/legacy/components/object_ui/objectValue.css.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport consolePinPaneStyles from './consolePinPane.css.js';\n\nconst UIStrings = {\n  /**\n   * @description A context menu item in the Console Pin Pane of the Console panel\n   */\n  removeExpression: 'Remove expression',\n  /**\n   * @description A context menu item in the Console Pin Pane of the Console panel\n   */\n  removeAllExpressions: 'Remove all expressions',\n  /**\n   * @description Screen reader label for delete button on a non-blank live expression\n   * @example {document} PH1\n   */\n  removeExpressionS: 'Remove expression: {PH1}',\n  /**\n   * @description Screen reader label for delete button on a blank live expression\n   */\n  removeBlankExpression: 'Remove blank expression',\n  /**\n   * @description Text in Console Pin Pane of the Console panel\n   */\n  liveExpressionEditor: 'Live expression editor',\n  /**\n   * @description Text in Console Pin Pane of the Console panel\n   */\n  expression: 'Expression',\n  /**\n   * @description Side effect label title in Console Pin Pane of the Console panel\n   */\n  evaluateAllowingSideEffects: 'Evaluate, allowing side effects',\n  /**\n   * @description Text of a DOM element in Console Pin Pane of the Console panel\n   */\n  notAvailable: 'not available',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/console/ConsolePinPane.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst elementToConsolePin = new WeakMap<Element, ConsolePinPresenter>();\n\nexport class ConsolePinPane extends UI.Widget.VBox {\n  private pins: Set<ConsolePinPresenter>;\n  private readonly pinsSetting: Common.Settings.Setting<string[]>;\n  private readonly throttler: Common.Throttler.Throttler;\n  constructor(private readonly liveExpressionButton: UI.Toolbar.ToolbarButton, private readonly focusOut: () => void) {\n    super({useShadowDom: true});\n    this.throttler = new Common.Throttler.Throttler(250);\n    this.registerRequiredCSS(consolePinPaneStyles, objectValueStyles);\n    this.contentElement.classList.add('console-pins', 'monospace');\n    this.contentElement.addEventListener('contextmenu', this.contextMenuEventFired.bind(this), false);\n    this.contentElement.setAttribute('jslog', `${VisualLogging.pane('console-pins')}`);\n\n    this.pins = new Set();\n    this.pinsSetting = Common.Settings.Settings.instance().createLocalSetting('console-pins', []);\n    for (const expression of this.pinsSetting.get()) {\n      this.addPin(expression);\n    }\n  }\n\n  override willHide(): void {\n    super.willHide();\n    for (const pin of this.pins) {\n      pin.setHovered(false);\n    }\n  }\n\n  savePins(): void {\n    const toSave = Array.from(this.pins).map(pin => pin.expression());\n    this.pinsSetting.set(toSave);\n  }\n\n  private contextMenuEventFired(event: Event): void {\n    const contextMenu = new UI.ContextMenu.ContextMenu(event);\n    const target = UI.UIUtils.deepElementFromEvent(event);\n    if (target) {\n      const targetPinElement = target.enclosingNodeOrSelfWithClass('console-pin');\n      if (targetPinElement) {\n        const targetPin = elementToConsolePin.get(targetPinElement);\n        if (targetPin) {\n          contextMenu.editSection().appendItem(\n              i18nString(UIStrings.removeExpression), this.removePin.bind(this, targetPin),\n              {jslogContext: 'remove-expression'});\n          targetPin.appendToContextMenu(contextMenu);\n        }\n      }\n    }\n    contextMenu.editSection().appendItem(\n        i18nString(UIStrings.removeAllExpressions), this.removeAllPins.bind(this),\n        {jslogContext: 'remove-all-expressions'});\n    void contextMenu.show();\n  }\n\n  private removeAllPins(): void {\n    for (const pin of this.pins) {\n      this.removePin(pin);\n    }\n  }\n\n  removePin(pin: ConsolePinPresenter): void {\n    pin.element().remove();\n    const newFocusedPin = this.focusedPinAfterDeletion(pin);\n    this.pins.delete(pin);\n    this.savePins();\n    if (newFocusedPin) {\n      void newFocusedPin.focus();\n    } else {\n      this.liveExpressionButton.focus();\n    }\n  }\n\n  addPin(expression: string, userGesture?: boolean): void {\n    const pin = new ConsolePinPresenter(expression, this, this.focusOut);\n    this.contentElement.appendChild(pin.element());\n    this.pins.add(pin);\n    this.savePins();\n    if (userGesture) {\n      void pin.focus();\n    }\n    this.requestUpdate();\n  }\n\n  private focusedPinAfterDeletion(deletedPin: ConsolePinPresenter): ConsolePinPresenter|null {\n    const pinArray = Array.from(this.pins);\n    for (let i = 0; i < pinArray.length; i++) {\n      if (pinArray[i] === deletedPin) {\n        if (pinArray.length === 1) {\n          return null;\n        }\n        if (i === pinArray.length - 1) {\n          return pinArray[i - 1];\n        }\n        return pinArray[i + 1];\n      }\n    }\n    return null;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    void this.throttler.schedule(this.requestUpdate.bind(this));\n  }\n\n  override async performUpdate(): Promise<void> {\n    if (!this.pins.size || !this.isShowing()) {\n      return;\n    }\n    const updatePromises = Array.from(this.pins, pin => pin.updatePreview());\n    await Promise.all(updatePromises);\n    this.updatedForTest();\n    void this.throttler.schedule(this.requestUpdate.bind(this));\n  }\n\n  private updatedForTest(): void {\n  }\n}\n\nexport class ConsolePinPresenter {\n  private readonly pin: ConsolePin;\n  private readonly pinEditor: ConsolePinEditor;\n  private readonly pinElement: Element;\n  private readonly pinPreview: HTMLElement;\n  private editor: TextEditor.TextEditor.TextEditor;\n  private hovered: boolean;\n  private lastNode: SDK.RemoteObject.RemoteObject|null;\n  private deletePinIcon: Buttons.Button.Button;\n\n  constructor(expression: string, private readonly pinPane: ConsolePinPane, private readonly focusOut: () => void) {\n    this.deletePinIcon = new Buttons.Button.Button();\n    this.deletePinIcon\n        .data = {variant: Buttons.Button.Variant.ICON, iconName: 'cross', size: Buttons.Button.Size.MICRO};\n    this.deletePinIcon.classList.add('close-button');\n    this.deletePinIcon.setAttribute('jslog', `${VisualLogging.close().track({click: true})}`);\n    this.deletePinIcon.tabIndex = 0;\n\n    if (expression.length) {\n      UI.ARIAUtils.setLabel(this.deletePinIcon, i18nString(UIStrings.removeExpressionS, {PH1: expression}));\n    } else {\n      UI.ARIAUtils.setLabel(this.deletePinIcon, i18nString(UIStrings.removeBlankExpression));\n    }\n    self.onInvokeElement(this.deletePinIcon, event => {\n      pinPane.removePin(this);\n      event.consume(true);\n    });\n\n    const fragment = UI.Fragment.Fragment.build`\n  <div class='console-pin'>\n  ${this.deletePinIcon}\n  <div class='console-pin-name' $='name' jslog=\"${VisualLogging.textField().track({\n      change: true,\n    })}\"></div>\n  <div class='console-pin-preview' $='preview'></div>\n  </div>`;\n    this.pinElement = fragment.element();\n    this.pinPreview = (fragment.$('preview') as HTMLElement);\n    const nameElement = (fragment.$('name') as HTMLElement);\n    UI.Tooltip.Tooltip.install(nameElement, expression);\n    elementToConsolePin.set(this.pinElement, this);\n\n    this.hovered = false;\n    this.lastNode = null;\n    this.editor = this.#createEditor(expression, nameElement);\n\n    this.pinEditor = {\n      workingCopy: () => this.editor.state.doc.toString(),\n      workingCopyWithHint: () => TextEditor.Config.contentIncludingHint(this.editor.editor),\n      isEditing: () => this.pinElement.hasFocus(),\n    };\n    this.pin = new ConsolePin(this.pinEditor, expression);\n\n    this.pinPreview.addEventListener('mouseenter', this.setHovered.bind(this, true), false);\n    this.pinPreview.addEventListener('mouseleave', this.setHovered.bind(this, false), false);\n    this.pinPreview.addEventListener('click', (event: Event) => {\n      if (this.lastNode) {\n        void Common.Revealer.reveal(this.lastNode);\n        event.consume();\n      }\n    }, false);\n\n    // Prevent Esc from toggling the drawer\n    nameElement.addEventListener('keydown', event => {\n      if (event.key === 'Escape') {\n        event.consume();\n      }\n    });\n  }\n\n  #createInitialEditorState(doc: string): CodeMirror.EditorState {\n    const extensions = [\n      CodeMirror.EditorView.contentAttributes.of({'aria-label': i18nString(UIStrings.liveExpressionEditor)}),\n      CodeMirror.EditorView.lineWrapping,\n      CodeMirror.javascript.javascriptLanguage,\n      TextEditor.Config.showCompletionHint,\n      CodeMirror.placeholder(i18nString(UIStrings.expression)),\n      CodeMirror.keymap.of([\n        {\n          key: 'Escape',\n          run: (view: CodeMirror.EditorView) => {\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.pin.expression}});\n            this.focusOut();\n            return true;\n          },\n        },\n        {\n          key: 'Enter',\n          run: () => {\n            this.focusOut();\n            return true;\n          },\n        },\n        {\n          key: 'Mod-Enter',\n          run: () => {\n            this.focusOut();\n            return true;\n          },\n        },\n        {\n          key: 'Tab',\n          run: (view: CodeMirror.EditorView) => {\n            if (CodeMirror.completionStatus(this.editor.state) !== null) {\n              return false;\n            }\n            // User should be able to tab out of edit field after auto complete is done\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.pin.expression}});\n            this.focusOut();\n            return true;\n          },\n        },\n        {\n          key: 'Shift-Tab',\n          run: (view: CodeMirror.EditorView) => {\n            if (CodeMirror.completionStatus(this.editor.state) !== null) {\n              return false;\n            }\n            // User should be able to tab out of edit field after auto complete is done\n            view.dispatch({changes: {from: 0, to: view.state.doc.length, insert: this.pin.expression}});\n            this.editor.blur();\n            this.deletePinIcon.focus();\n            return true;\n          },\n        },\n      ]),\n      CodeMirror.EditorView.domEventHandlers({blur: (_e, view) => this.#onBlur(view)}),\n      TextEditor.Config.baseConfiguration(doc),\n      TextEditor.Config.closeBrackets.instance(),\n      TextEditor.Config.autocompletion.instance(),\n    ];\n    if (Root.Runtime.Runtime.queryParam('noJavaScriptCompletion') !== 'true') {\n      extensions.push(TextEditor.JavaScript.completion());\n    }\n    return CodeMirror.EditorState.create({doc, extensions});\n  }\n\n  #createEditor(doc: string, parent: HTMLElement): TextEditor.TextEditor.TextEditor {\n    const editor = new TextEditor.TextEditor.TextEditor(this.#createInitialEditorState(doc));\n    parent.appendChild(editor);\n    return editor;\n  }\n\n  #onBlur(editor: CodeMirror.EditorView): void {\n    const commitedAsIs = this.pin.commit();\n    this.pinPane.savePins();\n    const newExpression = this.pin.expression;\n\n    if (newExpression.length) {\n      UI.ARIAUtils.setLabel(this.deletePinIcon, i18nString(UIStrings.removeExpressionS, {PH1: newExpression}));\n    } else {\n      UI.ARIAUtils.setLabel(this.deletePinIcon, i18nString(UIStrings.removeBlankExpression));\n    }\n    editor.dispatch({\n      selection: {anchor: this.pin.expression.length},\n      changes: !commitedAsIs ? {from: 0, to: this.editor.state.doc.length, insert: newExpression} : undefined,\n    });\n  }\n\n  setHovered(hovered: boolean): void {\n    if (this.hovered === hovered) {\n      return;\n    }\n    this.hovered = hovered;\n    if (!hovered && this.lastNode) {\n      SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    }\n  }\n\n  expression(): string {\n    return this.pin.expression;\n  }\n\n  element(): Element {\n    return this.pinElement;\n  }\n\n  async focus(): Promise<void> {\n    const editor = this.editor;\n    editor.editor.focus();\n    editor.dispatch({selection: {anchor: editor.state.doc.length}});\n  }\n\n  appendToContextMenu(contextMenu: UI.ContextMenu.ContextMenu): void {\n    const {lastResult} = this.pin;\n    if (lastResult && !('error' in lastResult) && lastResult.object) {\n      contextMenu.appendApplicableItems(lastResult.object);\n      // Prevent result from being released automatically, since it may be used by\n      // the context menu action. It will be released when the console is cleared,\n      // where we release the 'live-expression' object group.\n      this.pin.skipReleaseLastResult();\n    }\n  }\n\n  async updatePreview(): Promise<void> {\n    if (!this.editor) {\n      return;\n    }\n    const executionContext = UI.Context.Context.instance().flavor(SDK.RuntimeModel.ExecutionContext);\n    if (!executionContext) {\n      return;\n    }\n\n    const {result, node} = await this.pin.evaluate(executionContext);\n\n    const formatter = new ObjectUI.RemoteObjectPreviewFormatter.RemoteObjectPreviewFormatter();\n    const preview = result ? formatter.renderEvaluationResultPreview(result) : document.createDocumentFragment();\n\n    const previewText = preview.deepTextContent();\n    if (!previewText || previewText !== this.pinPreview.deepTextContent()) {\n      this.pinPreview.removeChildren();\n      if (result && SDK.RuntimeModel.RuntimeModel.isSideEffectFailure(result)) {\n        const sideEffectLabel = this.pinPreview.createChild('span', 'object-value-calculate-value-button');\n        sideEffectLabel.textContent = '(â€¦)';\n        UI.Tooltip.Tooltip.install(sideEffectLabel, i18nString(UIStrings.evaluateAllowingSideEffects));\n      } else if (previewText) {\n        this.pinPreview.appendChild(preview);\n      } else if (!this.pinEditor.isEditing()) {\n        UI.UIUtils.createTextChild(this.pinPreview, i18nString(UIStrings.notAvailable));\n      }\n      UI.Tooltip.Tooltip.install(this.pinPreview, previewText);\n    }\n\n    if (this.hovered) {\n      if (node) {\n        SDK.OverlayModel.OverlayModel.highlightObjectAsDOMNode(node);\n      } else if (this.lastNode) {\n        SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n      }\n    }\n    this.lastNode = node || null;\n\n    const isError = result && !('error' in result) && result.exceptionDetails &&\n        !SDK.RuntimeModel.RuntimeModel.isSideEffectFailure(result);\n    this.pinElement.classList.toggle('error-level', Boolean(isError));\n  }\n}\n\n/**\n * Small helper interface to allow `ConsolePin` to retrieve the current working copy.\n */\ninterface ConsolePinEditor {\n  workingCopy(): string;\n  workingCopyWithHint(): string;\n  isEditing(): boolean;\n}\n\n/**\n * A pinned console expression.\n */\nexport class ConsolePin {\n  readonly #editor: ConsolePinEditor;\n  #expression: string;\n\n  // We track the last evaluation result for this pin so we can release the RemoteObject.\n  #lastResult: SDK.RuntimeModel.EvaluationResult|null = null;\n  #lastExecutionContext: SDK.RuntimeModel.ExecutionContext|null = null;\n  #releaseLastResult = true;\n\n  constructor(editor: ConsolePinEditor, expression: string) {\n    this.#editor = editor;\n    this.#expression = expression;\n  }\n\n  get expression(): string {\n    return this.#expression;\n  }\n\n  get lastResult(): SDK.RuntimeModel.EvaluationResult|null {\n    return this.#lastResult;\n  }\n\n  skipReleaseLastResult(): void {\n    this.#releaseLastResult = false;\n  }\n\n  /**\n   * Commit the current working copy from the editor.\n   * @returns true, iff the working copy was commited as-is.\n   */\n  commit(): boolean {\n    const text = this.#editor.workingCopy();\n    const trimmedText = text.trim();\n    this.#expression = trimmedText;\n    return this.#expression === text;\n  }\n\n  /** Evaluates the current working copy of the pinned expression. If the result is a DOM node, we return that separately for convenience.  */\n  async evaluate(executionContext: SDK.RuntimeModel.ExecutionContext):\n      Promise<{result: SDK.RuntimeModel.EvaluationResult | null, node: SDK.RemoteObject.RemoteObject|null}> {\n    const editorText = this.#editor.workingCopyWithHint();\n    const throwOnSideEffect = this.#editor.isEditing() && editorText !== this.#expression;\n    const timeout = throwOnSideEffect ? 250 : undefined;\n\n    const result = await ObjectUI.JavaScriptREPL.JavaScriptREPL.evaluate(\n        editorText, executionContext, throwOnSideEffect, /* replMode*/ true, timeout, 'live-expression',\n        /* awaitPromise */ true, /* silent */ true);\n\n    if (this.#lastResult && this.#releaseLastResult) {\n      this.#lastExecutionContext?.runtimeModel.releaseEvaluationResult(this.#lastResult);\n    }\n\n    this.#lastResult = result;\n    this.#lastExecutionContext = executionContext;\n    this.#releaseLastResult = true;\n\n    if (result && !('error' in result) && result.object.type === 'object' && result.object.subtype === 'node') {\n      return {result, node: result.object};\n    }\n    return {result, node: null};\n  }\n}\n"]}