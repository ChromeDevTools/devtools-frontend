{"version":3,"file":"StylePropertyEditor.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/StylePropertyEditor.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-lit-render-outside-of-view */\n\nimport '../../../ui/components/icon_button/icon_button.js';\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport {findFlexContainerIcon, findGridContainerIcon, type IconInfo} from './CSSPropertyIconResolver.js';\nimport stylePropertyEditorStyles from './stylePropertyEditor.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Title of the button that selects a flex property.\n   * @example {flex-direction} propertyName\n   * @example {column} propertyValue\n   */\n  selectButton: 'Add {propertyName}: {propertyValue}',\n  /**\n   * @description Title of the button that deselects a flex property.\n   * @example {flex-direction} propertyName\n   * @example {row} propertyValue\n   */\n  deselectButton: 'Remove {propertyName}: {propertyValue}',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/StylePropertyEditor.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst {render, html, Directives} = Lit;\n\ndeclare global {\n  interface HTMLElementEventMap {\n    propertyselected: PropertySelectedEvent;\n    propertydeselected: PropertyDeselectedEvent;\n  }\n}\n\ninterface FlexEditorData {\n  authoredProperties: Map<string, string>;\n  computedProperties: Map<string, string>;\n}\n\ninterface EditableProperty {\n  propertyName: string;\n  propertyValues: string[];\n}\n\nexport class PropertySelectedEvent extends Event {\n  static readonly eventName = 'propertyselected';\n  data: {name: string, value: string};\n\n  constructor(name: string, value: string) {\n    super(PropertySelectedEvent.eventName, {});\n    this.data = {name, value};\n  }\n}\n\nexport class PropertyDeselectedEvent extends Event {\n  static readonly eventName = 'propertydeselected';\n  data: {name: string, value: string};\n\n  constructor(name: string, value: string) {\n    super(PropertyDeselectedEvent.eventName, {});\n    this.data = {name, value};\n  }\n}\n\nexport class StylePropertyEditor extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #authoredProperties = new Map<string, string>();\n  #computedProperties = new Map<string, string>();\n  protected readonly editableProperties: EditableProperty[] = [];\n\n  getEditableProperties(): EditableProperty[] {\n    return this.editableProperties;\n  }\n\n  set data(data: FlexEditorData) {\n    this.#authoredProperties = data.authoredProperties;\n    this.#computedProperties = data.computedProperties;\n    this.#render();\n  }\n\n  #render(): void {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <style>${stylePropertyEditorStyles}</style>\n      <div class=\"container\">\n        ${this.editableProperties.map(prop => this.#renderProperty(prop))}\n      </div>\n    `, this.#shadow, {\n      host: this,\n    });\n    // clang-format on\n  }\n\n  #renderProperty(prop: EditableProperty): Lit.TemplateResult {\n    const authoredValue = this.#authoredProperties.get(prop.propertyName);\n    const notAuthored = !authoredValue;\n    const shownValue = authoredValue || this.#computedProperties.get(prop.propertyName);\n    const classes = Directives.classMap({\n      'property-value': true,\n      'not-authored': notAuthored,\n    });\n    return html`<div class=\"row\">\n      <div class=\"property\">\n        <span class=\"property-name\">${prop.propertyName}</span>: <span class=${classes}>${shownValue}</span>\n      </div>\n      <div class=\"buttons\">\n        ${prop.propertyValues.map(value => this.#renderButton(value, prop.propertyName, value === authoredValue))}\n      </div>\n    </div>`;\n  }\n\n  #renderButton(propertyValue: string, propertyName: string, selected = false): Lit.TemplateResult {\n    const query = `${propertyName}: ${propertyValue}`;\n    const iconInfo = this.findIcon(query, this.#computedProperties);\n    if (!iconInfo) {\n      throw new Error(`Icon for ${query} is not found`);\n    }\n    const transform = `transform: rotate(${iconInfo.rotate}deg) scale(${iconInfo.scaleX}, ${iconInfo.scaleY})`;\n    const classes = Directives.classMap({\n      button: true,\n      selected,\n    });\n    const values = {propertyName, propertyValue};\n    const title = selected ? i18nString(UIStrings.deselectButton, values) : i18nString(UIStrings.selectButton, values);\n    return html`\n      <button title=${title}\n              class=${classes}\n              jslog=${VisualLogging.item().track({click: true}).context(`${propertyName}-${propertyValue}`)}\n              @click=${() => this.#onButtonClick(propertyName, propertyValue, selected)}>\n        <devtools-icon style=${transform} name=${iconInfo.iconName}>\n        </devtools-icon>\n      </button>\n    `;\n  }\n\n  #onButtonClick(propertyName: string, propertyValue: string, selected: boolean): void {\n    if (selected) {\n      this.dispatchEvent(new PropertyDeselectedEvent(propertyName, propertyValue));\n    } else {\n      this.dispatchEvent(new PropertySelectedEvent(propertyName, propertyValue));\n    }\n  }\n\n  protected findIcon(_query: string, _computedProperties: Map<string, string>): IconInfo|null {\n    throw new Error('Not implemented');\n  }\n}\n\nexport class FlexboxEditor extends StylePropertyEditor {\n  readonly jslogContext = 'cssFlexboxEditor';\n  protected override readonly editableProperties: EditableProperty[] = FlexboxEditableProperties;\n\n  protected override findIcon(query: string, computedProperties: Map<string, string>): IconInfo|null {\n    return findFlexContainerIcon(query, computedProperties);\n  }\n}\n\ncustomElements.define('devtools-flexbox-editor', FlexboxEditor);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-flexbox-editor': FlexboxEditor;\n  }\n}\n\nexport class GridEditor extends StylePropertyEditor {\n  readonly jslogContext = 'cssGridEditor';\n  protected override readonly editableProperties: EditableProperty[] = GridEditableProperties;\n\n  protected override findIcon(query: string, computedProperties: Map<string, string>): IconInfo|null {\n    return findGridContainerIcon(query, computedProperties);\n  }\n}\n\ncustomElements.define('devtools-grid-editor', GridEditor);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-grid-editor': GridEditor;\n  }\n}\n\nexport class MasonryEditor extends StylePropertyEditor {\n  readonly jslogContext = 'cssMasonryEditor';\n  protected override readonly editableProperties: EditableProperty[] = MasonryEditableProperties;\n\n  protected override findIcon(query: string, computedProperties: Map<string, string>): IconInfo|null {\n    return findGridContainerIcon(query, computedProperties);\n  }\n}\n\ncustomElements.define('devtools-masonry-editor', MasonryEditor);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-masonry-editor': MasonryEditor;\n  }\n}\n\nexport const FlexboxEditableProperties = [\n  {\n    propertyName: 'flex-direction',\n    propertyValues: [\n      'row',\n      'column',\n      'row-reverse',\n      'column-reverse',\n    ],\n  },\n  {\n    propertyName: 'flex-wrap',\n    propertyValues: [\n      'nowrap',\n      'wrap',\n    ],\n  },\n  {\n    propertyName: 'align-content',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'space-around',\n      'space-between',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-content',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n    ],\n  },\n  {\n    propertyName: 'align-items',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'stretch',\n      'baseline',\n    ],\n  },\n];\n\nexport const GridEditableProperties = [\n  {\n    propertyName: 'align-content',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-content',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'align-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n      'baseline',\n    ],\n  },\n  {\n    propertyName: 'justify-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n    ],\n  },\n];\n\nexport const MasonryEditableProperties = [\n  {\n    propertyName: 'align-content',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-content',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'align-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n    ],\n  },\n];\n"]}