{"version":3,"file":"DeviceSizeInputElement.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/emulation/components/DeviceSizeInputElement.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-lit-render-outside-of-view */\n\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as EmulationModel from '../../../models/emulation/emulation.js';\nimport * as UILegacy from '../../../ui/legacy/legacy.js';\nimport {html, render} from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nclass SizeChangedEvent extends Event {\n  static readonly eventName = 'sizechanged';\n  constructor(public size: number) {\n    super(SizeChangedEvent.eventName);\n  }\n}\n\nfunction getInputValue(event: Event): number {\n  return Number((event.target as HTMLInputElement).value);\n}\n\nexport class SizeInputElement extends HTMLElement {\n  #root = this.attachShadow({mode: 'open'});\n  #disabled = false;\n  #size = '0';\n  #placeholder = '';\n  #title: Platform.UIString.LocalizedString;\n  #jslogContext: string;\n\n  constructor(title: Platform.UIString.LocalizedString, {jslogContext}: {jslogContext: string}) {\n    super();\n    this.#title = title;\n    this.#jslogContext = jslogContext;\n  }\n\n  connectedCallback(): void {\n    this.render();\n  }\n\n  set disabled(disabled: boolean) {\n    this.#disabled = disabled;\n    this.render();\n  }\n\n  set size(size: string) {\n    this.#size = size;\n    this.render();\n  }\n\n  set placeholder(placeholder: string) {\n    this.#placeholder = placeholder;\n    this.render();\n  }\n\n  render(): void {\n    render(\n        // Since the emulation code runs in a different frame, we can't\n        // use constructed stylesheets (they are disallowed cross-frame).\n        // For now, use an inline style tag and later we can refactor this\n        // to use proper constructed stylesheets, when the code runs\n        // in the correct frame context.\n        html`\n      <style>\n        input {\n          /*\n           * 4 characters for the maximum size of the value,\n           * 2 characters for the width of the step-buttons,\n           * 2 pixels padding between the characters and the\n           * step-buttons.\n           */\n          width: calc(4ch + 2ch + 2px);\n          max-height: 18px;\n          border: var(--sys-color-neutral-outline);\n          border-radius: 4px;\n          margin: 0 2px;\n          text-align: center;\n          font-size: inherit;\n          font-family: inherit;\n        }\n\n        input:disabled {\n          user-select: none;\n        }\n\n        input:focus::-webkit-input-placeholder {\n          color: transparent;\n        }\n      </style>\n      <input type=\"number\"\n             max=${EmulationModel.DeviceModeModel.MaxDeviceSize}\n             min=${EmulationModel.DeviceModeModel.MinDeviceSize}\n             jslog=${VisualLogging.textField().track({change: true}).context(this.#jslogContext)}\n             maxlength=\"4\"\n             title=${this.#title}\n             placeholder=${this.#placeholder}\n             ?disabled=${this.#disabled}\n             .value=${this.#size}\n             @change=${this.#fireSizeChange}\n             @keydown=${this.#handleModifierKeys} />\n    `,\n        this.#root, {host: this});\n  }\n\n  #fireSizeChange(event: Event): void {\n    this.dispatchEvent(new SizeChangedEvent(getInputValue(event)));\n  }\n\n  #handleModifierKeys(event: Event): void {\n    let modifiedValue = UILegacy.UIUtils.modifiedFloatNumber(getInputValue(event), event);\n    if (modifiedValue === null) {\n      return;\n    }\n\n    modifiedValue = Math.min(modifiedValue, EmulationModel.DeviceModeModel.MaxDeviceSize);\n    modifiedValue = Math.max(modifiedValue, EmulationModel.DeviceModeModel.MinDeviceSize);\n\n    event.preventDefault();\n    (event.target as HTMLInputElement).value = String(modifiedValue);\n    this.dispatchEvent(new SizeChangedEvent(modifiedValue));\n  }\n}\n\n// eslint-disable-next-line @devtools/enforce-custom-element-prefix\ncustomElements.define('device-mode-emulation-size-input', SizeInputElement);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'device-mode-emulation-size-input': SizeInputElement;\n  }\n  interface HTMLElementEventMap {\n    sizechanged: SizeChangedEvent;\n  }\n}\n"]}