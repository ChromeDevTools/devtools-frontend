{"version":3,"file":"AffectedResourcesView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/issues/AffectedResourcesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport type * as IssuesManager from '../../models/issues_manager/issues_manager.js';\nimport * as Logs from '../../models/logs/logs.js';\nimport type * as NetworkForward from '../../panels/network/forward/forward.js';\nimport * as RequestLinkIcon from '../../ui/components/request_link_icon/request_link_icon.js';\nimport {Icon} from '../../ui/kit/kit.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\nimport * as PanelsCommon from '../common/common.js';\n\nimport type {IssueView} from './IssueView.js';\n\nconst UIStrings = {\n  /**\n   * @description Text in Object Properties Section\n   */\n  unknown: 'unknown',\n  /**\n   * @description Tooltip for button linking to the Elements panel\n   */\n  clickToRevealTheFramesDomNodeIn: 'Click to reveal the frame\\'s DOM node in the Elements panel',\n  /**\n   * @description Replacement text for a link to an HTML element which is not available (anymore).\n   */\n  unavailable: 'unavailable',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/issues/AffectedResourcesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport const enum AffectedItem {\n  COOKIE = 'Cookie',\n  DIRECTIVE = 'Directive',\n  ELEMENT = 'Element',\n  REQUEST = 'Request',\n  SOURCE = 'Source',\n}\n\nexport const extractShortPath = (path: Platform.DevToolsPath.UrlString): string => {\n  // 1st regex matches everything after last '/'\n  // if path ends with '/', 2nd regex returns everything between the last two '/'\n  return (/[^/]+$/.exec(path) || /[^/]+\\/$/.exec(path) || [''])[0];\n};\n\nexport interface CreateRequestCellOptions {\n  linkToPreflight?: boolean;\n  highlightHeader?: {section: NetworkForward.UIRequestLocation.UIHeaderSection, name: string};\n  networkTab?: NetworkForward.UIRequestLocation.UIRequestTabs;\n  additionalOnClickAction?: () => void;\n}\n\n/**\n * The base class for all affected resource views. It provides basic scaffolding\n * as well as machinery for resolving request and frame ids to SDK objects.\n */\nexport abstract class AffectedResourcesView extends UI.TreeOutline.TreeElement {\n  readonly #parentView: IssueView;\n  protected issue: IssuesManager.IssueAggregator.AggregatedIssue;\n  protected affectedResourcesCountElement: HTMLElement;\n  protected affectedResources: HTMLElement;\n  #affectedResourcesCount: number;\n  #frameListeners: Common.EventTarget.EventDescriptor[];\n  #unresolvedFrameIds: Set<string>;\n  protected requestResolver: Logs.RequestResolver.RequestResolver;\n\n  constructor(parent: IssueView, issue: IssuesManager.IssueAggregator.AggregatedIssue, jslogContext: string) {\n    super(/* title */ undefined, /* expandable */ undefined, jslogContext);\n    this.#parentView = parent;\n    this.issue = issue;\n    this.toggleOnClick = true;\n    this.affectedResourcesCountElement = this.createAffectedResourcesCounter();\n\n    this.affectedResources = this.createAffectedResources();\n    this.#affectedResourcesCount = 0;\n    this.requestResolver = new Logs.RequestResolver.RequestResolver();\n    this.#frameListeners = [];\n    this.#unresolvedFrameIds = new Set();\n  }\n\n  /**\n   * Sets the issue to take the resources from. Does not\n   * trigger an update, the caller needs to do that explicitly.\n   */\n  setIssue(issue: IssuesManager.IssueAggregator.AggregatedIssue): void {\n    this.issue = issue;\n  }\n\n  createAffectedResourcesCounter(): HTMLElement {\n    const counterLabel = document.createElement('div');\n    counterLabel.classList.add('affected-resource-label');\n    this.listItemElement.appendChild(counterLabel);\n    return counterLabel;\n  }\n\n  createAffectedResources(): HTMLElement {\n    const body = new UI.TreeOutline.TreeElement();\n    const affectedResources = document.createElement('table');\n    affectedResources.classList.add('affected-resource-list');\n    body.listItemElement.appendChild(affectedResources);\n    this.appendChild(body);\n\n    return affectedResources;\n  }\n\n  protected abstract getResourceNameWithCount(count: number): string;\n\n  protected updateAffectedResourceCount(count: number): void {\n    this.#affectedResourcesCount = count;\n    this.affectedResourcesCountElement.textContent = this.getResourceNameWithCount(count);\n    this.hidden = this.#affectedResourcesCount === 0;\n    this.#parentView.updateAffectedResourceVisibility();\n  }\n\n  isEmpty(): boolean {\n    return this.#affectedResourcesCount === 0;\n  }\n\n  clear(): void {\n    this.affectedResources.textContent = '';\n    this.requestResolver.clear();\n  }\n\n  expandIfOneResource(): void {\n    if (this.#affectedResourcesCount === 1) {\n      this.expand();\n    }\n  }\n\n  /**\n   * This function resolves a frameId to a ResourceTreeFrame. If the frameId does not resolve, or hasn't navigated yet,\n   * a listener is installed that takes care of updating the view if the frame is added. This is useful if the issue is\n   * added before the frame gets reported.\n   */\n  #resolveFrameId(frameId: Protocol.Page.FrameId): SDK.ResourceTreeModel.ResourceTreeFrame|null {\n    const frame = SDK.FrameManager.FrameManager.instance().getFrame(frameId);\n    if (!frame?.url) {\n      this.#unresolvedFrameIds.add(frameId);\n      if (!this.#frameListeners.length) {\n        const addListener = SDK.FrameManager.FrameManager.instance().addEventListener(\n            SDK.FrameManager.Events.FRAME_ADDED_TO_TARGET, this.#onFrameChanged, this);\n        const navigateListener = SDK.FrameManager.FrameManager.instance().addEventListener(\n            SDK.FrameManager.Events.FRAME_NAVIGATED, this.#onFrameChanged, this);\n        this.#frameListeners = [addListener, navigateListener];\n      }\n    }\n    return frame;\n  }\n\n  #onFrameChanged(event: Common.EventTarget.EventTargetEvent<{frame: SDK.ResourceTreeModel.ResourceTreeFrame}>): void {\n    const frame = event.data.frame;\n    if (!frame.url) {\n      return;\n    }\n    const frameWasUnresolved = this.#unresolvedFrameIds.delete(frame.id);\n    if (this.#unresolvedFrameIds.size === 0 && this.#frameListeners.length) {\n      // Stop listening once all requests are resolved.\n      Common.EventTarget.removeEventListeners(this.#frameListeners);\n      this.#frameListeners = [];\n    }\n    if (frameWasUnresolved) {\n      this.update();\n    }\n  }\n\n  protected createFrameCell(frameId: Protocol.Page.FrameId, issueCategory: IssuesManager.Issue.IssueCategory):\n      HTMLElement {\n    const frame = this.#resolveFrameId(frameId);\n    const url = frame && (frame.unreachableUrl() || frame.url) || i18nString(UIStrings.unknown);\n\n    const frameCell = document.createElement('td');\n    frameCell.classList.add('affected-resource-cell');\n    if (frame) {\n      const icon = new Icon();\n      icon.name = 'code-circle';\n      icon.classList.add('link', 'elements-panel', 'medium');\n      icon.onclick = async () => {\n        Host.userMetrics.issuesPanelResourceOpened(issueCategory, AffectedItem.ELEMENT);\n        const frame = SDK.FrameManager.FrameManager.instance().getFrame(frameId);\n        if (frame) {\n          const ownerNode = await frame.getOwnerDOMNodeOrDocument();\n          if (ownerNode) {\n            void Common.Revealer.reveal(ownerNode);\n          }\n        }\n      };\n      icon.title = i18nString(UIStrings.clickToRevealTheFramesDomNodeIn);\n      frameCell.appendChild(icon);\n    }\n    frameCell.appendChild(document.createTextNode(url));\n    frameCell.onmouseenter = () => {\n      const frame = SDK.FrameManager.FrameManager.instance().getFrame(frameId);\n      if (frame) {\n        void frame.highlight();\n      }\n    };\n    frameCell.onmouseleave = () => SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    return frameCell;\n  }\n\n  protected createRequestCell(affectedRequest: Protocol.Audits.AffectedRequest, options: CreateRequestCellOptions = {}):\n      HTMLElement {\n    const requestCell = document.createElement('td');\n    requestCell.classList.add('affected-resource-cell');\n    const requestLinkIcon = new RequestLinkIcon.RequestLinkIcon.RequestLinkIcon();\n    requestLinkIcon.data = {...options, affectedRequest, requestResolver: this.requestResolver, displayURL: true};\n    requestCell.appendChild(requestLinkIcon);\n    return requestCell;\n  }\n\n  protected async createElementCell(\n      {backendNodeId, nodeName, target}: IssuesManager.Issue.AffectedElement,\n      issueCategory: IssuesManager.Issue.IssueCategory): Promise<Element> {\n    if (!target) {\n      const cellElement = document.createElement('td');\n      cellElement.textContent = nodeName || i18nString(UIStrings.unavailable);\n      return cellElement;\n    }\n\n    function sendTelemetry(): void {\n      Host.userMetrics.issuesPanelResourceOpened(issueCategory, AffectedItem.ELEMENT);\n    }\n\n    const deferredDOMNode = new SDK.DOMModel.DeferredDOMNode(target, backendNodeId);\n    const anchorElement = PanelsCommon.DOMLinkifier.Linkifier.instance().linkify(deferredDOMNode) as HTMLElement;\n    anchorElement.textContent = nodeName;\n    anchorElement.addEventListener('click', () => sendTelemetry());\n    anchorElement.addEventListener('keydown', (event: Event) => {\n      if ((event as KeyboardEvent).key === 'Enter') {\n        sendTelemetry();\n      }\n    });\n    const cellElement = document.createElement('td');\n    cellElement.classList.add('affected-resource-element', 'devtools-link');\n    cellElement.appendChild(anchorElement);\n    return cellElement;\n  }\n\n  protected appendSourceLocation(\n      element: HTMLElement,\n      sourceLocation: {url: string, lineNumber: number, scriptId?: Protocol.Runtime.ScriptId, columnNumber?: number}|\n      undefined,\n      target: SDK.Target.Target|null|undefined): void {\n    const sourceCodeLocation = document.createElement('td');\n    sourceCodeLocation.classList.add('affected-source-location');\n    if (sourceLocation) {\n      const maxLengthForDisplayedURLs = 40;  // Same as console messages.\n      const linkifier = new Components.Linkifier.Linkifier(maxLengthForDisplayedURLs);\n      const sourceAnchor = linkifier.linkifyScriptLocation(\n          target || null, sourceLocation.scriptId || null, sourceLocation.url as Platform.DevToolsPath.UrlString,\n          sourceLocation.lineNumber, {columnNumber: sourceLocation.columnNumber, inlineFrameIndex: 0});\n      sourceAnchor.setAttribute('jslog', `${VisualLogging.link('source-location').track({click: true})}`);\n      sourceCodeLocation.appendChild(sourceAnchor);\n    }\n    element.appendChild(sourceCodeLocation);\n  }\n\n  protected appendColumnTitle(header: HTMLElement, title: string, additionalClass: string|null = null): void {\n    const info = document.createElement('td');\n    info.classList.add('affected-resource-header');\n    if (additionalClass) {\n      info.classList.add(additionalClass);\n    }\n    info.textContent = title;\n    header.appendChild(info);\n  }\n\n  protected createIssueDetailCell(textContent: string|HTMLElement, additionalClass: string|null = null):\n      HTMLTableDataCellElement {\n    const cell = document.createElement('td');\n\n    if (typeof textContent === 'string') {\n      cell.textContent = textContent;\n    } else {\n      cell.appendChild(textContent);\n    }\n\n    if (additionalClass) {\n      cell.classList.add(additionalClass);\n    }\n    return cell;\n  }\n\n  protected appendIssueDetailCell(\n      element: HTMLElement, textContent: string|HTMLElement,\n      additionalClass: string|null = null): HTMLTableDataCellElement {\n    const cell = this.createIssueDetailCell(textContent, additionalClass);\n    element.appendChild(cell);\n    return cell;\n  }\n\n  abstract update(): void;\n}\n"]}