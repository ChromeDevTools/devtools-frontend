{"version":3,"file":"MainView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/media/MainView.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAC7B,oDAAoD;AAGpD,OAAO,KAAK,IAAI,MAAM,yBAAyB,CAAC;AAEhD,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAE7C,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAEhD,OAAO,EAAS,UAAU,EAAmB,MAAM,iBAAiB,CAAC;AACrE,OAAO,EAAC,gBAAgB,EAAC,MAAM,uBAAuB,CAAC;AACvD,OAAO,EAAC,cAAc,EAAC,MAAM,qBAAqB,CAAC;AAEnD,MAAM,SAAS,GAAG;IAChB;;;OAGG;IACH,uBAAuB,EAAE,0BAA0B;IACnD;;;OAGG;IACH,mBAAmB,EAAE,+CAA+C;IACpE;;;OAGG;IACH,aAAa,EAAE,iBAAiB;IAChC;;;OAGG;IACH,sBAAsB,EAAE,4DAA4D;CAC5E,CAAC;AACX,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,0BAA0B,EAAE,SAAS,CAAC,CAAC;AAChF,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAEtE,MAAM,4BAA4B,GAC9B,kEAAqG,CAAC;AAgB1G,MAAM,oBAAoB;IACP,UAAU,CAAsB;IAChC,QAAQ,CAAiC;IACzC,MAAM,CAAgB;IACtB,MAAM,CAA+B;IAEtD;QACE,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,EAAE,CAAC;QAC5B,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;IACnB,CAAC;IAED,UAAU,CAAC,QAAuC;QAChD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC;IACrD,CAAC;IAED,OAAO,CAAC,KAAiC;QACvC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1B,CAAC;IAED,SAAS,CAAC,OAAqC;QAC7C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC9B,CAAC;IAED,OAAO,CAAC,KAAkB;QACxB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1B,CAAC;IAED,MAAM;QAMJ,OAAO,EAAC,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAC,CAAC;IAC1G,CAAC;CACF;AAED,MAAM,OAAO,yBAAyB;IACnB,oBAAoB,CAAoC;IACzE;QACE,IAAI,CAAC,oBAAoB,GAAG,IAAI,GAAG,EAAE,CAAC;IACxC,CAAC;IAED,SAAS,CAAC,QAAgB;QACxB,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,oBAAoB,EAAE,CAAC,CAAC;IACtE,CAAC;IAED,UAAU,CAAC,QAAgB,EAAE,QAAuC;QAClE,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,EAAE,CAAC;YACpB,OAAO;QACT,CAAC;QAED,cAAc,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAED,OAAO,CAAC,QAAgB,EAAE,KAAiC;QACzD,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,EAAE,CAAC;YACpB,OAAO;QACT,CAAC;QAED,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAED,SAAS,CAAC,QAAgB,EAAE,OAAqC;QAC/D,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,EAAE,CAAC;YACpB,OAAO;QACT,CAAC;QAED,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IACpC,CAAC;IAED,OAAO,CAAC,QAAgB,EAAE,KAAkB;QAC1C,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,EAAE,CAAC;YACpB,OAAO;QACT,CAAC;QAED,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAED,gBAAgB,CAAC,QAAgB;QAM/B,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,EAAE,CAAC;YACpB,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;QAC3C,CAAC;QAED,OAAO,cAAc,CAAC,MAAM,EAAE,CAAC;IACjC,CAAC;IAED,YAAY,CAAC,QAAgB;QAC3B,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC7C,CAAC;CACF;AAED,MAAM,OAAO,QAAS,SAAQ,EAAE,CAAC,KAAK,CAAC,gBAAgB;IAC7C,YAAY,CAAgC;IAC5C,cAAc,CAAc;IACnB,aAAa,CAA4B;IACzC,OAAO,CAAiB;IACzC,mBAAmB,CAAqC;IACxD,sBAAsB,CAA0C;IAChE,YAAY,CAA6B;IAChC,4BAA4B,CAAgB;IACrD,mCAAmC,GAAe,GAAG,EAAE,GAAE,CAAC,CAAC;IAE3D,YAAY,gBAA2C,IAAI,yBAAyB,EAAE;QACpF,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,YAAY,GAAG,IAAI,GAAG,EAAE,CAAC;QAC9B,IAAI,CAAC,mBAAmB,GAAG,IAAI,GAAG,EAAE,CAAC;QACrC,IAAI,CAAC,sBAAsB,GAAG,IAAI,GAAG,EAAE,CAAC;QACxC,IAAI,CAAC,4BAA4B,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;YACxD,IAAI,CAAC,mCAAmC,GAAG,OAAO,CAAC;QACrD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;QAEhC,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QAEnC,IAAI,CAAC,OAAO,GAAG,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC;QACxC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC;QAC9C,IAAI,CAAC,WAAW,EAAE,CAAC,WAAW,EAAE,CAAC;QAEjC,IAAI,CAAC,YAAY;YACb,IAAI,EAAE,CAAC,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,aAAa,CAAC,EAAE,SAAS,CAAC,sBAAsB,CAAC,CAAC;QAC1G,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;QAC3C,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,4BAA4B,CAAC;QAEtD,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,aAAa,CAAC,UAAU,EAAE,IAAI,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC,CAAC,CAAC;IAC7F,CAAC;IAED,eAAe,CAAC,QAAgB;QAC9B,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACrC,OAAO;QACT,CAAC;QACD,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,UAAU,EAAE,CAAC;QACnD,IAAI,UAAU,EAAE,CAAC;YACf,UAAU,CAAC,kBAAkB,EAAE,CAAC;QAClC,CAAC;QACD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;IAC5D,CAAC;IAEQ,QAAQ;QACf,KAAK,CAAC,QAAQ,EAAE,CAAC;QACjB,KAAK,MAAM,KAAK,IAAI,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,UAAU,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC,CAAC,EAAE,CAAC;YAClG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAChC,CAAC;IACH,CAAC;IAEQ,QAAQ;QACf,KAAK,CAAC,QAAQ,EAAE,CAAC;QACjB,KAAK,MAAM,KAAK,IAAI,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,UAAU,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC,CAAC,EAAE,CAAC;YAClG,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;QACnC,CAAC;IACH,CAAC;IAED,UAAU,CAAC,KAAiB;QAC1B,IAAI,IAAI,CAAC,SAAS,EAAE,EAAE,CAAC;YACrB,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAChC,CAAC;IACH,CAAC;IAED,YAAY,CAAC,KAAiB;QAC5B,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC;IAEO,iBAAiB,CAAC,UAAsB;QAC9C,UAAU,CAAC,aAAa,EAAE,CAAC;QAC3B,UAAU,CAAC,gBAAgB,mEAAmC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAC5F,UAAU,CAAC,gBAAgB,uDAA6B,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAChF,UAAU,CAAC,gBAAgB,6DAAgC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACtF,UAAU,CAAC,gBAAgB,yDAA8B,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QAClF,UAAU,CAAC,gBAAgB,8CAAwB,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;IAC/E,CAAC;IAEO,oBAAoB,CAAC,UAAsB;QACjD,UAAU,CAAC,mBAAmB,mEAAmC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAC/F,UAAU,CAAC,mBAAmB,uDAA6B,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QACnF,UAAU,CAAC,mBAAmB,6DAAgC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACzF,UAAU,CAAC,mBAAmB,yDAA8B,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACrF,UAAU,CAAC,mBAAmB,8CAAwB,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;IAClF,CAAC;IAEO,iBAAiB,CAAC,KAAuF;QAE/G,KAAK,MAAM,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;YAC7C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QACjD,CAAC;IACH,CAAC;IAEO,WAAW,CAAC,KAAiF;QACnG,KAAK,MAAM,EAAE,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACnC,4GAA4G;YAC5G,+GAA+G;YAC/G,2FAA2F;YAC3F,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAiB,CAAC,CAAC;QACvD,CAAC;IACH,CAAC;IAEO,cAAc,CAAC,KAAoF;QACzG,KAAK,MAAM,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;YAC1C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QAC/C,CAAC;IACH,CAAC;IAEO,YAAY,CAAC,KAAkF;QACrG,KAAK,MAAM,KAAK,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACtC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC3C,CAAC;IACH,CAAC;IAEO,eAAe,CAAC,QAAgB;QACtC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC/E,CAAC;IAED,UAAU,CAAC,QAAgB,EAAE,QAAuC;QAClE,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC;YACpC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAClD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC;IACxD,CAAC;IAED,OAAO,CAAC,QAAgB,EAAE,KAAiC;QACzD,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC;YACpC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACtC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC5C,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;IAClD,CAAC;IAED,SAAS,CAAC,QAAgB,EAAE,OAAqC;QAC/D,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC;YACpC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QAC1C,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QAChD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC;IACtD,CAAC;IAED,OAAO,CAAC,QAAgB,EAAE,KAAkB;QAC1C,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC;YACpC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACtC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC5C,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;IAClD,CAAC;IAED,uBAAuB,CAAC,SAAqC;QAC3D,MAAM,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAC5D,IAAI,CAAC,QAAQ,EAAE,CAAC;YACd,OAAO;QACT,CAAC;QACD,MAAM,MAAM,GAAG,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtD,IAAI,MAAM,EAAE,CAAC;YACX,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACjD,CAAC;IACH,CAAC;IAED,qBAAqB;QACnB,OAAO,IAAI,CAAC,4BAA4B,CAAC;IAC3C,CAAC;IAEO,aAAa,CAAC,KAAiE;QACrF,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC;QAC1B,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACtD,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC;YACrB,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;QACrE,CAAC;QAED,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,8CAAiC,EAAE,CAAC;YACnE,IAAI,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,CAAC;QAChC,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAClD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE,IAAI,gBAAgB,EAAE,CAAC,CAAC;QAC/D,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAE9C,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC;YACjC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,UAAU,CAAC,SAAS,CAAC,uBAAuB,CAAC,CAAC;YACzE,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;QACrE,CAAC;QAED,IAAI,CAAC,mCAAmC,EAAE,CAAC;IAC7C,CAAC;IAED,qBAAqB,CAAC,QAAgB;QACpC,+EAA+E;QAC/E,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAClC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACnC,MAAM,MAAM,GAAG,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtD,IAAI,MAAM,EAAE,SAAS,EAAE,CAAC;YACtB,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACvD,CAAC;QACD,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC1C,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QACpC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC1C,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC;YACjC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,UAAU,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;YAC/D,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,CAAC,SAAS,CAAC,sBAAsB,CAAC,CAAC;YACtE,IAAI,CAAC,WAAW,EAAE,CAAC,WAAW,EAAE,CAAC;YACjC,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,UAAU,EAAE,CAAC;YACnD,IAAI,UAAU,EAAE,CAAC;gBACf,UAAU,CAAC,kBAAkB,EAAE,CAAC;YAClC,CAAC;YACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,2BAA2B,CAAC,QAAgB;QAC1C,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC;YAC7C,IAAI,KAAK,KAAK,QAAQ,EAAE,CAAC;gBACvB,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;YACpC,CAAC;QACH,CAAC;IACH,CAAC;IAED,gBAAgB,CAAC,QAAgB;QAC/B,MAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAC3D,MAAM,UAAU,GAAG,gCAAgC,GAAG,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QACxG,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;QAC3C,MAAM,CAAC,IAAI,GAAG,UAAU,CAAC;QACzB,MAAM,CAAC,QAAQ,GAAG,QAAQ,GAAG,OAAO,CAAC;QACrC,MAAM,CAAC,KAAK,EAAE,CAAC;IACjB,CAAC;CACF","sourcesContent":["// Copyright 2019 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport type * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport {Events, MediaModel, type PlayerEvent} from './MediaModel.js';\nimport {PlayerDetailView} from './PlayerDetailView.js';\nimport {PlayerListView} from './PlayerListView.js';\n\nconst UIStrings = {\n  /**\n   * @description Text to show if no media player has been selected\n   * A media player can be an audio and video source of a page.\n   */\n  noPlayerDetailsSelected: 'No media player selected',\n  /**\n   * @description Text to instruct the user on how to view media player details\n   * A media player can be an audio and video source of a page.\n   */\n  selectToViewDetails: 'Select a media player to inspect its details.',\n  /**\n   * @description Text to show if no player can be shown\n   * A media player can be an audio and video source of a page.\n   */\n  noMediaPlayer: 'No media player',\n  /**\n   * @description Text to explain this panel\n   * A media player can be an audio and video source of a page.\n   */\n  mediaPlayerDescription: 'On this page you can view and export media player details.',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/media/MainView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst MEDIA_PLAYER_EXPLANATION_URL =\n    'https://developer.chrome.com/docs/devtools/media-panel#hide-show' as Platform.DevToolsPath.UrlString;\n\nexport interface TriggerHandler {\n  onProperty(property: Protocol.Media.PlayerProperty): void;\n  onError(error: Protocol.Media.PlayerError): void;\n  onMessage(message: Protocol.Media.PlayerMessage): void;\n  onEvent(event: PlayerEvent): void;\n}\n\nexport interface TriggerDispatcher {\n  onProperty(playerID: string, property: Protocol.Media.PlayerProperty): void;\n  onError(playerID: string, error: Protocol.Media.PlayerError): void;\n  onMessage(playerID: string, message: Protocol.Media.PlayerMessage): void;\n  onEvent(playerID: string, event: PlayerEvent): void;\n}\n\nclass PlayerDataCollection implements TriggerHandler {\n  private readonly properties: Map<string, string>;\n  private readonly messages: Protocol.Media.PlayerMessage[];\n  private readonly events: PlayerEvent[];\n  private readonly errors: Protocol.Media.PlayerError[];\n\n  constructor() {\n    this.properties = new Map();\n    this.messages = [];\n    this.events = [];\n    this.errors = [];\n  }\n\n  onProperty(property: Protocol.Media.PlayerProperty): void {\n    this.properties.set(property.name, property.value);\n  }\n\n  onError(error: Protocol.Media.PlayerError): void {\n    this.errors.push(error);\n  }\n\n  onMessage(message: Protocol.Media.PlayerMessage): void {\n    this.messages.push(message);\n  }\n\n  onEvent(event: PlayerEvent): void {\n    this.events.push(event);\n  }\n\n  export(): {\n    properties: Map<string, string>,\n    messages: Protocol.Media.PlayerMessage[],\n    events: PlayerEvent[],\n    errors: Protocol.Media.PlayerError[],\n  } {\n    return {properties: this.properties, messages: this.messages, events: this.events, errors: this.errors};\n  }\n}\n\nexport class PlayerDataDownloadManager implements TriggerDispatcher {\n  private readonly playerDataCollection: Map<string, PlayerDataCollection>;\n  constructor() {\n    this.playerDataCollection = new Map();\n  }\n\n  addPlayer(playerID: string): void {\n    this.playerDataCollection.set(playerID, new PlayerDataCollection());\n  }\n\n  onProperty(playerID: string, property: Protocol.Media.PlayerProperty): void {\n    const playerProperty = this.playerDataCollection.get(playerID);\n    if (!playerProperty) {\n      return;\n    }\n\n    playerProperty.onProperty(property);\n  }\n\n  onError(playerID: string, error: Protocol.Media.PlayerError): void {\n    const playerProperty = this.playerDataCollection.get(playerID);\n    if (!playerProperty) {\n      return;\n    }\n\n    playerProperty.onError(error);\n  }\n\n  onMessage(playerID: string, message: Protocol.Media.PlayerMessage): void {\n    const playerProperty = this.playerDataCollection.get(playerID);\n    if (!playerProperty) {\n      return;\n    }\n\n    playerProperty.onMessage(message);\n  }\n\n  onEvent(playerID: string, event: PlayerEvent): void {\n    const playerProperty = this.playerDataCollection.get(playerID);\n    if (!playerProperty) {\n      return;\n    }\n\n    playerProperty.onEvent(event);\n  }\n\n  exportPlayerData(playerID: string): {\n    properties: Map<string, string>,\n    messages: Protocol.Media.PlayerMessage[],\n    events: PlayerEvent[],\n    errors: Protocol.Media.PlayerError[],\n  } {\n    const playerProperty = this.playerDataCollection.get(playerID);\n    if (!playerProperty) {\n      throw new Error('Unable to find player');\n    }\n\n    return playerProperty.export();\n  }\n\n  deletePlayer(playerID: string): void {\n    this.playerDataCollection.delete(playerID);\n  }\n}\n\nexport class MainView extends UI.Panel.PanelWithSidebar implements SDK.TargetManager.SDKModelObserver<MediaModel> {\n  private detailPanels: Map<string, PlayerDetailView>;\n  private deletedPlayers: Set<string>;\n  private readonly downloadStore: PlayerDataDownloadManager;\n  private readonly sidebar: PlayerListView;\n  #playerIdsToPlayers: Map<string, Protocol.Media.Player>;\n  #domNodeIdsToPlayerIds: Map<Protocol.DOM.BackendNodeId, string>;\n  #placeholder: UI.EmptyWidget.EmptyWidget;\n  readonly #initialPlayersLoadedPromise: Promise<void>;\n  #initialPlayersLoadedPromiseResolve: () => void = () => {};\n\n  constructor(downloadStore: PlayerDataDownloadManager = new PlayerDataDownloadManager()) {\n    super('media');\n    this.detailPanels = new Map();\n    this.#playerIdsToPlayers = new Map();\n    this.#domNodeIdsToPlayerIds = new Map();\n    this.#initialPlayersLoadedPromise = new Promise(resolve => {\n      this.#initialPlayersLoadedPromiseResolve = resolve;\n    });\n\n    this.deletedPlayers = new Set();\n\n    this.downloadStore = downloadStore;\n\n    this.sidebar = new PlayerListView(this);\n    this.sidebar.show(this.panelSidebarElement());\n    this.splitWidget().hideSidebar();\n\n    this.#placeholder =\n        new UI.EmptyWidget.EmptyWidget(i18nString(UIStrings.noMediaPlayer), UIStrings.mediaPlayerDescription);\n    this.#placeholder.show(this.mainElement());\n    this.#placeholder.link = MEDIA_PLAYER_EXPLANATION_URL;\n\n    SDK.TargetManager.TargetManager.instance().observeModels(MediaModel, this, {scoped: true});\n  }\n\n  renderMainPanel(playerID: string): void {\n    if (!this.detailPanels.has(playerID)) {\n      return;\n    }\n    const mainWidget = this.splitWidget().mainWidget();\n    if (mainWidget) {\n      mainWidget.detachChildWidgets();\n    }\n    this.detailPanels.get(playerID)?.show(this.mainElement());\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    for (const model of SDK.TargetManager.TargetManager.instance().models(MediaModel, {scoped: true})) {\n      this.addEventListeners(model);\n    }\n  }\n\n  override willHide(): void {\n    super.willHide();\n    for (const model of SDK.TargetManager.TargetManager.instance().models(MediaModel, {scoped: true})) {\n      this.removeEventListeners(model);\n    }\n  }\n\n  modelAdded(model: MediaModel): void {\n    if (this.isShowing()) {\n      this.addEventListeners(model);\n    }\n  }\n\n  modelRemoved(model: MediaModel): void {\n    this.removeEventListeners(model);\n  }\n\n  private addEventListeners(mediaModel: MediaModel): void {\n    mediaModel.ensureEnabled();\n    mediaModel.addEventListener(Events.PLAYER_PROPERTIES_CHANGED, this.propertiesChanged, this);\n    mediaModel.addEventListener(Events.PLAYER_EVENTS_ADDED, this.eventsAdded, this);\n    mediaModel.addEventListener(Events.PLAYER_MESSAGES_LOGGED, this.messagesLogged, this);\n    mediaModel.addEventListener(Events.PLAYER_ERRORS_RAISED, this.errorsRaised, this);\n    mediaModel.addEventListener(Events.PLAYER_CREATED, this.playerCreated, this);\n  }\n\n  private removeEventListeners(mediaModel: MediaModel): void {\n    mediaModel.removeEventListener(Events.PLAYER_PROPERTIES_CHANGED, this.propertiesChanged, this);\n    mediaModel.removeEventListener(Events.PLAYER_EVENTS_ADDED, this.eventsAdded, this);\n    mediaModel.removeEventListener(Events.PLAYER_MESSAGES_LOGGED, this.messagesLogged, this);\n    mediaModel.removeEventListener(Events.PLAYER_ERRORS_RAISED, this.errorsRaised, this);\n    mediaModel.removeEventListener(Events.PLAYER_CREATED, this.playerCreated, this);\n  }\n\n  private propertiesChanged(event: Common.EventTarget.EventTargetEvent<Protocol.Media.PlayerPropertiesChangedEvent>):\n      void {\n    for (const property of event.data.properties) {\n      this.onProperty(event.data.playerId, property);\n    }\n  }\n\n  private eventsAdded(event: Common.EventTarget.EventTargetEvent<Protocol.Media.PlayerEventsAddedEvent>): void {\n    for (const ev of event.data.events) {\n      // TODO(crbug.com/1228674): The conversion from Protocol.Media.PlayerEvent to PlayerEvent happens implicitly\n      // by augmenting the protocol type with some additional property in various places. This needs to be cleaned up\n      // in a conversion function that takes the protocol type and produces the PlayerEvent type.\n      this.onEvent(event.data.playerId, ev as PlayerEvent);\n    }\n  }\n\n  private messagesLogged(event: Common.EventTarget.EventTargetEvent<Protocol.Media.PlayerMessagesLoggedEvent>): void {\n    for (const message of event.data.messages) {\n      this.onMessage(event.data.playerId, message);\n    }\n  }\n\n  private errorsRaised(event: Common.EventTarget.EventTargetEvent<Protocol.Media.PlayerErrorsRaisedEvent>): void {\n    for (const error of event.data.errors) {\n      this.onError(event.data.playerId, error);\n    }\n  }\n\n  private shouldPropagate(playerID: string): boolean {\n    return !this.deletedPlayers.has(playerID) && this.detailPanels.has(playerID);\n  }\n\n  onProperty(playerID: string, property: Protocol.Media.PlayerProperty): void {\n    if (!this.shouldPropagate(playerID)) {\n      return;\n    }\n    this.sidebar.onProperty(playerID, property);\n    this.downloadStore.onProperty(playerID, property);\n    this.detailPanels.get(playerID)?.onProperty(property);\n  }\n\n  onError(playerID: string, error: Protocol.Media.PlayerError): void {\n    if (!this.shouldPropagate(playerID)) {\n      return;\n    }\n    this.sidebar.onError(playerID, error);\n    this.downloadStore.onError(playerID, error);\n    this.detailPanels.get(playerID)?.onError(error);\n  }\n\n  onMessage(playerID: string, message: Protocol.Media.PlayerMessage): void {\n    if (!this.shouldPropagate(playerID)) {\n      return;\n    }\n    this.sidebar.onMessage(playerID, message);\n    this.downloadStore.onMessage(playerID, message);\n    this.detailPanels.get(playerID)?.onMessage(message);\n  }\n\n  onEvent(playerID: string, event: PlayerEvent): void {\n    if (!this.shouldPropagate(playerID)) {\n      return;\n    }\n    this.sidebar.onEvent(playerID, event);\n    this.downloadStore.onEvent(playerID, event);\n    this.detailPanels.get(playerID)?.onEvent(event);\n  }\n\n  selectPlayerByDOMNodeId(domNodeId: Protocol.DOM.BackendNodeId): void {\n    const playerId = this.#domNodeIdsToPlayerIds.get(domNodeId);\n    if (!playerId) {\n      return;\n    }\n    const player = this.#playerIdsToPlayers.get(playerId);\n    if (player) {\n      this.sidebar.selectPlayerById(player.playerId);\n    }\n  }\n\n  waitForInitialPlayers(): Promise<void> {\n    return this.#initialPlayersLoadedPromise;\n  }\n\n  private playerCreated(event: Common.EventTarget.EventTargetEvent<Protocol.Media.Player>): void {\n    const player = event.data;\n    this.#playerIdsToPlayers.set(player.playerId, player);\n    if (player.domNodeId) {\n      this.#domNodeIdsToPlayerIds.set(player.domNodeId, player.playerId);\n    }\n\n    if (this.splitWidget().showMode() !== UI.SplitWidget.ShowMode.BOTH) {\n      this.splitWidget().showBoth();\n    }\n    this.sidebar.addMediaElementItem(player.playerId);\n    this.detailPanels.set(player.playerId, new PlayerDetailView());\n    this.downloadStore.addPlayer(player.playerId);\n\n    if (this.detailPanels.size === 1) {\n      this.#placeholder.header = i18nString(UIStrings.noPlayerDetailsSelected);\n      this.#placeholder.text = i18nString(UIStrings.selectToViewDetails);\n    }\n\n    this.#initialPlayersLoadedPromiseResolve();\n  }\n\n  markPlayerForDeletion(playerID: string): void {\n    // TODO(tmathmeyer): send this to chromium to save the storage space there too.\n    this.deletedPlayers.add(playerID);\n    this.detailPanels.delete(playerID);\n    const player = this.#playerIdsToPlayers.get(playerID);\n    if (player?.domNodeId) {\n      this.#domNodeIdsToPlayerIds.delete(player.domNodeId);\n    }\n    this.#playerIdsToPlayers.delete(playerID);\n    this.sidebar.deletePlayer(playerID);\n    this.downloadStore.deletePlayer(playerID);\n    if (this.detailPanels.size === 0) {\n      this.#placeholder.header = i18nString(UIStrings.noMediaPlayer);\n      this.#placeholder.text = i18nString(UIStrings.mediaPlayerDescription);\n      this.splitWidget().hideSidebar();\n      const mainWidget = this.splitWidget().mainWidget();\n      if (mainWidget) {\n        mainWidget.detachChildWidgets();\n      }\n      this.#placeholder.show(this.mainElement());\n    }\n  }\n\n  markOtherPlayersForDeletion(playerID: string): void {\n    for (const keyID of this.detailPanels.keys()) {\n      if (keyID !== playerID) {\n        this.markPlayerForDeletion(keyID);\n      }\n    }\n  }\n\n  exportPlayerData(playerID: string): void {\n    const dump = this.downloadStore.exportPlayerData(playerID);\n    const uriContent = 'data:application/octet-stream,' + encodeURIComponent(JSON.stringify(dump, null, 2));\n    const anchor = document.createElement('a');\n    anchor.href = uriContent;\n    anchor.download = playerID + '.json';\n    anchor.click();\n  }\n}\n"]}