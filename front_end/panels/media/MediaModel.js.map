{"version":3,"file":"MediaModel.js","sourceRoot":"","sources":["../../../../../../front_end/panels/media/MediaModel.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AA0B7C,MAAM,OAAO,UAAW,SAAQ,GAAG,CAAC,QAAQ,CAAC,QAAoB;IACvD,OAAO,CAAU;IACR,KAAK,CAA4B;IAElD,YAAY,MAAyB;QACnC,KAAK,CAAC,MAAM,CAAC,CAAC;QAEd,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC;QAEjC,MAAM,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEQ,KAAK,CAAC,WAAW;QACxB,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YAClB,OAAO,MAAM,OAAO,CAAC,OAAO,EAAE,CAAC;QACjC,CAAC;QACD,MAAM,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;IACnC,CAAC;IAED,aAAa;QACX,KAAK,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;QAChC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACtB,CAAC;IAED,uBAAuB,CAAC,KAAkD;QACxE,IAAI,CAAC,wBAAwB,mEAAmC,KAAK,CAAC,CAAC;IACzE,CAAC;IAED,iBAAiB,CAAC,KAA4C;QAC5D,IAAI,CAAC,wBAAwB,uDAA6B,KAAK,CAAC,CAAC;IACnE,CAAC;IAED,oBAAoB,CAAC,KAA+C;QAClE,IAAI,CAAC,wBAAwB,6DAAgC,KAAK,CAAC,CAAC;IACtE,CAAC;IAED,kBAAkB,CAAC,KAA6C;QAC9D,IAAI,CAAC,wBAAwB,yDAA8B,KAAK,CAAC,CAAC;IACpE,CAAC;IAED,aAAa,CAAC,EAAC,MAAM,EAAoC;QACvD,IAAI,CAAC,wBAAwB,8CAAwB,MAAM,CAAC,CAAC;IAC/D,CAAC;CACF;AACD,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU,EAAE,EAAC,YAAY,0CAA6B,EAAE,SAAS,EAAE,KAAK,EAAC,CAAC,CAAC","sourcesContent":["// Copyright 2019 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nexport interface PlayerEvent extends Protocol.Media.PlayerEvent {\n  value: string;\n  displayTimestamp: string;\n  event: string;\n}\n\nexport const enum Events {\n  PLAYER_PROPERTIES_CHANGED = 'PlayerPropertiesChanged',\n  PLAYER_EVENTS_ADDED = 'PlayerEventsAdded',\n  PLAYER_MESSAGES_LOGGED = 'PlayerMessagesLogged',\n  PLAYER_ERRORS_RAISED = 'PlayerErrorsRaised',\n  PLAYER_CREATED = 'PlayerCreated',\n}\n\nexport interface EventTypes {\n  [Events.PLAYER_PROPERTIES_CHANGED]: Protocol.Media.PlayerPropertiesChangedEvent;\n  [Events.PLAYER_EVENTS_ADDED]: Protocol.Media.PlayerEventsAddedEvent;\n  [Events.PLAYER_MESSAGES_LOGGED]: Protocol.Media.PlayerMessagesLoggedEvent;\n  [Events.PLAYER_ERRORS_RAISED]: Protocol.Media.PlayerErrorsRaisedEvent;\n  [Events.PLAYER_CREATED]: Protocol.Media.Player;\n}\n\nexport class MediaModel extends SDK.SDKModel.SDKModel<EventTypes> implements ProtocolProxyApi.MediaDispatcher {\n  private enabled: boolean;\n  private readonly agent: ProtocolProxyApi.MediaApi;\n\n  constructor(target: SDK.Target.Target) {\n    super(target);\n\n    this.enabled = false;\n    this.agent = target.mediaAgent();\n\n    target.registerMediaDispatcher(this);\n  }\n\n  override async resumeModel(): Promise<void> {\n    if (!this.enabled) {\n      return await Promise.resolve();\n    }\n    await this.agent.invoke_enable();\n  }\n\n  ensureEnabled(): void {\n    void this.agent.invoke_enable();\n    this.enabled = true;\n  }\n\n  playerPropertiesChanged(event: Protocol.Media.PlayerPropertiesChangedEvent): void {\n    this.dispatchEventToListeners(Events.PLAYER_PROPERTIES_CHANGED, event);\n  }\n\n  playerEventsAdded(event: Protocol.Media.PlayerEventsAddedEvent): void {\n    this.dispatchEventToListeners(Events.PLAYER_EVENTS_ADDED, event);\n  }\n\n  playerMessagesLogged(event: Protocol.Media.PlayerMessagesLoggedEvent): void {\n    this.dispatchEventToListeners(Events.PLAYER_MESSAGES_LOGGED, event);\n  }\n\n  playerErrorsRaised(event: Protocol.Media.PlayerErrorsRaisedEvent): void {\n    this.dispatchEventToListeners(Events.PLAYER_ERRORS_RAISED, event);\n  }\n\n  playerCreated({player}: Protocol.Media.PlayerCreatedEvent): void {\n    this.dispatchEventToListeners(Events.PLAYER_CREATED, player);\n  }\n}\nSDK.SDKModel.SDKModel.register(MediaModel, {capabilities: SDK.Target.Capability.MEDIA, autostart: false});\n"]}