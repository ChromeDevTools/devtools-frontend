{"version":3,"file":"PlayerListView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/media/PlayerListView.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,qBAAqB,CAAC;AAE7B,OAAO,KAAK,IAAI,MAAM,yBAAyB,CAAC;AAEhD,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAChD,OAAO,EAAC,UAAU,EAAE,IAAI,EAAE,MAAM,EAAC,MAAM,qBAAqB,CAAC;AAC7D,OAAO,KAAK,aAAa,MAAM,2CAA2C,CAAC;AAI3E,OAAO,oBAAoB,MAAM,yBAAyB,CAAC;AAG3D,MAAM,EAAC,QAAQ,EAAC,GAAG,UAAU,CAAC;AAE9B,MAAM,SAAS,GAAG;IAChB;;OAEG;IACH,UAAU,EAAE,aAAa;IACzB;;OAEG;IACH,aAAa,EAAE,iBAAiB;IAChC;;OAEG;IACH,cAAc,EAAE,kBAAkB;IAClC;;OAEG;IACH,OAAO,EAAE,SAAS;CACV,CAAC;AACX,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,gCAAgC,EAAE,SAAS,CAAC,CAAC;AACtF,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAoBtE,MAAM,YAAY,GAAS,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;IACpD,mBAAmB;IACnB,MAAM,CACJ,IAAI,CAAA;eACO,oBAAoB;yCACM,UAAU,CAAC,SAAS,CAAC,OAAO,CAAC;QAC9D,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;QAC3B,MAAM,UAAU,GAAG,MAAM,CAAC,QAAQ,KAAK,KAAK,CAAC,gBAAgB,CAAC;QAC9D,OAAO,IAAI,CAAA;uBACI,QAAQ,CAAC;YACpB,kBAAkB,EAAE,IAAI;YACxB,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE,UAAU;YACpB,mBAAmB,EAAE,UAAU;SAChC,CAAC;wBACY,GAAG,EAAE,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC;8BACpC,CAAC,CAAQ,EAAE,EAAE,CAAC,KAAK,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;uBAClE,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC;;;sCAGlC,MAAM,CAAC,QAAQ;;;oDAGD,MAAM,CAAC,UAAU;qDAChB,MAAM,CAAC,WAAW;;SAE9D,CAAC;IACJ,CAAC,CAAC;KACH,EACD,MAAM,CACP,CAAC;IACF,kBAAkB;AACpB,CAAC,CAAC;AAEF,MAAM,OAAO,cAAe,SAAQ,EAAE,CAAC,MAAM,CAAC,IAAI;IAChD,KAAK,CAAO;IACK,cAAc,CAA4B;IAC1C,mCAAmC,CAAc;IACjD,aAAa,CAAW;IACjC,yBAAyB,CAAc;IAE/C,YAAY,aAAuB,EAAE,OAAa,YAAY;QAC5D,KAAK,CAAC,EAAC,YAAY,EAAE,IAAI,EAAC,CAAC,CAAC;QAC5B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;QAChC,IAAI,CAAC,mCAAmC,GAAG,IAAI,GAAG,EAAE,CAAC;QAErD,2DAA2D;QAC3D,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QAEnC,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEQ,aAAa;QACpB,MAAM,KAAK,GAAc;YACvB,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC;YACjD,gBAAgB,EAAE,IAAI,CAAC,yBAAyB;YAChD,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC;YAC3C,mBAAmB,EAAE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC;SACtD,CAAC;QACF,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;IAC7C,CAAC;IAED,gBAAgB,CAAC,QAAgB;QAC/B,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACtC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC9B,CAAC;IACH,CAAC;IAEO,YAAY,CAAC,QAAgB;QACnC,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,CAAC,yBAAyB,GAAG,QAAQ,CAAC;QAC1C,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEO,gBAAgB,CAAC,QAAgB,EAAE,KAAY;QACrD,MAAM,WAAW,GAAG,IAAI,EAAE,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC1D,WAAW,CAAC,aAAa,EAAE,CAAC,UAAU,CAClC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,EAC7G,EAAC,YAAY,EAAE,aAAa,EAAC,CAAC,CAAC;QACnC,WAAW,CAAC,aAAa,EAAE,CAAC,UAAU,CAClC,UAAU,CAAC,SAAS,CAAC,aAAa,CAAC,EACnC,IAAI,CAAC,aAAa,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,EACjF,EAAC,YAAY,EAAE,iBAAiB,EAAC,CAAC,CAAC;QACvC,WAAW,CAAC,aAAa,EAAE,CAAC,UAAU,CAClC,UAAU,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,EAC5G,EAAC,YAAY,EAAE,kBAAkB,EAAC,CAAC,CAAC;QACxC,KAAK,WAAW,CAAC,IAAI,EAAE,CAAC;IAC1B,CAAC;IAEO,yBAAyB,CAAC,QAAgB,EAAE,UAAkB,EAAE,UAAmB;QACzF,4EAA4E;QAC5E,4EAA4E;QAC5E,4BAA4B;QAC5B,IAAI,IAAI,CAAC,mCAAmC,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC3D,IAAI,CAAC,UAAU,EAAE,CAAC;gBAChB,IAAI,CAAC,mCAAmC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YAC5D,CAAC;QACH,CAAC;aAAM,IAAI,UAAU,EAAE,CAAC;YACtB,OAAO;QACT,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACvC,OAAO;QACT,CAAC;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,YAAY,EAAE,CAAC;YACjB,YAAY,CAAC,UAAU,GAAG,UAAU,CAAC;YACrC,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IAEO,0BAA0B,CAAC,QAAgB,EAAE,WAAmB;QACtE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACvC,OAAO;QACT,CAAC;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,YAAY,EAAE,CAAC;YACjB,YAAY,CAAC,WAAW,GAAG,WAAW,CAAC;YACvC,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IAEO,yBAAyB,CAAC,QAAgB,EAAE,QAAgB;QAClE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACvC,OAAO;QACT,CAAC;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,YAAY,EAAE,CAAC;YACjB,YAAY,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACjC,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IAEO,iBAAiB,CACrB,QAAgB,EAAE,IAAiC,EAAE,SAAiB,EAAE,GAAW,EAAE,GAAW;QAClG,IAAI,SAAS,CAAC,MAAM,IAAI,GAAG,EAAE,CAAC;YAC5B,OAAO;QACT,CAAC;QACD,IAAI,SAAS,CAAC,MAAM,IAAI,GAAG,EAAE,CAAC;YAC5B,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;QACpD,CAAC;QACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;IACvC,CAAC;IAED,mBAAmB,CAAC,QAAgB;QAClC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,EAAE;YAChC,WAAW,EAAE,aAAa;YAC1B,UAAU,EAAE,YAAY;YACxB,QAAQ;YACR,MAAM,EAAE,IAAI;YACZ,OAAO,EAAE,KAAK;YACd,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,OAAO;SAClB,CAAC,CAAC;QACH,IAAI,CAAC,mCAAmC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,YAAY,CAAC,QAAgB;QAC3B,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACvC,OAAO;QACT,CAAC;QACD,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACrC,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,OAAO,CAAC,QAAgB,EAAE,KAAkB;QAC1C,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACvC,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC;QAE/B,2EAA2E;QAC3E,0EAA0E;QAC1E,wEAAwE;QACxE,yDAAyD;QACzD,IAAI,SAAS,KAAK,OAAO,EAAE,CAAC;YAC1B,MAAM,GAAG,GAAG,MAAM,CAAC,GAAa,CAAC;YACjC,MAAM,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YAC1D,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,IAAI,CAAC,0BAA0B,EAAE,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;YACpF,OAAO;QACT,CAAC;QAED,IAAI,SAAS,KAAK,OAAO,EAAE,CAAC;YAC1B,IAAI,CAAC,yBAAyB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjD,OAAO;QACT,CAAC;QAED,IAAI,SAAS,KAAK,QAAQ,IAAI,SAAS,KAAK,QAAQ,EAAE,CAAC;YACrD,IAAI,CAAC,yBAAyB,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAClD,OAAO;QACT,CAAC;QAED,IAAI,SAAS,KAAK,0BAA0B,EAAE,CAAC;YAC7C,IAAI,CAAC,yBAAyB,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAClD,OAAO;QACT,CAAC;IACH,CAAC;IAED,UAAU,CAAC,QAAgB,EAAE,QAAuC;QAClE,2EAA2E;QAC3E,6EAA6E;QAC7E,2EAA2E;QAC3E,2EAA2E;QAC3E,sBAAsB;QACtB,IAAI,QAAQ,CAAC,IAAI,mDAAiC,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC;YACpD,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,IAAI,CAAC,yBAAyB,EAAE,UAAU,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;YACpF,OAAO;QACT,CAAC;QAED,yEAAyE;QACzE,yEAAyE;QACzE,0EAA0E;QAC1E,uEAAuE;QACvE,wEAAwE;QACxE,+CAA+C;QAC/C,IAAI,QAAQ,CAAC,IAAI,uDAAmC,IAAI,QAAQ,CAAC,KAAK,EAAE,CAAC;YACvE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,IAAI,CAAC,yBAAyB,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;YACxF,OAAO;QACT,CAAC;IACH,CAAC;IAED,OAAO,CAAC,SAAiB,EAAE,MAAkC;QAC3D,8DAA8D;IAChE,CAAC;IAED,SAAS,CAAC,SAAiB,EAAE,QAAsC;QACjE,wEAAwE;IAC1E,CAAC;CACF","sourcesContent":["// Copyright 2019 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/kit/kit.js';\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives, html, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport type {MainView, TriggerDispatcher} from './MainView.js';\nimport type {PlayerEvent} from './MediaModel.js';\nimport playerListViewStyles from './playerListView.css.js';\nimport {PlayerPropertyKeys} from './PlayerPropertiesView.js';\n\nconst {classMap} = Directives;\n\nconst UIStrings = {\n  /**\n   * @description A right-click context menu entry which when clicked causes the menu entry for that player to be removed.\n   */\n  hidePlayer: 'Hide player',\n  /**\n   * @description A right-click context menu entry which should keep the element selected, while hiding all other entries.\n   */\n  hideAllOthers: 'Hide all others',\n  /**\n   * @description Context menu entry which downloads the json dump when clicked\n   */\n  savePlayerInfo: 'Save player info',\n  /**\n   * @description Side-panel entry title text for the players section.\n   */\n  players: 'Players',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/media/PlayerListView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface PlayerStatus {\n  playerTitle: string;\n  frameTitle: string;\n  playerID: string;\n  exists: boolean;\n  playing: boolean;\n  titleEdited: boolean;\n  iconName: string;\n}\n\nexport interface ViewInput {\n  players: PlayerStatus[];\n  selectedPlayerID: string|null;\n  onPlayerClick: (playerID: string) => void;\n  onPlayerContextMenu: (playerID: string, event: Event) => void;\n}\nexport type View = (input: ViewInput, output: object, target: HTMLElement) => void;\n\nconst DEFAULT_VIEW: View = (input, _output, target) => {\n  // clang-format off\n  render(\n    html`\n      <style>${playerListViewStyles}</style>\n      <div class=\"player-entry-header\">${i18nString(UIStrings.players)}</div>\n      ${input.players.map(player => {\n        const isSelected = player.playerID === input.selectedPlayerID;\n        return html`\n          <div class=${classMap({\n            'player-entry-row': true,\n            hbox: true,\n            selected: isSelected,\n            'force-white-icons': isSelected,\n          })}\n               @click=${() => input.onPlayerClick(player.playerID)}\n               @contextmenu=${(e: Event) => input.onPlayerContextMenu(player.playerID, e)}\n               jslog=${VisualLogging.item('player').track({click: true})}>\n            <div class=\"player-entry-status-icon vbox\">\n              <div class=\"player-entry-status-icon-centering\">\n                <devtools-icon name=${player.iconName}></devtools-icon>\n              </div>\n            </div>\n            <div class=\"player-entry-frame-title\">${player.frameTitle}</div>\n            <div class=\"player-entry-player-title\">${player.playerTitle}</div>\n          </div>\n        `;\n      })}\n    `,\n    target\n  );\n  // clang-format on\n};\n\nexport class PlayerListView extends UI.Widget.VBox implements TriggerDispatcher {\n  #view: View;\n  private readonly playerStatuses: Map<string, PlayerStatus>;\n  private readonly playerEntriesWithHostnameFrameTitle: Set<string>;\n  private readonly mainContainer: MainView;\n  private currentlySelectedPlayerID: string|null;\n\n  constructor(mainContainer: MainView, view: View = DEFAULT_VIEW) {\n    super({useShadowDom: true});\n    this.#view = view;\n\n    this.playerStatuses = new Map();\n    this.playerEntriesWithHostnameFrameTitle = new Set();\n\n    // Container where new panels can be added based on clicks.\n    this.mainContainer = mainContainer;\n\n    this.currentlySelectedPlayerID = null;\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    const input: ViewInput = {\n      players: Array.from(this.playerStatuses.values()),\n      selectedPlayerID: this.currentlySelectedPlayerID,\n      onPlayerClick: this.selectPlayer.bind(this),\n      onPlayerContextMenu: this.rightClickPlayer.bind(this),\n    };\n    this.#view(input, {}, this.contentElement);\n  }\n\n  selectPlayerById(playerID: string): void {\n    if (this.playerStatuses.has(playerID)) {\n      this.selectPlayer(playerID);\n    }\n  }\n\n  private selectPlayer(playerID: string): void {\n    this.mainContainer.renderMainPanel(playerID);\n    this.currentlySelectedPlayerID = playerID;\n    this.requestUpdate();\n  }\n\n  private rightClickPlayer(playerID: string, event: Event): void {\n    const contextMenu = new UI.ContextMenu.ContextMenu(event);\n    contextMenu.headerSection().appendItem(\n        i18nString(UIStrings.hidePlayer), this.mainContainer.markPlayerForDeletion.bind(this.mainContainer, playerID),\n        {jslogContext: 'hide-player'});\n    contextMenu.headerSection().appendItem(\n        i18nString(UIStrings.hideAllOthers),\n        this.mainContainer.markOtherPlayersForDeletion.bind(this.mainContainer, playerID),\n        {jslogContext: 'hide-all-others'});\n    contextMenu.headerSection().appendItem(\n        i18nString(UIStrings.savePlayerInfo), this.mainContainer.exportPlayerData.bind(this.mainContainer, playerID),\n        {jslogContext: 'save-player-info'});\n    void contextMenu.show();\n  }\n\n  private setMediaElementFrameTitle(playerID: string, frameTitle: string, isHostname: boolean): void {\n    // Only remove the title from the set if we aren't setting a hostname title.\n    // Otherwise, if it has a non-hostname title, and the requested new title is\n    // a hostname, just drop it.\n    if (this.playerEntriesWithHostnameFrameTitle.has(playerID)) {\n      if (!isHostname) {\n        this.playerEntriesWithHostnameFrameTitle.delete(playerID);\n      }\n    } else if (isHostname) {\n      return;\n    }\n\n    if (!this.playerStatuses.has(playerID)) {\n      return;\n    }\n    const playerStatus = this.playerStatuses.get(playerID);\n    if (playerStatus) {\n      playerStatus.frameTitle = frameTitle;\n      this.requestUpdate();\n    }\n  }\n\n  private setMediaElementPlayerTitle(playerID: string, playerTitle: string): void {\n    if (!this.playerStatuses.has(playerID)) {\n      return;\n    }\n    const playerStatus = this.playerStatuses.get(playerID);\n    if (playerStatus) {\n      playerStatus.playerTitle = playerTitle;\n      this.requestUpdate();\n    }\n  }\n\n  private setMediaElementPlayerIcon(playerID: string, iconName: string): void {\n    if (!this.playerStatuses.has(playerID)) {\n      return;\n    }\n    const playerStatus = this.playerStatuses.get(playerID);\n    if (playerStatus) {\n      playerStatus.iconName = iconName;\n      this.requestUpdate();\n    }\n  }\n\n  private formatAndEvaluate(\n      playerID: string, func: (...args: any[]) => unknown, candidate: string, min: number, max: number): void {\n    if (candidate.length <= min) {\n      return;\n    }\n    if (candidate.length >= max) {\n      candidate = candidate.substring(0, max - 1) + 'â€¦';\n    }\n    func.bind(this)(playerID, candidate);\n  }\n\n  addMediaElementItem(playerID: string): void {\n    this.playerStatuses.set(playerID, {\n      playerTitle: 'PlayerTitle',\n      frameTitle: 'FrameTitle',\n      playerID,\n      exists: true,\n      playing: false,\n      titleEdited: false,\n      iconName: 'pause',\n    });\n    this.playerEntriesWithHostnameFrameTitle.add(playerID);\n    this.requestUpdate();\n  }\n\n  deletePlayer(playerID: string): void {\n    if (!this.playerStatuses.has(playerID)) {\n      return;\n    }\n    this.playerStatuses.delete(playerID);\n    this.requestUpdate();\n  }\n\n  onEvent(playerID: string, event: PlayerEvent): void {\n    const parsed = JSON.parse(event.value);\n    const eventType = parsed.event;\n\n    // Load events provide the actual underlying URL for the video, which makes\n    // a great way to identify a specific video within a page that potentially\n    // may have many videos. MSE videos have a special blob:http(s) protocol\n    // that we'd like to keep mind of, so we do prepend blob:\n    if (eventType === 'kLoad') {\n      const url = parsed.url as string;\n      const videoName = url.substring(url.lastIndexOf('/') + 1);\n      this.formatAndEvaluate(playerID, this.setMediaElementPlayerTitle, videoName, 1, 20);\n      return;\n    }\n\n    if (eventType === 'kPlay') {\n      this.setMediaElementPlayerIcon(playerID, 'play');\n      return;\n    }\n\n    if (eventType === 'kPause' || eventType === 'kEnded') {\n      this.setMediaElementPlayerIcon(playerID, 'pause');\n      return;\n    }\n\n    if (eventType === 'kWebMediaPlayerDestroyed') {\n      this.setMediaElementPlayerIcon(playerID, 'cross');\n      return;\n    }\n  }\n\n  onProperty(playerID: string, property: Protocol.Media.PlayerProperty): void {\n    // FrameUrl is always present, and we can generate a basic frame title from\n    // it by grabbing the hostname. It's not possible to generate a \"good\" player\n    // title from the FrameUrl though, since the page location itself might not\n    // have any relevance to the video being played, and would be shared by all\n    // videos on the page.\n    if (property.name === PlayerPropertyKeys.FRAME_URL) {\n      const frameTitle = new URL(property.value).hostname;\n      this.formatAndEvaluate(playerID, this.setMediaElementFrameTitle, frameTitle, 1, 20);\n      return;\n    }\n\n    // On the other hand, the page may set a title, which usually makes for a\n    // better frame title than a hostname. Unfortunately, its only \"usually\",\n    // since the site is free to set the title to _anything_, it might just be\n    // junk, or it might be super long. If it's empty, or 1 character, It's\n    // preferable to just drop it. Titles longer than 20 will have the first\n    // 17 characters kept and an ellipsis appended.\n    if (property.name === PlayerPropertyKeys.FRAME_TITLE && property.value) {\n      this.formatAndEvaluate(playerID, this.setMediaElementFrameTitle, property.value, 1, 20);\n      return;\n    }\n  }\n\n  onError(_playerID: string, _error: Protocol.Media.PlayerError): void {\n    // TODO(tmathmeyer) show an error icon next to the player name\n  }\n\n  onMessage(_playerID: string, _message: Protocol.Media.PlayerMessage): void {\n    // TODO(tmathmeyer) show a message count number next to the player name.\n  }\n}\n"]}