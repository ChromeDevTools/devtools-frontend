{"version":3,"file":"NetworkWaterfallColumn.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/NetworkWaterfallColumn.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport * as Common from '../../core/common/common.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as NetworkTimeCalculator from '../../models/network_time_calculator/network_time_calculator.js';\nimport * as RenderCoordinator from '../../ui/components/render_coordinator/render_coordinator.js';\nimport * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as ThemeSupport from '../../ui/legacy/theme_support/theme_support.js';\n\nimport type {NetworkNode} from './NetworkDataGridNode.js';\nimport {RequestTimeRangeNameToColor} from './NetworkOverview.js';\nimport networkWaterfallColumnStyles from './networkWaterfallColumn.css.js';\nimport {RequestTimingView} from './RequestTimingView.js';\n\nconst BAR_SPACING = 1;\n\nexport class NetworkWaterfallColumn extends UI.Widget.VBox {\n  private canvas: HTMLCanvasElement;\n  private canvasPosition: DOMRect;\n  private readonly leftPadding: number;\n  private readonly fontSize: number;\n  private rightPadding: number;\n  private scrollTop: number;\n  private headerHeight: number;\n  private calculator: NetworkTimeCalculator.NetworkTimeCalculator;\n  private rowHeight: number;\n  private offsetWidth: number;\n  private offsetHeight: number;\n  private startTime: number;\n  private endTime: number;\n  private readonly popoverHelper: UI.PopoverHelper.PopoverHelper;\n  private nodes: NetworkNode[];\n  private hoveredNode: NetworkNode|null;\n  private eventDividers: Map<string, number[]>;\n  private readonly styleForTimeRangeName: Map<NetworkTimeCalculator.RequestTimeRangeNames, LayerStyle>;\n  private readonly styleForWaitingResourceType: Map<Common.ResourceType.ResourceType, LayerStyle>;\n  private readonly styleForDownloadingResourceType: Map<Common.ResourceType.ResourceType, LayerStyle>;\n  private readonly wiskerStyle: LayerStyle;\n  private readonly hoverDetailsStyle: LayerStyle;\n  private readonly pathForStyle: Map<LayerStyle, Path2D>;\n  private textLayers: TextLayer[];\n\n  constructor(calculator: NetworkTimeCalculator.NetworkTimeCalculator) {\n    // TODO(allada) Make this a shadowDOM when the NetworkWaterfallColumn gets moved into NetworkLogViewColumns.\n    super();\n    this.registerRequiredCSS(networkWaterfallColumnStyles);\n\n    this.canvas = this.contentElement.createChild('canvas');\n    this.canvas.tabIndex = -1;\n    this.setDefaultFocusedElement(this.canvas);\n    this.canvasPosition = this.canvas.getBoundingClientRect();\n\n    this.leftPadding = 5;\n    this.fontSize = 10;\n\n    this.rightPadding = 0;\n    this.scrollTop = 0;\n\n    this.headerHeight = 0;\n    this.calculator = calculator;\n\n    this.rowHeight = 0;\n\n    this.offsetWidth = 0;\n    this.offsetHeight = 0;\n    this.startTime = this.calculator.minimumBoundary();\n    this.endTime = this.calculator.maximumBoundary();\n\n    this.popoverHelper =\n        new UI.PopoverHelper.PopoverHelper(this.element, this.getPopoverRequest.bind(this), 'network.timing');\n    this.popoverHelper.setTimeout(300, 300);\n\n    this.nodes = [];\n\n    this.hoveredNode = null;\n\n    this.eventDividers = new Map();\n\n    this.element.addEventListener('mousemove', this.onMouseMove.bind(this), true);\n    this.element.addEventListener('mouseleave', _event => this.setHoveredNode(null, false), true);\n    this.element.addEventListener('click', this.onClick.bind(this), true);\n\n    this.styleForTimeRangeName = NetworkWaterfallColumn.buildRequestTimeRangeStyle();\n\n    const resourceStyleTuple = NetworkWaterfallColumn.buildResourceTypeStyle();\n    this.styleForWaitingResourceType = resourceStyleTuple[0];\n    this.styleForDownloadingResourceType = resourceStyleTuple[1];\n\n    const baseLineColor = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-state-disabled');\n    this.wiskerStyle = {borderColor: baseLineColor, lineWidth: 1, fillStyle: undefined};\n    this.hoverDetailsStyle = {fillStyle: baseLineColor, lineWidth: 1, borderColor: baseLineColor};\n\n    this.pathForStyle = new Map();\n    this.textLayers = [];\n  }\n\n  private static buildRequestTimeRangeStyle(): Map<NetworkTimeCalculator.RequestTimeRangeNames, LayerStyle> {\n    const styleMap = new Map<NetworkTimeCalculator.RequestTimeRangeNames, LayerStyle>();\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.CONNECTING,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.CONNECTING]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.SSL,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.SSL]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.DNS,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.DNS]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.PROXY,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.PROXY]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.BLOCKING,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.BLOCKING]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.PUSH,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.PUSH]});\n    styleMap.set(NetworkTimeCalculator.RequestTimeRangeNames.QUEUEING, {\n      fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.QUEUEING],\n      lineWidth: 2,\n      borderColor: 'lightgrey',\n    });\n    // This ensures we always show at least 2 px for a request.\n    styleMap.set(NetworkTimeCalculator.RequestTimeRangeNames.RECEIVING, {\n      fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.RECEIVING],\n      lineWidth: 2,\n      borderColor: '#03A9F4',\n    });\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.WAITING,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.WAITING]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.RECEIVING_PUSH,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.RECEIVING_PUSH]});\n    styleMap.set(\n        NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER,\n        {fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER]});\n    styleMap.set(NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER_PREPARATION, {\n      fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER_PREPARATION]\n    });\n    styleMap.set(NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER_RESPOND_WITH, {\n      fillStyle: RequestTimeRangeNameToColor[NetworkTimeCalculator.RequestTimeRangeNames.SERVICE_WORKER_RESPOND_WITH],\n    });\n    return styleMap;\n  }\n\n  private static buildResourceTypeStyle(): Array<Map<Common.ResourceType.ResourceType, LayerStyle>> {\n    const baseResourceTypeColors = new Map([\n      ['document', 'hsl(215, 100%, 80%)'],\n      ['font', 'hsl(8, 100%, 80%)'],\n      ['media', 'hsl(90, 50%, 80%)'],\n      ['image', 'hsl(90, 50%, 80%)'],\n      ['script', 'hsl(31, 100%, 80%)'],\n      ['stylesheet', 'hsl(272, 64%, 80%)'],\n      ['texttrack', 'hsl(8, 100%, 80%)'],\n      ['websocket', 'hsl(0, 0%, 95%)'],\n      ['xhr', 'hsl(53, 100%, 80%)'],\n      ['fetch', 'hsl(53, 100%, 80%)'],\n      ['other', 'hsl(0, 0%, 95%)'],\n    ]);\n    const waitingStyleMap = new Map<Common.ResourceType.ResourceType, LayerStyle>();\n    const downloadingStyleMap = new Map<Common.ResourceType.ResourceType, LayerStyle>();\n\n    for (const resourceType of Object.values(Common.ResourceType.resourceTypes)) {\n      let color = baseResourceTypeColors.get(resourceType.name());\n      if (!color) {\n        color = baseResourceTypeColors.get('other');\n      }\n      const borderColor = toBorderColor((color as string));\n\n      waitingStyleMap.set(\n          // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n          // @ts-expect-error\n          resourceType, {fillStyle: toWaitingColor((color as string)), lineWidth: 1, borderColor});\n      // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n      // @ts-expect-error\n      downloadingStyleMap.set(resourceType, {fillStyle: color, lineWidth: 1, borderColor});\n    }\n    return [waitingStyleMap, downloadingStyleMap];\n\n    function toBorderColor(color: string): string|null {\n      const parsedColor = Common.Color.parse(color)?.as(Common.Color.Format.HSL);\n      if (!parsedColor) {\n        return '';\n      }\n      let {s, l} = parsedColor;\n      s /= 2;\n      l -= Math.min(l, 0.2);\n      return new Common.Color.HSL(parsedColor.h, s, l, parsedColor.alpha).asString();\n    }\n\n    function toWaitingColor(color: string): string|null {\n      const parsedColor = Common.Color.parse(color)?.as(Common.Color.Format.HSL);\n      if (!parsedColor) {\n        return '';\n      }\n      let {l} = parsedColor;\n      l *= 1.1;\n      return new Common.Color.HSL(parsedColor.h, parsedColor.s, l, parsedColor.alpha).asString();\n    }\n  }\n\n  private resetPaths(): void {\n    this.pathForStyle.clear();\n    this.pathForStyle.set(this.wiskerStyle, new Path2D());\n    this.styleForTimeRangeName.forEach(style => this.pathForStyle.set(style, new Path2D()));\n    this.styleForWaitingResourceType.forEach(style => this.pathForStyle.set(style, new Path2D()));\n    this.styleForDownloadingResourceType.forEach(style => this.pathForStyle.set(style, new Path2D()));\n    this.pathForStyle.set(this.hoverDetailsStyle, new Path2D());\n  }\n\n  override willHide(): void {\n    this.popoverHelper.hidePopover();\n    super.willHide();\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.update();\n  }\n\n  private onMouseMove(event: MouseEvent): void {\n    this.setHoveredNode(this.getNodeFromPoint(event.offsetY), event.shiftKey);\n  }\n\n  private onClick(event: MouseEvent): void {\n    const handled = this.setSelectedNode(this.getNodeFromPoint(event.offsetY));\n    if (handled) {\n      event.consume(true);\n    }\n  }\n\n  private getPopoverRequest(event: MouseEvent|KeyboardEvent): UI.PopoverHelper.PopoverRequest|null {\n    if (event instanceof KeyboardEvent) {\n      return null;\n    }\n    if (!this.hoveredNode) {\n      return null;\n    }\n    const request = this.hoveredNode.request();\n    if (!request) {\n      return null;\n    }\n    const useTimingBars =\n        !Common.Settings.Settings.instance().moduleSetting('network-color-code-resource-types').get() &&\n        !this.calculator.startAtZero;\n    let range;\n    let start;\n    let end;\n    if (useTimingBars) {\n      range = NetworkTimeCalculator.calculateRequestTimeRanges(request, 0)\n                  .find(data => data.name === NetworkTimeCalculator.RequestTimeRangeNames.TOTAL);\n      start = this.timeToPosition((range as NetworkTimeCalculator.RequestTimeRange).start);\n      end = this.timeToPosition((range as NetworkTimeCalculator.RequestTimeRange).end);\n    } else {\n      range = this.getSimplifiedBarRange(request, 0);\n      start = range.start;\n      end = range.end;\n    }\n\n    if (end - start < 50) {\n      const halfWidth = (end - start) / 2;\n      start = start + halfWidth - 25;\n      end = end - halfWidth + 25;\n    }\n\n    if (event.clientX < this.canvasPosition.left + start || event.clientX > this.canvasPosition.left + end) {\n      return null;\n    }\n\n    const rowIndex = this.nodes.findIndex(node => node.hovered());\n    const barHeight = this.getBarHeight((range as NetworkTimeCalculator.RequestTimeRange).name);\n    const y = this.headerHeight + (this.rowHeight * rowIndex - this.scrollTop) + ((this.rowHeight - barHeight) / 2);\n\n    if (event.clientY < this.canvasPosition.top + y || event.clientY > this.canvasPosition.top + y + barHeight) {\n      return null;\n    }\n\n    const anchorBox = this.element.boxInWindow();\n    anchorBox.x += start;\n    anchorBox.y += y;\n    anchorBox.width = end - start;\n    anchorBox.height = barHeight;\n\n    return {\n      box: anchorBox,\n      show: async (popover: UI.GlassPane.GlassPane) => {\n        const content = RequestTimingView.create(request, this.calculator);\n        await content.updateComplete;\n        content.show(popover.contentElement);\n        return true;\n      },\n      hide: undefined,\n    };\n  }\n\n  private setHoveredNode(node: NetworkNode|null, highlightInitiatorChain: boolean): void {\n    if (this.hoveredNode) {\n      this.hoveredNode.setHovered(false, false);\n    }\n    this.hoveredNode = node;\n    if (this.hoveredNode) {\n      this.hoveredNode.setHovered(true, highlightInitiatorChain);\n    }\n  }\n\n  private setSelectedNode(node: NetworkNode|null): boolean {\n    if (node?.dataGrid) {\n      node.select();\n      node.dataGrid.element.focus();\n      return true;\n    }\n    return false;\n  }\n\n  setRowHeight(height: number): void {\n    this.rowHeight = height;\n  }\n\n  setHeaderHeight(height: number): void {\n    this.headerHeight = height;\n  }\n\n  setRightPadding(padding: number): void {\n    this.rightPadding = padding;\n    this.calculateCanvasSize();\n  }\n\n  setCalculator(calculator: NetworkTimeCalculator.NetworkTimeCalculator): void {\n    this.calculator = calculator;\n  }\n\n  getNodeFromPoint(y: number): NetworkNode|null {\n    if (y <= this.headerHeight) {\n      return null;\n    }\n    return this.nodes[Math.floor((this.scrollTop + y - this.headerHeight) / this.rowHeight)];\n  }\n\n  scheduleDraw(): void {\n    void RenderCoordinator.write('NetworkWaterfallColumn.render', () => this.update());\n  }\n\n  update(scrollTop?: number, eventDividers?: Map<string, number[]>, nodes?: NetworkNode[]): void {\n    if (scrollTop !== undefined && this.scrollTop !== scrollTop) {\n      this.popoverHelper.hidePopover();\n      this.scrollTop = scrollTop;\n    }\n    if (nodes) {\n      this.nodes = nodes;\n      this.calculateCanvasSize();\n    }\n    if (eventDividers !== undefined) {\n      this.eventDividers = eventDividers;\n    }\n\n    this.startTime = this.calculator.minimumBoundary();\n    this.endTime = this.calculator.maximumBoundary();\n    this.resetCanvas();\n    this.resetPaths();\n    this.textLayers = [];\n    this.draw();\n  }\n\n  private resetCanvas(): void {\n    const ratio = window.devicePixelRatio;\n    this.canvas.width = this.offsetWidth * ratio;\n    this.canvas.height = this.offsetHeight * ratio;\n    this.canvas.style.width = this.offsetWidth + 'px';\n    this.canvas.style.height = this.offsetHeight + 'px';\n  }\n\n  override onResize(): void {\n    super.onResize();\n    this.calculateCanvasSize();\n    this.scheduleDraw();\n  }\n\n  private calculateCanvasSize(): void {\n    this.offsetWidth = this.contentElement.offsetWidth - this.rightPadding;\n    this.offsetHeight = this.contentElement.offsetHeight;\n    this.calculator.setDisplayWidth(this.offsetWidth);\n    this.canvasPosition = this.canvas.getBoundingClientRect();\n  }\n\n  private timeToPosition(time: number): number {\n    const availableWidth = this.offsetWidth - this.leftPadding;\n    const timeToPixel = availableWidth / (this.endTime - this.startTime);\n    return Math.floor(this.leftPadding + (time - this.startTime) * timeToPixel);\n  }\n\n  private didDrawForTest(): void {\n  }\n\n  private draw(): void {\n    const useTimingBars =\n        !Common.Settings.Settings.instance().moduleSetting('network-color-code-resource-types').get() &&\n        !this.calculator.startAtZero;\n    const nodes = this.nodes;\n    const context = (this.canvas.getContext('2d'));\n    if (!context) {\n      return;\n    }\n    context.save();\n    context.scale(window.devicePixelRatio, window.devicePixelRatio);\n    context.translate(0, this.headerHeight);\n    context.rect(0, 0, this.offsetWidth, this.offsetHeight);\n    context.clip();\n    const firstRequestIndex = Math.floor(this.scrollTop / this.rowHeight);\n    const lastRequestIndex = Math.min(nodes.length, firstRequestIndex + Math.ceil(this.offsetHeight / this.rowHeight));\n    for (let i = firstRequestIndex; i < lastRequestIndex; i++) {\n      const rowOffset = this.rowHeight * i;\n      const node = nodes[i];\n      this.decorateRow(context, node, rowOffset - this.scrollTop);\n      let drawNodes: NetworkNode[] = [];\n      if (node.hasChildren() && !node.expanded) {\n        drawNodes = (node.flatChildren() as NetworkNode[]);\n      }\n      drawNodes.push(node);\n      for (const drawNode of drawNodes) {\n        if (useTimingBars) {\n          this.buildTimingBarLayers(drawNode, rowOffset - this.scrollTop);\n        } else {\n          this.buildSimplifiedBarLayers(context, drawNode, rowOffset - this.scrollTop);\n        }\n      }\n    }\n    this.drawLayers(context, useTimingBars);\n\n    context.save();\n    context.fillStyle = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-state-disabled');\n    for (const textData of this.textLayers) {\n      context.fillText(textData.text, textData.x, textData.y);\n    }\n    context.restore();\n\n    this.drawEventDividers(context);\n    context.restore();\n\n    const freeZoneAtLeft = 75;\n    const freeZoneAtRight = 18;\n    const dividersData = PerfUI.TimelineGrid.TimelineGrid.calculateGridOffsets(this.calculator);\n    PerfUI.TimelineGrid.TimelineGrid.drawCanvasGrid(context, dividersData);\n    PerfUI.TimelineGrid.TimelineGrid.drawCanvasHeaders(\n        context, dividersData, time => this.calculator.formatValue(time, dividersData.precision), this.fontSize,\n        this.headerHeight, freeZoneAtLeft);\n    context.save();\n    context.scale(window.devicePixelRatio, window.devicePixelRatio);\n    context.clearRect(this.offsetWidth - freeZoneAtRight, 0, freeZoneAtRight, this.headerHeight);\n    context.restore();\n    this.didDrawForTest();\n  }\n\n  private drawLayers(context: CanvasRenderingContext2D, useTimingBars: boolean): void {\n    for (const entry of this.pathForStyle) {\n      const style = (entry[0]);\n      const path = (entry[1]);\n      context.save();\n      context.beginPath();\n      if (style.lineWidth) {\n        context.lineWidth = style.lineWidth;\n        if (style.borderColor) {\n          context.strokeStyle = style.borderColor;\n        }\n        context.stroke(path);\n      }\n      if (style.fillStyle) {\n        context.fillStyle =\n            useTimingBars ? ThemeSupport.ThemeSupport.instance().getComputedValue(style.fillStyle) : style.fillStyle;\n        context.fill(path);\n      }\n      context.restore();\n    }\n  }\n\n  private drawEventDividers(context: CanvasRenderingContext2D): void {\n    context.save();\n    context.lineWidth = 1;\n    for (const color of this.eventDividers.keys()) {\n      context.strokeStyle = color;\n      for (const time of this.eventDividers.get(color) || []) {\n        context.beginPath();\n        const x = this.timeToPosition(time);\n        context.moveTo(x, 0);\n        context.lineTo(x, this.offsetHeight);\n      }\n      context.stroke();\n    }\n    context.restore();\n  }\n\n  private getBarHeight(type?: NetworkTimeCalculator.RequestTimeRangeNames): number {\n    switch (type) {\n      case NetworkTimeCalculator.RequestTimeRangeNames.CONNECTING:\n      case NetworkTimeCalculator.RequestTimeRangeNames.SSL:\n      case NetworkTimeCalculator.RequestTimeRangeNames.DNS:\n      case NetworkTimeCalculator.RequestTimeRangeNames.PROXY:\n      case NetworkTimeCalculator.RequestTimeRangeNames.BLOCKING:\n      case NetworkTimeCalculator.RequestTimeRangeNames.PUSH:\n      case NetworkTimeCalculator.RequestTimeRangeNames.QUEUEING:\n        return 7;\n      default:\n        return 13;\n    }\n  }\n\n  // Used when `network-color-code-resource-types` is true\n  private getSimplifiedBarRange(request: SDK.NetworkRequest.NetworkRequest, borderOffset: number): {\n    start: number,\n    mid: number,\n    end: number,\n  } {\n    const drawWidth = this.offsetWidth - this.leftPadding;\n    const percentages = this.calculator.computeBarGraphPercentages(request);\n    return {\n      start: this.leftPadding + Math.floor((percentages.start / 100) * drawWidth) + borderOffset,\n      mid: this.leftPadding + Math.floor((percentages.middle / 100) * drawWidth) + borderOffset,\n      end: this.leftPadding + Math.floor((percentages.end / 100) * drawWidth) + borderOffset,\n    };\n  }\n\n  // Used when `network-color-code-resource-types` is true\n  private buildSimplifiedBarLayers(context: CanvasRenderingContext2D, node: NetworkNode, y: number): void {\n    const request = node.request();\n    if (!request) {\n      return;\n    }\n    const borderWidth = 1;\n    const borderOffset = borderWidth % 2 === 0 ? 0 : 0.5;\n\n    const ranges = this.getSimplifiedBarRange(request, borderOffset);\n    const height = this.getBarHeight();\n    y += Math.floor(this.rowHeight / 2 - height / 2 + borderWidth) - borderWidth / 2;\n\n    const waitingStyle = (this.styleForWaitingResourceType.get(request.resourceType()) as LayerStyle);\n    const waitingPath = (this.pathForStyle.get(waitingStyle) as Path2D);\n    waitingPath.rect(ranges.start, y, ranges.mid - ranges.start, height - borderWidth);\n\n    const barWidth = Math.max(2, ranges.end - ranges.mid);\n    const downloadingStyle = (this.styleForDownloadingResourceType.get(request.resourceType()) as LayerStyle);\n    const downloadingPath = (this.pathForStyle.get(downloadingStyle) as Path2D);\n    downloadingPath.rect(ranges.mid, y, barWidth, height - borderWidth);\n\n    let labels: NetworkTimeCalculator.Label|null = null;\n    if (node.hovered()) {\n      labels = this.calculator.computeBarGraphLabels(request);\n      const barDotLineLength = 10;\n      const leftLabelWidth = context.measureText(labels.left).width;\n      const rightLabelWidth = context.measureText(labels.right).width;\n      const hoverLinePath = (this.pathForStyle.get(this.hoverDetailsStyle) as Path2D);\n\n      if (leftLabelWidth < ranges.mid - ranges.start) {\n        const midBarX = ranges.start + (ranges.mid - ranges.start - leftLabelWidth) / 2;\n        this.textLayers.push({text: labels.left, x: midBarX, y: y + this.fontSize});\n      } else if (barDotLineLength + leftLabelWidth + this.leftPadding < ranges.start) {\n        this.textLayers.push(\n            {text: labels.left, x: ranges.start - leftLabelWidth - barDotLineLength - 1, y: y + this.fontSize});\n        hoverLinePath.moveTo(ranges.start - barDotLineLength, y + Math.floor(height / 2));\n        hoverLinePath.arc(ranges.start, y + Math.floor(height / 2), 2, 0, 2 * Math.PI);\n        hoverLinePath.moveTo(ranges.start - barDotLineLength, y + Math.floor(height / 2));\n        hoverLinePath.lineTo(ranges.start, y + Math.floor(height / 2));\n      }\n\n      const endX = ranges.mid + barWidth + borderOffset;\n      if (rightLabelWidth < endX - ranges.mid) {\n        const midBarX = ranges.mid + (endX - ranges.mid - rightLabelWidth) / 2;\n        this.textLayers.push({text: labels.right, x: midBarX, y: y + this.fontSize});\n      } else if (endX + barDotLineLength + rightLabelWidth < this.offsetWidth - this.leftPadding) {\n        this.textLayers.push({text: labels.right, x: endX + barDotLineLength + 1, y: y + this.fontSize});\n        hoverLinePath.moveTo(endX, y + Math.floor(height / 2));\n        hoverLinePath.arc(endX, y + Math.floor(height / 2), 2, 0, 2 * Math.PI);\n        hoverLinePath.moveTo(endX, y + Math.floor(height / 2));\n        hoverLinePath.lineTo(endX + barDotLineLength, y + Math.floor(height / 2));\n      }\n    }\n\n    if (!this.calculator.startAtZero) {\n      const queueingRange =\n          (NetworkTimeCalculator.calculateRequestTimeRanges(request, 0)\n               .find(data => data.name === NetworkTimeCalculator.RequestTimeRangeNames.TOTAL) as\n           NetworkTimeCalculator.RequestTimeRange);\n      const leftLabelWidth = labels ? context.measureText(labels.left).width : 0;\n      const leftTextPlacedInBar = leftLabelWidth < ranges.mid - ranges.start;\n      const wiskerTextPadding = 13;\n      const textOffset = (labels && !leftTextPlacedInBar) ? leftLabelWidth + wiskerTextPadding : 0;\n      const queueingStart = this.timeToPosition(queueingRange.start);\n      if (ranges.start - textOffset > queueingStart) {\n        const wiskerPath = (this.pathForStyle.get(this.wiskerStyle) as Path2D);\n        wiskerPath.moveTo(queueingStart, y + Math.floor(height / 2));\n        wiskerPath.lineTo(ranges.start - textOffset, y + Math.floor(height / 2));\n\n        // TODO(allada) This needs to be floored.\n        const wiskerHeight = height / 2;\n        wiskerPath.moveTo(queueingStart + borderOffset, y + wiskerHeight / 2);\n        wiskerPath.lineTo(queueingStart + borderOffset, y + height - wiskerHeight / 2 - 1);\n      }\n    }\n  }\n\n  private buildTimingBarLayers(node: NetworkNode, y: number): void {\n    const request = node.request();\n    if (!request) {\n      return;\n    }\n    const ranges = NetworkTimeCalculator.calculateRequestTimeRanges(request, 0);\n    let index = 0;\n    for (const range of ranges) {\n      if (range.name === NetworkTimeCalculator.RequestTimeRangeNames.TOTAL ||\n          range.name === NetworkTimeCalculator.RequestTimeRangeNames.SENDING || range.end - range.start === 0) {\n        continue;\n      }\n\n      const style = (this.styleForTimeRangeName.get(range.name) as LayerStyle);\n      const path = (this.pathForStyle.get(style) as Path2D);\n      const lineWidth = style.lineWidth || 0;\n      const height = this.getBarHeight(range.name);\n      const middleBarY = y + Math.floor(this.rowHeight / 2 - height / 2) + lineWidth / 2;\n      const start = this.timeToPosition(range.start);\n      const end = this.timeToPosition(range.end);\n      path.rect(start + (index * BAR_SPACING), middleBarY, end - start, height - lineWidth);\n      index++;\n    }\n  }\n\n  private decorateRow(context: CanvasRenderingContext2D, node: NetworkNode, y: number): void {\n    const nodeBgColorId = node.backgroundColor();\n    context.save();\n    context.beginPath();\n    context.fillStyle = ThemeSupport.ThemeSupport.instance().getComputedValue(nodeBgColorId);\n    context.rect(0, y, this.offsetWidth, this.rowHeight);\n    context.fill();\n    context.restore();\n  }\n}\n\ninterface TextLayer {\n  x: number;\n  y: number;\n  text: string;\n}\n\ninterface LayerStyle {\n  fillStyle?: string;\n  lineWidth?: number;\n  borderColor?: string;\n}\n"]}