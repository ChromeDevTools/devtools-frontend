{"version":3,"file":"RequestDeviceBoundSessionsView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/RequestDeviceBoundSessionsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2026 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/legacy/components/data_grid/data_grid.js';\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {html, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport requestDeviceBoundSessionsViewStyles from './requestDeviceBoundSessionsView.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Heading for the ID of a session.\n   */\n  sessionId: 'Session ID',\n  /**\n   * @description Heading for the decision on whether an HTTP request was deferred. (i.e. paused and\n   * later unpaused).\n   */\n  deferralDecision: 'Deferral decision',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was deferred (i.e. paused and later unpaused). The reasoning for the deferral\n   * is that there was a refresh.\n   */\n  deferred: 'Deferred (Refresh)',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was not deferred (i.e. not paused and later unpaused). The reasoning for it\n   * not being deferred is that there was a refresh attempted proactively.\n   */\n  proactiveRefreshAttempted: 'Not deferred (Proactive refresh attempted)',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was not deferred (i.e. not paused and later unpaused). The reasoning for it\n   * not being deferred is that while the HTTP request is in scope of a session, it was\n   * not possible to trigger a refresh proactively.\n   */\n  proactiveRefreshNotPossible: 'Not deferred (Request is in scope of session but proactive refresh is not possible)',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was not deferred (i.e. not paused and later unpaused). The reasoning for it\n   * not being deferred is that while the HTTP request is in scope of a session, the HTTP\n   * request's initiator is not allowed to trigger a refresh.\n   */\n  inScopeRefreshNotAllowed:\n      'Not deferred (Request is in scope of session but initiator is not allowed to trigger refresh)',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was not deferred (i.e. not paused and later unpaused). The reasoning for it\n   * not being deferred is that while the HTTP request is in scope of a session, the\n   * session's cookies are still present, so there is no need to trigger a refresh yet.\n   */\n  inScopeRefreshNotYetNeeded: 'Not deferred (Request is in scope of session but cookies are still present)',\n  /**\n   * @description One of the HTTP request deferral decisions. This one notes that the\n   * request was not deferred (i.e. not paused and later unpaused). The reasoning for it\n   * not being deferred is that the HTTP request is not in scope of a session.\n   */\n  notInScope: 'Not deferred (Request is not in scope of session)',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/network/RequestDeviceBoundSessionsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface ViewInput {\n  deviceBoundSessionUsages: Protocol.Network.DeviceBoundSessionWithUsage[];\n}\n\ntype ViewOutput = object;\n\nexport const DEFAULT_VIEW = (input: ViewInput, _output: ViewOutput, target: HTMLElement): void => {\n  const {deviceBoundSessionUsages} = input;\n\n  render(\n      html`\n      <style>${UI.inspectorCommonStyles}</style>\n      <style>${requestDeviceBoundSessionsViewStyles}</style>\n      <div class=\"request-device-bound-sessions-view\">\n        ${\n          deviceBoundSessionUsages.length > 0 ? html`\n            <div class=\"device-bound-session-grid-wrapper\">\n              <devtools-data-grid striped inline>\n                <table>\n                  <thead>\n                    <tr>\n                      <th id=\"session-id\" sortable>${i18nString(UIStrings.sessionId)}</th>\n                      <th id=\"deferral-decision\" sortable>${i18nString(UIStrings.deferralDecision)}</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    ${deviceBoundSessionUsages.map(session => html`\n                      <tr>\n                        <td>${session.sessionKey.id}</td>\n                        <td>${getDeferralDecision(session.usage)}</td>\n                      </tr>\n                    `)}\n                  </tbody>\n                </table>\n              </devtools-data-grid>\n            </div>\n          ` :\n                                                nothing}\n      </div>\n    `,\n      target);\n};\n\nexport class RequestDeviceBoundSessionsView extends UI.Widget.VBox {\n  #request: SDK.NetworkRequest.NetworkRequest;\n  #view: typeof DEFAULT_VIEW;\n\n  constructor(request: SDK.NetworkRequest.NetworkRequest, view: typeof DEFAULT_VIEW = DEFAULT_VIEW) {\n    super({jslog: `${VisualLogging.pane('device-bound-sessions-request')}`});\n    this.#request = request;\n    this.#view = view;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.#request.addEventListener(SDK.NetworkRequest.Events.RESPONSE_HEADERS_CHANGED, this.performUpdate, this);\n    this.performUpdate();\n  }\n\n  override willHide(): void {\n    super.willHide();\n    this.#request.removeEventListener(SDK.NetworkRequest.Events.RESPONSE_HEADERS_CHANGED, this.performUpdate, this);\n  }\n\n  override performUpdate(): void {\n    if (!this.isShowing()) {\n      return;\n    }\n    this.#view({deviceBoundSessionUsages: this.#request.getDeviceBoundSessionUsages()}, {}, this.contentElement);\n  }\n}\n\nfunction getDeferralDecision(usage: Protocol.Network.DeviceBoundSessionWithUsageUsage): string {\n  switch (usage) {\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.NotInScope:\n      return i18nString(UIStrings.notInScope);\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.InScopeRefreshNotYetNeeded:\n      return i18nString(UIStrings.inScopeRefreshNotYetNeeded);\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.InScopeRefreshNotAllowed:\n      return i18nString(UIStrings.inScopeRefreshNotAllowed);\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.ProactiveRefreshNotPossible:\n      return i18nString(UIStrings.proactiveRefreshNotPossible);\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.ProactiveRefreshAttempted:\n      return i18nString(UIStrings.proactiveRefreshAttempted);\n    case Protocol.Network.DeviceBoundSessionWithUsageUsage.Deferred:\n      return i18nString(UIStrings.deferred);\n    default:\n      return usage;\n  }\n}\n"]}