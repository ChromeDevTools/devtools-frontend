{"version":3,"file":"EditableSpan.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/network/components/EditableSpan.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-lit-render-outside-of-view */\n\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport {html, render} from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport editableSpanStyles from './EditableSpan.css.js';\n\nexport interface EditableSpanData {\n  value: string;\n}\n\nexport class EditableSpan extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #value = '';\n\n  connectedCallback(): void {\n    this.#shadow.addEventListener('focusin', this.#selectAllText.bind(this));\n    this.#shadow.addEventListener('keydown', this.#onKeyDown.bind(this));\n    this.#shadow.addEventListener('input', this.#onInput.bind(this));\n  }\n\n  set data(data: EditableSpanData) {\n    this.#value = data.value;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  }\n\n  get value(): string {\n    return this.#shadow.querySelector<HTMLSpanElement>('span')?.innerText || '';\n  }\n\n  set value(value: string) {\n    this.#value = value;\n    const span = this.#shadow.querySelector<HTMLSpanElement>('span');\n    if (span) {\n      span.innerText = value;\n    }\n  }\n\n  #onKeyDown(event: Event): void {\n    if ((event as KeyboardEvent).key === 'Enter') {\n      event.preventDefault();\n      (event.target as HTMLElement)?.blur();\n    }\n  }\n\n  #onInput(event: Event): void {\n    this.#value = (event.target as HTMLElement).innerText;\n  }\n\n  #selectAllText(event: Event): void {\n    const target = event.target as HTMLElement;\n    const selection = window.getSelection();\n    const range = document.createRange();\n    range.selectNodeContents(target);\n    selection?.removeAllRanges();\n    selection?.addRange(range);\n  }\n\n  #render(): void {\n    if (!ComponentHelpers.ScheduledRender.isScheduledRender(this)) {\n      throw new Error('HeaderSectionRow render was not scheduled');\n    }\n\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <style>${editableSpanStyles}</style>\n      <span\n        contenteditable=\"plaintext-only\"\n        class=\"editable\"\n        tabindex=\"0\"\n        .innerText=${this.#value}\n        jslog=${VisualLogging.value('header-editor').track({change: true, keydown: 'Enter|Escape'})}\n      </span>`, this.#shadow, {host: this});\n    // clang-format on\n  }\n\n  override focus(): void {\n    requestAnimationFrame(() => {\n      const span = this.#shadow.querySelector<HTMLElement>('.editable');\n      span?.focus();\n    });\n  }\n}\n\ncustomElements.define('devtools-editable-span', EditableSpan);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-editable-span': EditableSpan;\n  }\n}\n"]}