{"version":3,"file":"RequestHeaderSection.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/network/components/RequestHeaderSection.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-lit-render-outside-of-view */\n\nimport '../../../ui/legacy/legacy.js';\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Platform from '../../../core/platform/platform.js';\nimport type * as SDK from '../../../core/sdk/sdk.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\nimport * as NetworkForward from '../forward/forward.js';\n\nimport {EditingAllowedStatus, type HeaderDescriptor} from './HeaderSectionRow.js';\nimport requestHeaderSectionStyles from './RequestHeaderSection.css.js';\n\nconst {render, html} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Text that is usually a hyperlink to more documentation\n   */\n  learnMore: 'Learn more',\n  /**\n   * @description Message to explain lack of raw headers for a particular network request\n   */\n  provisionalHeadersAreShownDisableCache: 'Provisional headers are shown. Disable cache to see full headers.',\n  /**\n   * @description Tooltip to explain lack of raw headers for a particular network request\n   */\n  onlyProvisionalHeadersAre:\n      'Only provisional headers are available because this request was not sent over the network and instead was served from a local cache, which doesnâ€™t store the original request headers. Disable cache to see full request headers.',\n  /**\n   * @description Message to explain lack of raw headers for a particular network request\n   */\n  provisionalHeadersAreShown: 'Provisional headers are shown.',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/network/components/RequestHeaderSection.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface RequestHeaderSectionData {\n  request: SDK.NetworkRequest.NetworkRequest;\n  toReveal?: {section: NetworkForward.UIRequestLocation.UIHeaderSection, header?: string};\n}\n\nexport class RequestHeaderSection extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #request?: Readonly<SDK.NetworkRequest.NetworkRequest>;\n  #headers: HeaderDescriptor[] = [];\n\n  set data(data: RequestHeaderSectionData) {\n    this.#request = data.request;\n\n    this.#headers = this.#request.requestHeaders().map(header => ({\n                                                         name: Platform.StringUtilities.toLowerCaseString(header.name),\n                                                         value: header.value,\n                                                         valueEditable: EditingAllowedStatus.FORBIDDEN,\n                                                       }));\n    this.#headers.sort((a, b) => Platform.StringUtilities.compare(a.name, b.name));\n\n    if (data.toReveal?.section === NetworkForward.UIRequestLocation.UIHeaderSection.REQUEST) {\n      this.#headers.filter(header => header.name === data.toReveal?.header?.toLowerCase()).forEach(header => {\n        header.highlight = true;\n      });\n    }\n\n    this.#render();\n  }\n\n  #render(): void {\n    if (!this.#request) {\n      return;\n    }\n\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <style>${requestHeaderSectionStyles}</style>\n      ${this.#maybeRenderProvisionalHeadersWarning()}\n      ${this.#headers.map(header => html`\n        <devtools-header-section-row\n          .data=${{header}}\n          jslog=${VisualLogging.item('request-header')}\n        ></devtools-header-section-row>\n      `)}\n    `, this.#shadow, {host: this});\n    // clang-format on\n  }\n\n  #maybeRenderProvisionalHeadersWarning(): Lit.LitTemplate {\n    if (!this.#request || this.#request.requestHeadersText() !== undefined) {\n      return Lit.nothing;\n    }\n\n    let cautionText;\n    let cautionTitle = '';\n    if (this.#request.cachedInMemory() || this.#request.cached()) {\n      cautionText = i18nString(UIStrings.provisionalHeadersAreShownDisableCache);\n      cautionTitle = i18nString(UIStrings.onlyProvisionalHeadersAre);\n    } else {\n      cautionText = i18nString(UIStrings.provisionalHeadersAreShown);\n    }\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    return html`\n      <div class=\"call-to-action\">\n        <div class=\"call-to-action-body\">\n          <div class=\"explanation\" title=${cautionTitle}>\n            <devtools-icon class=\"inline-icon medium\" name='warning-filled'>\n            </devtools-icon>\n            ${cautionText} <x-link href=\"https://developer.chrome.com/docs/devtools/network/reference/#provisional-headers\" class=\"link\">${i18nString(UIStrings.learnMore)}</x-link>\n          </div>\n        </div>\n      </div>\n    `;\n    // clang-format on\n  }\n}\n\ncustomElements.define('devtools-request-header-section', RequestHeaderSection);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-request-header-section': RequestHeaderSection;\n  }\n}\n"]}