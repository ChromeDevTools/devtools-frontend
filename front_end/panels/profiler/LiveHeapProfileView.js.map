{"version":3,"file":"LiveHeapProfileView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/profiler/LiveHeapProfileView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2019 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport '../../ui/legacy/legacy.js';\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as DataGrid from '../../ui/legacy/components/data_grid/data_grid.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport liveHeapProfileStyles from './liveHeapProfile.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Text for a heap profile type\n   */\n  jsHeap: 'JS Heap',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   */\n  allocatedJsHeapSizeCurrentlyIn: 'Allocated JS heap size currently in use',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   */\n  vms: 'VMs',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   */\n  numberOfVmsSharingTheSameScript: 'Number of VMs sharing the same script source',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   */\n  scriptUrl: 'Script URL',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   */\n  urlOfTheScriptSource: 'URL of the script source',\n  /**\n   * @description Data grid name for Heap Profile data grids\n   */\n  heapProfile: 'Heap Profile',\n  /**\n   * @description Text in Live Heap Profile View of a profiler tool\n   * @example {1} PH1\n   */\n  anonymousScriptS: '(Anonymous Script {PH1})',\n  /**\n   * @description A unit\n   */\n  kb: 'kB',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/profiler/LiveHeapProfileView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nlet liveHeapProfileViewInstance: LiveHeapProfileView;\nexport class LiveHeapProfileView extends UI.Widget.VBox {\n  readonly gridNodeByUrl: Map<string, GridNode>;\n  setting: Common.Settings.Setting<boolean>;\n  readonly toggleRecordAction: UI.ActionRegistration.Action;\n  readonly toggleRecordButton: UI.Toolbar.ToolbarToggle;\n  readonly startWithReloadButton: UI.Toolbar.ToolbarButton|undefined;\n  readonly dataGrid: DataGrid.SortableDataGrid.SortableDataGrid<GridNode>;\n  currentPollId: number;\n\n  private constructor() {\n    super({useShadowDom: true});\n    this.gridNodeByUrl = new Map();\n    this.registerRequiredCSS(liveHeapProfileStyles);\n\n    this.setting = Common.Settings.Settings.instance().moduleSetting('memory-live-heap-profile');\n    const toolbar = this.contentElement.createChild('devtools-toolbar', 'live-heap-profile-toolbar');\n    this.toggleRecordAction =\n        UI.ActionRegistry.ActionRegistry.instance().getAction('live-heap-profile.toggle-recording');\n    this.toggleRecordButton =\n        (UI.Toolbar.Toolbar.createActionButton(this.toggleRecordAction) as UI.Toolbar.ToolbarToggle);\n    this.toggleRecordButton.setToggled(this.setting.get());\n    toolbar.appendToolbarItem(this.toggleRecordButton);\n\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (mainTarget?.model(SDK.ResourceTreeModel.ResourceTreeModel)) {\n      const startWithReloadAction =\n          UI.ActionRegistry.ActionRegistry.instance().getAction('live-heap-profile.start-with-reload');\n      this.startWithReloadButton = UI.Toolbar.Toolbar.createActionButton(startWithReloadAction);\n      toolbar.appendToolbarItem(this.startWithReloadButton);\n    }\n\n    this.dataGrid = this.createDataGrid();\n    this.dataGrid.asWidget().show(this.contentElement);\n\n    this.currentPollId = 0;\n  }\n\n  static instance(): LiveHeapProfileView {\n    if (!liveHeapProfileViewInstance) {\n      liveHeapProfileViewInstance = new LiveHeapProfileView();\n    }\n    return liveHeapProfileViewInstance;\n  }\n\n  createDataGrid(): DataGrid.SortableDataGrid.SortableDataGrid<GridNode> {\n    const defaultColumnConfig: DataGrid.DataGrid.ColumnDescriptor = {\n      id: '',\n      title: Common.UIString.LocalizedEmptyString,\n      width: undefined,\n      fixedWidth: true,\n      sortable: true,\n      align: DataGrid.DataGrid.Align.RIGHT,\n      sort: DataGrid.DataGrid.Order.Descending,\n      titleDOMFragment: undefined,\n      editable: undefined,\n      nonSelectable: undefined,\n      longText: undefined,\n      disclosure: undefined,\n      weight: undefined,\n      allowInSortByEvenWhenHidden: undefined,\n      dataType: undefined,\n      defaultWeight: undefined,\n    };\n    const columns = [\n      {\n        ...defaultColumnConfig,\n        id: 'size',\n        title: i18nString(UIStrings.jsHeap),\n        width: '72px',\n        fixedWidth: true,\n        sortable: true,\n        align: DataGrid.DataGrid.Align.RIGHT,\n        sort: DataGrid.DataGrid.Order.Descending,\n        tooltip: i18nString(UIStrings.allocatedJsHeapSizeCurrentlyIn),\n      },\n      {\n        ...defaultColumnConfig,\n        id: 'isolates',\n        title: i18nString(UIStrings.vms),\n        width: '40px',\n        fixedWidth: true,\n        align: DataGrid.DataGrid.Align.RIGHT,\n        tooltip: i18nString(UIStrings.numberOfVmsSharingTheSameScript),\n      },\n      {\n        ...defaultColumnConfig,\n        id: 'url',\n        title: i18nString(UIStrings.scriptUrl),\n        fixedWidth: false,\n        sortable: true,\n        tooltip: i18nString(UIStrings.urlOfTheScriptSource),\n      },\n    ] as Array<{tooltip: Common.UIString.LocalizedString}&DataGrid.DataGrid.ColumnDescriptor>;\n    const dataGrid = new DataGrid.SortableDataGrid.SortableDataGrid({\n      displayName: i18nString(UIStrings.heapProfile),\n      columns,\n      deleteCallback: undefined,\n      refreshCallback: undefined,\n    });\n    dataGrid.setResizeMethod(DataGrid.DataGrid.ResizeMethod.LAST);\n    dataGrid.element.classList.add('flex-auto');\n    dataGrid.element.addEventListener('keydown', this.onKeyDown.bind(this), false);\n    dataGrid.addEventListener(DataGrid.DataGrid.Events.OPENED_NODE, this.revealSourceForSelectedNode, this);\n    dataGrid.addEventListener(DataGrid.DataGrid.Events.SORTING_CHANGED, this.sortingChanged, this);\n    for (const info of columns) {\n      const headerCell = dataGrid.headerTableHeader(info.id);\n      if (headerCell) {\n        headerCell.setAttribute('title', info.tooltip);\n      }\n    }\n    return dataGrid;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    void this.poll();\n    this.setting.addChangeListener(this.settingChanged, this);\n  }\n\n  override willHide(): void {\n    super.willHide();\n    ++this.currentPollId;\n    this.setting.removeChangeListener(this.settingChanged, this);\n  }\n\n  settingChanged(value: Common.EventTarget.EventTargetEvent<boolean>): void {\n    this.toggleRecordButton.setToggled(value.data);\n  }\n\n  async poll(): Promise<void> {\n    const pollId = this.currentPollId;\n    do {\n      const isolates = Array.from(SDK.IsolateManager.IsolateManager.instance().isolates());\n      const profiles = await Promise.all(isolates.map(isolate => {\n        const heapProfilerModel = isolate.heapProfilerModel();\n        if (!heapProfilerModel) {\n          return null;\n        }\n\n        return heapProfilerModel.getSamplingProfile();\n      }));\n      if (this.currentPollId !== pollId) {\n        return;\n      }\n      this.update(isolates, profiles);\n      await new Promise(r => window.setTimeout(r, 3000));\n    } while (this.currentPollId === pollId);\n  }\n\n  update(\n      isolates: SDK.IsolateManager.Isolate[] = [],\n      profiles: Array<Protocol.HeapProfiler.SamplingHeapProfile|null> = []): void {\n    const dataByUrl = new Map<string, {\n      size: number,\n      isolates: Set<SDK.IsolateManager.Isolate>,\n    }>();\n    profiles.forEach((profile, index) => {\n      if (profile) {\n        processNodeTree(isolates[index], '', profile.head);\n      }\n    });\n\n    const rootNode = this.dataGrid.rootNode();\n    const existingNodes = new Set<GridNode>();\n    for (const pair of dataByUrl) {\n      const url = (pair[0]);\n      const size = (pair[1].size);\n      const isolateCount = (pair[1].isolates.size);\n      if (!url) {\n        console.info(`Node with empty URL: ${size} bytes`);  // eslint-disable-line no-console\n        continue;\n      }\n      let node = this.gridNodeByUrl.get(url);\n      if (node) {\n        node.updateNode(size, isolateCount);\n      } else {\n        node = new GridNode(url, size, isolateCount);\n        this.gridNodeByUrl.set(url, node);\n        rootNode.appendChild(node);\n      }\n      existingNodes.add(node);\n    }\n\n    for (const node of rootNode.children.slice()) {\n      const gridNode = node as GridNode;\n      if (!existingNodes.has(gridNode)) {\n        gridNode.remove();\n      }\n      this.gridNodeByUrl.delete(gridNode.url);\n    }\n\n    this.sortingChanged();\n\n    function processNodeTree(\n        isolate: SDK.IsolateManager.Isolate, parentUrl: string,\n        node: Protocol.HeapProfiler.SamplingHeapProfileNode): void {\n      const url = node.callFrame.url || parentUrl || systemNodeName(node) || anonymousScriptName(node);\n      node.children.forEach(processNodeTree.bind(null, isolate, url));\n      if (!node.selfSize) {\n        return;\n      }\n      let data = dataByUrl.get(url);\n      if (!data) {\n        data = {size: 0, isolates: new Set()};\n        dataByUrl.set(url, data);\n      }\n      data.size += node.selfSize;\n      data.isolates.add(isolate);\n    }\n\n    function systemNodeName(node: Protocol.HeapProfiler.SamplingHeapProfileNode): string {\n      const name = node.callFrame.functionName;\n      return name.startsWith('(') && name !== '(root)' ? name : '';\n    }\n\n    function anonymousScriptName(node: Protocol.HeapProfiler.SamplingHeapProfileNode): string {\n      return Number(node.callFrame.scriptId) ? i18nString(UIStrings.anonymousScriptS, {PH1: node.callFrame.scriptId}) :\n                                               '';\n    }\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (!(event.key === 'Enter')) {\n      return;\n    }\n    event.consume(true);\n    this.revealSourceForSelectedNode();\n  }\n\n  revealSourceForSelectedNode(): void {\n    const node = (this.dataGrid.selectedNode as GridNode);\n    if (!node?.url) {\n      return;\n    }\n    const sourceCode =\n        Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(node.url as Platform.DevToolsPath.UrlString);\n    if (sourceCode) {\n      void Common.Revealer.reveal(sourceCode);\n    }\n  }\n\n  sortingChanged(): void {\n    const columnId = this.dataGrid.sortColumnId();\n    if (!columnId) {\n      return;\n    }\n\n    function sortByUrl(\n        a: DataGrid.SortableDataGrid.SortableDataGridNode<GridNode>,\n        b: DataGrid.SortableDataGrid.SortableDataGridNode<GridNode>): number {\n      return (b as GridNode).url.localeCompare((a as GridNode).url);\n    }\n\n    function sortBySize(\n        a: DataGrid.SortableDataGrid.SortableDataGridNode<GridNode>,\n        b: DataGrid.SortableDataGrid.SortableDataGridNode<GridNode>): number {\n      return (b as GridNode).size - (a as GridNode).size;\n    }\n\n    const sortFunction = columnId === 'url' ? sortByUrl : sortBySize;\n    this.dataGrid.sortNodes(sortFunction, this.dataGrid.isSortOrderAscending());\n  }\n\n  toggleRecording(): void {\n    const enable = !this.setting.get();\n    if (enable) {\n      this.startRecording(false);\n    } else {\n      void this.stopRecording();\n    }\n  }\n\n  startRecording(reload?: boolean): void {\n    this.setting.set(true);\n    if (!reload) {\n      return;\n    }\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (!mainTarget) {\n      return;\n    }\n    const resourceTreeModel = (mainTarget.model(SDK.ResourceTreeModel.ResourceTreeModel));\n    if (resourceTreeModel) {\n      resourceTreeModel.reloadPage();\n    }\n  }\n\n  async stopRecording(): Promise<void> {\n    this.setting.set(false);\n  }\n}\n\nexport class GridNode extends DataGrid.SortableDataGrid.SortableDataGridNode<unknown> {\n  url: string;\n  size: number;\n  isolateCount: number;\n\n  constructor(url: string, size: number, isolateCount: number) {\n    super();\n    this.url = url;\n    this.size = size;\n    this.isolateCount = isolateCount;\n  }\n\n  updateNode(size: number, isolateCount: number): void {\n    if (this.size === size && this.isolateCount === isolateCount) {\n      return;\n    }\n    this.size = size;\n    this.isolateCount = isolateCount;\n    this.refresh();\n  }\n\n  override createCell(columnId: string): HTMLElement {\n    const cell = this.createTD(columnId);\n    switch (columnId) {\n      case 'url':\n        cell.textContent = this.url;\n        break;\n      case 'size':\n        cell.textContent = Platform.NumberUtilities.withThousandsSeparator(Math.round(this.size / 1e3));\n        cell.createChild('span', 'size-units').textContent = i18nString(UIStrings.kb);\n        break;\n      case 'isolates':\n        cell.textContent = `${this.isolateCount}`;\n        break;\n    }\n    return cell;\n  }\n}\n\nexport class ActionDelegate implements UI.ActionRegistration.ActionDelegate {\n  handleAction(_context: UI.Context.Context, actionId: string): boolean {\n    void (async () => {\n      const profileViewId = 'live-heap-profile';\n      await UI.ViewManager.ViewManager.instance().showView(profileViewId);\n      const view = UI.ViewManager.ViewManager.instance().view(profileViewId);\n      if (view) {\n        const widget = await view.widget();\n        this.innerHandleAction((widget as LiveHeapProfileView), actionId);\n      }\n    })();\n    return true;\n  }\n\n  innerHandleAction(profilerView: LiveHeapProfileView, actionId: string): void {\n    switch (actionId) {\n      case 'live-heap-profile.toggle-recording':\n        profilerView.toggleRecording();\n        break;\n      case 'live-heap-profile.start-with-reload':\n        profilerView.startRecording(true);\n        break;\n      default:\n        console.assert(false, `Unknown action: ${actionId}`);\n    }\n  }\n}\n"]}