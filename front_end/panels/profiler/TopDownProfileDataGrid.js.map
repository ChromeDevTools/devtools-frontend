{"version":3,"file":"TopDownProfileDataGrid.js","sourceRoot":"","sources":["../../../../../../front_end/panels/profiler/TopDownProfileDataGrid.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2009 280 North Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport type * as CPUProfile from '../../models/cpu_profile/cpu_profile.js';\nimport type * as UI from '../../ui/legacy/legacy.js';\n\nimport {type Formatter, ProfileDataGridNode, ProfileDataGridTree} from './ProfileDataGrid.js';\n\nexport class TopDownProfileDataGridNode extends ProfileDataGridNode {\n  remainingChildren: CPUProfile.ProfileTreeModel.ProfileNode[];\n  constructor(profileNode: CPUProfile.ProfileTreeModel.ProfileNode, owningTree: TopDownProfileDataGridTree) {\n    const hasChildren = Boolean(profileNode.children?.length);\n\n    super(profileNode, owningTree, hasChildren);\n\n    this.remainingChildren = profileNode.children;\n  }\n\n  static sharedPopulate(container: TopDownProfileDataGridTree|TopDownProfileDataGridNode): void {\n    const children = container.remainingChildren;\n    const childrenLength = children.length;\n\n    for (let i = 0; i < childrenLength; ++i) {\n      container.appendChild(\n          new TopDownProfileDataGridNode(children[i], (container.tree as TopDownProfileDataGridTree)));\n    }\n\n    container.remainingChildren = [];\n  }\n\n  static excludeRecursively(container: TopDownProfileDataGridTree|TopDownProfileDataGridNode, aCallUID: string): void {\n    if (container.remainingChildren.length > 0) {\n      (container as TopDownProfileDataGridNode).populate();\n    }\n\n    container.save();\n\n    const children = container.children;\n    let index = container.children.length;\n\n    while (index--) {\n      TopDownProfileDataGridNode.excludeRecursively((children[index] as TopDownProfileDataGridNode), aCallUID);\n    }\n\n    const child = container.childrenByCallUID.get(aCallUID);\n\n    if (child) {\n      ProfileDataGridNode.merge(container, child, true);\n    }\n  }\n\n  override populateChildren(): void {\n    TopDownProfileDataGridNode.sharedPopulate(this);\n  }\n}\n\nexport class TopDownProfileDataGridTree extends ProfileDataGridTree {\n  remainingChildren: CPUProfile.ProfileTreeModel.ProfileNode[];\n\n  constructor(\n      formatter: Formatter, searchableView: UI.SearchableView.SearchableView,\n      rootProfileNode: CPUProfile.ProfileTreeModel.ProfileNode, total: number) {\n    super(formatter, searchableView, total);\n    this.remainingChildren = rootProfileNode.children;\n    ProfileDataGridNode.populate(this);\n  }\n\n  override focus(profileDataGridNode: ProfileDataGridNode): void {\n    if (!profileDataGridNode) {\n      return;\n    }\n\n    this.save();\n    profileDataGridNode.savePosition();\n\n    this.children = [profileDataGridNode];\n    this.total = profileDataGridNode.total;\n  }\n\n  override exclude(profileDataGridNode: ProfileDataGridNode): void {\n    if (!profileDataGridNode) {\n      return;\n    }\n\n    this.save();\n\n    TopDownProfileDataGridNode.excludeRecursively(this, profileDataGridNode.callUID);\n\n    if (this.lastComparator) {\n      this.sort(this.lastComparator, true);\n    }\n  }\n\n  override restore(): void {\n    if (!this.savedChildren) {\n      return;\n    }\n\n    this.children[0].restorePosition();\n\n    super.restore();\n  }\n\n  override populateChildren(): void {\n    TopDownProfileDataGridNode.sharedPopulate(this);\n  }\n}\n"]}