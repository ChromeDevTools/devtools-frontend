{"version":3,"file":"SnippetsQuickOpen.js","sourceRoot":"","sources":["../../../../../../front_end/panels/snippets/SnippetsQuickOpen.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Workspace from '../../models/workspace/workspace.js';\nimport * as IconButton from '../../ui/components/icon_button/icon_button.js';\nimport * as QuickOpen from '../../ui/legacy/components/quick_open/quick_open.js';\n\nimport {evaluateScriptSnippet, findSnippetsProject} from './ScriptSnippetFileSystem.js';\n\nconst UIStrings = {\n  /**\n   * @description Text in Snippets Quick Open of the Sources panel when opening snippets\n   */\n  noSnippetsFound: 'No snippets found.',\n  /**\n   * @description Text for command prefix of run a code snippet\n   */\n  run: 'Run',\n  /**\n   * @description Text for suggestion of run a code snippet\n   */\n  snippet: 'Snippet',\n  /**\n   * @description Text for help title of run code snippet menu\n   */\n  runSnippet: 'Run snippet',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/snippets/SnippetsQuickOpen.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst i18nLazyString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, str_);\n\nlet snippetsQuickOpenInstance: SnippetsQuickOpen;\n\nexport class SnippetsQuickOpen extends QuickOpen.FilteredListWidget.Provider {\n  private snippets: Workspace.UISourceCode.UISourceCode[];\n  private constructor() {\n    super('snippet');\n    this.snippets = [];\n  }\n\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): SnippetsQuickOpen {\n    const {forceNew} = opts;\n    if (!snippetsQuickOpenInstance || forceNew) {\n      snippetsQuickOpenInstance = new SnippetsQuickOpen();\n    }\n\n    return snippetsQuickOpenInstance;\n  }\n\n  override selectItem(itemIndex: number|null, _promptValue: string): void {\n    if (itemIndex === null) {\n      return;\n    }\n    void evaluateScriptSnippet(this.snippets[itemIndex]);\n  }\n\n  override notFoundText(_query: string): string {\n    return i18nString(UIStrings.noSnippetsFound);\n  }\n\n  override attach(): void {\n    this.snippets = [...findSnippetsProject().uiSourceCodes()];\n  }\n\n  override detach(): void {\n    this.snippets = [];\n  }\n\n  override itemScoreAt(itemIndex: number, query: string): number {\n    // Prefer short matches over long matches\n    return query.length / this.snippets[itemIndex].name().length;\n  }\n\n  override itemCount(): number {\n    return this.snippets.length;\n  }\n\n  override itemKeyAt(itemIndex: number): string {\n    return this.snippets[itemIndex].name();\n  }\n\n  override renderItem(itemIndex: number, query: string, wrapperElement: Element): void {\n    const itemElement = wrapperElement.createChild('div');\n    const titleElement = itemElement.createChild('div');\n    const icon = IconButton.Icon.create('snippet', 'snippet');\n    wrapperElement.insertBefore(icon, itemElement);\n    titleElement.textContent = this.snippets[itemIndex].name();\n    QuickOpen.FilteredListWidget.FilteredListWidget.highlightRanges(titleElement, query, true);\n  }\n}\n\nQuickOpen.FilteredListWidget.registerProvider({\n  prefix: '!',\n  iconName: 'exclamation',\n  provider: () => Promise.resolve(SnippetsQuickOpen.instance()),\n  helpTitle: i18nLazyString(UIStrings.runSnippet),\n  titlePrefix: i18nLazyString(UIStrings.run),\n  titleSuggestion: i18nLazyString(UIStrings.snippet),\n});\n"]}