{"version":3,"file":"BreakpointEditDialog.js","sourceRoot":"","sources":["../../../../../../front_end/panels/sources/BreakpointEditDialog.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2018 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport '../../ui/legacy/legacy.js';\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as BreakpointManager from '../../models/breakpoints/breakpoints.js';\nimport * as CodeMirror from '../../third_party/codemirror.next/codemirror.next.js';\nimport * as TextEditor from '../../ui/components/text_editor/text_editor.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives, html, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport breakpointEditDialogStyles from './breakpointEditDialog.css.js';\n\nconst {ref} = Directives;\nconst {Direction} = TextEditor.TextEditorHistory;\n\nconst UIStrings = {\n  /**\n   * @description Screen reader label for a select box that chooses the breakpoint type in the Sources panel when editing a breakpoint\n   */\n  breakpointType: 'Breakpoint type',\n  /**\n   * @description Text in Breakpoint Edit Dialog of the Sources panel\n   */\n  breakpoint: 'Breakpoint',\n  /**\n   * @description Tooltip text in Breakpoint Edit Dialog of the Sources panel that shows up when hovering over the close icon\n   */\n  closeDialog: 'Close edit dialog and save changes',\n  /**\n   * @description Text in Breakpoint Edit Dialog of the Sources panel\n   */\n  conditionalBreakpoint: 'Conditional breakpoint',\n  /**\n   * @description Text in Breakpoint Edit Dialog of the Sources panel\n   */\n  logpoint: 'Logpoint',\n  /**\n   * @description Text in Breakpoint Edit Dialog of the Sources panel\n   */\n  expressionToCheckBeforePausingEg: 'Expression to check before pausing, e.g. x > 5',\n  /**\n   * @description Type selector element title in Breakpoint Edit Dialog of the Sources panel\n   */\n  pauseOnlyWhenTheConditionIsTrue: 'Pause only when the condition is true',\n  /**\n   * @description Link text in the Breakpoint Edit Dialog of the Sources panel\n   */\n  learnMoreOnBreakpointTypes: 'Learn more: Breakpoint Types',\n  /**\n   * @description Text in Breakpoint Edit Dialog of the Sources panel. It is used as\n   *the placeholder for a text input field before the user enters text. Provides the user with\n   *an example on how to use Logpoints. 'Log' is a verb and 'message' is a noun.\n   *See: https://developer.chrome.com/blog/new-in-devtools-73/#logpoints\n   */\n  logMessageEgXIsX: 'Log message, e.g. `\\'x is\\', x`',\n  /**\n   * @description Type selector element title in Breakpoint Edit Dialog of the Sources panel\n   */\n  logAMessageToConsoleDoNotBreak: 'Log a message to Console, do not break',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/sources/BreakpointEditDialog.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface BreakpointEditDialogResult {\n  committed: boolean;\n  condition: BreakpointManager.BreakpointManager.UserCondition;\n  isLogpoint: boolean;\n}\n\ninterface ViewInput {\n  state: CodeMirror.EditorState;\n  breakpointType: SDK.DebuggerModel.BreakpointType.LOGPOINT|SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT;\n  editorLineNumber: number;\n  onTypeChanged(breakpointType: SDK.DebuggerModel.BreakpointType): void;\n  saveAndFinish(): void;\n}\ninterface ViewOutput {\n  editor: TextEditor.TextEditor.TextEditor|undefined;\n}\ntype View = (input: ViewInput, output: ViewOutput, target: HTMLElement) => void;\nexport const DEFAULT_VIEW: View = (input, output, target) => {\n  const editorRef = (e: Element|undefined): void => {\n    output.editor = e as TextEditor.TextEditor.TextEditor;\n  };\n\n  const onTypeChanged = (event: Event): void => {\n    if (event.target instanceof HTMLSelectElement && event.target.selectedOptions.length === 1) {\n      input.onTypeChanged(event.target.selectedOptions.item(0)?.value as SDK.DebuggerModel.BreakpointType);\n    }\n    output.editor?.focus();\n  };\n\n  // clang-format off\n  render(html`\n    <style>${breakpointEditDialogStyles}</style>\n    <div class=dialog-header>\n      <devtools-toolbar class=source-frame-breakpoint-toolbar>Line ${input.editorLineNumber + 1}:\n        <select\n          class=type-selector\n          title=${input.breakpointType === SDK.DebuggerModel.BreakpointType.LOGPOINT\n            ? i18nString(UIStrings.logAMessageToConsoleDoNotBreak)\n            : i18nString(UIStrings.pauseOnlyWhenTheConditionIsTrue)}\n          aria-label=${i18nString(UIStrings.breakpointType)}\n          jslog=${VisualLogging.dropDown('type').track({change: true})}\n          @change=${onTypeChanged}>\n            <option value=${SDK.DebuggerModel.BreakpointType.REGULAR_BREAKPOINT}>\n              ${i18nString(UIStrings.breakpoint)}\n            </option>\n            <option\n              value=${SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT}\n              .selected=${input.breakpointType === SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT}>\n                ${i18nString(UIStrings.conditionalBreakpoint)}\n            </option>\n            <option\n              value=${SDK.DebuggerModel.BreakpointType.LOGPOINT}\n              .selected=${input.breakpointType === SDK.DebuggerModel.BreakpointType.LOGPOINT}>\n                ${i18nString(UIStrings.logpoint)}\n            </option>\n        </select>\n      </devtools-toolbar>\n      <devtools-icon\n        name=cross\n        title=${i18nString(UIStrings.closeDialog)}\n        jslog=${VisualLogging.close().track({click: true})}\n        @click=${input.saveAndFinish}>\n      </devtools-icon>\n    </div>\n    <div class=condition-editor jslog=${VisualLogging.textField().track({change: true})}>\n      <devtools-text-editor\n        ${ref(editorRef)}\n        autofocus\n        .state=${input.state}\n        @focus=${() => output.editor?.focus()}></devtools-text-editor>\n    </div>\n    <div class=link-wrapper>\n      <devtools-icon name=open-externally class=link-icon></devtools-icon>\n      <x-link class=\"link devtools-link\" tabindex=\"0\" href=\"https://goo.gle/devtools-loc\"\n                                          jslog=${VisualLogging.link('learn-more')}>${\n                     i18nString(UIStrings.learnMoreOnBreakpointTypes)}</x-link>\n    </div>\n    `,\n      // clang-format on\n      target);\n};\n\nexport class BreakpointEditDialog extends UI.Widget.Widget {\n  readonly #view: View;\n  readonly #history = new TextEditor.AutocompleteHistory.AutocompleteHistory(\n      Common.Settings.Settings.instance().createLocalSetting('breakpoint-condition-history', []));\n  #finished = false;\n  #editorLineNumber = 0;\n  #oldCondition = '';\n  #breakpointType: SDK.DebuggerModel.BreakpointType.LOGPOINT|SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT =\n      SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT;\n  #onFinish: (result: BreakpointEditDialogResult) => void = () => {};\n  #editor?: TextEditor.TextEditor.TextEditor;\n  #state?: CodeMirror.EditorState;\n\n  constructor(target?: HTMLElement, view = DEFAULT_VIEW) {\n    super({\n      jslog: `${VisualLogging.dialog('edit-breakpoint')}`,\n      useShadowDom: true,\n      delegatesFocus: true,\n      classes: ['sources-edit-breakpoint-dialog'],\n    });\n    this.#view = view;\n\n    this.element.tabIndex = -1;\n  }\n\n  get editorLineNumber(): number {\n    return this.#editorLineNumber;\n  }\n  set editorLineNumber(editorLineNumber: number) {\n    this.#editorLineNumber = editorLineNumber;\n    this.requestUpdate();\n  }\n  get oldCondition(): string {\n    return this.#oldCondition;\n  }\n  set oldCondition(oldCondition: string) {\n    this.#state = undefined;\n    this.#oldCondition = oldCondition;\n    this.requestUpdate();\n  }\n  get breakpointType(): SDK.DebuggerModel.BreakpointType {\n    return this.#breakpointType;\n  }\n  set breakpointType(\n      breakpointType: SDK.DebuggerModel.BreakpointType.LOGPOINT|\n      SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT) {\n    this.#breakpointType = breakpointType;\n    this.requestUpdate();\n  }\n  get onFinish(): (result: BreakpointEditDialogResult) => void {\n    return this.#onFinish;\n  }\n  set onFinish(onFinish: (result: BreakpointEditDialogResult) => void) {\n    this.#onFinish = onFinish;\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    const input: ViewInput = {\n      state: this.#getEditorState(),\n      breakpointType: this.#breakpointType,\n      editorLineNumber: this.#editorLineNumber,\n      onTypeChanged: type => this.#typeChanged(type),\n      saveAndFinish: () => this.saveAndFinish(),\n    };\n    const that = this;\n    const output = {\n      get editor() {\n        return that.#editor;\n      },\n      set editor(editor) {\n        that.#editor = editor;\n      }\n    };\n    this.#view(input, output, this.contentElement);\n  }\n\n  #getEditorState(): CodeMirror.EditorState {\n    if (this.#state) {\n      return this.#state;\n    }\n    const getPlaceholder = (): CodeMirror.Extension => {\n      if (this.#breakpointType === SDK.DebuggerModel.BreakpointType.CONDITIONAL_BREAKPOINT) {\n        return CodeMirror.placeholder(i18nString(UIStrings.expressionToCheckBeforePausingEg));\n      }\n      if (this.#breakpointType === SDK.DebuggerModel.BreakpointType.LOGPOINT) {\n        return CodeMirror.placeholder(i18nString(UIStrings.logMessageEgXIsX));\n      }\n      return [];\n    };\n\n    const history = (): TextEditor.TextEditorHistory.TextEditorHistory|undefined =>\n        this.#editor && new TextEditor.TextEditorHistory.TextEditorHistory(this.#editor, this.#history);\n    const autocomplete = (context: CodeMirror.CompletionContext): CodeMirror.CompletionResult|null =>\n        history()?.historyCompletions(context) ?? null;\n    const historyBack = (force: boolean): boolean => history()?.moveHistory(Direction.BACKWARD, force) ?? false;\n    const historyForward = (force: boolean): boolean => history()?.moveHistory(Direction.FORWARD, force) ?? false;\n\n    const finishIfComplete = (view: CodeMirror.EditorView): boolean => {\n      void TextEditor.JavaScript.isExpressionComplete(view.state.doc.toString()).then(complete => {\n        if (complete) {\n          this.finishEditing(true, view.state.doc.toString());\n        } else {\n          CodeMirror.insertNewlineAndIndent(view);\n        }\n      });\n      return true;\n    };\n\n    const keymap = [\n      {key: 'ArrowUp', run: () => historyBack(false)},\n      {key: 'ArrowDown', run: () => historyForward(false)},\n      {mac: 'Ctrl-p', run: () => historyBack(true)},\n      {mac: 'Ctrl-n', run: () => historyForward(true)},\n      {key: 'Mod-Enter', run: finishIfComplete},\n      {key: 'Enter', run: finishIfComplete},\n      {key: 'Shift-Enter', run: CodeMirror.insertNewlineAndIndent},\n      {\n        key: 'Escape',\n        run: () => {\n          this.finishEditing(false, '');\n          return true;\n        }\n      },\n    ];\n\n    const editorConfig = [\n      CodeMirror.javascript.javascriptLanguage,\n      TextEditor.Config.baseConfiguration(this.oldCondition),\n      TextEditor.Config.closeBrackets.instance(),\n      TextEditor.Config.autocompletion.instance(),\n      CodeMirror.EditorView.lineWrapping,\n      TextEditor.Config.showCompletionHint,\n      TextEditor.Config.conservativeCompletion,\n      CodeMirror.javascript.javascriptLanguage.data.of({autocomplete}),\n      CodeMirror.autocompletion(),\n      TextEditor.JavaScript.argumentHints(),\n    ];\n\n    this.#state = CodeMirror.EditorState.create({\n      doc: this.oldCondition,\n      selection: {anchor: 0, head: this.oldCondition.length},\n      extensions: [\n        new CodeMirror.Compartment().of(getPlaceholder()),\n        CodeMirror.keymap.of(keymap),\n        editorConfig,\n      ],\n    });\n    return this.#state;\n  }\n\n  #typeChanged(breakpointType: SDK.DebuggerModel.BreakpointType): void {\n    if (breakpointType === SDK.DebuggerModel.BreakpointType.REGULAR_BREAKPOINT) {\n      this.finishEditing(true, '');\n      return;\n    }\n    this.breakpointType = breakpointType;\n    this.requestUpdate();\n  }\n\n  finishEditing(committed: boolean, condition: string): void {\n    if (this.#finished) {\n      return;\n    }\n    this.#finished = true;\n    this.#history.pushHistoryItem(condition);\n    const isLogpoint = this.breakpointType === SDK.DebuggerModel.BreakpointType.LOGPOINT;\n    this.onFinish({committed, condition: condition as BreakpointManager.BreakpointManager.UserCondition, isLogpoint});\n  }\n\n  saveAndFinish(): void {\n    if (this.#editor) {\n      this.finishEditing(true, this.#editor.state.doc.toString());\n    }\n  }\n}\n"]}