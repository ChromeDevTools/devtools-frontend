{"version":3,"file":"FilteredUISourceCodeListProvider.js","sourceRoot":"","sources":["../../../../../../front_end/panels/sources/FilteredUISourceCodeListProvider.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2012 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../ui/components/highlighting/highlighting.js';\n\nimport type * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Root from '../../core/root/root.js';\nimport * as Persistence from '../../models/persistence/persistence.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as QuickOpen from '../../ui/legacy/components/quick_open/quick_open.js';\nimport {Directives, html, type TemplateResult} from '../../ui/lit/lit.js';\n\nimport {FilePathScoreFunction} from './FilePathScoreFunction.js';\nimport filteredUISourceCodeListProviderStyles from './filteredUISourceCodeListProvider.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Text in Filtered UISource Code List Provider of the Sources panel\n   */\n  noFilesFound: 'No files found',\n  /**\n   * @description Name of an item that is on the ignore list\n   * @example {compile.html} PH1\n   */\n  sIgnoreListed: '{PH1} (ignore listed)',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/sources/FilteredUISourceCodeListProvider.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {classMap} = Directives;\n\nexport class FilteredUISourceCodeListProvider extends QuickOpen.FilteredListWidget.Provider {\n  private queryLineNumberAndColumnNumber: string;\n  private defaultScores: Map<Workspace.UISourceCode.UISourceCode, number>|null;\n  private scorer: FilePathScoreFunction;\n  private uiSourceCodes: Workspace.UISourceCode.UISourceCode[];\n  private readonly uiSourceCodeIds: Set<string>;\n  private query!: string;\n  constructor(jslogContext: string) {\n    super(jslogContext);\n\n    this.queryLineNumberAndColumnNumber = '';\n    this.defaultScores = null;\n    this.scorer = new FilePathScoreFunction('');\n\n    this.uiSourceCodes = [];\n    this.uiSourceCodeIds = new Set();\n  }\n\n  private projectRemoved(event: Common.EventTarget.EventTargetEvent<Workspace.Workspace.Project>): void {\n    const project = event.data;\n    this.populate(project);\n    this.refresh();\n  }\n\n  private populate(skipProject?: Workspace.Workspace.Project): void {\n    this.uiSourceCodes = [];\n    this.uiSourceCodeIds.clear();\n    for (const project of Workspace.Workspace.WorkspaceImpl.instance().projects()) {\n      if (project !== skipProject && this.filterProject(project)) {\n        for (const uiSourceCode of project.uiSourceCodes()) {\n          if (this.filterUISourceCode(uiSourceCode)) {\n            this.uiSourceCodes.push(uiSourceCode);\n            this.uiSourceCodeIds.add(uiSourceCode.canonicalScriptId());\n          }\n        }\n      }\n    }\n  }\n\n  private filterUISourceCode(uiSourceCode: Workspace.UISourceCode.UISourceCode): boolean {\n    if (this.uiSourceCodeIds.has(uiSourceCode.canonicalScriptId())) {\n      return false;\n    }\n    if (Root.Runtime.experiments.isEnabled(Root.Runtime.ExperimentName.JUST_MY_CODE) &&\n        Workspace.IgnoreListManager.IgnoreListManager.instance().isUserOrSourceMapIgnoreListedUISourceCode(\n            uiSourceCode)) {\n      return false;\n    }\n\n    if (uiSourceCode.isFetchXHR()) {\n      return false;\n    }\n\n    const binding = Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode);\n    return !binding || binding.fileSystem === uiSourceCode;\n  }\n\n  uiSourceCodeSelected(\n      _uiSourceCode: Workspace.UISourceCode.UISourceCode|null, _lineNumber?: number, _columnNumber?: number): void {\n    // Overridden by subclasses\n  }\n\n  filterProject(_project: Workspace.Workspace.Project): boolean {\n    return true;\n    // Overridden by subclasses\n  }\n\n  override itemCount(): number {\n    return this.uiSourceCodes.length;\n  }\n\n  itemContentTypeAt(itemIndex: number): Common.ResourceType.ResourceType {\n    return this.uiSourceCodes[itemIndex].contentType();\n  }\n\n  override itemKeyAt(itemIndex: number): string {\n    return this.uiSourceCodes[itemIndex].url();\n  }\n\n  setDefaultScores(defaultScores: Map<Workspace.UISourceCode.UISourceCode, number>|null): void {\n    this.defaultScores = defaultScores;\n  }\n\n  override itemScoreAt(itemIndex: number, query: string): number {\n    const uiSourceCode = this.uiSourceCodes[itemIndex];\n    const score = this.defaultScores ? (this.defaultScores.get(uiSourceCode) || 0) : 0;\n    if (!query || query.length < 2) {\n      return score;\n    }\n\n    if (this.query !== query) {\n      this.query = query;\n      this.scorer = new FilePathScoreFunction(query);\n    }\n\n    let multiplier = 10;\n    if (uiSourceCode.project().type() === Workspace.Workspace.projectTypes.FileSystem &&\n        !Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode)) {\n      multiplier = 5;\n    }\n\n    let contentTypeBonus = 0;\n    if (uiSourceCode.contentType().isFromSourceMap() && !uiSourceCode.isKnownThirdParty()) {\n      contentTypeBonus = 100;\n    }\n    if (uiSourceCode.contentType().isScript()) {\n      // Bonus points for being a script if it is not ignore-listed. Note\n      // that ignore listing logic does not apply to non-scripts.\n      if (!Workspace.IgnoreListManager.IgnoreListManager.instance().isUserOrSourceMapIgnoreListedUISourceCode(\n              uiSourceCode)) {\n        contentTypeBonus += 50;\n      }\n    }\n\n    const fullDisplayName = uiSourceCode.fullDisplayName();\n    return score + multiplier * (contentTypeBonus + this.scorer.calculateScore(fullDisplayName, null));\n  }\n\n  override renderItem(itemIndex: number, query: string): TemplateResult {\n    query = this.rewriteQuery(query);\n    const uiSourceCode = this.uiSourceCodes[itemIndex];\n    const fullDisplayName = uiSourceCode.fullDisplayName();\n    const indexes: number[] = [];\n    new FilePathScoreFunction(query).calculateScore(fullDisplayName, indexes);\n    const fileNameIndex = fullDisplayName.lastIndexOf('/');\n    const isIgnoreListed =\n        Workspace.IgnoreListManager.IgnoreListManager.instance().isUserOrSourceMapIgnoreListedUISourceCode(\n            uiSourceCode);\n    let tooltipText = fullDisplayName;\n\n    if (isIgnoreListed) {\n      tooltipText = i18nString(UIStrings.sIgnoreListed, {PH1: tooltipText});\n    }\n\n    const titleRanges = [];\n    const subtitleRanges = [];\n\n    if (indexes[0] > fileNameIndex) {\n      for (let i = 0; i < indexes.length; ++i) {\n        titleRanges.push({offset: indexes[i] - (fileNameIndex + 1), length: 1});\n      }\n    } else {\n      for (let i = 0; i < indexes.length; ++i) {\n        subtitleRanges.push({offset: indexes[i], length: 1});\n      }\n    }\n    // clang-format off\n    return html`\n      <style>${filteredUISourceCodeListProviderStyles}</style>\n      <div class=\"filtered-ui-source-code-list-item\n                  ${classMap({'is-ignore-listed': isIgnoreListed})}\">\n        <devtools-highlight\n            type=\"markup\"\n            ranges=${titleRanges.map(r => `${r.offset},${r.length}`).join(' ')}\n            class=\"filtered-ui-source-code-title ${classMap({'search-mode': Boolean(query)})}\">\n          ${uiSourceCode.displayName() + (this.queryLineNumberAndColumnNumber || '')}\n        </devtools-highlight>\n        <devtools-highlight\n            type=\"markup\"\n            ranges=${subtitleRanges.map(r => `${r.offset},${r.length}`).join(' ')}\n            class=\"filtered-ui-source-code-subtitle\" title=${tooltipText}>\n          ${this.renderSubtitleElement(fullDisplayName.substring(0, fileNameIndex + 1))}\n        </devtools-highlight>\n      </div>`;\n    // clang-format on\n  }\n\n  private renderSubtitleElement(text: string): TemplateResult {\n    let splitPosition = text.lastIndexOf('/');\n    const maxTextLength = 43;\n    if (text.length > maxTextLength) {\n      splitPosition = text.length - maxTextLength;\n    }\n    // clang-format off\n    return html`\n      <div class=\"first-part\">${text.substring(0, splitPosition)}</div>\n      <div class=\"second-part\">${text.substring(splitPosition)}</div>`;\n    // clang-format on\n  }\n\n  override selectItem(itemIndex: number|null, promptValue: string): void {\n    const parsedExpression = promptValue.trim().match(/^([^:]*)(:\\d+)?(:\\d+)?$/);\n    if (!parsedExpression) {\n      return;\n    }\n\n    let lineNumber;\n    let columnNumber;\n    if (parsedExpression[2]) {\n      lineNumber = parseInt(parsedExpression[2].substr(1), 10) - 1;\n    }\n    if (parsedExpression[3]) {\n      columnNumber = parseInt(parsedExpression[3].substr(1), 10) - 1;\n    }\n    const uiSourceCode = itemIndex !== null ? this.uiSourceCodes[itemIndex] : null;\n    this.uiSourceCodeSelected(uiSourceCode, lineNumber, columnNumber);\n  }\n\n  override rewriteQuery(query: string): string {\n    query = query ? query.trim() : '';\n    if (!query || query === ':') {\n      return '';\n    }\n    const lineNumberMatch = query.match(/^([^:]+)((?::[^:]*){0,2})$/);\n    this.queryLineNumberAndColumnNumber = lineNumberMatch ? lineNumberMatch[2] : '';\n    return lineNumberMatch ? lineNumberMatch[1] : query;\n  }\n\n  private uiSourceCodeAdded(event: Common.EventTarget.EventTargetEvent<Workspace.UISourceCode.UISourceCode>): void {\n    const uiSourceCode = event.data;\n    if (!this.filterUISourceCode(uiSourceCode) || !this.filterProject(uiSourceCode.project())) {\n      return;\n    }\n    this.uiSourceCodes.push(uiSourceCode);\n    this.uiSourceCodeIds.add(uiSourceCode.canonicalScriptId());\n    this.refresh();\n  }\n\n  override notFoundText(): string {\n    return i18nString(UIStrings.noFilesFound);\n  }\n\n  override attach(): void {\n    Workspace.Workspace.WorkspaceImpl.instance().addEventListener(\n        Workspace.Workspace.Events.UISourceCodeAdded, this.uiSourceCodeAdded, this);\n    Workspace.Workspace.WorkspaceImpl.instance().addEventListener(\n        Workspace.Workspace.Events.ProjectRemoved, this.projectRemoved, this);\n    this.populate();\n  }\n\n  override detach(): void {\n    Workspace.Workspace.WorkspaceImpl.instance().removeEventListener(\n        Workspace.Workspace.Events.UISourceCodeAdded, this.uiSourceCodeAdded, this);\n    Workspace.Workspace.WorkspaceImpl.instance().removeEventListener(\n        Workspace.Workspace.Events.ProjectRemoved, this.projectRemoved, this);\n    this.queryLineNumberAndColumnNumber = '';\n    this.defaultScores = null;\n  }\n}\n"]}