{"version":3,"file":"TimelineFlameChartDataProvider.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineFlameChartDataProvider.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2014 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Root from '../../core/root/root.js';\nimport * as AIAssistance from '../../models/ai_assistance/ai_assistance.js';\nimport * as Trace from '../../models/trace/trace.js';\nimport * as SourceMapsResolver from '../../models/trace_source_maps_resolver/trace_source_maps_resolver.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as ThemeSupport from '../../ui/legacy/theme_support/theme_support.js';\n\nimport {CompatibilityTracksAppender, type DrawOverride, type TrackAppenderName} from './CompatibilityTracksAppender.js';\nimport {initiatorsDataToDraw} from './Initiators.js';\nimport {ModificationsManager} from './ModificationsManager.js';\nimport {ThreadAppender} from './ThreadAppender.js';\nimport timelineFlamechartPopoverStyles from './timelineFlamechartPopover.css.js';\nimport {FlameChartStyle, Selection} from './TimelineFlameChartView.js';\nimport {\n  selectionFromEvent,\n  selectionIsRange,\n  selectionsEqual,\n  type TimelineSelection,\n} from './TimelineSelection.js';\nimport {buildPersistedConfig} from './TrackConfiguration.js';\nimport * as Utils from './utils/utils.js';\n\nconst UIStrings = {\n  /**\n   * @description Text for rendering frames\n   */\n  frames: 'Frames',\n  /**\n   * @description Text in Timeline Flame Chart Data Provider of the Performance panel\n   */\n  idleFrame: 'Idle frame',\n  /**\n   * @description Text in Timeline Frame Chart Data Provider of the Performance panel\n   */\n  droppedFrame: 'Dropped frame',\n  /**\n   * @description Text in Timeline Frame Chart Data Provider of the Performance panel\n   */\n  partiallyPresentedFrame: 'Partially-presented frame',\n  /**\n   * @description Text for a rendering frame\n   */\n  frame: 'Frame',\n  /**\n   * @description Text for Hiding a function from the Flame Chart\n   */\n  hideFunction: 'Hide function',\n  /**\n   * @description Text for Hiding all children of a function from the Flame Chart\n   */\n  hideChildren: 'Hide children',\n  /**\n   * @description Text for Hiding all child entries that are identical to the selected entry from the Flame Chart\n   */\n  hideRepeatingChildren: 'Hide repeating children',\n  /**\n   * @description Text for remove script from ignore list from the Flame Chart\n   */\n  removeScriptFromIgnoreList: 'Remove script from ignore list',\n  /**\n   * @description Text for add script to ignore list from the Flame Chart\n   */\n  addScriptToIgnoreList: 'Add script to ignore list',\n  /**\n   * @description Text for an action that shows all of the hidden children of an entry\n   */\n  resetChildren: 'Reset children',\n  /**\n   * @description Text for an action that shows all of the hidden entries of the Flame Chart\n   */\n  resetTrace: 'Reset trace',\n  /**\n   * @description Text of a context menu item to redirect to the AI assistance panel and to start a chat.\n   */\n  startAChat: 'Start a chat',\n  /**\n   * @description Context menu item in Performance panel to label an entry.\n   */\n  labelEntry: 'Label entry',\n  /**\n   * @description Context menu item in Performance panel to assess the purpose of an entry via AI.\n   */\n  assessThePurpose: 'Assess the purpose',\n  /**\n   * @description Context menu item in Performance panel to identify time spent in a call tree via AI.\n   */\n  identifyTimeSpent: 'Identify time spent',\n  /**\n   * @description Context menu item in Performance panel to find improvements for a call tree via AI.\n   */\n  findImprovements: 'Find improvements',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/TimelineFlameChartDataProvider.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class TimelineFlameChartDataProvider extends Common.ObjectWrapper.ObjectWrapper<EventTypes> implements\n    PerfUI.FlameChart.FlameChartDataProvider {\n  private droppedFramePattern: CanvasPattern|null;\n  private partialFramePattern: CanvasPattern|null;\n  #timelineData: PerfUI.FlameChart.FlameChartTimelineData|null = null;\n  private currentLevel = 0;\n\n  private compatibilityTracksAppender: CompatibilityTracksAppender|null = null;\n  private parsedTrace: Trace.TraceModel.ParsedTrace|null = null;\n\n  #minimumBoundary = 0;\n  private timeSpan = 0;\n  private readonly framesGroupStyle: PerfUI.FlameChart.GroupStyle;\n  private readonly screenshotsGroupStyle: PerfUI.FlameChart.GroupStyle;\n\n  // Contains all the entries that are DRAWN onto the track. Entries that have\n  // been hidden - either by a user action, or because they aren't visible at\n  // all - will not appear in this array and it will change per-render. For\n  // example, if a user collapses an icicle in the flamechart, those entries\n  // that are now hidden will no longer be in this array.\n  // This also includes entrys that used to be special cased (e.g.\n  // TimelineFrames) that are now of type Types.Events.Event and so the old\n  // `TimelineFlameChartEntry` type has been removed in faovur of using\n  // Trace.Types.Events.Event directly. See crrev.com/c/5973695 for details.\n  private entryData: Trace.Types.Events.Event[] = [];\n\n  private entryTypeByLevel: EntryType[] = [];\n  private entryIndexToTitle: string[] = [];\n  #lastInitiatorEntryIndex = -1;\n\n  private lastSelection: Selection|null = null;\n  readonly #font = `${PerfUI.Font.DEFAULT_FONT_SIZE} ${PerfUI.Font.getFontFamilyForCanvas()}`;\n  #eventIndexByEvent = new WeakMap<Trace.Types.Events.Event, number|null>();\n  #entityMapper: Trace.EntityMapper.EntityMapper|null = null;\n\n  /**\n   * When we create initiator chains for a selected event, we store those\n   * chains in this map so that if the user reselects the same event we do not\n   * have to recalculate. This is reset when the trace changes.\n   */\n  #initiatorsCache = new Map<number, PerfUI.FlameChart.FlameChartInitiatorData[]>();\n  #persistedGroupConfigSetting: Common.Settings.Setting<PerfUI.FlameChart.PersistedGroupConfig[]|null>|null = null;\n\n  constructor() {\n    super();\n    this.reset();\n\n    [this.droppedFramePattern, this.partialFramePattern] = this.preparePatternCanvas();\n\n    this.framesGroupStyle = this.buildGroupStyle({useFirstLineForOverview: true});\n    this.screenshotsGroupStyle = this.buildGroupStyle({\n      useFirstLineForOverview: true,\n      nestingLevel: 1,\n      collapsible: PerfUI.FlameChart.GroupCollapsibleState.NEVER,\n      itemsHeight: 150\n    });\n\n    ThemeSupport.ThemeSupport.instance().addEventListener(ThemeSupport.ThemeChangeEvent.eventName, () => {\n      const headers = [\n        this.framesGroupStyle,\n        this.screenshotsGroupStyle,\n      ];\n      for (const header of headers) {\n        header.color = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-on-surface');\n        header.backgroundColor =\n            ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container');\n      }\n    });\n    Utils.ImageCache.emitter.addEventListener(\n        'screenshot-loaded', () => this.dispatchEventToListeners(Events.DATA_CHANGED));\n\n    Common.Settings.Settings.instance()\n        .moduleSetting('skip-stack-frames-pattern')\n        .addChangeListener(this.#onIgnoreListChanged.bind(this));\n    Common.Settings.Settings.instance()\n        .moduleSetting('skip-content-scripts')\n        .addChangeListener(this.#onIgnoreListChanged.bind(this));\n    Common.Settings.Settings.instance()\n        .moduleSetting('automatically-ignore-list-known-third-party-scripts')\n        .addChangeListener(this.#onIgnoreListChanged.bind(this));\n    Common.Settings.Settings.instance()\n        .moduleSetting('enable-ignore-listing')\n        .addChangeListener(this.#onIgnoreListChanged.bind(this));\n    Common.Settings.Settings.instance()\n        .moduleSetting('skip-anonymous-scripts')\n        .addChangeListener(this.#onIgnoreListChanged.bind(this));\n  }\n\n  handleTrackConfigurationChange(groups: readonly PerfUI.FlameChart.Group[], indexesInVisualOrder: number[]): void {\n    if (!this.#persistedGroupConfigSetting) {\n      return;\n    }\n    if (!this.parsedTrace) {\n      return;\n    }\n    const persistedDataForTrace = buildPersistedConfig(groups, indexesInVisualOrder);\n    this.#persistedGroupConfigSetting.set(persistedDataForTrace);\n  }\n\n  setPersistedGroupConfigSetting(setting: Common.Settings.Setting<PerfUI.FlameChart.PersistedGroupConfig[]|null>):\n      void {\n    this.#persistedGroupConfigSetting = setting;\n  }\n\n  hasTrackConfigurationMode(): boolean {\n    return true;\n  }\n\n  getPossibleActions(entryIndex: number, groupIndex: number): PerfUI.FlameChart.PossibleFilterActions|void {\n    const data = this.timelineData();\n    if (!data) {\n      return;\n    }\n    const group = data.groups.at(groupIndex);\n    // Early exit here if there is no group or:\n    // 1. The group is not expanded: it needs to be expanded to allow the\n    //    context menu actions to occur.\n    // 2. The group does not have the showStackContextMenu flag which indicates\n    //    that it does not show entries that support the stack actions.\n    if (!group || !group.expanded || !group.showStackContextMenu) {\n      return;\n    }\n\n    // Check which actions are possible on an entry.\n    // If an action would not change the entries (for example it has no children to collapse), we do not need to show it.\n    return this.findPossibleContextMenuActions(entryIndex);\n  }\n\n  customizedContextMenu(mouseEvent: MouseEvent, entryIndex: number, groupIndex: number): UI.ContextMenu.ContextMenu\n      |undefined {\n    const entry = this.eventByIndex(entryIndex);\n    if (!entry) {\n      return;\n    }\n\n    const possibleActions = this.getPossibleActions(entryIndex, groupIndex);\n\n    // This action and its 'execute' is defined in `freestyler-meta`\n    const PERF_AI_ACTION_ID = 'drjones.performance-panel-context';\n    const perfAIEntryPointEnabled =\n        Boolean(entry && this.parsedTrace && UI.ActionRegistry.ActionRegistry.instance().hasAction(PERF_AI_ACTION_ID));\n\n    if (!possibleActions && !perfAIEntryPointEnabled) {\n      // Early exit: no possible actions (e.g. collapsing children) and no AI\n      // entrypoint, so we don't need to do anything.\n      return;\n    }\n\n    const contextMenu = new UI.ContextMenu.ContextMenu(mouseEvent);\n    if (perfAIEntryPointEnabled && this.parsedTrace) {\n      const callTree = AIAssistance.AICallTree.AICallTree.fromEvent(entry, this.parsedTrace);\n      if (callTree) {\n        const action = UI.ActionRegistry.ActionRegistry.instance().getAction(PERF_AI_ACTION_ID);\n\n        function appendSubmenuPromptAction(\n            submenu: UI.ContextMenu.SubMenu, action: UI.ActionRegistration.Action,\n            label: Common.UIString.LocalizedString, prompt: string, jslogContext: string): void {\n          submenu.defaultSection().appendItem(\n              label, () => action.execute({prompt}), {disabled: !action.enabled(), jslogContext});\n        }\n\n        const submenu = contextMenu.footerSection().appendSubMenuItem(action.title(), false, PERF_AI_ACTION_ID);\n        submenu.defaultSection().appendAction(PERF_AI_ACTION_ID, i18nString(UIStrings.startAChat));\n        submenu.defaultSection().appendItem(i18nString(UIStrings.labelEntry), () => {\n          this.dispatchEventToListeners(\n              Events.ENTRY_LABEL_ANNOTATION_ADDED, {entryIndex, withLinkCreationButton: false});\n        }, {\n          jslogContext: 'timeline.annotations.create-entry-label',\n        });\n        appendSubmenuPromptAction(\n            submenu, action, i18nString(UIStrings.assessThePurpose), 'What\\'s the purpose of this entry?',\n            PERF_AI_ACTION_ID + '.purpose');\n        appendSubmenuPromptAction(\n            submenu, action, i18nString(UIStrings.identifyTimeSpent),\n            'Where is most time being spent in this call tree?', PERF_AI_ACTION_ID + '.time-spent');\n        appendSubmenuPromptAction(\n            submenu, action, i18nString(UIStrings.findImprovements), 'How can I reduce the time of this call tree?',\n            PERF_AI_ACTION_ID + '.improvements');\n      }\n    }\n\n    if (!possibleActions) {\n      // All the code below here adds possible actions to the context menu,\n      // some of which may be marked as disabled. If we didn't get any possible\n      // actions, rather than add them all and mark all of them as disabled, we\n      // early exit + don't add any of them.\n      return contextMenu;\n    }\n\n    const hideEntryOption = contextMenu.defaultSection().appendItem(i18nString(UIStrings.hideFunction), () => {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.MERGE_FUNCTION, entryIndex);\n    }, {\n      disabled: !possibleActions?.[PerfUI.FlameChart.FilterAction.MERGE_FUNCTION],\n      jslogContext: 'hide-function',\n    });\n    hideEntryOption.setAccelerator(UI.KeyboardShortcut.Keys.H, [UI.KeyboardShortcut.Modifiers.None]);\n    hideEntryOption.setIsDevToolsPerformanceMenuItem(true);\n\n    const hideChildrenOption = contextMenu.defaultSection().appendItem(i18nString(UIStrings.hideChildren), () => {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.COLLAPSE_FUNCTION, entryIndex);\n    }, {\n      disabled: !possibleActions?.[PerfUI.FlameChart.FilterAction.COLLAPSE_FUNCTION],\n      jslogContext: 'hide-children',\n    });\n    hideChildrenOption.setAccelerator(UI.KeyboardShortcut.Keys.C, [UI.KeyboardShortcut.Modifiers.None]);\n    hideChildrenOption.setIsDevToolsPerformanceMenuItem(true);\n\n    const hideRepeatingChildrenOption =\n        contextMenu.defaultSection().appendItem(i18nString(UIStrings.hideRepeatingChildren), () => {\n          this.modifyTree(PerfUI.FlameChart.FilterAction.COLLAPSE_REPEATING_DESCENDANTS, entryIndex);\n        }, {\n          disabled: !possibleActions?.[PerfUI.FlameChart.FilterAction.COLLAPSE_REPEATING_DESCENDANTS],\n          jslogContext: 'hide-repeating-children',\n        });\n    hideRepeatingChildrenOption.setAccelerator(UI.KeyboardShortcut.Keys.R, [UI.KeyboardShortcut.Modifiers.None]);\n    hideRepeatingChildrenOption.setIsDevToolsPerformanceMenuItem(true);\n\n    const resetChildrenOption = contextMenu.defaultSection().appendItem(i18nString(UIStrings.resetChildren), () => {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.RESET_CHILDREN, entryIndex);\n    }, {\n      disabled: !possibleActions?.[PerfUI.FlameChart.FilterAction.RESET_CHILDREN],\n      jslogContext: 'reset-children',\n    });\n    resetChildrenOption.setAccelerator(UI.KeyboardShortcut.Keys.U, [UI.KeyboardShortcut.Modifiers.None]);\n    resetChildrenOption.setIsDevToolsPerformanceMenuItem(true);\n\n    contextMenu.defaultSection().appendItem(i18nString(UIStrings.resetTrace), () => {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.UNDO_ALL_ACTIONS, entryIndex);\n    }, {\n      disabled: !possibleActions?.[PerfUI.FlameChart.FilterAction.UNDO_ALL_ACTIONS],\n      jslogContext: 'reset-trace',\n    });\n\n    if (!this.parsedTrace || Trace.Types.Events.isLegacyTimelineFrame(entry)) {\n      return contextMenu;\n    }\n\n    const url = SourceMapsResolver.SourceMapsResolver.resolvedURLForEntry(this.parsedTrace, entry);\n    if (!url) {\n      return contextMenu;\n    }\n    if (Utils.IgnoreList.isIgnoreListedEntry(entry)) {\n      contextMenu.defaultSection().appendItem(i18nString(UIStrings.removeScriptFromIgnoreList), () => {\n        Workspace.IgnoreListManager.IgnoreListManager.instance().unIgnoreListURL(url);\n        this.#onIgnoreListChanged();\n      }, {\n        jslogContext: 'remove-from-ignore-list',\n      });\n    } else {\n      contextMenu.defaultSection().appendItem(i18nString(UIStrings.addScriptToIgnoreList), () => {\n        Workspace.IgnoreListManager.IgnoreListManager.instance().ignoreListURL(url);\n        this.#onIgnoreListChanged();\n      }, {\n        jslogContext: 'add-to-ignore-list',\n      });\n    }\n\n    return contextMenu;\n  }\n\n  #onIgnoreListChanged(): void {\n    this.timelineData(/* rebuild= */ true);\n    this.dispatchEventToListeners(Events.DATA_CHANGED);\n  }\n\n  modifyTree(action: PerfUI.FlameChart.FilterAction, entryIndex: number): void {\n    const entry = this.entryData[entryIndex];\n\n    ModificationsManager.activeManager()?.getEntriesFilter().applyFilterAction({type: action, entry});\n    this.timelineData(true);\n    this.buildFlowForInitiator(entryIndex);\n    this.dispatchEventToListeners(Events.DATA_CHANGED);\n  }\n\n  findPossibleContextMenuActions(entryIndex: number): PerfUI.FlameChart.PossibleFilterActions|void {\n    const entry = this.entryData[entryIndex];\n    return ModificationsManager.activeManager()?.getEntriesFilter().findPossibleActions(entry);\n  }\n\n  handleFlameChartTransformKeyboardEvent(event: KeyboardEvent, entryIndex: number, groupIndex: number): void {\n    const possibleActions = this.getPossibleActions(entryIndex, groupIndex);\n    if (!possibleActions) {\n      return;\n    }\n\n    let handled = false;\n\n    if (event.code === 'KeyH' && possibleActions[PerfUI.FlameChart.FilterAction.MERGE_FUNCTION]) {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.MERGE_FUNCTION, entryIndex);\n      handled = true;\n    } else if (event.code === 'KeyC' && possibleActions[PerfUI.FlameChart.FilterAction.COLLAPSE_FUNCTION]) {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.COLLAPSE_FUNCTION, entryIndex);\n      handled = true;\n    } else if (\n        event.code === 'KeyR' && possibleActions[PerfUI.FlameChart.FilterAction.COLLAPSE_REPEATING_DESCENDANTS]) {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.COLLAPSE_REPEATING_DESCENDANTS, entryIndex);\n      handled = true;\n    } else if (event.code === 'KeyU') {\n      this.modifyTree(PerfUI.FlameChart.FilterAction.RESET_CHILDREN, entryIndex);\n      handled = true;\n    }\n\n    if (handled) {\n      event.consume(true);\n    }\n  }\n\n  private buildGroupStyle(extra: Object): PerfUI.FlameChart.GroupStyle {\n    const defaultGroupStyle = {\n      padding: 4,\n      height: 17,\n      collapsible: PerfUI.FlameChart.GroupCollapsibleState.ALWAYS,\n      color: ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-on-surface'),\n      backgroundColor: ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container'),\n      nestingLevel: 0,\n      shareHeaderLine: true,\n    };\n    return Object.assign(defaultGroupStyle, extra);\n  }\n\n  setModel(parsedTrace: Trace.TraceModel.ParsedTrace, entityMapper: Trace.EntityMapper.EntityMapper): void {\n    this.reset();\n    this.parsedTrace = parsedTrace;\n    const {traceBounds} = parsedTrace.data.Meta;\n    const minTime = Trace.Helpers.Timing.microToMilli(traceBounds.min);\n    const maxTime = Trace.Helpers.Timing.microToMilli(traceBounds.max);\n    this.#minimumBoundary = minTime;\n    this.timeSpan = minTime === maxTime ? 1000 : maxTime - this.#minimumBoundary;\n    this.#entityMapper = entityMapper;\n  }\n\n  /**\n   * Instances and caches a CompatibilityTracksAppender using the\n   * internal flame chart data and the trace parsed data coming from the\n   * trace engine.\n   * The model data must have been set to the data provider instance before\n   * attempting to instance the CompatibilityTracksAppender.\n   */\n  compatibilityTracksAppenderInstance(forceNew = false): CompatibilityTracksAppender {\n    if (!this.compatibilityTracksAppender || forceNew) {\n      if (!this.parsedTrace) {\n        throw new Error(\n            'Attempted to instantiate a CompatibilityTracksAppender without having set the trace parse data first.');\n      }\n      this.#timelineData = this.#instantiateTimelineData();\n      this.compatibilityTracksAppender = new CompatibilityTracksAppender(\n          this.#timelineData, this.parsedTrace, this.entryData, this.entryTypeByLevel, this.#entityMapper);\n    }\n    return this.compatibilityTracksAppender;\n  }\n\n  #insertEventToEntryData(event: Trace.Types.Events.Event): number {\n    // TODO(crbug.com/457866795): We don't actually need to keep this sorted yet, because we sort\n    // in CompatibilityTracksAppender.eventsInTrack. But if we ever wanted to remove that sort,\n    // the following code will be needed.\n\n    // const index = Platform.ArrayUtilities.lowerBound(this.entryData, event, (a, b) => a.ts - b.ts);\n    // this.entryData.splice(index, 0, event);\n    // return index;\n\n    // For now, just keep it simple and slightly faster.\n    this.entryData.push(event);\n    return this.entryData.length - 1;\n  }\n\n  /**\n   * Returns the instance of the timeline flame chart data, without\n   * adding data to it. In case the timeline data hasn't been instanced\n   * creates a new instance and returns it.\n   */\n  #instantiateTimelineData(): PerfUI.FlameChart.FlameChartTimelineData {\n    if (!this.#timelineData) {\n      this.#timelineData = PerfUI.FlameChart.FlameChartTimelineData.createEmpty();\n    }\n    return this.#timelineData;\n  }\n\n  /**\n   * Builds the flame chart data whilst allowing for a custom filtering of track appenders.\n   * This is ONLY to be used in test environments.\n   */\n  buildWithCustomTracksForTest(options?: {\n    /**\n     * Filters the track by the given name. Only tracks that match this filter will be drawn.\n     */\n    filterTracks?: (name: string, trackIndex: number) => boolean,\n    /**\n     * Choose if a given track is expanded based on the name\n     */\n    expandTracks?: (name: string, trackIndex: number) => boolean,\n  }): void {\n    const compatAppender = this.compatibilityTracksAppenderInstance();  // Make sure the instance exists in tests\n    const appenders = compatAppender.allVisibleTrackAppenders();\n    let visibleTrackIndexCounter = 0;\n    for (const appender of appenders) {\n      const trackName = appender instanceof ThreadAppender ? appender.trackName() : appender.appenderName;\n\n      const shouldIncludeTrack = options?.filterTracks?.call(null, trackName, visibleTrackIndexCounter) ?? true;\n      if (!shouldIncludeTrack) {\n        continue;\n      }\n\n      const shouldExpandTrack = options?.expandTracks?.call(null, trackName, visibleTrackIndexCounter) ?? true;\n      this.currentLevel = appender.appendTrackAtLevel(this.currentLevel, shouldExpandTrack);\n      visibleTrackIndexCounter++;\n    }\n  }\n\n  groupTreeEvents(group: PerfUI.FlameChart.Group): Trace.Types.Events.Event[]|null {\n    return this.compatibilityTracksAppender?.groupEventsForTreeView(group) ?? null;\n  }\n\n  mainFrameNavigationStartEvents(): readonly Trace.Types.Events.NavigationStart[] {\n    if (!this.parsedTrace) {\n      return [];\n    }\n    return this.parsedTrace.data.Meta.mainFrameNavigations;\n  }\n\n  entryTitle(entryIndex: number): string|null {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.SCREENSHOT) {\n      return '';\n    }\n    if (entryType === EntryType.TRACK_APPENDER) {\n      const timelineData = (this.#timelineData as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const event = (this.entryData[entryIndex]);\n      return this.compatibilityTracksAppender?.titleForEvent(event, eventLevel) || null;\n    }\n    let title: Common.UIString.LocalizedString|string = this.entryIndexToTitle[entryIndex];\n    if (!title) {\n      title = `Unexpected entryIndex ${entryIndex}`;\n      console.error(title);\n    }\n    return title;\n  }\n\n  textColor(index: number): string {\n    const event = this.entryData[index];\n    return Utils.IgnoreList.isIgnoreListedEntry(event) ? '#888' : FlameChartStyle.textColor;\n  }\n\n  entryFont(_index: number): string|null {\n    return this.#font;\n  }\n\n  /**\n   * Clear the cache and rebuild the timeline data This should be called\n   * when the trace file is the same but we want to rebuild the timeline\n   * data. Some possible example: when we hide/unhide an event, or the\n   * ignore list is changed etc.\n   */\n  rebuildTimelineData(): void {\n    this.currentLevel = 0;\n    this.entryData = [];\n    this.entryTypeByLevel = [];\n    this.entryIndexToTitle = [];\n    this.#eventIndexByEvent = new WeakMap();\n\n    if (this.#timelineData) {\n      this.compatibilityTracksAppender?.setFlameChartDataAndEntryData(\n          this.#timelineData, this.entryData, this.entryTypeByLevel);\n      this.compatibilityTracksAppender?.threadAppenders().forEach(\n          threadAppender => threadAppender.setHeaderAppended(false));\n    }\n  }\n\n  /**\n   * Reset all data other than the UI elements.\n   * This should be called when\n   * - initialized the data provider\n   * - a new trace file is coming (when `setModel()` is called)\n   * etc.\n   */\n  reset(): void {\n    this.currentLevel = 0;\n    this.entryData = [];\n    this.entryTypeByLevel = [];\n    this.entryIndexToTitle = [];\n    this.#eventIndexByEvent = new WeakMap();\n    this.#minimumBoundary = 0;\n    this.timeSpan = 0;\n\n    this.compatibilityTracksAppender?.reset();\n    this.compatibilityTracksAppender = null;\n    this.#timelineData = null;\n    this.parsedTrace = null;\n    this.#entityMapper = null;\n    this.#lastInitiatorEntryIndex = -1;\n    this.#initiatorsCache.clear();\n  }\n\n  maxStackDepth(): number {\n    return this.currentLevel;\n  }\n\n  /**\n   * Builds the flame chart data using the tracks appender (which use\n   * the new trace engine). The result built data is cached and returned.\n   */\n  timelineData(rebuild = false): PerfUI.FlameChart.FlameChartTimelineData {\n    if (!rebuild && this.#timelineData && this.#timelineData.entryLevels.length !== 0) {\n      // If the flame chart data is built already and we don't want to rebuild, we can return the cached data.\n      // |entryLevels.length| is used to check if the cached data is not empty (correctly built),\n      return this.#timelineData;\n    }\n\n    this.#timelineData = PerfUI.FlameChart.FlameChartTimelineData.createEmpty();\n\n    if (rebuild) {\n      // This function will interact with the |compatibilityTracksAppender|, which needs the reference of\n      // |timelineDataInternal|, so make sure this is called after the correct |timelineDataInternal|.\n      this.rebuildTimelineData();\n    }\n\n    this.currentLevel = 0;\n\n    if (this.parsedTrace) {\n      this.compatibilityTracksAppender = this.compatibilityTracksAppenderInstance();\n      // Note for readers: NodeJS CpuProfiles are purposefully NOT generic.\n      // We wrap them in a `TracingStartedInPage` event, which causes them to\n      // be treated like \"real\" Chrome traces. This is by design!\n      if (this.parsedTrace.data.Meta.traceIsGeneric) {\n        this.#processGenericTrace();\n      } else {\n        this.#processInspectorTrace();\n      }\n    }\n    return this.#timelineData;\n  }\n\n  #processGenericTrace(): void {\n    if (!this.compatibilityTracksAppender) {\n      return;\n    }\n\n    const appendersByProcess = this.compatibilityTracksAppender.allThreadAppendersByProcess();\n\n    for (const [pid, threadAppenders] of appendersByProcess) {\n      const processGroupStyle = this.buildGroupStyle({shareHeaderLine: false});\n      const processName = this.parsedTrace?.data.Meta.processNames.get(pid)?.args.name || 'Process';\n      this.appendHeader(`${processName} (${pid})`, processGroupStyle, true, false);\n      for (const appender of threadAppenders) {\n        appender.setHeaderNestingLevel(1);\n        this.currentLevel = appender.appendTrackAtLevel(this.currentLevel);\n      }\n    }\n  }\n\n  #processInspectorTrace(): void {\n    // In CPU Profiles the trace data will not have frames nor\n    // screenshots, so we can keep this call as it will be a no-op in\n    // these cases.\n    this.#appendFramesAndScreenshotsTrack();\n\n    const weight = (track: {type?: string, forMainFrame?: boolean, appenderName?: TrackAppenderName}): number => {\n      switch (track.appenderName) {\n        case 'Animations':\n          return 0;\n        case 'Timings':\n          return 1;\n        case 'Interactions':\n          return 2;\n        case 'LayoutShifts':\n          return 3;\n        case 'Extension':\n          return 4;\n        case 'Thread':\n          return 5;\n        case 'ServerTimings':\n          return 6;\n        case 'GPU':\n          return 7;\n        case 'Thread_AuctionWorklet':\n          return 8;\n        default:\n          return 9;\n      }\n    };\n\n    const allTrackAppenders =\n        this.compatibilityTracksAppender ? this.compatibilityTracksAppender.allVisibleTrackAppenders() : [];\n\n    allTrackAppenders.sort((a, b) => weight(a) - weight(b));\n\n    for (const appender of allTrackAppenders) {\n      if (!this.parsedTrace) {\n        continue;\n      }\n\n      this.currentLevel = appender.appendTrackAtLevel(this.currentLevel);\n\n      // If there is not a selected group, we want to default to selecting the\n      // main thread track. Therefore in this check we look to see if the\n      // current appender is a ThreadAppender and represnets the Main Thread.\n      // If it is, we mark the group as selected.\n      if (this.#timelineData && !this.#timelineData.selectedGroup) {\n        if (appender instanceof ThreadAppender &&\n            (appender.threadType === Trace.Handlers.Threads.ThreadType.MAIN_THREAD ||\n             appender.threadType === Trace.Handlers.Threads.ThreadType.CPU_PROFILE)) {\n          const group = this.compatibilityTracksAppender?.groupForAppender(appender);\n          if (group) {\n            this.#timelineData.selectedGroup = group;\n          }\n        }\n      }\n    }\n    if (this.#timelineData?.selectedGroup) {\n      this.#timelineData.selectedGroup.expanded = true;\n    }\n  }\n\n  minimumBoundary(): number {\n    return this.#minimumBoundary;\n  }\n\n  totalTime(): number {\n    return this.timeSpan;\n  }\n\n  search(visibleWindow: Trace.Types.Timing.TraceWindowMicro, filter?: Trace.Extras.TraceFilter.TraceFilter):\n      PerfUI.FlameChart.DataProviderSearchResult[] {\n    const results: PerfUI.FlameChart.DataProviderSearchResult[] = [];\n    this.timelineData();\n    for (let i = 0; i < this.entryData.length; ++i) {\n      const entry = this.entryData[i];\n      if (!entry) {\n        continue;\n      }\n\n      if (Trace.Types.Events.isLegacyTimelineFrame(entry)) {\n        continue;\n      }\n\n      if (Trace.Types.Events.isLegacyScreenshot(entry)) {\n        // Screenshots are represented as trace events, but you can't search for them, so skip.\n        continue;\n      }\n      if (!Trace.Helpers.Timing.eventIsInBounds(entry, visibleWindow)) {\n        continue;\n      }\n      if (!filter || filter.accept(entry, this.parsedTrace?.data || undefined)) {\n        const startTimeMilli = Trace.Helpers.Timing.microToMilli(entry.ts);\n        results.push({index: i, startTimeMilli, provider: 'main'});\n      }\n    }\n    return results;\n  }\n\n  getEntryTypeForLevel(level: number): EntryType {\n    return this.entryTypeByLevel[level];\n  }\n\n  /**\n   * The frames and screenshots track is special cased because it is rendered\n   * differently to the rest of the tracks and not as a series of events. This\n   * is why it is not done via the appender system; we track frames &\n   * screenshots as a different EntryType to the TrackAppender entries,\n   * because then when it comes to drawing we can decorate them differently.\n   **/\n  #appendFramesAndScreenshotsTrack(): void {\n    if (this.entryData.length) {\n      throw new Error('expected this.entryData to be empty');\n    }\n\n    if (!this.parsedTrace) {\n      return;\n    }\n\n    const filmStrip = Trace.Extras.FilmStrip.fromHandlerData(this.parsedTrace.data);\n    const hasScreenshots = filmStrip.frames.length > 0;\n    const hasFrames = this.parsedTrace.data.Frames.frames.length > 0;\n    if (!hasFrames && !hasScreenshots) {\n      return;\n    }\n\n    this.framesGroupStyle.collapsible =\n        hasScreenshots ? PerfUI.FlameChart.GroupCollapsibleState.ALWAYS : PerfUI.FlameChart.GroupCollapsibleState.NEVER;\n    const expanded = Root.Runtime.Runtime.queryParam('flamechart-force-expand') === 'frames';\n\n    this.appendHeader(i18nString(UIStrings.frames), this.framesGroupStyle, false /* selectable */, expanded);\n\n    this.entryTypeByLevel[this.currentLevel] = EntryType.FRAME;\n    for (const frame of this.parsedTrace.data.Frames.frames) {\n      this.#appendFrame(frame);\n    }\n    ++this.currentLevel;\n\n    if (!hasScreenshots) {\n      return;\n    }\n    this.#appendScreenshots(filmStrip);\n  }\n\n  #appendScreenshots(filmStrip: Trace.Extras.FilmStrip.Data): void {\n    if (!this.#timelineData || !this.parsedTrace) {\n      return;\n    }\n\n    this.appendHeader('', this.screenshotsGroupStyle, false /* selectable */);\n    this.entryTypeByLevel[this.currentLevel] = EntryType.SCREENSHOT;\n\n    const traceEnd = Trace.Helpers.Timing.traceWindowMilliSeconds(this.parsedTrace.data.Meta.traceBounds).max;\n\n    for (let i = 0; i < filmStrip.frames.length; ++i) {\n      const currentFrame = filmStrip.frames[i];\n      const nextFrame = filmStrip.frames[i + 1];\n      const startTimeMillis = Trace.Helpers.Timing.microToMilli(currentFrame.screenshotEvent.ts);\n      // If there is no next frame, use the end of the trace.\n      const endTimeMillis = nextFrame ? Trace.Helpers.Timing.microToMilli(nextFrame.screenshotEvent.ts) : traceEnd;\n      const durationMillis = endTimeMillis - startTimeMillis;\n\n      const index = this.#insertEventToEntryData(currentFrame.screenshotEvent);\n      (this.#timelineData.entryLevels as number[]).splice(index, 0, this.currentLevel);\n      (this.#timelineData.entryStartTimes as number[]).splice(index, 0, startTimeMillis);\n      (this.#timelineData.entryTotalTimes as number[]).splice(index, 0, durationMillis);\n      this.entryIndexToTitle.splice(index, 0, '');\n    }\n\n    ++this.currentLevel;\n  }\n\n  #entryTypeForIndex(entryIndex: number): EntryType {\n    const level = this.timelineData().entryLevels[entryIndex];\n    return this.entryTypeByLevel[level];\n  }\n\n  preparePopoverElement(entryIndex: number): Element|null {\n    let time = '';\n    let title;\n    let warningElements: Element[] = [];\n    let timeElementClassName = 'popoverinfo-time';\n    const additionalContent: HTMLElement[] = [];\n\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.TRACK_APPENDER) {\n      if (!this.compatibilityTracksAppender) {\n        return null;\n      }\n      const event = (this.entryData[entryIndex]);\n      const timelineData = (this.#timelineData as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const popoverInfo = this.compatibilityTracksAppender.popoverInfo(event, eventLevel);\n      title = popoverInfo.title;\n      time = popoverInfo.formattedTime;\n      warningElements = popoverInfo.warningElements || warningElements;\n      if (popoverInfo.additionalElements?.length) {\n        additionalContent.push(...popoverInfo.additionalElements);\n      }\n\n      this.dispatchEventToListeners(Events.FLAME_CHART_ITEM_HOVERED, event);\n\n    } else if (entryType === EntryType.FRAME) {\n      const frame = (this.entryData[entryIndex] as Trace.Types.Events.LegacyTimelineFrame);\n      time = i18n.TimeUtilities.preciseMillisToString(Trace.Helpers.Timing.microToMilli(frame.duration), 1);\n\n      if (frame.idle) {\n        title = i18nString(UIStrings.idleFrame);\n      } else if (frame.dropped) {\n        title = frame.isPartial ? i18nString(UIStrings.partiallyPresentedFrame) : i18nString(UIStrings.droppedFrame);\n        timeElementClassName = 'popoverinfo-warning';\n      } else {\n        title = i18nString(UIStrings.frame);\n      }\n    } else {\n      this.dispatchEventToListeners(Events.FLAME_CHART_ITEM_HOVERED, null);\n      return null;\n    }\n\n    const popoverElement = document.createElement('div');\n    const root = UI.UIUtils.createShadowRootWithCoreStyles(popoverElement, {cssFile: timelineFlamechartPopoverStyles});\n    const popoverContents = root.createChild('div', 'timeline-flamechart-popover');\n    popoverContents.createChild('span', timeElementClassName).textContent = time;\n    popoverContents.createChild('span', 'popoverinfo-title').textContent = title;\n    for (const warningElement of warningElements) {\n      warningElement.classList.add('popoverinfo-warning');\n      popoverContents.appendChild(warningElement);\n    }\n    for (const elem of additionalContent) {\n      popoverContents.appendChild(elem);\n    }\n    return popoverElement;\n  }\n\n  preparePopoverForCollapsedArrow(entryIndex: number): Element|null {\n    const element = document.createElement('div');\n    const root = UI.UIUtils.createShadowRootWithCoreStyles(element, {cssFile: timelineFlamechartPopoverStyles});\n\n    const entry = this.entryData[entryIndex];\n    const hiddenEntriesAmount =\n        ModificationsManager.activeManager()?.getEntriesFilter().findHiddenDescendantsAmount(entry);\n\n    if (!hiddenEntriesAmount) {\n      return null;\n    }\n    const contents = root.createChild('div', 'timeline-flamechart-popover');\n    contents.createChild('span', 'popoverinfo-title').textContent = hiddenEntriesAmount + ' hidden';\n\n    return element;\n  }\n\n  getDrawOverride(entryIndex: number): DrawOverride|undefined {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType !== EntryType.TRACK_APPENDER) {\n      return;\n    }\n\n    const timelineData = (this.#timelineData as PerfUI.FlameChart.FlameChartTimelineData);\n    const eventLevel = timelineData.entryLevels[entryIndex];\n    const event = (this.entryData[entryIndex]);\n    return this.compatibilityTracksAppender?.getDrawOverride(event, eventLevel);\n  }\n\n  #entryColorForFrame(entryIndex: number): string {\n    const frame = (this.entryData[entryIndex] as Trace.Types.Events.LegacyTimelineFrame);\n    if (frame.idle) {\n      return 'white';\n    }\n    if (frame.dropped) {\n      if (frame.isPartial) {\n        // For partially presented frame boxes, paint a yellow background with\n        // a sparse white dashed-line pattern overlay.\n        return '#f0e442';\n      }\n      // For dropped frame boxes, paint a red background with a dense white\n      // solid-line pattern overlay.\n      return '#f08080';\n    }\n    return '#d7f0d1';\n  }\n\n  entryColor(entryIndex: number): string {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.FRAME) {\n      return this.#entryColorForFrame(entryIndex);\n    }\n    if (entryType === EntryType.TRACK_APPENDER) {\n      const timelineData = (this.#timelineData as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const event = (this.entryData[entryIndex]);\n      return this.compatibilityTracksAppender?.colorForEvent(event, eventLevel) || '';\n    }\n    return '';\n  }\n\n  private preparePatternCanvas(): Array<CanvasPattern|null> {\n    // Set the candy stripe pattern to 17px so it repeats well.\n    const size = 17;\n    const droppedFrameCanvas = document.createElement('canvas');\n    const partialFrameCanvas = document.createElement('canvas');\n    droppedFrameCanvas.width = droppedFrameCanvas.height = size;\n    partialFrameCanvas.width = partialFrameCanvas.height = size;\n\n    const ctx = droppedFrameCanvas.getContext('2d', {willReadFrequently: true}) as CanvasRenderingContext2D;\n    // Make a dense solid-line pattern.\n    ctx.translate(size * 0.5, size * 0.5);\n    ctx.rotate(Math.PI * 0.25);\n    ctx.translate(-size * 0.5, -size * 0.5);\n\n    ctx.fillStyle = 'rgb(255, 255, 255)';\n    for (let x = -size; x < size * 2; x += 3) {\n      ctx.fillRect(x, -size, 1, size * 3);\n    }\n    const droppedFramePattern = ctx.createPattern(droppedFrameCanvas, 'repeat');\n\n    const ctx2 = partialFrameCanvas.getContext('2d', {willReadFrequently: true}) as CanvasRenderingContext2D;\n    // Make a sparse dashed-line pattern.\n    ctx2.strokeStyle = 'rgb(255, 255, 255)';\n    ctx2.lineWidth = 2;\n    ctx2.beginPath();\n    ctx2.moveTo(17, 0);\n    ctx2.lineTo(10, 7);\n    ctx2.moveTo(8, 9);\n    ctx2.lineTo(2, 15);\n    ctx2.stroke();\n    const partialFramePattern = ctx.createPattern(partialFrameCanvas, 'repeat');\n    return [droppedFramePattern, partialFramePattern];\n  }\n\n  private drawFrame(\n      entryIndex: number, context: CanvasRenderingContext2D, barX: number, barY: number, barWidth: number,\n      barHeight: number, transformColor: (color: string) => string): void {\n    const hPadding = 1;\n    const frame = this.entryData[entryIndex] as Trace.Types.Events.LegacyTimelineFrame;\n    barX += hPadding;\n    barWidth -= 2 * hPadding;\n    context.fillStyle = transformColor(this.entryColor(entryIndex));\n\n    if (frame.dropped) {\n      context.fillRect(barX, barY, barWidth, barHeight);\n      if (frame.isPartial) {\n        // For partially presented frame boxes, paint a yellow background with\n        // a sparse white dashed-line pattern overlay.\n        context.fillStyle = this.partialFramePattern || context.fillStyle;\n      } else {\n        // For dropped frame boxes, paint a red background with a dense white\n        // solid-line pattern overlay.\n        context.fillStyle = this.droppedFramePattern || context.fillStyle;\n      }\n    }\n    context.fillRect(barX, barY, barWidth, barHeight);\n\n    const frameDurationText =\n        i18n.TimeUtilities.preciseMillisToString(Trace.Helpers.Timing.microToMilli(frame.duration), 1);\n    const textWidth = context.measureText(frameDurationText).width;\n    if (textWidth <= barWidth) {\n      context.fillStyle = this.textColor(entryIndex);\n      context.fillText(frameDurationText, barX + (barWidth - textWidth) / 2, barY + barHeight - 4);\n    }\n  }\n\n  private async drawScreenshot(\n      entryIndex: number, context: CanvasRenderingContext2D, barX: number, barY: number, barWidth: number,\n      barHeight: number): Promise<void> {\n    const screenshot = (this.entryData[entryIndex] as Trace.Types.Events.LegacySyntheticScreenshot);\n    const image = Utils.ImageCache.getOrQueue(screenshot);\n    if (!image) {\n      return;\n    }\n    const imageX = barX + 1;\n    const imageY = barY + 1;\n    const imageHeight = barHeight - 2;\n    const scale = imageHeight / image.naturalHeight;\n    const imageWidth = Math.floor(image.naturalWidth * scale);\n    context.save();\n    context.beginPath();\n    context.rect(barX, barY, barWidth, barHeight);\n    context.clip();\n    context.drawImage(image, imageX, imageY, imageWidth, imageHeight);\n    context.strokeStyle = '#ccc';\n    context.strokeRect(imageX - 0.5, imageY - 0.5, Math.min(barWidth - 1, imageWidth + 1), imageHeight);\n    context.restore();\n  }\n\n  decorateEntry(\n      entryIndex: number, context: CanvasRenderingContext2D, text: string|null, barX: number, barY: number,\n      barWidth: number, barHeight: number, unclippedBarX: number, timeToPixelRatio: number,\n      transformColor: (color: string) => string): boolean {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n\n    if (entryType === EntryType.FRAME) {\n      this.drawFrame(entryIndex, context, barX, barY, barWidth, barHeight, transformColor);\n      return true;\n    }\n\n    if (entryType === EntryType.SCREENSHOT) {\n      void this.drawScreenshot(entryIndex, context, barX, barY, barWidth, barHeight);\n      return true;\n    }\n\n    if (entryType === EntryType.TRACK_APPENDER) {\n      const entry = this.entryData[entryIndex];\n      if (Trace.Types.Events.isSyntheticInteraction(entry)) {\n        this.#drawInteractionEventWithWhiskers(\n            context, entryIndex, text, entry, barX, barY, unclippedBarX, barWidth, barHeight, timeToPixelRatio);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Draws the left and right whiskers around an interaction in the timeline.\n   * @param context the canvas that will be drawn onto\n   * @param entryIndex\n   * @param entryTitle the title of the entry\n   * @param entry the entry itself\n   * @param barX the starting X pixel position of the bar representing this event. This is clipped: if the bar is off the left side of the screen, this value will be 0\n   * @param barY the starting Y pixel position of the bar representing this event.\n   * @param unclippedBarXStartPixel the starting X pixel position of the bar representing this event, not clipped. This means if the bar is off the left of the screen this will be a negative number.\n   * @param barWidth the width of the full bar in pixels\n   * @param barHeight the height of the full bar in pixels\n   * @param timeToPixelRatio the ratio required to convert a millisecond time to a pixel value.\n   **/\n  #drawInteractionEventWithWhiskers(\n      context: CanvasRenderingContext2D, entryIndex: number, entryTitle: string|null,\n      entry: Trace.Types.Events.SyntheticInteractionPair, barX: number, barY: number, unclippedBarXStartPixel: number,\n      barWidth: number, barHeight: number, timeToPixelRatio: number): void {\n    /**\n     * An interaction is drawn with whiskers as so:\n     * |----------[=======]-------------|\n     * => The left whisker is the event's start time (event.ts)\n     * => The box start is the event's processingStart time\n     * => The box end is the event's processingEnd time\n     * => The right whisker is the event's end time (event.ts + event.dur)\n     *\n     * When we draw the event in the InteractionsAppender, we draw a huge box\n     * that spans the entire of the above. So here we need to draw over the\n     * rectangle that is outside of {processingStart, processingEnd} and\n     * replace it with the whiskers.\n     * TODO(crbug.com/1495248): rework how we draw whiskers to avoid this inefficiency\n     */\n\n    const beginTime = Trace.Helpers.Timing.microToMilli(entry.ts);\n    const entireBarEndXPixel = barX + barWidth;\n\n    function timeToPixel(time: Trace.Types.Timing.Micro): number {\n      const timeMilli = Trace.Helpers.Timing.microToMilli(time);\n      return Math.floor(unclippedBarXStartPixel + (timeMilli - beginTime) * timeToPixelRatio);\n    }\n\n    context.save();\n\n    // Clear portions of initial rect to prepare for the ticks.\n    context.fillStyle = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container');\n    let desiredBoxStartX = timeToPixel(entry.processingStart);\n    const desiredBoxEndX = timeToPixel(entry.processingEnd);\n\n    // If the entry has no processing duration, ensure the box is 1px wide so at least it is visible.\n    if (entry.processingEnd - entry.processingStart === 0) {\n      desiredBoxStartX -= 1;\n    }\n\n    context.fillRect(barX, barY - 0.5, desiredBoxStartX - barX, barHeight);\n    context.fillRect(desiredBoxEndX, barY - 0.5, entireBarEndXPixel - desiredBoxEndX, barHeight);\n\n    /** Draws left and right whiskers **/\n    function drawTick(begin: number, end: number, y: number): void {\n      const tickHeightPx = 6;\n      context.moveTo(begin, y - tickHeightPx / 2);\n      context.lineTo(begin, y + tickHeightPx / 2);\n      context.moveTo(begin, y);\n      context.lineTo(end, y);\n    }\n\n    // The left whisker starts at the entry timestamp, and continues until the start of the box (processingStart).\n    const leftWhiskerX = timeToPixel(entry.ts);\n    // The right whisker ends at (entry.ts + entry.dur). We draw the line from the end of the box (processingEnd).\n    const rightWhiskerX = timeToPixel(Trace.Types.Timing.Micro(entry.ts + entry.dur));\n    context.beginPath();\n    context.lineWidth = 1;\n    context.strokeStyle = '#ccc';\n    const lineY = Math.floor(barY + barHeight / 2) + 0.5;\n    const leftTick = leftWhiskerX + 0.5;\n    const rightTick = rightWhiskerX - 0.5;\n    drawTick(leftTick, desiredBoxStartX, lineY);\n    drawTick(rightTick, desiredBoxEndX, lineY);\n    context.stroke();\n\n    if (entryTitle) {\n      // BarX will be set to 0 if the start of the box if off the screen to the\n      // left. If this happens, the desiredBoxStartX will be negative. In that\n      // case, we fallback to the BarX. This ensures that even if the box\n      // starts off-screen, we draw the text at the first visible on screen\n      // pixels, so the user can still see the event's title.\n      const textStartX = desiredBoxStartX > 0 ? desiredBoxStartX : barX;\n      context.font = this.#font;\n      const textWidth = UI.UIUtils.measureTextWidth(context, entryTitle);\n\n      // These numbers are duplicated from FlameChart.ts.\n      const textPadding = 5;\n      const textBaseline = 5;\n\n      // Only draw the text if it can fit in the amount of box that is visible.\n      if (textWidth <= desiredBoxEndX - textStartX + textPadding) {\n        context.fillStyle = this.textColor(entryIndex);\n        context.fillText(entryTitle, textStartX + textPadding, barY + barHeight - textBaseline);\n      }\n    }\n    context.restore();\n  }\n\n  forceDecoration(entryIndex: number): boolean {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.FRAME) {\n      return true;\n    }\n    if (entryType === EntryType.SCREENSHOT) {\n      return true;\n    }\n    const event = (this.entryData[entryIndex]);\n\n    if (Trace.Types.Events.isSyntheticInteraction(event)) {\n      // We draw interactions with whiskers, which are done via the\n      // decorateEntry() method, hence we always want to force these to be\n      // decorated.\n      return true;\n    }\n    return Boolean(this.parsedTrace?.data.Warnings.perEvent.get(event));\n  }\n\n  private appendHeader(title: string, style: PerfUI.FlameChart.GroupStyle, selectable: boolean, expanded?: boolean):\n      PerfUI.FlameChart.Group {\n    const group =\n        ({startLevel: this.currentLevel, name: title, style, selectable, expanded} as PerfUI.FlameChart.Group);\n    (this.#timelineData as PerfUI.FlameChart.FlameChartTimelineData).groups.push(group);\n    return group;\n  }\n\n  #appendFrame(frame: Trace.Types.Events.LegacyTimelineFrame): void {\n    const index = this.#insertEventToEntryData(frame);\n    const durationMilliseconds = Trace.Helpers.Timing.microToMilli(frame.duration);\n    this.entryIndexToTitle.splice(index, 0, i18n.TimeUtilities.millisToString(durationMilliseconds, true));\n\n    if (!this.#timelineData) {\n      return;\n    }\n\n    if (Array.isArray(this.#timelineData.entryLevels) && Array.isArray(this.#timelineData.entryTotalTimes) &&\n        Array.isArray(this.#timelineData.entryStartTimes)) {\n      this.#timelineData.entryLevels.splice(index, 0, this.currentLevel);\n      this.#timelineData.entryTotalTimes.splice(index, 0, durationMilliseconds);\n      this.#timelineData.entryStartTimes.splice(index, 0, Trace.Helpers.Timing.microToMilli(frame.startTime));\n    } else {\n      this.#timelineData.entryLevels[index] = this.currentLevel;\n      this.#timelineData.entryTotalTimes[index] = durationMilliseconds;\n      this.#timelineData.entryStartTimes[index] = Trace.Helpers.Timing.microToMilli(frame.startTime);\n    }\n  }\n\n  createSelection(entryIndex: number): TimelineSelection|null {\n    const entry = this.entryData[entryIndex];\n    const timelineSelection: TimelineSelection|null = entry ? selectionFromEvent(entry) : null;\n    if (timelineSelection) {\n      this.lastSelection = new Selection(timelineSelection, entryIndex);\n    }\n    return timelineSelection;\n  }\n\n  formatValue(value: number, precision?: number): string {\n    return i18n.TimeUtilities.preciseMillisToString(value, precision);\n  }\n\n  groupForEvent(entryIndex: number): PerfUI.FlameChart.Group|null {\n    if (!this.compatibilityTracksAppender) {\n      return null;\n    }\n    const level = this.#timelineData?.entryLevels[entryIndex] ?? null;\n    if (level === null) {\n      return null;\n    }\n    const groupForLevel = this.compatibilityTracksAppender.groupForLevel(level);\n    if (!groupForLevel) {\n      return null;\n    }\n    return groupForLevel;\n  }\n\n  canJumpToEntry(_entryIndex: number): boolean {\n    return false;\n  }\n\n  entryIndexForSelection(selection: TimelineSelection|null): number {\n    if (!selection || selectionIsRange(selection) || Trace.Types.Events.isNetworkTrackEntry(selection.event)) {\n      return -1;\n    }\n\n    if (this.lastSelection && selectionsEqual(this.lastSelection.timelineSelection, selection)) {\n      return this.lastSelection.entryIndex;\n    }\n\n    const index = this.entryData.indexOf(selection.event);\n    // If the index is -1 and the selection is a TraceEvent, it might be\n    // the case that this Entry is hidden by the Context Menu action.\n    // Try revealing the entry and getting the index again.\n    if (index === -1) {\n      if (this.#timelineData?.selectedGroup) {\n        ModificationsManager.activeManager()?.getEntriesFilter().revealEntry(selection.event);\n        this.timelineData(true);\n      }\n    }\n\n    if (index !== -1) {\n      this.lastSelection = new Selection(selection, index);\n    }\n    return index;\n  }\n\n  /**\n   * Return the index for the given entry. Note that this method assumes that\n   * timelineData() has been generated. If it hasn't, this method will return\n   * null.\n   */\n  indexForEvent(targetEvent: Trace.Types.Events.Event): number|null {\n    // Gets the index for the given event by walking through the array of entryData.\n    // This may seem inefficient - but we have seen that by building up large\n    // maps keyed by trace events that this has a significant impact on the\n    // performance of the panel.\n    // Therefore, we strike a middle ground: look up the event the first time,\n    // but then cache the result.\n    const fromCache = this.#eventIndexByEvent.get(targetEvent);\n    if (typeof fromCache === 'number') {\n      return fromCache;\n    }\n    const index = this.entryData.indexOf(targetEvent);\n    const result = index > -1 ? index : null;\n    this.#eventIndexByEvent.set(targetEvent, result);\n    return result;\n  }\n\n  /**\n   * Build the data for initiators and initiated entries.\n   * @param entryIndex\n   * @returns if we should re-render the flame chart (canvas)\n   */\n  buildFlowForInitiator(entryIndex: number): boolean {\n    if (!this.parsedTrace || !this.compatibilityTracksAppender || !this.#timelineData) {\n      return false;\n    }\n\n    if (this.#lastInitiatorEntryIndex === entryIndex) {\n      // If the user clicks on an entry twice by mistake, this can fire. But if\n      // the entry matches the selected entry, then there is nothing more for\n      // us to do.\n      return false;\n    }\n\n    this.#lastInitiatorEntryIndex = entryIndex;\n\n    const previousInitiatorsDataLength = this.#timelineData.initiatorsData.length;\n\n    if (entryIndex === -1) {\n      // User has deselected an event, so if it had any initiators we need to clear them.\n      if (this.#timelineData.initiatorsData.length === 0) {\n        // The previous selected entry had no initiators, so we can early exit and not redraw anything.\n        return false;\n      }\n      // Clear initiator data and trigger a re-render.\n      this.#timelineData.emptyInitiators();\n      return true;\n    }\n\n    // If the user hasn't clicked on an event, bail, as there are no initiators\n    // for screenshots or frames.\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType !== EntryType.TRACK_APPENDER) {\n      return false;\n    }\n\n    // Avoid re-building the initiators if we already did it previously.\n    const cached = this.#initiatorsCache.get(entryIndex);\n    if (cached) {\n      this.#timelineData.initiatorsData = cached;\n      return true;\n    }\n\n    // At this point, we know we:\n    // 1. Have an event to build initiators for.\n    // 2. Know that it's not an event with initiators that are cached.\n    const event = this.entryData[entryIndex];\n    // Reset to clear any previous arrows from the last event.\n    this.#timelineData.emptyInitiators();\n\n    const hiddenEvents: Trace.Types.Events.Event[] =\n        ModificationsManager.activeManager()?.getEntriesFilter().invisibleEntries() ?? [];\n    const expandableEntries: Trace.Types.Events.Event[] =\n        ModificationsManager.activeManager()?.getEntriesFilter().expandableEntries() ?? [];\n\n    const initiatorsData = initiatorsDataToDraw(this.parsedTrace, event, hiddenEvents, expandableEntries);\n\n    if (initiatorsData.length === 0) {\n      // Small optimization: cache if this entry has 0 initiators, meaning if\n      // it gets reselected we don't redo the work to find out it has 0\n      // initiators.\n      this.#initiatorsCache.set(entryIndex, []);\n    }\n\n    // Previous event had 0 initiators, new event has 0, therefore exit early and don't render.\n    if (previousInitiatorsDataLength === 0 && initiatorsData.length === 0) {\n      return false;\n    }\n\n    for (const initiatorData of initiatorsData) {\n      const eventIndex = this.indexForEvent(initiatorData.event);\n      const initiatorIndex = this.indexForEvent(initiatorData.initiator);\n      if (eventIndex === null || initiatorIndex === null) {\n        continue;\n      }\n      this.#timelineData.initiatorsData.push({\n        initiatorIndex,\n        eventIndex,\n        isInitiatorHidden: initiatorData.isInitiatorHidden,\n        isEntryHidden: initiatorData.isEntryHidden,\n      });\n    }\n    this.#initiatorsCache.set(entryIndex, this.#timelineData.initiatorsData);\n    return true;\n  }\n\n  eventByIndex(entryIndex: number): Trace.Types.Events.Event|null {\n    if (entryIndex < 0) {\n      return null;\n    }\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.TRACK_APPENDER) {\n      return this.entryData[entryIndex];\n    }\n    if (entryType === EntryType.FRAME) {\n      return this.entryData[entryIndex] as Trace.Types.Events.LegacyTimelineFrame;\n    }\n    return null;\n  }\n}\n\nexport const InstantEventVisibleDurationMs = Trace.Types.Timing.Milli(0.001);\n\nexport const enum Events {\n  DATA_CHANGED = 'DataChanged',\n  FLAME_CHART_ITEM_HOVERED = 'FlameChartItemHovered',\n  ENTRY_LABEL_ANNOTATION_ADDED = 'EntryLabelAnnotationAdded'\n}\n\nexport interface EventTypes {\n  [Events.DATA_CHANGED]: void;\n  [Events.FLAME_CHART_ITEM_HOVERED]: Trace.Types.Events.Event|null;\n  [Events.ENTRY_LABEL_ANNOTATION_ADDED]: {\n    entryIndex: number,\n    withLinkCreationButton: boolean,\n  };\n}\n\n/**\n * an entry is a trace event, they are classified into \"entry types\"\n * because some events are rendered differently. For example, screenshot\n * events are rendered as images. Checks for entry types allow to have\n * different styles, names, etc. for events that look differently.\n * In the future we won't have this checks: instead we will forward\n * the event to the corresponding \"track appender\" and it will determine\n * how the event shall be rendered.\n **/\nexport const enum EntryType {\n  FRAME = 'Frame',\n  TRACK_APPENDER = 'TrackAppender',\n  SCREENSHOT = 'Screenshot',\n}\n"]}