{"version":3,"file":"TimelineLayersView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineLayersView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2014 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport type * as Common from '../../core/common/common.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as LayerViewer from '../layer_viewer/layer_viewer.js';\n\nimport type {TracingFrameLayerTree} from './TracingLayerTree.js';\n\nexport class TimelineLayersView extends UI.SplitWidget.SplitWidget {\n  private readonly showPaintProfilerCallback: (arg0: SDK.PaintProfiler.PaintProfilerSnapshot) => void;\n  private readonly rightSplitWidget: UI.SplitWidget.SplitWidget;\n  private readonly layerViewHost: LayerViewer.LayerViewHost.LayerViewHost;\n  private readonly layers3DView: LayerViewer.Layers3DView.Layers3DView;\n  private frameLayerTree?: TracingFrameLayerTree;\n  private updateWhenVisible?: boolean;\n  constructor(showPaintProfilerCallback: (arg0: SDK.PaintProfiler.PaintProfilerSnapshot) => void) {\n    super(true, false, 'timeline-layers-view');\n    this.showPaintProfilerCallback = showPaintProfilerCallback;\n\n    this.element.classList.add('timeline-layers-view');\n    this.rightSplitWidget = new UI.SplitWidget.SplitWidget(true, true, 'timeline-layers-view-details');\n    this.rightSplitWidget.element.classList.add('timeline-layers-view-properties');\n    this.setMainWidget(this.rightSplitWidget);\n\n    const vbox = new UI.Widget.VBox();\n    this.setSidebarWidget(vbox);\n\n    this.layerViewHost = new LayerViewer.LayerViewHost.LayerViewHost();\n\n    const layerTreeOutline = new LayerViewer.LayerTreeOutline.LayerTreeOutline(this.layerViewHost);\n    vbox.element.appendChild(layerTreeOutline.element);\n\n    this.layers3DView = new LayerViewer.Layers3DView.Layers3DView(this.layerViewHost);\n    this.layers3DView.addEventListener(\n        LayerViewer.Layers3DView.Events.PAINT_PROFILER_REQUESTED, this.onPaintProfilerRequested, this);\n    this.rightSplitWidget.setMainWidget(this.layers3DView);\n\n    const layerDetailsView = new LayerViewer.LayerDetailsView.LayerDetailsView(this.layerViewHost);\n    this.rightSplitWidget.setSidebarWidget(layerDetailsView);\n    layerDetailsView.addEventListener(\n        LayerViewer.LayerDetailsView.Events.PAINT_PROFILER_REQUESTED, this.onPaintProfilerRequested, this);\n  }\n\n  showLayerTree(frameLayerTree: TracingFrameLayerTree): void {\n    this.frameLayerTree = frameLayerTree;\n    if (this.isShowing()) {\n      this.update();\n    } else {\n      this.updateWhenVisible = true;\n    }\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    if (this.updateWhenVisible) {\n      this.updateWhenVisible = false;\n      this.update();\n    }\n  }\n\n  private async onPaintProfilerRequested(\n      event: Common.EventTarget.EventTargetEvent<LayerViewer.LayerViewHost.Selection>): Promise<void> {\n    const selection = event.data;\n    const snapshotWithRect = await this.layers3DView.snapshotForSelection(selection);\n    if (snapshotWithRect) {\n      this.showPaintProfilerCallback(snapshotWithRect.snapshot);\n    }\n  }\n\n  update(): void {\n    if (this.frameLayerTree) {\n      void this.frameLayerTree.layerTreePromise().then(layerTree => this.layerViewHost.setLayerTree(layerTree));\n    }\n  }\n}\n"]}