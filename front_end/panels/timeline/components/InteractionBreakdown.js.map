{"version":3,"file":"InteractionBreakdown.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/InteractionBreakdown.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,IAAI,MAAM,4BAA4B,CAAC;AAEnD,OAAO,KAAK,EAAE,MAAM,8BAA8B,CAAC;AACnD,OAAO,KAAK,GAAG,MAAM,wBAAwB,CAAC;AAE9C,OAAO,0BAA0B,MAAM,+BAA+B,CAAC;AAEvE,MAAM,EAAC,IAAI,EAAC,GAAG,GAAG,CAAC;AAEnB,MAAM,SAAS,GAAG;IAChB;;OAEG;IACH,UAAU,EAAE,aAAa;IACzB;;OAEG;IACH,kBAAkB,EAAE,qBAAqB;IACzC;;OAEG;IACH,iBAAiB,EAAE,oBAAoB;CAC/B,CAAC;AAEX,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,oDAAoD,EAAE,SAAS,CAAC,CAAC;AAC1G,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAQtE,MAAM,CAAC,MAAM,YAAY,GAAS,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE;IAC1D,MAAM,EAAC,KAAK,EAAC,GAAG,KAAK,CAAC;IAEtB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,+BAA+B,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IACxF,MAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,+BAA+B,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;IACpG,MAAM,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,+BAA+B,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;IAEtG,mBAAmB;IACnB,GAAG,CAAC,MAAM,CACR,IAAI,CAAA,UAAU,0BAA0B;;uCAEL,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,uBAAuB,UAAU;+CACzD,UAAU,CAAC,SAAS,CAAC,kBAAkB,CAAC,uBAAuB,cAAc;8CAC9E,UAAU,CAAC,SAAS,CAAC,iBAAiB,CAAC,uBAAuB,iBAAiB;;GAE1H,EAAE,MAAM,CAAC,CAAC;IACX,kBAAkB;AACpB,CAAC,CAAC;AAEF,MAAM,OAAO,oBAAqB,SAAQ,EAAE,CAAC,MAAM,CAAC,MAAM;IACxD,MAAM,CAAC,mBAAmB,CAAC,KAAkD;QAE3E,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAkD,CAAC;QACjH,aAAa,CAAC,YAAY,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,oBAAoB,EAAE,EAAC,KAAK,EAAC,CAAC,CAAC;QACnF,OAAO,aAAa,CAAC;IACvB,CAAC;IAED,KAAK,CAAO;IACZ,MAAM,GAAqD,IAAI,CAAC;IAEhE,YAAY,OAAqB,EAAE,OAAa,YAAY;QAC1D,KAAK,CAAC,OAAO,EAAE,EAAC,YAAY,EAAE,IAAI,EAAC,CAAC,CAAC;QACrC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACpB,CAAC;IAED,IAAI,KAAK,CAAC,KAAkD;QAC1D,IAAI,KAAK,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;YAC1B,OAAO;QACT,CAAC;QAED,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEQ,aAAa;QACpB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACjB,OAAO;QACT,CAAC;QAED,MAAM,KAAK,GAAc;YACvB,KAAK,EAAE,IAAI,CAAC,MAAM;SACnB,CAAC;QACF,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;IACpD,CAAC;CACF","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Trace from '../../../models/trace/trace.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\n\nimport interactionBreakdownStyles from './interactionBreakdown.css.js';\n\nconst {html} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Text shown next to the interaction event's input delay time in the detail view.\n   */\n  inputDelay: 'Input delay',\n  /**\n   * @description Text shown next to the interaction event's thread processing duration in the detail view.\n   */\n  processingDuration: 'Processing duration',\n  /**\n   * @description Text shown next to the interaction event's presentation delay time in the detail view.\n   */\n  presentationDelay: 'Presentation delay',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/components/InteractionBreakdown.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface ViewInput {\n  entry: Trace.Types.Events.SyntheticInteractionPair;\n}\n\ntype View = (input: ViewInput, output: undefined, target: HTMLElement) => void;\n\nexport const DEFAULT_VIEW: View = (input, output, target) => {\n  const {entry} = input;\n\n  const inputDelay = i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(entry.inputDelay);\n  const mainThreadTime = i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(entry.mainThreadHandling);\n  const presentationDelay = i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(entry.presentationDelay);\n\n  // clang-format off\n  Lit.render(\n    html`<style>${interactionBreakdownStyles}</style>\n      <ul class=\"breakdown\">\n        <li data-entry=\"input-delay\">${i18nString(UIStrings.inputDelay)}<span class=\"value\">${inputDelay}</span></li>\n        <li data-entry=\"processing-duration\">${i18nString(UIStrings.processingDuration)}<span class=\"value\">${mainThreadTime}</span></li>\n        <li data-entry=\"presentation-delay\">${i18nString(UIStrings.presentationDelay)}<span class=\"value\">${presentationDelay}</span></li>\n      </ul>\n  `, target);\n  // clang-format on\n};\n\nexport class InteractionBreakdown extends UI.Widget.Widget {\n  static createWidgetElement(entry: Trace.Types.Events.SyntheticInteractionPair):\n      UI.Widget.WidgetElement<InteractionBreakdown> {\n    const widgetElement = document.createElement('devtools-widget') as UI.Widget.WidgetElement<InteractionBreakdown>;\n    widgetElement.widgetConfig = UI.Widget.widgetConfig(InteractionBreakdown, {entry});\n    return widgetElement;\n  }\n\n  #view: View;\n  #entry: Trace.Types.Events.SyntheticInteractionPair|null = null;\n\n  constructor(element?: HTMLElement, view: View = DEFAULT_VIEW) {\n    super(element, {useShadowDom: true});\n    this.#view = view;\n  }\n\n  set entry(entry: Trace.Types.Events.SyntheticInteractionPair) {\n    if (entry === this.#entry) {\n      return;\n    }\n\n    this.#entry = entry;\n    this.requestUpdate();\n  }\n\n  override performUpdate(): void {\n    if (!this.#entry) {\n      return;\n    }\n\n    const input: ViewInput = {\n      entry: this.#entry,\n    };\n    this.#view(input, undefined, this.contentElement);\n  }\n}\n"]}