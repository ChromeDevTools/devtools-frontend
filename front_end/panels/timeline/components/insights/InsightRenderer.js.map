{"version":3,"file":"InsightRenderer.js","sourceRoot":"","sources":["../../../../../../../../front_end/panels/timeline/components/insights/InsightRenderer.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Trace from '../../../../models/trace/trace.js';\nimport * as UI from '../../../../ui/legacy/legacy.js';\n\nimport type {BaseInsightComponent} from './BaseInsightComponent.js';\nimport {Cache} from './Cache.js';\nimport {CLSCulprits} from './CLSCulprits.js';\nimport {DocumentLatency} from './DocumentLatency.js';\nimport {DOMSize} from './DOMSize.js';\nimport {DuplicatedJavaScript} from './DuplicatedJavaScript.js';\nimport {FontDisplay} from './FontDisplay.js';\nimport {ForcedReflow} from './ForcedReflow.js';\nimport {ImageDelivery} from './ImageDelivery.js';\nimport {INPBreakdown} from './INPBreakdown.js';\nimport {LCPBreakdown} from './LCPBreakdown.js';\nimport {LCPDiscovery} from './LCPDiscovery.js';\nimport {LegacyJavaScript} from './LegacyJavaScript.js';\nimport {ModernHTTP} from './ModernHTTP.js';\nimport {NetworkDependencyTree} from './NetworkDependencyTree.js';\nimport {RenderBlocking} from './RenderBlocking.js';\nimport {SlowCSSSelector} from './SlowCSSSelector.js';\nimport {ThirdParties} from './ThirdParties.js';\nimport {Viewport} from './Viewport.js';\n\nconst {widgetConfig} = UI.Widget;\n\ntype InsightWidgetElement = UI.Widget.WidgetElement<BaseInsightComponent<Trace.Insights.Types.InsightModel>>;\n\n/**\n * Every insight (INCLUDING experimental ones).\n *\n * Order does not matter (but keep alphabetized).\n */\nconst INSIGHT_NAME_TO_COMPONENT = {\n  Cache,\n  CLSCulprits,\n  DocumentLatency,\n  DOMSize,\n  DuplicatedJavaScript,\n  FontDisplay,\n  ForcedReflow,\n  ImageDelivery,\n  INPBreakdown,\n  LCPDiscovery,\n  LCPBreakdown,\n  LegacyJavaScript,\n  ModernHTTP,\n  NetworkDependencyTree,\n  RenderBlocking,\n  SlowCSSSelector,\n  ThirdParties,\n  Viewport,\n};\n\nexport class InsightRenderer {\n  #insightWidgetCache = new WeakMap<Trace.Insights.Types.InsightModel, InsightWidgetElement>();\n\n  renderInsightToWidgetElement(\n      parsedTrace: Trace.TraceModel.ParsedTrace, insightSet: Trace.Insights.Types.InsightSet,\n      model: Trace.Insights.Types.InsightModel, insightName: string,\n      options: Partial<Pick<\n          BaseInsightComponent<Trace.Insights.Types.InsightModel>,\n          'selected'|'agentFocus'|'fieldMetrics'|'isAIAssistanceContext'>>): InsightWidgetElement {\n    let widgetElement = this.#insightWidgetCache.get(model);\n    if (!widgetElement) {\n      widgetElement = document.createElement('devtools-widget') as InsightWidgetElement;\n      widgetElement.classList.add('insight-component-widget');\n      this.#insightWidgetCache.set(model, widgetElement);\n    }\n\n    const componentClass = INSIGHT_NAME_TO_COMPONENT[insightName as keyof typeof INSIGHT_NAME_TO_COMPONENT];\n    widgetElement.widgetConfig = widgetConfig(componentClass, {\n      selected: options.selected ?? false,\n      parsedTrace,\n      // The `model` passed in as a parameter is the base type, but since\n      // `componentClass` is the union of every derived insight component, the\n      // `model` for the widget config is the union of every model. That can't be\n      // satisfied, so disable typescript.\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      model: model as any,\n      bounds: insightSet.bounds,\n      insightSetKey: insightSet.id,\n      agentFocus: options.agentFocus ?? null,\n      fieldMetrics: options.fieldMetrics ?? null,\n      isAIAssistanceContext: options.isAIAssistanceContext ?? false,\n    });\n\n    return widgetElement;\n  }\n}\n"]}