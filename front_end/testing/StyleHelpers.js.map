{"version":3,"file":"StyleHelpers.js","sourceRoot":"","sources":["../../../../../front_end/testing/StyleHelpers.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../core/sdk/sdk.js';\nimport * as Protocol from '../generated/protocol.js';\n\nimport {\n  clearMockConnectionResponseHandler,\n  type ProtocolCommandHandler,\n  setMockConnectionResponseHandler\n} from './MockConnection.js';\n\nexport function getMatchedStylesWithStylesheet(payload: {\n  cssModel: SDK.CSSModel.CSSModel,\n  origin: Protocol.CSS.StyleSheetOrigin,\n  styleSheetId: Protocol.CSS.StyleSheetId,\n  getEnvironmentVariablesCallback?: ProtocolCommandHandler<'CSS.getEnvironmentVariables'>,\n}&Partial<Protocol.CSS.CSSStyleSheetHeader>&Partial<SDK.CSSMatchedStyles.CSSMatchedStylesPayload>):\n    Promise<SDK.CSSMatchedStyles.CSSMatchedStyles> {\n  payload.cssModel.styleSheetAdded({\n    frameId: '' as Protocol.Page.FrameId,\n    sourceURL: '',\n    title: '',\n    disabled: false,\n    isInline: false,\n    isMutable: false,\n    isConstructed: false,\n    startLine: 0,\n    startColumn: 0,\n    length: 0,\n    endLine: 0,\n    endColumn: 0,\n    ...payload,\n  });\n  return getMatchedStyles(payload, payload.getEnvironmentVariablesCallback);\n}\n\nexport function getMatchedStylesWithBlankRule(payload: {\n  cssModel: SDK.CSSModel.CSSModel,\n  selector?: string,\n  range?: Protocol.CSS.SourceRange,\n  origin?: Protocol.CSS.StyleSheetOrigin,\n  styleSheetId?: Protocol.CSS.StyleSheetId,\n  getEnvironmentVariablesCallback?: ProtocolCommandHandler<'CSS.getEnvironmentVariables'>,\n}&Partial<SDK.CSSMatchedStyles.CSSMatchedStylesPayload>) {\n  return getMatchedStylesWithProperties({properties: {}, ...payload});\n}\n\nexport function createCSSStyle(\n    cssProperties: Protocol.CSS.CSSProperty[],\n    range?: Protocol.CSS.SourceRange,\n    styleSheetId = '0' as Protocol.CSS.StyleSheetId,\n    ): Protocol.CSS.CSSStyle {\n  return {\n    cssProperties,\n    styleSheetId,\n    range,\n    shorthandEntries: [],\n  };\n}\n\nfunction getSimpleList(selector: string): Protocol.CSS.SelectorList {\n  return {\n    selectors: [{text: selector}],\n    text: selector,\n  };\n}\n\nexport function ruleMatch(\n    selectorOrList: string|Protocol.CSS.SelectorList,\n    properties: Protocol.CSS.CSSProperty[]|Record<string, string>,\n    options: {\n      range?: Protocol.CSS.SourceRange,\n      origin?: Protocol.CSS.StyleSheetOrigin,\n      styleSheetId?: Protocol.CSS.StyleSheetId,\n      /** Matches all selectors if undefined */\n      matchingSelectorsIndexes?: number[],\n      nestingSelectors?: string[],\n    } = {},\n    ): Protocol.CSS.RuleMatch {\n  const {\n    range,\n    origin = Protocol.CSS.StyleSheetOrigin.Regular,\n    styleSheetId,\n    matchingSelectorsIndexes,\n    nestingSelectors,\n  } = options;\n\n  const cssProperties =\n      Array.isArray(properties) ? properties : Object.keys(properties).map(name => ({name, value: properties[name]}));\n  const selectorList = typeof selectorOrList === 'string' ? getSimpleList(selectorOrList) : selectorOrList;\n  const matchingSelectors = matchingSelectorsIndexes ?? selectorList.selectors.map((_, index) => index);\n\n  return {\n    rule: {\n      nestingSelectors,\n      selectorList,\n      origin,\n      style: createCSSStyle(cssProperties, range, styleSheetId),\n      styleSheetId,\n    },\n    matchingSelectors,\n  };\n}\n\nexport function getMatchedStylesWithProperties(payload: {\n  cssModel: SDK.CSSModel.CSSModel,\n  properties: Protocol.CSS.CSSProperty[]|Record<string, string>,\n  selector?: string,\n  range?: Protocol.CSS.SourceRange,\n  origin?: Protocol.CSS.StyleSheetOrigin,\n  styleSheetId?: Protocol.CSS.StyleSheetId,\n  getEnvironmentVariablesCallback?: ProtocolCommandHandler<'CSS.getEnvironmentVariables'>,\n}&Partial<SDK.CSSMatchedStyles.CSSMatchedStylesPayload>) {\n  const styleSheetId = payload.styleSheetId ?? '0' as Protocol.CSS.StyleSheetId;\n  const range = payload.range;\n  const origin = payload.origin ?? Protocol.CSS.StyleSheetOrigin.Regular;\n  const matchedPayload = [ruleMatch(payload.selector ?? 'div', payload.properties, {range, origin, styleSheetId})];\n  return getMatchedStylesWithStylesheet({styleSheetId, origin, matchedPayload, ...payload});\n}\n\nexport function getMatchedStyles(\n    payload: Partial<SDK.CSSMatchedStyles.CSSMatchedStylesPayload> = {},\n    getEnvironmentVariablesCallback: ProtocolCommandHandler<'CSS.getEnvironmentVariables'> = () =>\n        ({environmentVariables: {}})) {\n  clearMockConnectionResponseHandler('CSS.getEnvironmentVariables');\n  setMockConnectionResponseHandler('CSS.getEnvironmentVariables', getEnvironmentVariablesCallback);\n  let node = payload.node;\n  if (!node) {\n    node = sinon.createStubInstance(SDK.DOMModel.DOMNode);\n    node.id = 1 as Protocol.DOM.NodeId;\n  }\n\n  let cssModel = payload.cssModel;\n  if (!cssModel) {\n    cssModel = sinon.createStubInstance(SDK.CSSModel.CSSModel);\n  }\n  return SDK.CSSMatchedStyles.CSSMatchedStyles.create({\n    cssModel,\n    node,\n    inlinePayload: null,\n    attributesPayload: null,\n    matchedPayload: [],\n    pseudoPayload: [],\n    inheritedPayload: [],\n    inheritedPseudoPayload: [],\n    animationsPayload: [],\n    parentLayoutNodeId: undefined,\n    positionTryRules: [],\n    propertyRules: [],\n    cssPropertyRegistrations: [],\n    atRules: [],\n    activePositionFallbackIndex: -1,\n    animationStylesPayload: [],\n    transitionsStylePayload: null,\n    inheritedAnimatedPayload: [],\n    functionRules: [],\n    ...payload,\n  });\n}\n"]}