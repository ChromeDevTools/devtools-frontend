{"version":3,"file":"ViewFunctionHelpers.js","sourceRoot":"","sources":["../../../../../front_end/testing/ViewFunctionHelpers.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAsC7B,MAAM,UAAU,sBAAsB,CAClC,YAAgC,EAChC,YAA6C;IAE/C,MAAM,MAAM,GACR,KAAK,CAAC,IAAI,CACN,CAAC,KAAoC,EAAE,MAAsC,EAAE,OAAoB,EAAE,EAAE;QACrG,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;QACrB,IAAI,MAAM,IAAI,YAAY,EAAE,CAAC;YAC3B,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QACtC,CAAC;QACD,MAAM,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;IAC1B,CAAC,CAAyC,CAAC;IACnD,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,WAAW,EAAE;QACzC,GAAG;YACD,OAAO,IAAI,OAAO,CAAgC,OAAO,CAAC,EAAE;gBAC1D,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;YAC3B,CAAC,CAAC,CAAC;QACL,CAAC;KACF,CAAC,CAAC;IACH,OAAO,MAA8C,CAAC;AACxD,CAAC","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Platform from '../core/platform/platform.js';\nimport type * as UI from '../ui/legacy/legacy.js';\n\ntype WidgetConstructor = Platform.Constructor.AbstractConstructor<UI.Widget.Widget|HTMLElement>;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype ViewFunctionLike = (input: any, output: any, target: HTMLElement) => void;\n\ntype FindViewFunction<ParametersT extends readonly unknown[]> = ParametersT extends [infer Head, ...infer Tail] ?\n    Head extends ViewFunctionLike ? Head : FindViewFunction<Tail>:\n    never;\n\ntype ViewFunction<WidgetConstructorT extends WidgetConstructor> =\n    FindViewFunction<Required<ConstructorParameters<WidgetConstructorT>>>;\n\ntype ViewFunctionParameters<WidgetConstructorT extends WidgetConstructor> =\n    Parameters<ViewFunction<WidgetConstructorT>>;\n\ntype ViewInput<WidgetConstructorT extends WidgetConstructor> = ViewFunctionParameters<WidgetConstructorT>[0];\n\ntype ViewOutput<WidgetConstructorT extends WidgetConstructor> = ViewFunctionParameters<WidgetConstructorT>[1];\n\ninterface ViewStubExtensions<WidgetConstructorT extends WidgetConstructor> extends\n    sinon.SinonSpy<[ViewInput<WidgetConstructorT>, ViewOutput<WidgetConstructorT>, HTMLElement], void> {\n  input: ViewInput<WidgetConstructorT>;\n  nextInput: Promise<ViewInput<WidgetConstructorT>>;\n  callCount: number;\n}\n\ninterface InternalViewStubExtensions<WidgetConstructorT extends WidgetConstructor> extends\n    ViewStubExtensions<WidgetConstructorT> {\n  invoked?: (input: ViewInput<WidgetConstructorT>) => void;\n}\n\nexport type ViewFunctionStub<WidgetConstructorT extends WidgetConstructor> =\n    ViewFunction<WidgetConstructorT>&ViewStubExtensions<WidgetConstructorT>;\n\nexport function createViewFunctionStub<WidgetConstructorT extends WidgetConstructor>(\n    _constructor: WidgetConstructorT,\n    outputValues?: ViewOutput<WidgetConstructorT>,\n    ): ViewFunctionStub<WidgetConstructorT> {\n  const result: InternalViewStubExtensions<WidgetConstructorT> =\n      sinon.fake(\n          (input: ViewInput<WidgetConstructorT>, output: ViewOutput<WidgetConstructorT>, _target: HTMLElement) => {\n            result.input = input;\n            if (output && outputValues) {\n              Object.assign(output, outputValues);\n            }\n            result.invoked?.(input);\n          }) as ViewFunctionStub<WidgetConstructorT>;\n  Object.defineProperty(result, 'nextInput', {\n    get() {\n      return new Promise<ViewInput<WidgetConstructorT>>(resolve => {\n        result.invoked = resolve;\n      });\n    }\n  });\n  return result as ViewFunctionStub<WidgetConstructorT>;\n}\n"]}