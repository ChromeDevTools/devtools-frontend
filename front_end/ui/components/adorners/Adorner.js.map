{"version":3,"file":"Adorner.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/adorners/Adorner.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-lit-render-outside-of-view, @devtools/enforce-custom-element-definitions-location */\n\nimport type * as Platform from '../../../core/platform/platform.js';\nimport {html, render} from '../../../ui/lit/lit.js';\nimport * as UI from '../../legacy/legacy.js';\nimport * as VisualElements from '../../visual_logging/visual_logging.js';\n\nimport adornerStyles from './adorner.css.js';\n\nexport interface AdornerData {\n  name: string;\n  content?: HTMLElement;\n  jslogContext?: string;\n}\n\nexport class Adorner extends HTMLElement {\n  name = '';\n\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #isToggle = false;\n  #ariaLabelDefault?: string;\n  #ariaLabelActive?: string;\n  #content?: HTMLElement;\n  #jslogContext?: string;\n\n  set data(data: AdornerData) {\n    this.name = data.name;\n    this.#jslogContext = data.jslogContext;\n    if (data.content) {\n      this.#content?.remove();\n      this.append(data.content);\n      this.#content = data.content;\n    }\n    this.#render();\n  }\n\n  override cloneNode(deep?: boolean): Node {\n    const node = UI.UIUtils.cloneCustomElement(this, deep);\n    node.data = {name: this.name, content: this.#content, jslogContext: this.#jslogContext};\n    return node;\n  }\n\n  connectedCallback(): void {\n    if (!this.getAttribute('aria-label')) {\n      this.setAttribute('aria-label', this.name);\n    }\n    if (this.#jslogContext && !this.getAttribute('jslog')) {\n      this.setAttribute('jslog', `${VisualElements.adorner(this.#jslogContext)}`);\n    }\n    this.#render();\n  }\n\n  isActive(): boolean {\n    return this.getAttribute('aria-pressed') === 'true';\n  }\n\n  /**\n   * Toggle the active state of the adorner. Optionally pass `true` to force-set\n   * an active state; pass `false` to force-set an inactive state.\n   */\n  toggle(forceActiveState?: boolean): void {\n    if (!this.#isToggle) {\n      return;\n    }\n    const shouldBecomeActive = forceActiveState === undefined ? !this.isActive() : forceActiveState;\n    this.setAttribute('aria-pressed', Boolean(shouldBecomeActive).toString());\n    this.setAttribute('aria-label', (shouldBecomeActive ? this.#ariaLabelActive : this.#ariaLabelDefault) || this.name);\n  }\n\n  show(): void {\n    this.classList.remove('hidden');\n  }\n\n  hide(): void {\n    this.classList.add('hidden');\n  }\n\n  /**\n   * Make adorner interactive by responding to click events with the provided action\n   * and simulating ARIA-capable toggle button behavior.\n   */\n  addInteraction(action: EventListener, options: {\n    ariaLabelDefault: Platform.UIString.LocalizedString,\n    ariaLabelActive: Platform.UIString.LocalizedString,\n    isToggle?: boolean,\n    shouldPropagateOnKeydown?: boolean,\n  }): void {\n    const {isToggle = false, shouldPropagateOnKeydown = false, ariaLabelDefault, ariaLabelActive} = options;\n\n    this.#isToggle = isToggle;\n    this.#ariaLabelDefault = ariaLabelDefault;\n    this.#ariaLabelActive = ariaLabelActive;\n    this.setAttribute('aria-label', ariaLabelDefault);\n    if (this.#jslogContext) {\n      this.setAttribute('jslog', `${VisualElements.adorner(this.#jslogContext).track({click: true})}`);\n    }\n\n    if (isToggle) {\n      this.addEventListener('click', () => {\n        this.toggle();\n      });\n      this.toggle(false /* initialize inactive state */);\n    }\n\n    this.addEventListener('click', action);\n\n    // Simulate an ARIA-capable toggle button\n    this.classList.add('clickable');\n    this.setAttribute('role', 'button');\n    this.tabIndex = 0;\n    this.addEventListener('keydown', event => {\n      if (event.code === 'Enter' || event.code === 'Space') {\n        this.click();\n        if (!shouldPropagateOnKeydown) {\n          event.stopPropagation();\n        }\n      }\n    });\n  }\n\n  #render(): void {\n    render(html`<style>${adornerStyles}</style><slot></slot>`, this.#shadow, {host: this});\n  }\n}\n\ncustomElements.define('devtools-adorner', Adorner);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-adorner': Adorner;\n  }\n}\n"]}