{
  "version": 3,
  "sources": ["../../../../../../../front_end/ui/components/annotations/AnnotationRepository.ts", "../../../../../../../front_end/ui/components/annotations/AnnotationType.ts"],
  "sourcesContent": ["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport * as Root from '../../../core/root/root.js';\nimport type * as SDK from '../../../core/sdk/sdk.js';\n\nimport {AnnotationType} from './AnnotationType.js';\n\ninterface BaseAnnotationData {\n  id: number;\n  type: AnnotationType;\n  message: string;\n  // Sometimes the anchor for an annotation is not known, but is provided using a\n  // string id instead (which can be converted to an `anchor` later).\n  lookupId: string;\n  // Sometimes we want annotations to anchor to a particular string on the page.\n  anchorToString?: string;\n}\n\nexport interface ElementsAnnotationData extends BaseAnnotationData {\n  type: AnnotationType.ELEMENT_NODE;\n  anchor?: SDK.DOMModel.DOMNode;\n}\n\nexport const enum Events {\n  ANNOTATION_ADDED = 'AnnotationAdded',\n}\n\nexport interface EventTypes {\n  [Events.ANNOTATION_ADDED]: BaseAnnotationData;\n}\n\nexport class AnnotationRepository {\n  static #instance: AnnotationRepository|null = null;\n  #events = new Common.ObjectWrapper.ObjectWrapper<EventTypes>();\n  #annotations: BaseAnnotationData[] = [];\n  #nextId = 0;\n\n  static instance(): AnnotationRepository {\n    if (!AnnotationRepository.#instance) {\n      AnnotationRepository.#instance = new AnnotationRepository();\n    }\n    return AnnotationRepository.#instance;\n  }\n\n  static annotationsEnabled(): boolean {\n    return Boolean(Root.Runtime.hostConfig.devToolsGreenDevUi?.enabled);\n  }\n\n  addEventListener<T extends keyof EventTypes>(\n      eventType: T, listener: (arg0: Common.EventTarget.EventTargetEvent<EventTypes[T]>) => void,\n      thisObject?: Object): Common.EventTarget.EventDescriptor<EventTypes, T> {\n    if (!AnnotationRepository.annotationsEnabled()) {\n      console.warn('Received request to add event listener with annotations disabled');\n    }\n    return this.#events.addEventListener(eventType, listener, thisObject);\n  }\n\n  getAnnotationsByType(type: AnnotationType): BaseAnnotationData[] {\n    if (!AnnotationRepository.annotationsEnabled()) {\n      console.warn('Received query for annotation types with annotations disabled');\n      return [];\n    }\n\n    const annotations = this.#annotations.filter(annotation => annotation.type === type);\n    return annotations;\n  }\n\n  addElementsAnnotation(\n      label: string,\n      lookupId?: string,\n      anchor?: SDK.DOMModel.DOMNode,\n      anchorToString?: string,\n      ): void {\n    if (!AnnotationRepository.annotationsEnabled()) {\n      console.warn('Received annotation registration with annotations disabled');\n      return;\n    }\n\n    const annotationData: ElementsAnnotationData = {\n      id: this.#nextId++,\n      type: AnnotationType.ELEMENT_NODE,\n      message: label,\n      lookupId: lookupId || '',\n      anchor,\n      anchorToString\n    };\n    this.#annotations.push(annotationData);\n    // eslint-disable-next-line no-console\n    console.log('[AnnotationRepository] Added annotation:', label, {\n      annotationData,\n      annotations: this.#annotations.length,\n    });\n    this.#events.dispatchEventToListeners(Events.ANNOTATION_ADDED, annotationData);\n  }\n}\n", "// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nexport enum AnnotationType {\n  ELEMENT_NODE = 0,\n  STYLE_RULE = 1,\n  NETWORK_REQUEST = 2,\n  NETWORK_REQUEST_SUBPANEL_HEADERS = 3,\n}\n"],
  "mappings": ";AAIA,YAAY,YAAY;AACxB,YAAY,UAAU;;;ACDtB,IAAY;CAAZ,SAAYA,iBAAc;AACxB,EAAAA,gBAAAA,gBAAA,cAAA,IAAA,CAAA,IAAA;AACA,EAAAA,gBAAAA,gBAAA,YAAA,IAAA,CAAA,IAAA;AACA,EAAAA,gBAAAA,gBAAA,iBAAA,IAAA,CAAA,IAAA;AACA,EAAAA,gBAAAA,gBAAA,kCAAA,IAAA,CAAA,IAAA;AACF,GALY,mBAAA,iBAAc,CAAA,EAAA;;;AD8BpB,IAAO,uBAAP,MAAO,sBAAoB;EAC/B,OAAO,YAAuC;EAC9C,UAAU,IAAW,qBAAc,cAAa;EAChD,eAAqC,CAAA;EACrC,UAAU;EAEV,OAAO,WAAQ;AACb,QAAI,CAAC,sBAAqB,WAAW;AACnC,4BAAqB,YAAY,IAAI,sBAAoB;IAC3D;AACA,WAAO,sBAAqB;EAC9B;EAEA,OAAO,qBAAkB;AACvB,WAAO,QAAa,aAAQ,WAAW,oBAAoB,OAAO;EACpE;EAEA,iBACI,WAAc,UACd,YAAmB;AACrB,QAAI,CAAC,sBAAqB,mBAAkB,GAAI;AAC9C,cAAQ,KAAK,kEAAkE;IACjF;AACA,WAAO,KAAK,QAAQ,iBAAiB,WAAW,UAAU,UAAU;EACtE;EAEA,qBAAqB,MAAoB;AACvC,QAAI,CAAC,sBAAqB,mBAAkB,GAAI;AAC9C,cAAQ,KAAK,+DAA+D;AAC5E,aAAO,CAAA;IACT;AAEA,UAAM,cAAc,KAAK,aAAa,OAAO,gBAAc,WAAW,SAAS,IAAI;AACnF,WAAO;EACT;EAEA,sBACI,OACA,UACA,QACA,gBAAuB;AAEzB,QAAI,CAAC,sBAAqB,mBAAkB,GAAI;AAC9C,cAAQ,KAAK,4DAA4D;AACzE;IACF;AAEA,UAAM,iBAAyC;MAC7C,IAAI,KAAK;MACT,MAAM,eAAe;MACrB,SAAS;MACT,UAAU,YAAY;MACtB;MACA;;AAEF,SAAK,aAAa,KAAK,cAAc;AAErC,YAAQ,IAAI,4CAA4C,OAAO;MAC7D;MACA,aAAa,KAAK,aAAa;KAChC;AACD,SAAK,QAAQ,yBAAwB,mBAA0B,cAAc;EAC/E;;",
  "names": ["AnnotationType"]
}
