{
  "version": 3,
  "sources": ["../../../../../../../front_end/ui/components/helpers/scheduled-render.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as RenderCoordinator from '../render_coordinator/render_coordinator.js';\n\nexport type RenderCallback = () => (void|Promise<void>);\n\nconst requests = new Map<HTMLElement, {callback: RenderCallback, promise: Promise<void>}>();\nconst active = new Set<HTMLElement>();\n\nexport function scheduleRender(component: HTMLElement, callback: RenderCallback): Promise<void> {\n  const request = requests.get(component);\n  if (request !== undefined) {\n    if (request.callback !== callback) {\n      throw new TypeError(\n          `Incompatible callback arguments for scheduling rendering of ${component.nodeName.toLowerCase()}`);\n    }\n    return request.promise;\n  }\n\n  const promise = RenderCoordinator.write(async () => {\n    try {\n      active.add(component);\n      requests.delete(component);\n      await callback.call(component);\n    } catch (error) {\n      console.error(`ScheduledRender: rendering ${component.nodeName.toLowerCase()}:`);\n      console.error(error);\n      throw error;\n    } finally {\n      active.delete(component);\n    }\n  });\n\n  requests.set(component, {callback, promise});\n  return promise;\n}\n\nexport function isScheduledRender(component: HTMLElement): boolean {\n  return active.has(component);\n}\n"],
  "mappings": ";AAIA,YAAY,uBAAuB;AAInC,MAAM,WAAW,oBAAI,IAAqE;AAC1F,MAAM,SAAS,oBAAI,IAAiB;AAE7B,gBAAS,eAAe,WAAwB,UAAyC;AAC9F,QAAM,UAAU,SAAS,IAAI,SAAS;AACtC,MAAI,YAAY,QAAW;AACzB,QAAI,QAAQ,aAAa,UAAU;AACjC,YAAM,IAAI;AAAA,QACN,+DAA+D,UAAU,SAAS,YAAY,CAAC;AAAA,MAAE;AAAA,IACvG;AACA,WAAO,QAAQ;AAAA,EACjB;AAEA,QAAM,UAAU,kBAAkB,MAAM,YAAY;AAClD,QAAI;AACF,aAAO,IAAI,SAAS;AACpB,eAAS,OAAO,SAAS;AACzB,YAAM,SAAS,KAAK,SAAS;AAAA,IAC/B,SAAS,OAAO;AACd,cAAQ,MAAM,8BAA8B,UAAU,SAAS,YAAY,CAAC,GAAG;AAC/E,cAAQ,MAAM,KAAK;AACnB,YAAM;AAAA,IACR,UAAE;AACA,aAAO,OAAO,SAAS;AAAA,IACzB;AAAA,EACF,CAAC;AAED,WAAS,IAAI,WAAW,EAAC,UAAU,QAAO,CAAC;AAC3C,SAAO;AACT;AAEO,gBAAS,kBAAkB,WAAiC;AACjE,SAAO,OAAO,IAAI,SAAS;AAC7B;",
  "names": []
}
