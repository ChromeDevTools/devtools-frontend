{"version":3,"file":"FilterSuggestionBuilder.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/FilterSuggestionBuilder.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,QAAQ,MAAM,iCAAiC,CAAC;AAI5D,MAAM,OAAO,uBAAuB;IACjB,IAAI,CAAW;IACf,WAAW,CAAyF;IACpG,SAAS,GAAG,IAAI,GAAG,EAAuB,CAAC;IAE5D,YAAY,IAAc,EAAE,WAAsD;QAChF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,WAAW,GAAG,WAAW,IAAI,CAAC,CAAC,CAAS,EAAE,MAAgB,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC;IACrF,CAAC;IAED,WAAW,CAAC,WAAmB,EAAE,MAAc,EAAE,KAAe;QAC9D,IAAI,CAAC,MAAM,IAAI,CAAC,KAAK,EAAE,CAAC;YACtB,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAC7B,CAAC;QAED,MAAM,QAAQ,GAAG,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;QACxC,IAAI,QAAQ,EAAE,CAAC;YACb,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC/B,CAAC;QACD,MAAM,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;QACrC,MAAM,mBAAmB,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEhD,MAAM,WAAW,GAAiB,EAAE,CAAC;QACrC,IAAI,mBAAmB,KAAK,CAAC,CAAC,EAAE,CAAC;YAC/B,MAAM,OAAO,GAAG,IAAI,MAAM,CAAC,GAAG,GAAG,QAAQ,CAAC,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC;YACxF,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;gBAC5B,IAAI,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;oBACtB,WAAW,CAAC,IAAI,CAAC,CAAC,EAAC,IAAI,EAAE,QAAQ,GAAG,GAAG,GAAG,GAAG,EAAC,CAAC,CAAC,CAAC;gBACnD,CAAC;YACH,CAAC;QACH,CAAC;aAAM,CAAC;YACN,MAAM,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,mBAAmB,CAAC,CAAC,WAAW,EAAE,CAAC;YACnE,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,mBAAmB,GAAG,CAAC,CAAC,CAAC;YACxD,MAAM,OAAO,GAAG,IAAI,MAAM,CAAC,GAAG,GAAG,QAAQ,CAAC,eAAe,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC;YACvF,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,GAAG,EAAU,CAAC,CAAC;YACxE,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC9B,KAAK,MAAM,IAAI,IAAI,MAAM,EAAE,CAAC;gBAC1B,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;oBAC3C,WAAW,CAAC,IAAI,CAAC,CAAC,EAAC,IAAI,EAAE,QAAQ,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,EAAC,CAAC,CAAC,CAAC;gBAC1D,CAAC;YACH,CAAC;QACH,CAAC;QACD,OAAO,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IACtC,CAAC;IAED,OAAO,CAAC,GAAW,EAAE,KAAmB;QACtC,IAAI,CAAC,KAAK,EAAE,CAAC;YACX,OAAO;QACT,CAAC;QAED,IAAI,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAClC,IAAI,CAAC,GAAG,EAAE,CAAC;YACT,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,CAAC,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QAC/B,CAAC;QACD,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;IACjB,CAAC;IAED,KAAK;QACH,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;IACzB,CAAC;CACF","sourcesContent":["// Copyright 2017 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../core/platform/platform.js';\n\nimport type {Suggestion} from './SuggestBox.js';\n\nexport class FilterSuggestionBuilder {\n  private readonly keys: string[];\n  private readonly valueSorter: ((arg0: string, arg1: string[]) => void)|((key: string, result: string[]) => string[]);\n  private readonly valuesMap = new Map<string, Set<string>>();\n\n  constructor(keys: string[], valueSorter?: ((arg0: string, arg1: string[]) => void)) {\n    this.keys = keys;\n    this.valueSorter = valueSorter || ((_: string, result: string[]) => result.sort());\n  }\n\n  completions(_expression: string, prefix: string, force?: boolean): Promise<Suggestion[]> {\n    if (!prefix && !force) {\n      return Promise.resolve([]);\n    }\n\n    const negative = prefix.startsWith('-');\n    if (negative) {\n      prefix = prefix.substring(1);\n    }\n    const modifier = negative ? '-' : '';\n    const valueDelimiterIndex = prefix.indexOf(':');\n\n    const suggestions: Suggestion[] = [];\n    if (valueDelimiterIndex === -1) {\n      const matcher = new RegExp('^' + Platform.StringUtilities.escapeForRegExp(prefix), 'i');\n      for (const key of this.keys) {\n        if (matcher.test(key)) {\n          suggestions.push(({text: modifier + key + ':'}));\n        }\n      }\n    } else {\n      const key = prefix.substring(0, valueDelimiterIndex).toLowerCase();\n      const value = prefix.substring(valueDelimiterIndex + 1);\n      const matcher = new RegExp('^' + Platform.StringUtilities.escapeForRegExp(value), 'i');\n      const values = Array.from(this.valuesMap.get(key) || new Set<string>());\n      this.valueSorter(key, values);\n      for (const item of values) {\n        if (matcher.test(item) && (item !== value)) {\n          suggestions.push(({text: modifier + key + ':' + item}));\n        }\n      }\n    }\n    return Promise.resolve(suggestions);\n  }\n\n  addItem(key: string, value?: string|null): void {\n    if (!value) {\n      return;\n    }\n\n    let set = this.valuesMap.get(key);\n    if (!set) {\n      set = (new Set());\n      this.valuesMap.set(key, set);\n    }\n    set.add(value);\n  }\n\n  clear(): void {\n    this.valuesMap.clear();\n  }\n}\n"]}