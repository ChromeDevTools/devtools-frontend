{"version":3,"file":"Floaty.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/Floaty.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as Logs from '../../models/logs/logs.js';\nimport * as Trace from '../../models/trace/trace.js';\nimport * as Buttons from '../components/buttons/buttons.js';\nimport {html, render, type TemplateResult} from '../lit/lit.js';\n\nimport {Context} from './Context.js';\nimport floatyStyles from './floaty.css.js';\nimport {Widget} from './Widget.js';\n\nlet instance: Floaty|null = null;\n\nexport const enum FloatyContextTypes {\n  ELEMENT_NODE_ID = 'ELEMENT_NODE_ID',\n  NETWORK_REQUEST = 'NETWORK_REQUEST',\n  PERFORMANCE_EVENT = 'PERFORMANCE_EVENT',\n  PERFORMANCE_INSIGHT = 'PERFORMANCE_INSIGHT'\n}\n\nexport type FloatyContextSelection = SDK.DOMModel.DOMNode|SDK.NetworkRequest.NetworkRequest|\n                                     {event: Trace.Types.Events.Event, traceStartTime: Trace.Types.Timing.Micro}|\n                                     {insight: Trace.Insights.Types.InsightModel, trace: Trace.TraceModel.ParsedTrace};\n\nconst enum State {\n  READONLY = 'readonly',\n  INSPECT_MODE = 'inspect',\n}\n\nexport class FloatyFlavor {\n  selectedContexts: FloatyContextSelection[] = [];\n\n  constructor(contexts: Set<FloatyContextSelection>) {\n    this.selectedContexts = Array.from(contexts);\n  }\n}\n\nexport class Floaty {\n  static defaultVisibility = false;\n\n  #container: HTMLElement;\n  #floaty: FloatyUI;\n\n  #boundKeyDown = this.#onKeyShortcut.bind(this);\n\n  static exists(): boolean {\n    return instance !== null;\n  }\n\n  static instance(opts: {\n    forceNew: boolean|null,\n    document: Document|null,\n  } = {forceNew: null, document: null}): Floaty {\n    if (instance) {\n      return instance;\n    }\n    if (!opts.document) {\n      throw new Error('document required');\n    }\n    instance = new Floaty(opts.document);\n    return instance;\n  }\n\n  private constructor(document: Document) {\n    // eslint-disable-next-line @devtools/no-imperative-dom-api\n    this.#container = document.createElement('div');\n    this.#container.classList.add('floaty-container');\n    this.#floaty = new FloatyUI();\n    this.#floaty.markAsRoot();\n    this.#insertIntoDOM();\n  }\n\n  #onKeyShortcut(e: KeyboardEvent): void {\n    const origin = e.composedPath().at(0);\n    // If the user was typing into an input field, don't make it trigger the Floaty.\n    if (origin && (origin instanceof HTMLTextAreaElement || origin instanceof HTMLInputElement)) {\n      return;\n    }\n    if (e.key === 'f') {\n      this.open();\n    }\n  }\n\n  #insertIntoDOM(): void {\n    if (Root.Runtime.hostConfig.devToolsGreenDevUi?.enabled) {\n      this.#floaty.show(this.#container);\n      document.body.appendChild(this.#container);\n      document.body.addEventListener('keydown', this.#boundKeyDown);\n    }\n  }\n\n  setDevToolsRect(rect: DOMRect): void {\n    this.#floaty.devtoolsRect = rect;\n  }\n\n  open(): void {\n    this.#floaty.open = true;\n  }\n\n  registerClick(input: Readonly<FloatyClickInput>): void {\n    if (this.#floaty.state !== State.INSPECT_MODE) {\n      return;\n    }\n\n    const type = input.type;  // Switching on type, rather than input.type, means TS narrows it properly.\n    switch (type) {\n      case FloatyContextTypes.ELEMENT_NODE_ID: {\n        const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n        if (!mainTarget) {\n          return;\n        }\n        const domModel = mainTarget.model(SDK.DOMModel.DOMModel);\n        const node = domModel?.nodeForId(input.data.nodeId);\n        if (node) {\n          this.#floaty.addSelectedContext(node);\n        }\n        break;\n      }\n      case FloatyContextTypes.NETWORK_REQUEST: {\n        const networkRequests = Logs.NetworkLog.NetworkLog.instance().requestsForId(input.data.requestId);\n        for (const req of networkRequests) {\n          this.#floaty.addSelectedContext(req);\n        }\n        break;\n      }\n      case FloatyContextTypes.PERFORMANCE_EVENT: {\n        this.#floaty.addSelectedContext(input.data);\n        break;\n      }\n      case FloatyContextTypes.PERFORMANCE_INSIGHT: {\n        this.#floaty.addSelectedContext(input.data);\n        break;\n      }\n      default:\n        Platform.assertNever(type, 'Unsupported Floaty Context type');\n    }\n  }\n\n  inInspectMode(): boolean {\n    return this.#floaty.state === State.INSPECT_MODE;\n  }\n\n  deleteContext(context: FloatyContextSelection): void {\n    this.#floaty.removeSelectedContext(context);\n  }\n}\n\ntype FloatyClickInput = {\n  type: FloatyContextTypes.ELEMENT_NODE_ID,\n  data: {nodeId: Protocol.DOM.NodeId},\n}|{\n  type: FloatyContextTypes.NETWORK_REQUEST,\n  data: {requestId: string},\n}|{\n  type: FloatyContextTypes.PERFORMANCE_EVENT,\n  data: {event: Trace.Types.Events.Event, traceStartTime: Trace.Types.Timing.Micro},\n}|{\n  type: FloatyContextTypes.PERFORMANCE_INSIGHT,\n  data: {\n    insight: Trace.Insights.Types.InsightModel,\n    trace: Trace.TraceModel.ParsedTrace,\n  },\n};\n\nexport function enabled(): boolean {\n  return Root.Runtime.hostConfig.devToolsGreenDevUi?.enabled === true;\n}\n\nexport function onFloatyOpen(): void {\n  if (!enabled()) {\n    return;\n  }\n  Floaty.instance().open();\n}\n\nexport function onFloatyContextDelete(context: FloatyContextSelection): void {\n  if (!enabled()) {\n    return;\n  }\n  Floaty.instance().deleteContext(context);\n}\n\n/**\n * Registers a click to the Floaty.\n * @returns true if the element was added to the floaty context, and false\n * otherwise. This lets callers determine if this should override the default\n * click behaviour.\n */\nexport function onFloatyClick(input: FloatyClickInput): boolean {\n  if (!enabled()) {\n    return false;\n  }\n  const floaty = Floaty.instance();\n  if (floaty.inInspectMode()) {\n    floaty.registerClick(input);\n    return true;\n  }\n  return false;\n}\n\nexport class FloatyUI extends Widget {\n  #view: (input: ViewInput, output: null, target: HTMLElement) => void;\n  #dialog: HTMLDialogElement|null = null;\n  #initialMouseX = 0;\n  #initialMouseY = 0;\n  #initialDialogLeft = 0;\n  #initialDialogTop = 0;\n  #devtoolsRect: DOMRect|null = null;\n  #selectedContexts = new Set<FloatyContextSelection>();\n  #open = Floaty.defaultVisibility;\n  #state = State.READONLY;\n\n  constructor(element?: HTMLElement, view = VIEW) {\n    super(element);\n    this.#view = view;\n  }\n\n  get devtoolsRect(): DOMRect|null {\n    return this.#devtoolsRect;\n  }\n\n  get state(): State {\n    return this.#state;\n  }\n\n  set state(x: State) {\n    this.#state = x;\n    this.requestUpdate();\n  }\n\n  set devtoolsRect(rect: DOMRect) {\n    this.#devtoolsRect = rect;\n    this.#repositionWithNewRect(rect);\n    this.requestUpdate();\n  }\n\n  addSelectedContext(context: FloatyContextSelection): void {\n    if (this.#selectedContexts.has(context)) {\n      return;\n    }\n\n    this.#selectedContexts.add(context);\n    Context.instance().setFlavor(FloatyFlavor, new FloatyFlavor(this.#selectedContexts));\n    this.requestUpdate();\n  }\n\n  removeSelectedContext(context: FloatyContextSelection): void {\n    this.#selectedContexts.delete(context);\n    this.#state = State.READONLY;\n    Context.instance().setFlavor(FloatyFlavor, new FloatyFlavor(this.#selectedContexts));\n    this.requestUpdate();\n  }\n\n  get open(): boolean {\n    return this.#open;\n  }\n\n  set open(open: boolean) {\n    this.#open = open;\n    this.requestUpdate();\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.requestUpdate();\n  }\n\n  #repositionWithNewRect(rect: DOMRect): void {\n    if (!this.#dialog) {\n      return;\n    }\n    const computedStyle = window.getComputedStyle(this.#dialog);\n    const currentLeft = parseInt(computedStyle.left, 10);\n    const currentTop = parseInt(computedStyle.top, 10);\n    this.#dialog.style.left = `${Math.max(currentLeft, rect.left)}px`;\n    this.#dialog.style.top = `${Math.max(currentTop, rect.top)}px`;\n  }\n\n  #onInspectClick(): void {\n    if (this.#state === State.INSPECT_MODE) {\n      this.#state = State.READONLY;\n    } else {\n      this.#state = State.INSPECT_MODE;\n    }\n    this.requestUpdate();\n  }\n\n  #onDialogClose(e: PointerEvent): void {\n    e.preventDefault();\n    this.#open = false;\n    this.requestUpdate();\n  }\n\n  #onContextDelete(context: FloatyContextSelection): (e: MouseEvent) => void {\n    return e => {\n      e.preventDefault();\n      this.removeSelectedContext(context);\n    };\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          open: this.open,\n          onDragStart: this.#onDragStart,\n          selectedContexts: this.#selectedContexts,\n          state: this.#state,\n          onInspectClick: this.#onInspectClick.bind(this),\n          onDialogClose: this.#onDialogClose.bind(this),\n          onContextDelete: this.#onContextDelete.bind(this)\n        },\n        null, this.contentElement);\n    this.#dialog = this.contentElement.querySelector('dialog');\n  }\n\n  #onDragStart = (event: MouseEvent): void => {\n    if (!this.#dialog) {\n      return;\n    }\n    this.#initialMouseX = event.clientX;\n    this.#initialMouseY = event.clientY;\n    const computedStyle = window.getComputedStyle(this.#dialog);\n    this.#initialDialogLeft = parseInt(computedStyle.left, 10);\n    this.#initialDialogTop = parseInt(computedStyle.top, 10);\n\n    document.addEventListener('mousemove', this.#onDrag);\n    document.addEventListener('mouseup', this.#onDragEnd);\n  };\n\n  #onDrag = (event: MouseEvent): void => {\n    if (!this.#dialog) {\n      return;\n    }\n    const deltaX = event.clientX - this.#initialMouseX;\n    const deltaY = event.clientY - this.#initialMouseY;\n\n    const minLeft = this.#devtoolsRect?.left ?? 0;\n    const minTop = this.#devtoolsRect?.top ?? 0;\n    const newLeft = Math.max(minLeft, this.#initialDialogLeft + deltaX);\n    const newTop = Math.max(minTop, this.#initialDialogTop + deltaY);\n    this.#dialog.style.left = `${newLeft}px`;\n    this.#dialog.style.top = `${newTop}px`;\n  };\n\n  #onDragEnd = (): void => {\n    document.removeEventListener('mousemove', this.#onDrag);\n    document.removeEventListener('mouseup', this.#onDragEnd);\n  };\n}\n\ninterface ViewInput {\n  onDragStart: (event: MouseEvent) => void;\n  selectedContexts: ReadonlySet<FloatyContextSelection>;\n  open: boolean;\n  state: State;\n  onInspectClick: () => void;\n  onDialogClose: (e: PointerEvent) => void;\n  onContextDelete: (item: FloatyContextSelection) => (e: MouseEvent) => void;\n}\n\nconst VIEW = (input: ViewInput, _output: null, target: HTMLElement): void => {\n  const contexts = Array.from(input.selectedContexts);\n  // clang-format off\n  render(html`\n   <style>${floatyStyles}</style>\n   <dialog ?open=${input.open} @mousedown=${input.onDragStart}>\n    <header>\n      <span>DevTools context picker</span>\n      <devtools-button\n        class=\"close-button\"\n        @click=${input.onDialogClose}\n        .data=${{\n          variant: Buttons.Button.Variant.TOOLBAR,\n          iconName: 'cross',\n          title: 'Close',\n          size: Buttons.Button.Size.SMALL,\n        } as Buttons.Button.ButtonData}\n      ></devtools-button>\n    </header>\n    <section class=\"body\">\n      <section class=\"contexts\">\n      ${contexts.length === 0 ? html`\n        <span class=\"no-context\">Select items to add them to the AI agent's context.</span>\n        ` : html`\n        <ul class=\"floaty-contexts\">\n          ${contexts.map(context => {\n            return html`<li>\n            <span class=\"context-item\">\n              ${floatyContextToUI(context)}\n            </span>\n            <devtools-button\n              class=\"close-button\"\n              @click=${input.onContextDelete(context)}\n              .data=${{\n                variant: Buttons.Button.Variant.TOOLBAR,\n                iconName: 'cross',\n                title: 'Delete',\n                size: Buttons.Button.Size.SMALL,\n              } as Buttons.Button.ButtonData}\n            ></devtools-button>\n            </li>`;\n          })}\n        </ul>\n      `}\n      </section>\n      <section class=\"actions\">\n          <devtools-button title=\"Select\" @click=${input.onInspectClick}\n            .active=${input.state === State.INSPECT_MODE}\n            .variant=${Buttons.Button.Variant.TONAL} .iconName=${'select-element'}\n          >Select</devtools-button>\n        </devtools-toolbar>\n      </section>\n    </section>\n   </dialog>`,\n  target);\n  // clang-format on\n};\n\nfunction floatyContextToUI(context: FloatyContextSelection): TemplateResult {\n  if (context instanceof SDK.NetworkRequest.NetworkRequest) {\n    return html`${context.url()}`;\n  }\n  if (context instanceof SDK.DOMModel.DOMNode) {\n    return html`${context.simpleSelector()}`;\n  }\n  if ('insight' in context) {\n    return html`Insight: ${context.insight.title}`;\n  }\n  if ('event' in context && 'traceStartTime' in context) {\n    const time = Trace.Types.Timing.Micro(context.event.ts - context.traceStartTime);\n    return html`${context.event.name} @ ${i18n.TimeUtilities.formatMicroSecondsAsMillisFixed(time)}`;\n  }\n\n  Platform.assertNever(context, '');\n}\n"]}