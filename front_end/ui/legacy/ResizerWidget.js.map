{"version":3,"file":"ResizerWidget.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/ResizerWidget.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2014 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\n\nimport {elementDragStart} from './UIUtils.js';\n\nexport class ResizerWidget extends Common.ObjectWrapper.ObjectWrapper<EventTypes> {\n  #isEnabled = true;\n  #elements = new Set<HTMLElement>();\n  readonly #installDragOnMouseDownBound: (event: Event) => false | undefined;\n  #cursor = 'nwse-resize';\n  #startX?: number;\n  #startY?: number;\n\n  constructor() {\n    super();\n\n    this.#installDragOnMouseDownBound = this.#installDragOnMouseDown.bind(this);\n  }\n\n  isEnabled(): boolean {\n    return this.#isEnabled;\n  }\n\n  setEnabled(enabled: boolean): void {\n    this.#isEnabled = enabled;\n    this.updateElementCursors();\n  }\n\n  elements(): Element[] {\n    return [...this.#elements];\n  }\n\n  addElement(element: HTMLElement): void {\n    if (!this.#elements.has(element)) {\n      this.#elements.add(element);\n      element.addEventListener('pointerdown', this.#installDragOnMouseDownBound, false);\n      this.#updateElementCursor(element);\n    }\n  }\n\n  removeElement(element: HTMLElement): void {\n    if (this.#elements.has(element)) {\n      this.#elements.delete(element);\n      element.removeEventListener('pointerdown', this.#installDragOnMouseDownBound, false);\n      element.style.removeProperty('cursor');\n    }\n  }\n\n  updateElementCursors(): void {\n    this.#elements.forEach(this.#updateElementCursor.bind(this));\n  }\n\n  #updateElementCursor(element: HTMLElement): void {\n    if (this.#isEnabled) {\n      element.style.setProperty('cursor', this.cursor());\n      element.style.setProperty('touch-action', 'none');\n    } else {\n      element.style.removeProperty('cursor');\n      element.style.removeProperty('touch-action');\n    }\n  }\n\n  cursor(): string {\n    return this.#cursor;\n  }\n\n  setCursor(cursor: string): void {\n    this.#cursor = cursor;\n    this.updateElementCursors();\n  }\n\n  #installDragOnMouseDown(event: Event): false|undefined {\n    const element = (event.target as HTMLElement);\n    // Only handle drags of the nodes specified.\n    if (!this.#elements.has(element)) {\n      return false;\n    }\n    elementDragStart(element, this.#dragStart.bind(this), event => {\n      this.#drag(event);\n    }, this.#dragEnd.bind(this), this.cursor(), event);\n    return undefined;\n  }\n\n  #dragStart(event: MouseEvent): boolean {\n    if (!this.#isEnabled) {\n      return false;\n    }\n    this.#startX = event.pageX;\n    this.#startY = event.pageY;\n    this.sendDragStart(this.#startX, this.#startY);\n    return true;\n  }\n\n  sendDragStart(x: number, y: number): void {\n    this.dispatchEventToListeners(Events.RESIZE_START, {startX: x, currentX: x, startY: y, currentY: y});\n  }\n\n  #drag(event: MouseEvent): boolean {\n    if (!this.#isEnabled) {\n      this.#dragEnd(event);\n      return true;  // Cancel drag.\n    }\n    this.sendDragMove((this.#startX as number), event.pageX, (this.#startY as number), event.pageY, event.shiftKey);\n    event.preventDefault();\n    return false;  // Continue drag.\n  }\n\n  sendDragMove(startX: number, currentX: number, startY: number, currentY: number, shiftKey: boolean): void {\n    this.dispatchEventToListeners(Events.RESIZE_UPDATE_XY, {startX, currentX, startY, currentY, shiftKey});\n  }\n\n  #dragEnd(_event: MouseEvent): void {\n    this.dispatchEventToListeners(Events.RESIZE_END);\n    this.#startX = undefined;\n    this.#startY = undefined;\n  }\n}\n\nexport const enum Events {\n  RESIZE_START = 'ResizeStart',\n  RESIZE_UPDATE_XY = 'ResizeUpdateXY',\n  RESIZE_UPDATE_POSITION = 'ResizeUpdatePosition',\n  RESIZE_END = 'ResizeEnd',\n}\n\nexport interface ResizeStartXYEvent {\n  startX: number;\n  currentX: number;\n  startY: number;\n  currentY: number;\n}\n\nexport interface ResizeStartPositionEvent {\n  startPosition: number;\n  currentPosition: number;\n}\n\nexport interface ResizeUpdateXYEvent {\n  startX: number;\n  currentX: number;\n  startY: number;\n  currentY: number;\n  shiftKey: boolean;\n}\n\nexport interface ResizeUpdatePositionEvent {\n  startPosition: number;\n  currentPosition: number;\n  shiftKey: boolean;\n}\n\nexport interface EventTypes {\n  [Events.RESIZE_START]: ResizeStartXYEvent|ResizeStartPositionEvent;\n  [Events.RESIZE_UPDATE_XY]: ResizeUpdateXYEvent;\n  [Events.RESIZE_UPDATE_POSITION]: ResizeUpdatePositionEvent;\n  [Events.RESIZE_END]: void;\n}\n\nexport class SimpleResizerWidget extends ResizerWidget {\n  #isVertical = true;\n\n  isVertical(): boolean {\n    return this.#isVertical;\n  }\n\n  /**\n   * Vertical widget resizes height (along y-axis).\n   */\n  setVertical(vertical: boolean): void {\n    this.#isVertical = vertical;\n    this.updateElementCursors();\n  }\n\n  override cursor(): string {\n    return this.#isVertical ? 'ns-resize' : 'ew-resize';\n  }\n\n  override sendDragStart(x: number, y: number): void {\n    const position = this.#isVertical ? y : x;\n    this.dispatchEventToListeners(Events.RESIZE_START, {startPosition: position, currentPosition: position});\n  }\n\n  override sendDragMove(startX: number, currentX: number, startY: number, currentY: number, shiftKey: boolean): void {\n    if (this.#isVertical) {\n      this.dispatchEventToListeners(\n          Events.RESIZE_UPDATE_POSITION, {startPosition: startY, currentPosition: currentY, shiftKey});\n    } else {\n      this.dispatchEventToListeners(\n          Events.RESIZE_UPDATE_POSITION, {startPosition: startX, currentPosition: currentX, shiftKey});\n    }\n  }\n}\n"]}