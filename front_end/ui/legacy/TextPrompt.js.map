{"version":3,"file":"TextPrompt.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/TextPrompt.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\n/*\n * Copyright (C) 2008 Apple Inc.  All rights reserved.\n * Copyright (C) 2011 Google Inc.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1.  Redistributions of source code must retain the above copyright\n *     notice, this list of conditions and the following disclaimer.\n * 2.  Redistributions in binary form must reproduce the above copyright\n *     notice, this list of conditions and the following disclaimer in the\n *     documentation and/or other materials provided with the distribution.\n * 3.  Neither the name of Apple Computer, Inc. (\"Apple\") nor the names of\n *     its contributors may be used to endorse or promote products derived\n *     from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../../core/common/common.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport * as VisualLogging from '../visual_logging/visual_logging.js';\n\nimport * as ARIAUtils from './ARIAUtils.js';\nimport {SuggestBox, type SuggestBoxDelegate, type Suggestion} from './SuggestBox.js';\nimport textPromptStyles from './textPrompt.css.js';\nimport {Tooltip} from './Tooltip.js';\nimport {cloneCustomElement, ElementFocusRestorer} from './UIUtils.js';\n\n/**\n * A custom element wrapper around TextPrompt that allows text-editing contents in-place.\n *\n * ## Usage ##\n *\n * ```\n * <devtools-prompt>\n *  <b>Structured</b> content\n * </devtools-prompt>\n *\n * ```\n *\n * @property completionTimeout Sets the delay for showing the autocomplete suggestion box.\n * @event commit Editing is done and the result was accepted.\n * @event cancel Editing was canceled.\n * @event beforeautocomplete This is sent before the autocomplete suggestion box is triggered and before the <datalist>\n *                           is read.\n * @attribute editing Setting/removing this attribute starts/stops editing.\n * @attribute completions Sets the `id` of the <datalist> containing the autocomplete options.\n * @attribute placeholder Sets a placeholder that's shown in place of the text contents when editing if the text is too\n *            large.\n */\nexport class TextPromptElement extends HTMLElement {\n  static readonly observedAttributes = ['editing', 'completions', 'placeholder'];\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  readonly #entrypoint = this.#shadow.createChild('span');\n  readonly #slot = this.#entrypoint.createChild('slot');\n  readonly #textPrompt = new TextPrompt();\n  #completionTimeout: number|null = null;\n  #completionObserver = new MutationObserver(this.#onMutate.bind(this));\n\n  constructor() {\n    super();\n    this.#textPrompt.initialize(this.#willAutoComplete.bind(this));\n  }\n\n  #onMutate(changes: MutationRecord[]): void {\n    const listId = this.getAttribute('completions');\n    if (!listId) {\n      return;\n    }\n    const checkIfNodeIsInCompletionList = (node: Node): boolean => {\n      if (node instanceof HTMLDataListElement) {\n        return node.id === listId;\n      }\n      if (node instanceof HTMLOptionElement) {\n        return Boolean(node.parentElement && checkIfNodeIsInCompletionList(node.parentElement));\n      }\n      return false;\n    };\n    const affectsCompletionList = (change: MutationRecord): boolean =>\n        change.addedNodes.values().some(checkIfNodeIsInCompletionList) ||\n        change.removedNodes.values().some(checkIfNodeIsInCompletionList) ||\n        checkIfNodeIsInCompletionList(change.target);\n\n    if (changes.some(affectsCompletionList)) {\n      this.#updateCompletions();\n    }\n  }\n\n  attributeChangedCallback(name: string, oldValue: string|null, newValue: string|null): void {\n    if (oldValue === newValue) {\n      return;\n    }\n\n    switch (name) {\n      case 'editing':\n        if (this.isConnected) {\n          if (newValue !== null && newValue !== 'false' && oldValue === null) {\n            this.#startEditing();\n          } else {\n            this.#stopEditing();\n          }\n        }\n        break;\n      case 'completions':\n        if (this.getAttribute('completions')) {\n          this.#completionObserver.observe(this, {childList: true, subtree: true});\n          this.#updateCompletions();\n        } else {\n          this.#textPrompt.clearAutocomplete();\n          this.#completionObserver.disconnect();\n        }\n        break;\n    }\n  }\n\n  #updateCompletions(): void {\n    if (this.isConnected) {\n      void this.#textPrompt.complete(/* force=*/ true);\n    }\n  }\n\n  async #willAutoComplete(expression: string, filter: string, force: boolean): Promise<Suggestion[]> {\n    this.dispatchEvent(new TextPromptElement.BeforeAutoCompleteEvent({expression, filter, force}));\n\n    const listId = this.getAttribute('completions');\n    if (!listId) {\n      return [];\n    }\n\n    const datalist = this.getComponentRoot()?.querySelectorAll<HTMLOptionElement>(`datalist#${listId} > option`);\n    if (!datalist?.length) {\n      return [];\n    }\n\n    return datalist.values()\n        .filter(option => option.textContent.startsWith(filter.toLowerCase()))\n        .map(option => ({text: option.textContent}))\n        .toArray();\n  }\n\n  #startEditing(): void {\n    const truncatedTextPlaceholder = this.getAttribute('placeholder');\n    const placeholder = this.#entrypoint.createChild('span');\n    if (truncatedTextPlaceholder === null) {\n      placeholder.textContent = this.#slot.deepInnerText();\n    } else {\n      placeholder.setTextContentTruncatedIfNeeded(this.#slot.deepInnerText(), truncatedTextPlaceholder);\n    }\n    this.#slot.remove();\n\n    const proxy = this.#textPrompt.attachAndStartEditing(placeholder, e => this.#done(e, /* commit=*/ true));\n    proxy.addEventListener('keydown', this.#editingValueKeyDown.bind(this));\n    placeholder.getComponentSelection()?.selectAllChildren(placeholder);\n  }\n\n  #stopEditing(): void {\n    this.#entrypoint.removeChildren();\n    this.#entrypoint.appendChild(this.#slot);\n    this.#textPrompt.detach();\n  }\n\n  connectedCallback(): void {\n    if (this.hasAttribute('editing')) {\n      this.attributeChangedCallback('editing', null, '');\n    }\n  }\n\n  #done(e: Event, commit: boolean): void {\n    const target = e.target as HTMLElement;\n    const text = target.textContent || '';\n    if (commit) {\n      this.dispatchEvent(new TextPromptElement.CommitEvent(text));\n    } else {\n      this.dispatchEvent(new TextPromptElement.CancelEvent());\n    }\n    e.consume();\n  }\n\n  #editingValueKeyDown(event: Event): void {\n    if (event.handled || !(event instanceof KeyboardEvent)) {\n      return;\n    }\n\n    if (event.key === 'Enter') {\n      this.#done(event, /* commit=*/ true);\n    } else if (Platform.KeyboardUtilities.isEscKey(event)) {\n      this.#done(event, /* commit=*/ false);\n    }\n  }\n\n  set completionTimeout(timeout: number) {\n    this.#completionTimeout = timeout;\n    this.#textPrompt.setAutocompletionTimeout(timeout);\n  }\n\n  override cloneNode(): Node {\n    const clone = cloneCustomElement(this);\n    if (this.#completionTimeout !== null) {\n      clone.completionTimeout = this.#completionTimeout;\n    }\n    return clone;\n  }\n}\n\nexport namespace TextPromptElement {\n  export class CommitEvent extends CustomEvent<string> {\n    constructor(detail: string) {\n      super('commit', {detail});\n    }\n  }\n  export class CancelEvent extends CustomEvent<string> {\n    constructor() {\n      super('cancel');\n    }\n  }\n  export class BeforeAutoCompleteEvent extends CustomEvent<{expression: string, filter: string, force: boolean}> {\n    constructor(detail: {expression: string, filter: string, force: boolean}) {\n      super('beforeautocomplete', {detail});\n    }\n  }\n}\n\ncustomElements.define('devtools-prompt', TextPromptElement);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-prompt': TextPromptElement;\n  }\n}\n\nexport class TextPrompt extends Common.ObjectWrapper.ObjectWrapper<EventTypes> implements SuggestBoxDelegate {\n  private proxyElement!: HTMLElement|undefined;\n  private proxyElementDisplay: string;\n  private autocompletionTimeout: number;\n  #title: string;\n  private queryRange: TextUtils.TextRange.TextRange|null;\n  private previousText: string;\n  private currentSuggestion: Suggestion|null;\n  private completionRequestId: number;\n  private ghostTextElement: HTMLSpanElement;\n  private leftParenthesesIndices: number[];\n  private loadCompletions!: (\n      this: null,\n      arg1: string,\n      arg2: string,\n      arg3: boolean,\n      ) => Promise<Suggestion[]>;\n  private completionStopCharacters!: string;\n  private usesSuggestionBuilder!: boolean;\n  #element?: Element;\n  private boundOnKeyDown?: ((ev: KeyboardEvent) => void);\n  private boundOnInput?: ((ev: Event) => void);\n  private boundOnMouseWheel?: ((event: Event) => void);\n  private boundClearAutocomplete?: (() => void);\n  private boundOnBlur?: ((ev: Event) => void);\n  private contentElement?: HTMLElement;\n  private suggestBox?: SuggestBox;\n  private isEditing?: boolean;\n  private focusRestorer?: ElementFocusRestorer;\n  private blurListener?: ((arg0: Event) => void);\n  private oldTabIndex?: number;\n  private completeTimeout?: number;\n  #disableDefaultSuggestionForEmptyInput?: boolean;\n  jslogContext: string|undefined = undefined;\n\n  constructor() {\n    super();\n    this.proxyElementDisplay = 'inline-block';\n    this.autocompletionTimeout = DefaultAutocompletionTimeout;\n    this.#title = '';\n    this.queryRange = null;\n    this.previousText = '';\n    this.currentSuggestion = null;\n    this.completionRequestId = 0;\n    this.ghostTextElement = document.createElement('span');\n    this.ghostTextElement.classList.add('auto-complete-text');\n    this.ghostTextElement.setAttribute('contenteditable', 'false');\n    this.leftParenthesesIndices = [];\n    ARIAUtils.setHidden(this.ghostTextElement, true);\n  }\n\n  initialize(\n      completions: (this: null, expression: string, filter: string, force: boolean) => Promise<Suggestion[]>,\n      stopCharacters?: string, usesSuggestionBuilder?: boolean): void {\n    this.loadCompletions = completions;\n    this.completionStopCharacters = stopCharacters || ' =:[({;,!+-*/&|^<>.';\n    this.usesSuggestionBuilder = usesSuggestionBuilder || false;\n  }\n\n  setAutocompletionTimeout(timeout: number): void {\n    this.autocompletionTimeout = timeout;\n  }\n\n  renderAsBlock(): void {\n    this.proxyElementDisplay = 'block';\n  }\n\n  /**\n   * Clients should never attach any event listeners to the |element|. Instead,\n   * they should use the result of this method to attach listeners for bubbling events.\n   */\n  attach(element: Element): Element {\n    return this.#attach(element);\n  }\n\n  /**\n   * Clients should never attach any event listeners to the |element|. Instead,\n   * they should use the result of this method to attach listeners for bubbling events\n   * or the |blurListener| parameter to register a \"blur\" event listener on the |element|\n   * (since the \"blur\" event does not bubble.)\n   */\n  attachAndStartEditing(element: Element, blurListener: (arg0: Event) => void): Element {\n    const proxyElement = this.#attach(element);\n    this.startEditing(blurListener);\n    return proxyElement;\n  }\n\n  #attach(element: Element): Element {\n    if (this.proxyElement) {\n      throw new Error('Cannot attach an attached TextPrompt');\n    }\n    this.#element = element;\n\n    this.boundOnKeyDown = this.onKeyDown.bind(this);\n    this.boundOnInput = this.onInput.bind(this);\n    this.boundOnMouseWheel = this.onMouseWheel.bind(this);\n    this.boundClearAutocomplete = this.clearAutocomplete.bind(this);\n    this.boundOnBlur = this.onBlur.bind(this);\n    this.proxyElement = element.ownerDocument.createElement('span');\n    Platform.DOMUtilities.appendStyle(this.proxyElement, textPromptStyles);\n    this.contentElement = this.proxyElement.createChild('div', 'text-prompt-root');\n    this.proxyElement.style.display = this.proxyElementDisplay;\n    if (element.parentElement) {\n      element.parentElement.insertBefore(this.proxyElement, element);\n    }\n    this.contentElement.appendChild(element);\n    let jslog = VisualLogging.textField().track({\n      keydown: 'ArrowLeft|ArrowUp|PageUp|Home|PageDown|ArrowRight|ArrowDown|End|Space|Tab|Enter|Escape',\n      change: true,\n    });\n\n    if (this.jslogContext) {\n      jslog = jslog.context(this.jslogContext);\n    }\n    if (!this.#element.hasAttribute('jslog')) {\n      this.#element.setAttribute('jslog', `${jslog}`);\n    }\n    this.#element.classList.add('text-prompt');\n    ARIAUtils.markAsTextBox(this.#element);\n    ARIAUtils.setAutocomplete(this.#element, ARIAUtils.AutocompleteInteractionModel.BOTH);\n    ARIAUtils.setHasPopup(this.#element, ARIAUtils.PopupRole.LIST_BOX);\n    this.#element.setAttribute('contenteditable', 'plaintext-only');\n    this.element().addEventListener('keydown', this.boundOnKeyDown, false);\n    this.#element.addEventListener('input', this.boundOnInput, false);\n    this.#element.addEventListener('wheel', this.boundOnMouseWheel, false);\n    this.#element.addEventListener('selectstart', this.boundClearAutocomplete, false);\n    this.#element.addEventListener('blur', this.boundOnBlur, false);\n\n    this.suggestBox = new SuggestBox(this, 20);\n\n    if (this.#title) {\n      Tooltip.install(this.proxyElement, this.#title);\n    }\n\n    return this.proxyElement;\n  }\n\n  element(): HTMLElement {\n    if (!this.#element) {\n      throw new Error('Expected an already attached element!');\n    }\n    return this.#element as HTMLElement;\n  }\n\n  detach(): void {\n    this.removeFromElement();\n    if (this.focusRestorer) {\n      this.focusRestorer.restore();\n    }\n    if (this.proxyElement?.parentElement) {\n      this.proxyElement.parentElement.insertBefore(this.element(), this.proxyElement);\n      this.proxyElement.remove();\n    }\n    delete this.proxyElement;\n    this.element().classList.remove('text-prompt');\n    this.element().removeAttribute('contenteditable');\n    this.element().removeAttribute('role');\n    ARIAUtils.clearAutocomplete(this.element());\n    ARIAUtils.setHasPopup(this.element(), ARIAUtils.PopupRole.FALSE);\n  }\n\n  textWithCurrentSuggestion(): string {\n    const text = this.text();\n    if (!this.queryRange || !this.currentSuggestion) {\n      return text;\n    }\n    const suggestion = this.currentSuggestion.text;\n    return text.substring(0, this.queryRange.startColumn) + suggestion + text.substring(this.queryRange.endColumn);\n  }\n\n  text(): string {\n    let text: string = this.element().textContent || '';\n    if (this.ghostTextElement.parentNode) {\n      const addition = this.ghostTextElement.textContent || '';\n      text = text.substring(0, text.length - addition.length);\n    }\n    return text;\n  }\n\n  setText(text: string): void {\n    this.clearAutocomplete();\n    this.element().textContent = text;\n    this.previousText = this.text();\n    if (this.element().hasFocus()) {\n      this.moveCaretToEndOfPrompt();\n      this.element().scrollIntoView();\n    }\n  }\n\n  setSelectedRange(startIndex: number, endIndex: number): void {\n    if (startIndex < 0) {\n      throw new RangeError('Selected range start must be a nonnegative integer');\n    }\n    const textContent = this.element().textContent;\n    const textContentLength = textContent ? textContent.length : 0;\n    if (endIndex > textContentLength) {\n      endIndex = textContentLength;\n    }\n    if (endIndex < startIndex) {\n      endIndex = startIndex;\n    }\n\n    const textNode = (this.element().childNodes[0] as Node);\n    const range = new Range();\n    range.setStart(textNode, startIndex);\n    range.setEnd(textNode, endIndex);\n    const selection = window.getSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n\n  focus(): void {\n    this.element().focus();\n  }\n\n  title(): string {\n    return this.#title;\n  }\n\n  setTitle(title: string): void {\n    this.#title = title;\n    if (this.proxyElement) {\n      Tooltip.install(this.proxyElement, title);\n    }\n  }\n\n  setPlaceholder(placeholder: string, ariaPlaceholder?: string): void {\n    if (placeholder) {\n      this.element().setAttribute('data-placeholder', placeholder);\n      // TODO(https://github.com/nvaccess/nvda/issues/10164): Remove ariaPlaceholder once the NVDA bug is fixed\n      // ariaPlaceholder and placeholder may differ, like in case the placeholder contains a '?'\n      ARIAUtils.setPlaceholder(this.element(), ariaPlaceholder || placeholder);\n    } else {\n      this.element().removeAttribute('data-placeholder');\n      ARIAUtils.setPlaceholder(this.element(), null);\n    }\n  }\n\n  setEnabled(enabled: boolean): void {\n    if (enabled) {\n      this.element().setAttribute('contenteditable', 'plaintext-only');\n    } else {\n      this.element().removeAttribute('contenteditable');\n    }\n    this.element().classList.toggle('disabled', !enabled);\n  }\n\n  private removeFromElement(): void {\n    this.clearAutocomplete();\n    this.element().removeEventListener(\n        'keydown', (this.boundOnKeyDown as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener('input', (this.boundOnInput as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener(\n        'selectstart', (this.boundClearAutocomplete as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener('blur', (this.boundOnBlur as (this: HTMLElement, arg1: Event) => void), false);\n    if (this.isEditing) {\n      this.stopEditing();\n    }\n    if (this.suggestBox) {\n      this.suggestBox.hide();\n    }\n  }\n\n  private startEditing(blurListener?: ((arg0: Event) => void)): void {\n    this.isEditing = true;\n    if (this.contentElement) {\n      this.contentElement.classList.add('text-prompt-editing');\n    }\n    this.focusRestorer = new ElementFocusRestorer(this.element());\n    if (blurListener) {\n      this.blurListener = blurListener;\n      this.element().addEventListener('blur', this.blurListener, false);\n    }\n    this.oldTabIndex = this.element().tabIndex;\n    if (this.element().tabIndex < 0) {\n      this.element().tabIndex = 0;\n    }\n    if (!this.text()) {\n      this.autoCompleteSoon();\n    }\n  }\n\n  private stopEditing(): void {\n    this.element().tabIndex = (this.oldTabIndex as number);\n    if (this.blurListener) {\n      this.element().removeEventListener('blur', this.blurListener, false);\n    }\n    if (this.contentElement) {\n      this.contentElement.classList.remove('text-prompt-editing');\n    }\n    delete this.isEditing;\n  }\n\n  onMouseWheel(_event: Event): void {\n    // Subclasses can implement.\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    let handled = false;\n    if (this.isSuggestBoxVisible() && this.suggestBox?.keyPressed(event)) {\n      void VisualLogging.logKeyDown(this.suggestBox.element, event);\n      event.consume(true);\n      return;\n    }\n\n    switch (event.key) {\n      case 'Tab':\n        handled = this.tabKeyPressed(event);\n        break;\n      case 'ArrowLeft':\n      case 'ArrowUp':\n      case 'PageUp':\n      case 'Home':\n        this.clearAutocomplete();\n        break;\n      case 'PageDown':\n      case 'ArrowRight':\n      case 'ArrowDown':\n      case 'End':\n        if (this.isCaretAtEndOfPrompt()) {\n          handled = this.acceptAutoComplete();\n        } else {\n          this.clearAutocomplete();\n        }\n        break;\n      case 'Escape':\n        if (this.isSuggestBoxVisible() || this.currentSuggestion) {\n          this.clearAutocomplete();\n          handled = true;\n        }\n        break;\n      case ' ':  // Space\n        if (event.ctrlKey && !event.metaKey && !event.altKey && !event.shiftKey) {\n          this.autoCompleteSoon(true);\n          handled = true;\n        }\n        break;\n    }\n\n    if (event.key === 'Enter') {\n      event.preventDefault();\n    }\n\n    if (handled) {\n      event.consume(true);\n    }\n  }\n\n  private acceptSuggestionOnStopCharacters(key: string): boolean {\n    if (!this.currentSuggestion || !this.queryRange || key.length !== 1 ||\n        !this.completionStopCharacters?.includes(key)) {\n      return false;\n    }\n\n    const query = this.text().substring(this.queryRange.startColumn, this.queryRange.endColumn);\n    if (query && this.currentSuggestion.text.startsWith(query + key)) {\n      this.queryRange.endColumn += 1;\n      return this.acceptAutoComplete();\n    }\n    return false;\n  }\n\n  onInput(ev: Event): void {\n    const event = (ev as InputEvent);\n    let text = this.text();\n    const currentEntry = event.data;\n\n    if (event.inputType === 'insertFromPaste' && text.includes('\\n')) {\n      /* Ensure that we remove any linebreaks from copied/pasted content\n       * to avoid breaking the rendering of the filter bar.\n       * See crbug.com/849563.\n       * We don't let users enter linebreaks when\n       * typing manually, so we should escape them if copying text in.\n       */\n      text = Platform.StringUtilities.stripLineBreaks(text);\n      this.setText(text);\n    }\n\n    // Skip the current ')' entry if the caret is right before a ')' and there's an unmatched '('.\n    const caretPosition = this.getCaretPosition();\n    if (currentEntry === ')' && caretPosition >= 0 && this.leftParenthesesIndices.length > 0) {\n      const nextCharAtCaret = text[caretPosition];\n      if (nextCharAtCaret === ')' && this.tryMatchingLeftParenthesis(caretPosition)) {\n        text = text.substring(0, caretPosition) + text.substring(caretPosition + 1);\n        this.setText(text);\n        return;\n      }\n    }\n\n    if (currentEntry && !this.acceptSuggestionOnStopCharacters(currentEntry)) {\n      const hasCommonPrefix = text.startsWith(this.previousText) || this.previousText.startsWith(text);\n      if (this.queryRange && hasCommonPrefix) {\n        this.queryRange.endColumn += text.length - this.previousText.length;\n      }\n    }\n    this.refreshGhostText();\n    this.previousText = text;\n    this.dispatchEventToListeners(Events.TEXT_CHANGED);\n\n    this.autoCompleteSoon();\n  }\n\n  acceptAutoComplete(): boolean {\n    let result = false;\n    if (this.isSuggestBoxVisible() && this.suggestBox) {\n      result = this.suggestBox.acceptSuggestion();\n    }\n    if (!result) {\n      result = this.#acceptSuggestion();\n    }\n    if (this.usesSuggestionBuilder && result) {\n      // Trigger autocompletions for text prompts using suggestion builders\n      this.autoCompleteSoon();\n    }\n    return result;\n  }\n\n  clearAutocomplete(): void {\n    const beforeText = this.textWithCurrentSuggestion();\n\n    if (this.isSuggestBoxVisible() && this.suggestBox) {\n      this.suggestBox.hide();\n    }\n    this.clearAutocompleteTimeout();\n    this.queryRange = null;\n    this.refreshGhostText();\n\n    if (beforeText !== this.textWithCurrentSuggestion()) {\n      this.dispatchEventToListeners(Events.TEXT_CHANGED);\n    }\n    this.currentSuggestion = null;\n  }\n\n  private onBlur(): void {\n    this.clearAutocomplete();\n  }\n\n  private refreshGhostText(): void {\n    if (this.currentSuggestion?.hideGhostText) {\n      this.ghostTextElement.remove();\n      return;\n    }\n    if (this.queryRange && this.currentSuggestion && this.isCaretAtEndOfPrompt() &&\n        this.currentSuggestion.text.startsWith(this.text().substring(this.queryRange.startColumn))) {\n      this.ghostTextElement.textContent =\n          this.currentSuggestion.text.substring(this.queryRange.endColumn - this.queryRange.startColumn);\n      this.element().appendChild(this.ghostTextElement);\n    } else {\n      this.ghostTextElement.remove();\n    }\n  }\n\n  private clearAutocompleteTimeout(): void {\n    if (this.completeTimeout) {\n      clearTimeout(this.completeTimeout);\n      delete this.completeTimeout;\n    }\n    this.completionRequestId++;\n  }\n\n  autoCompleteSoon(force?: boolean): void {\n    const immediately = this.isSuggestBoxVisible() || force;\n    if (!this.completeTimeout) {\n      this.completeTimeout =\n          window.setTimeout(this.complete.bind(this, force), immediately ? 0 : this.autocompletionTimeout);\n    }\n  }\n\n  async complete(force?: boolean): Promise<void> {\n    this.clearAutocompleteTimeout();\n    if (!this.element().isConnected) {\n      return;\n    }\n\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0) {\n      return;\n    }\n    const selectionRange = selection.getRangeAt(0);\n\n    let shouldExit;\n\n    if (!force && !this.isCaretAtEndOfPrompt() && !this.isSuggestBoxVisible()) {\n      shouldExit = true;\n    } else if (!selection.isCollapsed) {\n      shouldExit = true;\n    }\n\n    if (shouldExit) {\n      this.clearAutocomplete();\n      return;\n    }\n\n    const wordQueryRange = Platform.DOMUtilities.rangeOfWord(\n        selectionRange.startContainer, selectionRange.startOffset, this.completionStopCharacters, this.element(),\n        'backward');\n\n    const expressionRange = wordQueryRange.cloneRange();\n    expressionRange.collapse(true);\n    expressionRange.setStartBefore(this.element());\n    const completionRequestId = ++this.completionRequestId;\n    const completions =\n        await this.loadCompletions.call(null, expressionRange.toString(), wordQueryRange.toString(), Boolean(force));\n    this.completionsReady(completionRequestId, (selection), wordQueryRange, Boolean(force), completions);\n  }\n\n  disableDefaultSuggestionForEmptyInput(): void {\n    this.#disableDefaultSuggestionForEmptyInput = true;\n  }\n\n  private boxForAnchorAtStart(selection: Selection, textRange: Range): AnchorBox {\n    const rangeCopy = selection.getRangeAt(0).cloneRange();\n    const anchorElement = document.createElement('span');\n    anchorElement.textContent = '\\u200B';\n    textRange.insertNode(anchorElement);\n    const box = anchorElement.boxInWindow(window);\n    anchorElement.remove();\n    selection.removeAllRanges();\n    selection.addRange(rangeCopy);\n    return box;\n  }\n\n  additionalCompletions(_query: string): Suggestion[] {\n    return [];\n  }\n\n  private completionsReady(\n      completionRequestId: number, selection: Selection, originalWordQueryRange: Range, force: boolean,\n      completions: Suggestion[]): void {\n    if (this.completionRequestId !== completionRequestId) {\n      return;\n    }\n\n    const query = originalWordQueryRange.toString();\n\n    // Filter out dupes.\n    const store = new Set<string>();\n    completions = completions.filter(item => !store.has(item.text) && Boolean(store.add(item.text)));\n\n    if (query || force) {\n      if (query) {\n        completions = completions.concat(this.additionalCompletions(query));\n      } else {\n        completions = this.additionalCompletions(query).concat(completions);\n      }\n    }\n\n    if (!completions.length) {\n      this.clearAutocomplete();\n      return;\n    }\n\n    const selectionRange = selection.getRangeAt(0);\n\n    const fullWordRange = document.createRange();\n    fullWordRange.setStart(originalWordQueryRange.startContainer, originalWordQueryRange.startOffset);\n    fullWordRange.setEnd(selectionRange.endContainer, selectionRange.endOffset);\n\n    if (query + selectionRange.toString() !== fullWordRange.toString()) {\n      return;\n    }\n\n    const beforeRange = document.createRange();\n    beforeRange.setStart(this.element(), 0);\n    beforeRange.setEnd(fullWordRange.startContainer, fullWordRange.startOffset);\n    this.queryRange = new TextUtils.TextRange.TextRange(\n        0, beforeRange.toString().length, 0, beforeRange.toString().length + fullWordRange.toString().length);\n\n    const shouldSelect = !this.#disableDefaultSuggestionForEmptyInput || Boolean(this.text());\n    if (this.suggestBox) {\n      this.suggestBox.updateSuggestions(\n          this.boxForAnchorAtStart(selection, fullWordRange), completions, shouldSelect, !this.isCaretAtEndOfPrompt(),\n          this.text());\n    }\n  }\n\n  applySuggestion(suggestion: Suggestion|null, isIntermediateSuggestion?: boolean): void {\n    this.currentSuggestion = suggestion;\n    this.refreshGhostText();\n    if (isIntermediateSuggestion) {\n      this.dispatchEventToListeners(Events.TEXT_CHANGED);\n    }\n  }\n\n  acceptSuggestion(): void {\n    this.#acceptSuggestion();\n  }\n\n  #acceptSuggestion(): boolean {\n    if (!this.queryRange) {\n      return false;\n    }\n\n    const suggestionLength = this.currentSuggestion ? this.currentSuggestion.text.length : 0;\n    const selectionRange = this.currentSuggestion ? this.currentSuggestion.selectionRange : null;\n    const endColumn = selectionRange ? selectionRange.endColumn : suggestionLength;\n    const startColumn = selectionRange ? selectionRange.startColumn : suggestionLength;\n    this.element().textContent = this.textWithCurrentSuggestion();\n    this.setDOMSelection(this.queryRange.startColumn + startColumn, this.queryRange.startColumn + endColumn);\n    this.updateLeftParenthesesIndices();\n\n    this.clearAutocomplete();\n    this.dispatchEventToListeners(Events.TEXT_CHANGED);\n\n    return true;\n  }\n\n  ownerElement(): Element {\n    return this.element();\n  }\n\n  setDOMSelection(startColumn: number, endColumn: number): void {\n    this.element().normalize();\n    const node = this.element().childNodes[0];\n    if (!node || node === this.ghostTextElement) {\n      return;\n    }\n    const range = document.createRange();\n    range.setStart(node, startColumn);\n    range.setEnd(node, endColumn);\n    const selection = this.element().getComponentSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n\n  isSuggestBoxVisible(): boolean {\n    return this.suggestBox?.visible() ?? false;\n  }\n\n  private isCaretAtEndOfPrompt(): boolean {\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0 || !selection.isCollapsed) {\n      return false;\n    }\n\n    const selectionRange = selection.getRangeAt(0);\n    let node: (Node|null)|Node = selectionRange.startContainer;\n    if (!node.isSelfOrDescendant(this.element())) {\n      return false;\n    }\n\n    if (this.ghostTextElement.isAncestor(node)) {\n      return true;\n    }\n\n    if (node.nodeType === Node.TEXT_NODE && selectionRange.startOffset < (node.nodeValue || '').length) {\n      return false;\n    }\n\n    let foundNextText = false;\n    while (node) {\n      if (node.nodeType === Node.TEXT_NODE && node.nodeValue?.length) {\n        if (foundNextText && !this.ghostTextElement.isAncestor(node)) {\n          return false;\n        }\n        foundNextText = true;\n      }\n\n      node = node.traverseNextNode(this.#element);\n    }\n\n    return true;\n  }\n\n  moveCaretToEndOfPrompt(): void {\n    const selection = this.element().getComponentSelection();\n    const selectionRange = document.createRange();\n\n    let container: Node = this.element();\n    while (container.lastChild) {\n      container = container.lastChild;\n    }\n    let offset = 0;\n    if (container.nodeType === Node.TEXT_NODE) {\n      const textNode = (container as Text);\n      offset = (textNode.textContent || '').length;\n    }\n    selectionRange.setStart(container, offset);\n    selectionRange.setEnd(container, offset);\n\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(selectionRange);\n    }\n  }\n\n  /**\n   * -1 if no caret can be found in text prompt\n   */\n  private getCaretPosition(): number {\n    if (!this.element().hasFocus()) {\n      return -1;\n    }\n\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0 || !selection.isCollapsed) {\n      return -1;\n    }\n    const selectionRange = selection.getRangeAt(0);\n    if (selectionRange.startOffset !== selectionRange.endOffset) {\n      return -1;\n    }\n    return selectionRange.startOffset;\n  }\n\n  tabKeyPressed(_event: Event): boolean {\n    return this.acceptAutoComplete();\n  }\n\n  /**\n   * Try matching the most recent open parenthesis with the given right\n   * parenthesis, and closes the matched left parenthesis if found.\n   * Return the result of the matching.\n   */\n  private tryMatchingLeftParenthesis(rightParenthesisIndex: number): boolean {\n    const leftParenthesesIndices = this.leftParenthesesIndices;\n    if (leftParenthesesIndices.length === 0 || rightParenthesisIndex < 0) {\n      return false;\n    }\n\n    for (let i = leftParenthesesIndices.length - 1; i >= 0; --i) {\n      if (leftParenthesesIndices[i] < rightParenthesisIndex) {\n        leftParenthesesIndices.splice(i, 1);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  private updateLeftParenthesesIndices(): void {\n    const text = this.text();\n    const leftParenthesesIndices: number[] = this.leftParenthesesIndices = [];\n    for (let i = 0; i < text.length; ++i) {\n      if (text[i] === '(') {\n        leftParenthesesIndices.push(i);\n      }\n    }\n  }\n\n  suggestBoxForTest(): SuggestBox|undefined {\n    return this.suggestBox;\n  }\n}\n\nconst DefaultAutocompletionTimeout = 250;\n\nexport const enum Events {\n  TEXT_CHANGED = 'TextChanged',\n}\n\nexport interface EventTypes {\n  [Events.TEXT_CHANGED]: void;\n}\n"]}