{"version":3,"file":"ObjectPopoverHelper.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/object_ui/ObjectPopoverHelper.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2011 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as SDK from '../../../../core/sdk/sdk.js';\nimport * as Geometry from '../../../../models/geometry/geometry.js';\nimport * as UI from '../../legacy.js';\nimport * as Components from '../utils/utils.js';\n\nimport {CustomPreviewComponent} from './CustomPreviewComponent.js';\nimport objectPopoverStyles from './objectPopover.css.js';\nimport {ObjectPropertiesSection} from './ObjectPropertiesSection.js';\nimport objectValueStyles from './objectValue.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Text that is usually a hyperlink to more documentation\n   */\n  learnMore: 'Learn more',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('ui/legacy/components/object_ui/ObjectPopoverHelper.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class ObjectPopoverHelper {\n  private readonly linkifier: Components.Linkifier.Linkifier|null;\n  private readonly resultHighlightedAsDOM: boolean;\n  constructor(linkifier: Components.Linkifier.Linkifier|null, resultHighlightedAsDOM: boolean) {\n    this.linkifier = linkifier;\n    this.resultHighlightedAsDOM = resultHighlightedAsDOM;\n  }\n\n  dispose(): void {\n    if (this.resultHighlightedAsDOM) {\n      SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    }\n    if (this.linkifier) {\n      this.linkifier.dispose();\n    }\n  }\n\n  static async buildObjectPopover(result: SDK.RemoteObject.RemoteObject, popover: UI.GlassPane.GlassPane):\n      Promise<ObjectPopoverHelper|null> {\n    const description = Platform.StringUtilities.trimEndWithMaxLength(result.description || '', MaxPopoverTextLength);\n    let popoverContentElement: HTMLSpanElement|HTMLDivElement|null = null;\n    if (result.type === 'function' || result.type === 'object') {\n      let linkifier: Components.Linkifier.Linkifier|null = null;\n      let resultHighlightedAsDOM = false;\n      if (result.subtype === 'node') {\n        SDK.OverlayModel.OverlayModel.highlightObjectAsDOMNode(result);\n        resultHighlightedAsDOM = true;\n      }\n\n      if (result.customPreview()) {\n        const customPreviewComponent = new CustomPreviewComponent(result);\n        customPreviewComponent.expandIfPossible();\n        popoverContentElement = customPreviewComponent.element;\n      } else {\n        popoverContentElement = document.createElement('div');\n        popoverContentElement.classList.add('object-popover-content');\n        popover.registerRequiredCSS(objectValueStyles, objectPopoverStyles);\n        const titleElement = popoverContentElement.createChild('div', 'object-popover-title');\n        if (result.type === 'function') {\n          titleElement.classList.add('source-code');\n          titleElement.appendChild(ObjectPropertiesSection.valueElementForFunctionDescription(result.description));\n        } else {\n          titleElement.classList.add('monospace');\n          titleElement.createChild('span').textContent = description;\n        }\n        linkifier = new Components.Linkifier.Linkifier();\n        const section = new ObjectPropertiesSection(result, '', linkifier, true /* showOverflow */);\n        section.element.classList.add('object-popover-tree');\n        section.titleLessMode();\n        popoverContentElement.appendChild(section.element);\n      }\n      popoverContentElement.dataset.stableNameForTest = 'object-popover-content';\n      popover.setMaxContentSize(new Geometry.Size(300, 250));\n      popover.setSizeBehavior(UI.GlassPane.SizeBehavior.SET_EXACT_SIZE);\n      popover.contentElement.appendChild(popoverContentElement);\n      return new ObjectPopoverHelper(linkifier, resultHighlightedAsDOM);\n    }\n\n    popoverContentElement = document.createElement('span');\n    popoverContentElement.dataset.stableNameForTest = 'object-popover-content';\n    popover.registerRequiredCSS(objectValueStyles, objectPopoverStyles);\n    const valueElement = popoverContentElement.createChild('span', 'monospace object-value-' + result.type);\n    valueElement.style.whiteSpace = 'pre';\n\n    if (result.type === 'string') {\n      UI.UIUtils.createTextChildren(valueElement, `\"${description}\"`);\n    } else {\n      valueElement.textContent = description;\n    }\n\n    popover.contentElement.appendChild(popoverContentElement);\n    return new ObjectPopoverHelper(null, false);\n  }\n\n  static buildDescriptionPopover(description: string, link: string, popover: UI.GlassPane.GlassPane):\n      ObjectPopoverHelper {\n    const popoverContentElement = document.createElement('div');\n    popoverContentElement.classList.add('object-popover-description-box');\n    const descriptionDiv = document.createElement('div');\n    descriptionDiv.dataset.stableNameForTest = 'object-popover-content';\n    popover.registerRequiredCSS(objectPopoverStyles);\n    descriptionDiv.textContent = description;\n    const learnMoreLink =\n        UI.XLink.XLink.create(link, i18nString(UIStrings.learnMore), undefined, undefined, 'learn-more');\n    const footerDiv = document.createElement('div');\n    footerDiv.classList.add('object-popover-footer');\n    footerDiv.appendChild(learnMoreLink);\n\n    popoverContentElement.appendChild(descriptionDiv);\n    popoverContentElement.appendChild(footerDiv);\n    popover.contentElement.appendChild(popoverContentElement);\n    return new ObjectPopoverHelper(null, false);\n  }\n}\n\nconst MaxPopoverTextLength = 10000;\n"]}