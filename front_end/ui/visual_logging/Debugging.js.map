{"version":3,"file":"Debugging.js","sourceRoot":"","sources":["../../../../../../front_end/ui/visual_logging/Debugging.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable @devtools/no-imperative-dom-api */\n\nimport {assertNotNullOrUndefined} from '../../core/platform/platform.js';\n\nimport type {Loggable} from './Loggable.js';\nimport {type LoggingConfig, VisualElements} from './LoggingConfig.js';\nimport {getLoggingState, type LoggingState} from './LoggingState.js';\n\nlet veDebuggingEnabled = false;\nlet debugOverlay: HTMLElement|null = null;\nlet debugPopover: HTMLElement|null = null;\nconst highlightedElements: HTMLElement[] = [];\nconst nonDomDebugElements = new WeakMap<Loggable, HTMLElement>();\nlet onInspect: ((query: string) => void)|undefined = undefined;\n\nfunction ensureDebugOverlay(): void {\n  if (!debugOverlay) {\n    debugOverlay = document.createElement('div');\n    debugOverlay.style.position = 'fixed';\n    debugOverlay.style.top = '0';\n    debugOverlay.style.left = '0';\n    debugOverlay.style.width = '100vw';\n    debugOverlay.style.height = '100vh';\n    debugOverlay.style.zIndex = '100000';\n    debugOverlay.style.pointerEvents = 'none';\n    document.body.appendChild(debugOverlay);\n\n    debugPopover = document.createElement('div');\n    debugPopover.classList.add('ve-debug');\n    debugPopover.style.position = 'absolute';\n    debugPopover.style.background = 'var(--sys-color-cdt-base-container)';\n    debugPopover.style.borderRadius = '2px';\n    debugPopover.style.padding = '8px';\n    debugPopover.style.boxShadow = 'var(--drop-shadow)';\n    debugOverlay.appendChild(debugPopover);\n  }\n}\n\nexport function setVeDebuggingEnabled(enabled: boolean, inspect?: (query: string) => void): void {\n  veDebuggingEnabled = enabled;\n  if (enabled) {\n    ensureDebugOverlay();\n  }\n  onInspect = inspect;\n  if (!enabled) {\n    highlightElement(null);\n  }\n}\n\n// @ts-expect-error\nglobalThis.setVeDebuggingEnabled = setVeDebuggingEnabled;\n\nlet highlightedVeKey: string|null = null;\n\nexport function setHighlightedVe(veKey: string|null): void {\n  ensureDebugOverlay();\n  highlightedVeKey = veKey;\n  highlightElement(null);\n}\n\nfunction maybeHighlightElement(element: HTMLElement, highlightedKey: string): void {\n  highlightedKey = highlightedKey.trim();\n  let state = getLoggingState(element);\n  let trailingVe = state?.config?.ve ? VisualElements[state?.config?.ve] : null;\n  while (state && highlightedKey) {\n    const currentKey = elementKey(state.config);\n    if (highlightedKey.endsWith(currentKey)) {\n      highlightedKey = highlightedKey.slice(0, -currentKey.length).trim();\n    } else if (trailingVe && highlightedKey.endsWith(trailingVe)) {\n      highlightedKey = highlightedKey.slice(0, -trailingVe.length).trim();\n      trailingVe = null;\n    } else {\n      break;\n    }\n    state = state.parent;\n    if (state && !highlightedKey.endsWith('>')) {\n      break;\n    }\n    highlightedKey = highlightedKey.slice(0, -1).trim();\n  }\n  if (!highlightedKey && !state) {\n    highlightElement(element, true);\n  }\n}\n\nexport function processForDebugging(loggable: Loggable): void {\n  if (highlightedVeKey && loggable instanceof HTMLElement) {\n    maybeHighlightElement(loggable, highlightedVeKey);\n  }\n  const loggingState = getLoggingState(loggable);\n  if (!veDebuggingEnabled || !loggingState || loggingState.processedForDebugging) {\n    return;\n  }\n  if (loggable instanceof HTMLElement) {\n    processElementForDebugging(loggable, loggingState);\n  } else {\n    processNonDomLoggableForDebugging(loggable, loggingState);\n  }\n}\n\nfunction showDebugPopover(content: string, rect?: DOMRect): void {\n  if (!debugPopover) {\n    return;\n  }\n\n  // Set these first so we get the correct information from\n  // getBoundingClientRect\n  debugPopover.style.display = 'block';\n  debugPopover.textContent = content;\n\n  if (rect) {\n    const debugPopoverReact = debugPopover.getBoundingClientRect();\n\n    // If there is no space under the element\n    // render render it above the element\n    if (window.innerHeight < rect.bottom + debugPopoverReact.height + 8) {\n      debugPopover.style.top = `${rect.top - debugPopoverReact.height - 8}px`;\n    } else {\n      debugPopover.style.top = `${rect.bottom + 8}px`;\n    }\n\n    // If the element will go outside the viewport on the right\n    // render it with it's and at the viewport end.\n    if (window.innerWidth < rect.left + debugPopoverReact.width) {\n      debugPopover.style.right = '0px';\n      debugPopover.style.left = '';\n    } else {\n      debugPopover.style.right = '';\n      debugPopover.style.left = `${rect.left}px`;\n    }\n  }\n}\n\nfunction highlightElement(element: HTMLElement|null, allowMultiple = false): void {\n  if (highlightedElements.length > 0 && !allowMultiple && debugOverlay) {\n    [...debugOverlay.children].forEach(e => {\n      if (e !== debugPopover) {\n        e.remove();\n      }\n    });\n    highlightedElements.length = 0;\n  }\n  if (element && !highlightedElements.includes(element)) {\n    assertNotNullOrUndefined(debugOverlay);\n    const rect = element.getBoundingClientRect();\n    const highlight = document.createElement('div');\n    highlight.style.position = 'absolute';\n    highlight.style.top = `${rect.top}px`;\n    highlight.style.left = `${rect.left}px`;\n    highlight.style.width = `${rect.width}px`;\n    highlight.style.height = `${rect.height}px`;\n    highlight.style.background = 'rgb(71 140 222 / 50%)';\n    highlight.style.border = 'dashed 1px #7327C6';\n    highlight.style.pointerEvents = 'none';\n    debugOverlay.appendChild(highlight);\n    highlightedElements.push(element);\n  }\n}\n\nfunction processElementForDebugging(element: HTMLElement, loggingState: LoggingState): void {\n  if (element.tagName === 'OPTION') {\n    if (loggingState.parent?.selectOpen && debugPopover) {\n      debugPopover.innerHTML += '<br>' + debugString(loggingState.config);\n      loggingState.processedForDebugging = true;\n    }\n  } else {\n    element.addEventListener('mousedown', event => {\n      if (highlightedElements.length && debugPopover && veDebuggingEnabled) {\n        event.stopImmediatePropagation();\n        event.preventDefault();\n      }\n    }, {capture: true});\n    element.addEventListener('click', event => {\n      if (highlightedElements.includes(event.currentTarget as HTMLElement) && debugPopover && veDebuggingEnabled) {\n        onInspect?.(debugPopover.textContent || '');\n        event.stopImmediatePropagation();\n        event.preventDefault();\n      }\n    }, {capture: true});\n    element.addEventListener('mouseenter', () => {\n      if (!veDebuggingEnabled) {\n        return;\n      }\n      highlightElement(element);\n      assertNotNullOrUndefined(debugPopover);\n      const pathToRoot = [loggingState];\n      let ancestor = loggingState.parent;\n      while (ancestor) {\n        pathToRoot.unshift(ancestor);\n        ancestor = ancestor.parent;\n      }\n      showDebugPopover(pathToRoot.map(s => elementKey(s.config)).join(' > '), element.getBoundingClientRect());\n    }, {capture: true});\n    element.addEventListener('mouseleave', () => {\n      element.style.backgroundColor = '';\n      element.style.outline = '';\n      assertNotNullOrUndefined(debugPopover);\n      debugPopover.style.display = 'none';\n    }, {capture: true});\n    loggingState.processedForDebugging = true;\n  }\n}\n\ntype EventType = 'Click'|'Drag'|'Hover'|'Change'|'KeyDown'|'Resize'|'SettingAccess'|'FunctionCall';\nexport function processEventForDebugging(\n    event: EventType, state: LoggingState|null, extraInfo?: EventAttributes): void {\n  const format = localStorage.getItem('veDebugLoggingEnabled');\n  if (!format) {\n    return;\n  }\n\n  switch (format) {\n    case DebugLoggingFormat.INTUITIVE:\n      processEventForIntuitiveDebugging(event, state, extraInfo);\n      break;\n    case DebugLoggingFormat.TEST:\n      processEventForTestDebugging(event, state, extraInfo);\n      break;\n    case DebugLoggingFormat.AD_HOC_ANALYSIS:\n      processEventForAdHocAnalysisDebugging(event, state, extraInfo);\n      break;\n  }\n}\n\nexport function processEventForIntuitiveDebugging(\n    event: EventType, state: LoggingState|null, extraInfo?: EventAttributes): void {\n  const entry: IntuitiveLogEntry = {\n    event,\n    ve: state ? VisualElements[state?.config.ve] : undefined,\n    veid: state?.veid,\n    context: state?.config.context,\n    time: Date.now() - sessionStartTime,\n    ...extraInfo,\n  };\n  deleteUndefinedFields(entry);\n  maybeLogDebugEvent(entry);\n}\n\nexport function processEventForTestDebugging(\n    event: EventType, state: LoggingState|null, _extraInfo?: EventAttributes): void {\n  if (event !== 'SettingAccess' && event !== 'FunctionCall') {\n    lastImpressionLogEntry = null;\n  }\n  maybeLogDebugEvent({interaction: event, veid: state?.veid || 0});\n  checkPendingEventExpectation();\n}\n\nexport function processEventForAdHocAnalysisDebugging(\n    event: EventType, state: LoggingState|null, extraInfo?: EventAttributes): void {\n  const ve = state ? adHocAnalysisEntries.get(state.veid) : null;\n  if (ve) {\n    const interaction: AdHocAnalysisInteraction = {time: Date.now() - sessionStartTime, type: event, ...extraInfo};\n    deleteUndefinedFields(interaction);\n    ve.interactions.push(interaction);\n  }\n}\n\nfunction deleteUndefinedFields<T>(entry: T): void {\n  for (const stringKey in entry) {\n    const key = stringKey as keyof T;\n    if (typeof entry[key] === 'undefined') {\n      delete entry[key];\n    }\n  }\n}\n\nexport interface EventAttributes {\n  context?: string;\n  width?: number;\n  height?: number;\n  mouseButton?: number;\n  doubleClick?: boolean;\n  name?: string;\n  numericValue?: number;\n  stringValue?: string;\n}\n\ninterface VisualElementAttributes {\n  ve: string;\n  veid: number;\n  context?: string;\n  width?: number;\n  height?: number;\n}\n\ntype IntuitiveLogEntry = {\n  event?: EventType|'Impression'|'SessionStart',\n  children?: IntuitiveLogEntry[],\n  parent?: number,\n  time?: number,\n}&Partial<VisualElementAttributes>;\n\ntype AdHocAnalysisVisualElement = VisualElementAttributes&{\n  parent?: AdHocAnalysisVisualElement,\n};\n\ntype AdHocAnalysisInteraction = {\n  type: EventType,\n  time: number,\n}&EventAttributes;\n\ntype AdHocAnalysisLogEntry = AdHocAnalysisVisualElement&{\n  time: number,\n  interactions: AdHocAnalysisInteraction[],\n};\n\ntype TestLogEntry = {\n  impressions: string[],\n}|{\n  interaction: string,\n  veid?: number,\n};\n\nexport function processImpressionsForDebugging(states: LoggingState[]): void {\n  const format = localStorage.getItem('veDebugLoggingEnabled');\n  switch (format) {\n    case DebugLoggingFormat.INTUITIVE:\n      processImpressionsForIntuitiveDebugLog(states);\n      break;\n    case DebugLoggingFormat.TEST:\n      processImpressionsForTestDebugLog(states);\n      break;\n    case DebugLoggingFormat.AD_HOC_ANALYSIS:\n      processImpressionsForAdHocAnalysisDebugLog(states);\n      break;\n    default:\n  }\n}\n\nfunction processImpressionsForIntuitiveDebugLog(states: LoggingState[]): void {\n  const impressions = new Map<number, IntuitiveLogEntry>();\n  for (const state of states) {\n    const entry: IntuitiveLogEntry = {\n      event: 'Impression',\n      ve: VisualElements[state.config.ve],\n      context: state?.config.context,\n      width: state.size.width,\n      height: state.size.height,\n      veid: state.veid,\n    };\n    deleteUndefinedFields(entry);\n\n    impressions.set(state.veid, entry);\n    if (!state.parent || !impressions.has(state.parent?.veid)) {\n      entry.parent = state.parent?.veid;\n    } else {\n      const parent = impressions.get(state.parent?.veid) as IntuitiveLogEntry;\n      parent.children = parent.children || [];\n      parent.children.push(entry);\n    }\n  }\n\n  const entries = [...impressions.values()].filter(i => 'parent' in i);\n  if (entries.length === 1) {\n    entries[0].time = Date.now() - sessionStartTime;\n    maybeLogDebugEvent(entries[0]);\n  } else {\n    maybeLogDebugEvent({event: 'Impression', children: entries, time: Date.now() - sessionStartTime});\n  }\n}\n\nconst veTestKeys = new Map<number, string>();\nlet lastImpressionLogEntry: {impressions: string[]}|null = null;\n\nfunction processImpressionsForTestDebugLog(states: LoggingState[]): void {\n  if (!lastImpressionLogEntry) {\n    lastImpressionLogEntry = {impressions: []};\n    veDebugEventsLog.push(lastImpressionLogEntry);\n  }\n  for (const state of states) {\n    let key = '';\n    if (state.parent) {\n      key = (veTestKeys.get(state.parent.veid) || '<UNKNOWN>') + ' > ';\n    }\n    key += VisualElements[state.config.ve];\n    if (state.config.context) {\n      key += ': ' + state.config.context;\n    }\n    veTestKeys.set(state.veid, key);\n    lastImpressionLogEntry.impressions.push(key);\n  }\n  checkPendingEventExpectation();\n}\n\nconst adHocAnalysisEntries = new Map<number, AdHocAnalysisLogEntry>();\n\nfunction processImpressionsForAdHocAnalysisDebugLog(states: LoggingState[]): void {\n  for (const state of states) {\n    const buildVe = (state: LoggingState): AdHocAnalysisVisualElement => {\n      const ve: AdHocAnalysisVisualElement = {\n        ve: VisualElements[state.config.ve],\n        veid: state.veid,\n        width: state.size?.width,\n        height: state.size?.height,\n        context: state.config.context,\n      };\n      deleteUndefinedFields(ve);\n      if (state.parent) {\n        ve.parent = buildVe(state.parent);\n      }\n      return ve;\n    };\n    const entry = {...buildVe(state), interactions: [], time: Date.now() - sessionStartTime};\n    adHocAnalysisEntries.set(state.veid, entry);\n    maybeLogDebugEvent(entry);\n  }\n}\n\nfunction processNonDomLoggableForDebugging(loggable: Loggable, loggingState: LoggingState): void {\n  let debugElement = nonDomDebugElements.get(loggable);\n  if (!debugElement) {\n    debugElement = document.createElement('div');\n    debugElement.classList.add('ve-debug');\n    debugElement.style.background = 'black';\n    debugElement.style.color = 'white';\n    debugElement.style.zIndex = '100000';\n    debugElement.textContent = debugString(loggingState.config);\n    nonDomDebugElements.set(loggable, debugElement);\n    setTimeout(() => {\n      if (!loggingState.size?.width || !loggingState.size?.height) {\n        debugElement?.parentElement?.removeChild(debugElement);\n        nonDomDebugElements.delete(loggable);\n      }\n    }, 10000);\n  }\n  const parentDebugElement =\n      parent instanceof HTMLElement ? parent : nonDomDebugElements.get(parent as Loggable) || debugPopover;\n  assertNotNullOrUndefined(parentDebugElement);\n  if (!parentDebugElement.classList.contains('ve-debug')) {\n    debugElement.style.position = 'absolute';\n    parentDebugElement.insertBefore(debugElement, parentDebugElement.firstChild);\n  } else {\n    debugElement.style.marginLeft = '10px';\n    parentDebugElement.appendChild(debugElement);\n  }\n}\n\nfunction elementKey(config: LoggingConfig): string {\n  return `${VisualElements[config.ve]}${config.context ? `: ${config.context}` : ''}`;\n}\n\nexport function debugString(config: LoggingConfig): string {\n  const components = [VisualElements[config.ve]];\n  if (config.context) {\n    components.push(`context: ${config.context}`);\n  }\n  if (config.parent) {\n    components.push(`parent: ${config.parent}`);\n  }\n  if (config.track) {\n    components.push(`track: ${\n        Object.entries(config.track)\n            .map(([key, value]) => `${key}${typeof value === 'string' ? `: ${value}` : ''}`)\n            .join(', ')}`);\n  }\n  return components.join('; ');\n}\n\nconst veDebugEventsLog: Array<IntuitiveLogEntry|AdHocAnalysisLogEntry|TestLogEntry> = [];\n\nfunction maybeLogDebugEvent(entry: IntuitiveLogEntry|AdHocAnalysisLogEntry|TestLogEntry): void {\n  const format = localStorage.getItem('veDebugLoggingEnabled');\n  if (!format) {\n    return;\n  }\n  veDebugEventsLog.push(entry);\n  if (format === DebugLoggingFormat.INTUITIVE) {\n    // eslint-disable-next-line no-console\n    console.info('VE Debug:', entry);\n  }\n}\n\nexport const enum DebugLoggingFormat {\n  INTUITIVE = 'Intuitive',\n  TEST = 'Test',\n  AD_HOC_ANALYSIS = 'AdHocAnalysis',\n}\n\nexport function setVeDebugLoggingEnabled(enabled: boolean, format = DebugLoggingFormat.INTUITIVE): void {\n  if (enabled) {\n    localStorage.setItem('veDebugLoggingEnabled', format);\n  } else {\n    localStorage.removeItem('veDebugLoggingEnabled');\n  }\n}\n\nfunction findVeDebugImpression(veid: number, includeAncestorChain?: boolean): IntuitiveLogEntry|undefined {\n  const findImpression = (entry: IntuitiveLogEntry): IntuitiveLogEntry|undefined => {\n    if (entry.event === 'Impression' && entry.veid === veid) {\n      return entry;\n    }\n    let i = 0;\n    for (const childEntry of entry.children || []) {\n      const matchingEntry = findImpression(childEntry);\n      if (matchingEntry) {\n        if (includeAncestorChain) {\n          const children = [];\n          children[i] = matchingEntry;\n          return {...entry, children};\n        }\n        return matchingEntry;\n      }\n      ++i;\n    }\n    return undefined;\n  };\n  return findImpression({children: veDebugEventsLog as IntuitiveLogEntry[]});\n}\n\nfunction fieldValuesForSql<T>(\n    obj: T,\n    fields: {strings: ReadonlyArray<keyof T>, numerics: ReadonlyArray<keyof T>, booleans: ReadonlyArray<keyof T>}):\n    string {\n  return [\n    ...fields.strings.map(f => obj[f] ? `\"${obj[f]}\"` : '$NullString'),\n    ...fields.numerics.map(f => obj[f] ?? 'null'),\n    ...fields.booleans.map(f => obj[f] ?? '$NullBool'),\n  ].join(', ');\n}\n\nfunction exportAdHocAnalysisLogForSql(): void {\n  const VE_FIELDS = {\n    strings: ['ve', 'context'] as const,\n    numerics: ['veid', 'width', 'height'] as const,\n    booleans: [] as const,\n  };\n  const INTERACTION_FIELDS = {\n    strings: ['type', 'context'] as const,\n    numerics: ['width', 'height', 'mouseButton', 'time'] as const,\n    booleans: ['width', 'height', 'mouseButton', 'time'] as const,\n  };\n\n  const fieldsDefsForSql = (fields: string[]): string => fields.map((f, i) => `$${i + 1} as ${f}`).join(', ');\n\n  const veForSql = (e: AdHocAnalysisVisualElement): string =>\n      `$VeFields(${fieldValuesForSql(e, VE_FIELDS)}, ${e.parent ? `STRUCT(${veForSql(e.parent)})` : null})`;\n\n  const interactionForSql = (i: AdHocAnalysisInteraction): string =>\n      `$Interaction(${fieldValuesForSql(i, INTERACTION_FIELDS)})`;\n\n  const entryForSql = (e: AdHocAnalysisLogEntry): string =>\n      `$Entry(${veForSql(e)}, ([${e.interactions.map(interactionForSql).join(', ')}]), ${e.time})`;\n\n  const entries = veDebugEventsLog as AdHocAnalysisLogEntry[];\n\n  // eslint-disable-next-line no-console\n  console.log(`\nDEFINE MACRO NullString CAST(null AS STRING);\nDEFINE MACRO NullBool CAST(null AS BOOL);\nDEFINE MACRO VeFields ${fieldsDefsForSql([\n    ...VE_FIELDS.strings,\n    ...VE_FIELDS.numerics,\n    'parent',\n  ])};\nDEFINE MACRO Interaction STRUCT(${\n      fieldsDefsForSql([\n        ...INTERACTION_FIELDS.strings,\n        ...INTERACTION_FIELDS.numerics,\n        ...INTERACTION_FIELDS.booleans,\n      ])});\nDEFINE MACRO Entry STRUCT($1, $2 AS interactions, $3 AS time);\n\n// This fake entry put first fixes nested struct fields names being lost\nDEFINE MACRO FakeVeFields $VeFields(\"\", $NullString, 0, 0, 0, $1);\nDEFINE MACRO FakeVe STRUCT($FakeVeFields($1));\nDEFINE MACRO FakeEntry $Entry($FakeVeFields($FakeVe($FakeVe($FakeVe($FakeVe($FakeVe($FakeVe($FakeVe(null)))))))), ([]), 0);\n\nWITH\n  processed_logs AS (\n      SELECT * FROM UNNEST([\n        $FakeEntry,\n        ${entries.map(entryForSql).join(', \\n')}\n      ])\n    )\n\n\n\nSELECT * FROM processed_logs;`);\n}\n\ntype StateFlowNode = {\n  type: 'Session',\n  children: StateFlowNode[],\n}|({type: 'Impression', children: StateFlowNode[], time: number}&AdHocAnalysisVisualElement)|AdHocAnalysisInteraction;\n\ntype StateFlowMutation = (AdHocAnalysisLogEntry|(AdHocAnalysisInteraction&{veid: number}));\n\nfunction getStateFlowMutations(): StateFlowMutation[] {\n  const mutations: StateFlowMutation[] = [];\n  for (const entry of (veDebugEventsLog as AdHocAnalysisLogEntry[])) {\n    mutations.push(entry);\n    const veid = entry.veid;\n    for (const interaction of entry.interactions) {\n      mutations.push({...interaction, veid});\n    }\n  }\n  mutations.sort((e1, e2) => e1.time - e2.time);\n  return mutations;\n}\n\nclass StateFlowElementsByArea {\n  #data = new Map<number, AdHocAnalysisVisualElement>();\n\n  add(e: AdHocAnalysisVisualElement): void {\n    this.#data.set(e.veid, e);\n  }\n\n  get(veid: number): AdHocAnalysisVisualElement|undefined {\n    return this.#data.get(veid);\n  }\n\n  getArea(e: AdHocAnalysisVisualElement): number {\n    let area = (e.width || 0) * (e.height || 0);\n    const parent = e.parent ? this.#data.get(e.parent?.veid) : null;\n    if (!parent) {\n      return area;\n    }\n    const parentArea = this.getArea(parent);\n    if (area > parentArea) {\n      area = parentArea;\n    }\n    return area;\n  }\n\n  get data(): readonly AdHocAnalysisVisualElement[] {\n    return [...this.#data.values()].filter(e => this.getArea(e)).sort((e1, e2) => this.getArea(e2) - this.getArea(e1));\n  }\n}\n\nfunction updateStateFlowTree(\n    rootNode: StateFlowNode, elements: StateFlowElementsByArea, time: number,\n    interactions: AdHocAnalysisInteraction[]): void {\n  let node = rootNode;\n  for (const element of elements.data) {\n    if (!('children' in node)) {\n      return;\n    }\n    let nextNode = node.children[node.children.length - 1];\n    const nextNodeId = nextNode?.type === 'Impression' ? nextNode.veid : null;\n    if (nextNodeId !== element.veid) {\n      node.children.push(...interactions);\n      interactions.length = 0;\n      nextNode = {type: 'Impression', ve: element.ve, veid: element.veid, context: element.context, time, children: []};\n      node.children.push(nextNode);\n    }\n    node = nextNode;\n  }\n}\n\nfunction normalizeNode(node: StateFlowNode): void {\n  if (node.type !== 'Impression') {\n    return;\n  }\n  while (node.children.length === 1) {\n    if (node.children[0].type === 'Impression') {\n      node.children = node.children[0].children;\n    }\n  }\n  for (const child of node.children) {\n    normalizeNode(child);\n  }\n}\n\nfunction buildStateFlow(): StateFlowNode {\n  const mutations = getStateFlowMutations();\n  const elements = new StateFlowElementsByArea();\n  const rootNode: StateFlowNode = {type: 'Session', children: []};\n\n  let time = mutations[0].time;\n  const interactions: AdHocAnalysisInteraction[] = [];\n  for (const mutation of mutations) {\n    if (mutation.time > time + 1000) {\n      updateStateFlowTree(rootNode, elements, time, interactions);\n      interactions.length = 0;\n    }\n    if (!('type' in mutation)) {\n      elements.add(mutation);\n    } else if (mutation.type === 'Resize') {\n      const element = elements.get(mutation.veid);\n      if (!element) {\n        continue;\n      }\n      const oldArea = elements.getArea(element);\n      element.width = mutation.width;\n      element.height = mutation.height;\n      if (elements.getArea(element) !== 0 && oldArea !== 0) {\n        interactions.push(mutation);\n      }\n    } else {\n      interactions.push(mutation);\n    }\n    time = mutation.time;\n  }\n  updateStateFlowTree(rootNode, elements, time, interactions);\n\n  normalizeNode(rootNode);\n  return rootNode;\n}\n\nlet sessionStartTime: number = Date.now();\n\nexport function processStartLoggingForDebugging(): void {\n  sessionStartTime = Date.now();\n  if (localStorage.getItem('veDebugLoggingEnabled') === DebugLoggingFormat.INTUITIVE) {\n    maybeLogDebugEvent({event: 'SessionStart'});\n  }\n}\n\n/**\n * Compares the 'actual' log entry against the 'expected'.\n * For impressions events to match, all expected impressions need to be present\n * in the actual event. Unexpected impressions in the actual event are ignored.\n * Interaction events need to match exactly.\n **/\nfunction compareVeEvents(actual: TestLogEntry, expected: TestLogEntry): boolean {\n  if ('interaction' in expected && 'interaction' in actual) {\n    const actualString = formatInteraction(actual);\n    return expected.interaction === actualString;\n  }\n  if ('impressions' in expected && 'impressions' in actual) {\n    const actualSet = new Set(actual.impressions);\n    const expectedSet = new Set(expected.impressions);\n    const missing = [...expectedSet].filter(k => !actualSet.has(k));\n\n    return !Boolean(missing.length);\n  }\n  return false;\n}\n\ninterface PendingEventExpectation {\n  expectedEvents: TestLogEntry[];\n  missingEvents?: TestLogEntry[];\n  unmatchedEvents: TestLogEntry[];\n  success: () => void;\n  fail: (arg0: Error) => void;\n}\n\nlet pendingEventExpectation: PendingEventExpectation|null = null;\n\nfunction formatImpressions(impressions: string[]): string {\n  const result: string[] = [];\n  let lastImpression = '';\n  for (const impression of impressions.sort()) {\n    if (impression === lastImpression) {\n      continue;\n    }\n    while (!impression.startsWith(lastImpression)) {\n      lastImpression = lastImpression.substr(0, lastImpression.lastIndexOf(' > '));\n    }\n    result.push(' '.repeat(lastImpression.length) + impression.substr(lastImpression.length));\n    lastImpression = impression;\n  }\n  return result.join('\\n');\n}\n\nconst EVENT_EXPECTATION_TIMEOUT = 5000;\n\nfunction formatInteraction(e: TestLogEntry): string {\n  if ('interaction' in e) {\n    if (e.veid !== undefined) {\n      const key = veTestKeys.get(e.veid) || (e.veid ? '<UNKNOWN>' : '');\n      return `${e.interaction}: ${key}`;\n    }\n    return e.interaction;\n  }\n  return '';\n}\n\nfunction formatVeEvents(events: TestLogEntry[]): string {\n  return events\n      .map(e => {\n        if ('interaction' in e) {\n          return formatInteraction(e);\n        }\n        return formatImpressions(e.impressions);\n      })\n      .join('\\n');\n}\n\n/**\n * Verifies that VE events contains all the expected events in given order.\n * Unexpected VE events are ignored.\n **/\nexport async function expectVeEvents(expectedEvents: TestLogEntry[]): Promise<void> {\n  if (pendingEventExpectation) {\n    throw new Error('VE events expectation already set. Cannot set another one until the previous is resolved');\n  }\n  const {promise, resolve: success, reject: fail} = Promise.withResolvers<void>();\n  pendingEventExpectation = {expectedEvents, success, fail, unmatchedEvents: []};\n  checkPendingEventExpectation();\n\n  const timeout = setTimeout(() => {\n    if (pendingEventExpectation?.missingEvents) {\n      const allLogs = veDebugEventsLog.filter(ve => {\n        if ('interaction' in ve) {\n          // Very noisy in the error and not providing context\n          return ve.interaction !== 'SettingAccess';\n        }\n\n        return true;\n      });\n      pendingEventExpectation.fail(new Error(`\nMissing VE Events:\n${formatVeEvents(pendingEventExpectation.missingEvents)}\nUnmatched VE Events:\n${formatVeEvents(pendingEventExpectation.unmatchedEvents)}\nAll events:\n${JSON.stringify(allLogs, null, 2)}\n`));\n    }\n  }, EVENT_EXPECTATION_TIMEOUT);\n\n  return await promise.finally(() => {\n    clearTimeout(timeout);\n    pendingEventExpectation = null;\n  });\n}\n\nlet numMatchedEvents = 0;\n\nfunction checkPendingEventExpectation(): void {\n  if (!pendingEventExpectation) {\n    return;\n  }\n  const actualEvents = [...veDebugEventsLog] as TestLogEntry[];\n  let partialMatch = false;\n  const matchedImpressions = new Set<string>();\n  pendingEventExpectation.unmatchedEvents = [];\n  for (let i = 0; i < pendingEventExpectation.expectedEvents.length; ++i) {\n    const expectedEvent = pendingEventExpectation.expectedEvents[i];\n    while (true) {\n      if (actualEvents.length <= i) {\n        pendingEventExpectation.missingEvents = pendingEventExpectation.expectedEvents.slice(i);\n        for (const event of pendingEventExpectation.missingEvents) {\n          if ('impressions' in event) {\n            event.impressions = event.impressions.filter(impression => !matchedImpressions.has(impression));\n          }\n        }\n        return;\n      }\n      if (!compareVeEvents(actualEvents[i], expectedEvent)) {\n        if (partialMatch) {\n          const unmatched = {...actualEvents[i]};\n          if ('impressions' in unmatched && 'impressions' in expectedEvent) {\n            unmatched.impressions = unmatched.impressions.filter(impression => {\n              const matched = expectedEvent.impressions.includes(impression);\n              if (matched) {\n                matchedImpressions.add(impression);\n              }\n              return !matched;\n            });\n          }\n          pendingEventExpectation.unmatchedEvents.push(unmatched);\n        }\n        actualEvents.splice(i, 1);\n      } else {\n        partialMatch = true;\n        break;\n      }\n    }\n  }\n  numMatchedEvents = veDebugEventsLog.length - actualEvents.length + pendingEventExpectation.expectedEvents.length;\n  pendingEventExpectation.success();\n}\n\nfunction getUnmatchedVeEvents(): string {\n  console.error(numMatchedEvents);\n  return formatVeEvents(veDebugEventsLog.slice(numMatchedEvents) as TestLogEntry[]);\n}\n\n// @ts-expect-error\nglobalThis.setVeDebugLoggingEnabled = setVeDebugLoggingEnabled;\n// @ts-expect-error\nglobalThis.getUnmatchedVeEvents = getUnmatchedVeEvents;\n// @ts-expect-error\nglobalThis.veDebugEventsLog = veDebugEventsLog;\n// @ts-expect-error\nglobalThis.findVeDebugImpression = findVeDebugImpression;\n// @ts-expect-error\nglobalThis.exportAdHocAnalysisLogForSql = exportAdHocAnalysisLogForSql;\n// @ts-expect-error\nglobalThis.buildStateFlow = buildStateFlow;\n// @ts-expect-error\nglobalThis.expectVeEvents = expectVeEvents;\n"]}