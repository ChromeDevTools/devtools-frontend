{"version":3,"file":"main.js","sourceRoot":"","sources":["../../../../inspector_overlay/main.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport commonStyle from './common.css';\nimport {adoptStyleSheet} from './common.js';\nimport {gridStyle} from './highlight_grid_common.js';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport highlightGridStyle from './tool_grid.css';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport highlightStyle from './tool_highlight.css';\nimport {HighlightOverlay} from './tool_highlight.js';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport pausedStyle from './tool_paused.css';\nimport {PausedOverlay, type PausedToolMessage} from './tool_paused.js';\nimport {PersistentOverlay, type PersistentToolMessage} from './tool_persistent.js';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport screenshotStyle from './tool_screenshot.css';\nimport {ScreenshotOverlay, type ScreenshotToolMessage} from './tool_screenshot.js';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport sourceOrderStyle from './tool_source_order.css';\nimport {SourceOrderOverlay} from './tool_source_order.js';\nimport {ViewportSizeOverlay} from './tool_viewport_size.js';\n// @ts-expect-error Importing CSS is handled in Rollup.\nimport wcoStyle from './tool_window_controls.css';\nimport {WindowControlsOverlay} from './tool_window_controls.js';\n\ndeclare global {\n  interface Window {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    InspectorOverlayHost: {send(data: PausedToolMessage|PersistentToolMessage|ScreenshotToolMessage|string): void};\n  }\n}\n\nadoptStyleSheet(commonStyle);\n\nconst gridStyleSheet = new CSSStyleSheet();\ngridStyleSheet.replaceSync(gridStyle);\n\nconst highlightOverlay = new HighlightOverlay(window, [highlightStyle, gridStyleSheet]);\nconst persistentOverlay = new PersistentOverlay(window, [highlightGridStyle, gridStyleSheet]);\nconst pausedOverlay = new PausedOverlay(window, pausedStyle);\nconst screenshotOverlay = new ScreenshotOverlay(window, screenshotStyle);\nconst sourceOrderOverlay = new SourceOrderOverlay(window, sourceOrderStyle);\nconst viewportSizeOverlay = new ViewportSizeOverlay(window);\nconst windowControlsOverlay = new WindowControlsOverlay(window, [wcoStyle]);\n\ninterface Overlays {\n  highlight: HighlightOverlay;\n  persistent: PersistentOverlay;\n  paused: PausedOverlay;\n  screenshot: ScreenshotOverlay;\n  sourceOrder: SourceOrderOverlay;\n  viewportSize: ViewportSizeOverlay;\n  windowControlsOverlay: WindowControlsOverlay;\n}\n\ntype PlatformName = string;\n\n// Key in this object is the name the backend refers to a particular overlay by.\nconst overlays: Overlays = {\n  highlight: highlightOverlay,\n  persistent: persistentOverlay,\n  paused: pausedOverlay,\n  screenshot: screenshotOverlay,\n  sourceOrder: sourceOrderOverlay,\n  viewportSize: viewportSizeOverlay,\n  windowControlsOverlay,\n};\n\nlet currentOverlay: Overlays[keyof Overlays];\nlet platformName: PlatformName;\n\ninterface MessageLookup {\n  setOverlay: keyof Overlays;\n  setPlatform: PlatformName;\n  drawingFinished: '';\n}\n\nconst dispatch = <K extends keyof MessageLookup>(message: [a: K, b: MessageLookup[K]]) => {\n  const functionName = message[0];\n  if (functionName === 'setOverlay') {\n    const overlayName = message[1] as keyof Overlays;\n    if (currentOverlay) {\n      currentOverlay.uninstall();\n    }\n    currentOverlay = overlays[overlayName];\n    currentOverlay.setPlatform(platformName);\n    // TODO: setPlatform invokes install() for compatibility with the backend.\n    // The call to install() can be removed from setPlatform() after the backend is updated.\n    if (!currentOverlay.installed) {\n      currentOverlay.install();\n    }\n  } else if (functionName === 'setPlatform') {\n    platformName = message[1];\n  } else if (functionName === 'drawingFinished') {\n    // TODO The logic needs to be added here once the backend starts sending this event.\n  } else {\n    currentOverlay.dispatch(message);\n  }\n};\n\n// Window has an additional dispatch function added, so retype as unknown first\n(window as unknown as {dispatch: typeof dispatch}).dispatch = dispatch;\n"]}