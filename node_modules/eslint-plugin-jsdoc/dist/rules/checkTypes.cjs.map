{"version":3,"file":"checkTypes.cjs","names":["_buildRejectOrPreferRuleDefinition","require","_jsdocUtils","checkNativeTypes","preferredTypes","typeNodeName","preferred","parentNode","invalidTypes","changedPreferred","strictNativeType","strictNativeTypes","elements","length","left","type","value","toLowerCase","undefined","push","_default","exports","default","buildRejectOrPreferRuleDefinition","schema","additionalProperties","properties","exemptTagContexts","description","items","tag","types","oneOf","noDefaults","unifyParentAndChildTypeChecks","module"],"sources":["../../src/rules/checkTypes.js"],"sourcesContent":["import {\n  buildRejectOrPreferRuleDefinition,\n} from '../buildRejectOrPreferRuleDefinition.js';\nimport {\n  strictNativeTypes,\n} from '../jsdocUtils.js';\n\n/**\n * @callback CheckNativeTypes\n * Iterates strict types to see if any should be added to `invalidTypes` (and\n * the the relevant strict type returned as the new preferred type).\n * @param {import('../iterateJsdoc.js').PreferredTypes} preferredTypes\n * @param {string} typeNodeName\n * @param {string|undefined} preferred\n * @param {import('jsdoc-type-pratt-parser').NonRootResult|undefined} parentNode\n * @param {(string|false|undefined)[][]} invalidTypes\n * @returns {string|undefined} The `preferred` type string, optionally changed\n */\n\n/** @type {CheckNativeTypes} */\nconst checkNativeTypes = (preferredTypes, typeNodeName, preferred, parentNode, invalidTypes) => {\n  let changedPreferred = preferred;\n  for (const strictNativeType of strictNativeTypes) {\n    if (\n      strictNativeType === 'object' &&\n      (\n        // This is not set to remap with exact type match (e.g.,\n        //   `object: 'Object'`), so can ignore (including if circular)\n        !preferredTypes?.[typeNodeName] ||\n        // Although present on `preferredTypes` for remapping, this is a\n        //   parent object without a parent match (and not\n        //   `unifyParentAndChildTypeChecks`) and we don't want\n        //   `object<>` given TypeScript issue https://github.com/microsoft/TypeScript/issues/20555\n        /**\n         * @type {import('jsdoc-type-pratt-parser').GenericResult}\n         */\n        (\n          parentNode\n        )?.elements?.length && (\n        /**\n         * @type {import('jsdoc-type-pratt-parser').GenericResult}\n         */\n          (\n            parentNode\n          )?.left?.type === 'JsdocTypeName' &&\n          /**\n           * @type {import('jsdoc-type-pratt-parser').GenericResult}\n           */\n          (parentNode)?.left?.value === 'Object'\n        )\n      )\n    ) {\n      continue;\n    }\n\n    if (strictNativeType !== typeNodeName &&\n      strictNativeType.toLowerCase() === typeNodeName.toLowerCase() &&\n\n      // Don't report if user has own map for a strict native type\n      (!preferredTypes || preferredTypes?.[strictNativeType] === undefined)\n    ) {\n      changedPreferred = strictNativeType;\n      invalidTypes.push([\n        typeNodeName, changedPreferred,\n      ]);\n      break;\n    }\n  }\n\n  return changedPreferred;\n};\n\nexport default buildRejectOrPreferRuleDefinition({\n  checkNativeTypes,\n  schema: [\n    {\n      additionalProperties: false,\n      properties: {\n        exemptTagContexts: {\n          description: 'Avoids reporting when a bad type is found on a specified tag.',\n          items: {\n            additionalProperties: false,\n            properties: {\n              tag: {\n                description: 'Set a key `tag` to the tag to exempt',\n                type: 'string',\n              },\n              types: {\n                description: `Set to \\`true\\` to indicate that any types on that tag will be allowed,\nor to an array of strings which will only allow specific bad types.\nIf an array of strings is given, these must match the type exactly,\ne.g., if you only allow \\`\"object\"\\`, it will not allow\n\\`\"object<string, string>\"\\`. Note that this is different from the\nbehavior of \\`settings.jsdoc.preferredTypes\\`. This option is useful\nfor normally restricting generic types like \\`object\\` with\n\\`preferredTypes\\`, but allowing \\`typedef\\` to indicate that its base\ntype is \\`object\\`.`,\n                oneOf: [\n                  {\n                    type: 'boolean',\n                  },\n                  {\n                    items: {\n                      type: 'string',\n                    },\n                    type: 'array',\n                  },\n                ],\n              },\n            },\n            type: 'object',\n          },\n          type: 'array',\n        },\n        noDefaults: {\n          description: `Insists that only the supplied option type\nmap is to be used, and that the default preferences (such as \"string\"\nover \"String\") will not be enforced. The option's default is \\`false\\`.`,\n          type: 'boolean',\n        },\n        unifyParentAndChildTypeChecks: {\n          description: `@deprecated Use the \\`preferredTypes[preferredType]\\` setting of the same name instead.\nIf this option is \\`true\\`, will currently override \\`unifyParentAndChildTypeChecks\\` on the \\`preferredTypes\\` setting.`,\n          type: 'boolean',\n        },\n      },\n      type: 'object',\n    },\n  ],\n});\n"],"mappings":";;;;;;AAAA,IAAAA,kCAAA,GAAAC,OAAA;AAGA,IAAAC,WAAA,GAAAD,OAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAME,gBAAgB,GAAGA,CAACC,cAAc,EAAEC,YAAY,EAAEC,SAAS,EAAEC,UAAU,EAAEC,YAAY,KAAK;EAC9F,IAAIC,gBAAgB,GAAGH,SAAS;EAChC,KAAK,MAAMI,gBAAgB,IAAIC,6BAAiB,EAAE;IAChD,IACED,gBAAgB,KAAK,QAAQ;IAE3B;IACA;IACA,CAACN,cAAc,GAAGC,YAAY,CAAC;IAC/B;IACA;IACA;IACA;IACA;AACR;AACA;IAEUE,UAAU,EACTK,QAAQ,EAAEC,MAAM;IACnB;AACR;AACA;IAEYN,UAAU,EACTO,IAAI,EAAEC,IAAI,KAAK,eAAe;IACjC;AACV;AACA;IACWR,UAAU,EAAGO,IAAI,EAAEE,KAAK,KAAK,QAAQ,CACvC,CACF,EACD;MACA;IACF;IAEA,IAAIN,gBAAgB,KAAKL,YAAY,IACnCK,gBAAgB,CAACO,WAAW,CAAC,CAAC,KAAKZ,YAAY,CAACY,WAAW,CAAC,CAAC;IAE7D;IACC,CAACb,cAAc,IAAIA,cAAc,GAAGM,gBAAgB,CAAC,KAAKQ,SAAS,CAAC,EACrE;MACAT,gBAAgB,GAAGC,gBAAgB;MACnCF,YAAY,CAACW,IAAI,CAAC,CAChBd,YAAY,EAAEI,gBAAgB,CAC/B,CAAC;MACF;IACF;EACF;EAEA,OAAOA,gBAAgB;AACzB,CAAC;AAAC,IAAAW,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEa,IAAAC,oEAAiC,EAAC;EAC/CpB,gBAAgB;EAChBqB,MAAM,EAAE,CACN;IACEC,oBAAoB,EAAE,KAAK;IAC3BC,UAAU,EAAE;MACVC,iBAAiB,EAAE;QACjBC,WAAW,EAAE,+DAA+D;QAC5EC,KAAK,EAAE;UACLJ,oBAAoB,EAAE,KAAK;UAC3BC,UAAU,EAAE;YACVI,GAAG,EAAE;cACHF,WAAW,EAAE,sCAAsC;cACnDb,IAAI,EAAE;YACR,CAAC;YACDgB,KAAK,EAAE;cACLH,WAAW,EAAE;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;cACJI,KAAK,EAAE,CACL;gBACEjB,IAAI,EAAE;cACR,CAAC,EACD;gBACEc,KAAK,EAAE;kBACLd,IAAI,EAAE;gBACR,CAAC;gBACDA,IAAI,EAAE;cACR,CAAC;YAEL;UACF,CAAC;UACDA,IAAI,EAAE;QACR,CAAC;QACDA,IAAI,EAAE;MACR,CAAC;MACDkB,UAAU,EAAE;QACVL,WAAW,EAAE;AACvB;AACA,wEAAwE;QAC9Db,IAAI,EAAE;MACR,CAAC;MACDmB,6BAA6B,EAAE;QAC7BN,WAAW,EAAE;AACvB,yHAAyH;QAC/Gb,IAAI,EAAE;MACR;IACF,CAAC;IACDA,IAAI,EAAE;EACR,CAAC;AAEL,CAAC,CAAC;AAAAoB,MAAA,CAAAd,OAAA,GAAAA,OAAA,CAAAC,OAAA","ignoreList":[]}