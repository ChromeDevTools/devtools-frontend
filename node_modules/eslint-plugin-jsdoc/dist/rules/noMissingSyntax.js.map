{"version":3,"file":"noMissingSyntax.js","names":["setDefaults","state","selectorMap","incrementSelector","selector","comment","iterateJsdoc","context","node","info","sourceCode","options","contexts","foundContext","find","cntxt","esquery","matches","parse","visitorKeys","contextStr","contextSelected","exit","length","report","loc","start","column","line","message","some","contextKey","undefined","minimum","Object","values","every","cmmnt","data","end","matchContext","meta","docs","description","url","fixable","schema","additionalProperties","properties","items","anyOf","type"],"sources":["../../src/rules/noMissingSyntax.js"],"sourcesContent":["import esquery from 'esquery';\nimport iterateJsdoc from '../iterateJsdoc';\n\nconst setDefaults = (state) => {\n  if (!state.selectorMap) {\n    state.selectorMap = {};\n  }\n};\n\nconst incrementSelector = (state, selector, comment) => {\n  if (!state.selectorMap[selector]) {\n    state.selectorMap[selector] = {};\n  }\n\n  if (!state.selectorMap[selector][comment]) {\n    state.selectorMap[selector][comment] = 0;\n  }\n\n  state.selectorMap[selector][comment]++;\n};\n\nexport default iterateJsdoc(({\n  context,\n  node,\n  info: {\n    comment,\n  },\n  sourceCode,\n  state,\n}) => {\n  if (!context.options[0]) {\n    // Handle error later\n    return;\n  }\n\n  const {\n    contexts,\n  } = context.options[0];\n\n  const foundContext = contexts.find((cntxt) => {\n    return typeof cntxt === 'string' ?\n      esquery.matches(node, esquery.parse(cntxt), null, {\n        visitorKeys: sourceCode.visitorKeys,\n      }) :\n      (!cntxt.context || cntxt.context === 'any' || esquery.matches(node, esquery.parse(cntxt.context), null, {\n        visitorKeys: sourceCode.visitorKeys,\n      })) &&\n        comment === cntxt.comment;\n  });\n\n  const contextStr = typeof foundContext === 'object' ?\n    foundContext.context ?? 'any' :\n    foundContext;\n\n  setDefaults(state);\n\n  incrementSelector(state, contextStr, comment);\n}, {\n  contextSelected: true,\n  exit ({\n    context,\n    state,\n  }) {\n    if (!context.options.length) {\n      context.report({\n        loc: {\n          start: {\n            column: 1,\n            line: 1,\n          },\n        },\n        message: 'Rule `no-missing-syntax` is missing a `context` option.',\n      });\n\n      return;\n    }\n\n    setDefaults(state);\n\n    const {\n      contexts,\n    } = context.options[0];\n\n    // Report when MISSING\n    contexts.some((cntxt) => {\n      const contextStr = typeof cntxt === 'object' ? cntxt.context ?? 'any' : cntxt;\n      const comment = cntxt?.comment ?? '';\n\n      const contextKey = contextStr === 'any' ? undefined : contextStr;\n\n      if (\n        (!state.selectorMap[contextKey] ||\n        !state.selectorMap[contextKey][comment] ||\n        state.selectorMap[contextKey][comment] < (cntxt?.minimum ?? 1)) &&\n        (contextStr !== 'any' || Object.values(state.selectorMap).every((cmmnt) => {\n          return !cmmnt[comment] || cmmnt[comment] < (cntxt?.minimum ?? 1);\n        }))\n      ) {\n        const message = cntxt?.message ?? 'Syntax is required: {{context}}' +\n          (comment ? ' with {{comment}}' : '');\n        context.report({\n          data: {\n            comment,\n            context: contextStr,\n          },\n          loc: {\n            end: {\n              line: 1,\n            },\n            start: {\n              line: 1,\n            },\n          },\n          message,\n        });\n\n        return true;\n      }\n\n      return false;\n    });\n  },\n  matchContext: true,\n  meta: {\n    docs: {\n      description: 'Reports when certain comment structures are always expected.',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc#eslint-plugin-jsdoc-rules-no-missing-syntax',\n    },\n    fixable: 'code',\n    schema: [\n      {\n        additionalProperties: false,\n        properties: {\n          contexts: {\n            items: {\n              anyOf: [\n                {\n                  type: 'string',\n                },\n                {\n                  additionalProperties: false,\n                  properties: {\n                    comment: {\n                      type: 'string',\n                    },\n                    context: {\n                      type: 'string',\n                    },\n                    message: {\n                      type: 'string',\n                    },\n                    minimum: {\n                      type: 'integer',\n                    },\n                  },\n                  type: 'object',\n                },\n              ],\n            },\n            type: 'array',\n          },\n        },\n        type: 'object',\n      },\n    ],\n    type: 'suggestion',\n  },\n});\n"],"mappings":"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"}